# Command&Control: (Worm) Zhelatin - regex: to_server:GET /\?404=Y detector_id: 7
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Zhelatin"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?404=Y"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?404=Y/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000007; rev:194;)

# Command&Control: (Dropper) Tibs - regex: to_server:GET /adv/.*adload\.php\?a1=.*&a2=.*&a3=.*&a4=.*&table=.* detector_id: 8
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Tibs"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/adv/"; content:"adload.php?a1="; content:"&a2="; content:"&a3="; content:"&a4="; content:"&table="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/adv\/.*adload\.php\?a1=.*&a2=.*&a3=.*&a4=.*&table=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000008; rev:1002;)

# Command&Control: (Trojan) C2Lop - regex: to_server:GET .*abt\?udata=(DELAFFID|WWW).* detector_id: 10
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) C2Lop"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"abt?udata="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*abt\?udata=(DELAFFID|WWW).*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000010; rev:393;)

# Command&Control: (Trojan) Alureon_3 TDSS - regex: to_server:GET .*ac\.php\?aid=.*&sid=.* detector_id: 11
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Alureon_3 TDSS"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"ac.php?aid="; content:"&sid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*ac\.php\?aid=.*&sid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000011; rev:194;)

# FakeAV: FakeXPA - regex: to_server:GET /\?act=fb&1=.*&2=.*&3=.*&4=.*&5=.*&6=.*&7=.*&8=.*&9=.*&10=.* detector_id: 12
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeXPA"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?act=fb&1="; content:"&2="; content:"&3="; content:"&4="; content:"&5="; content:"&6="; content:"&7="; content:"&8="; content:"&9="; content:"&10="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?act=fb&1=.*&2=.*&3=.*&4=.*&5=.*&6=.*&7=.*&8=.*&9=.*&10=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000012; rev:194;)

# FakeAV: FakeScanti - regex: to_server:GET .*action3\.cgi\?p=.*&a=.* detector_id: 13
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeScanti"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"action3.cgi?p="; content:"&a="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*action3\.cgi\?p=.*&a=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000013; rev:1002;)

# Command&Control: (Trojan) Bredolab  - regex: to_server:GET .*controller\.php\?action=bot&entity_list=.*&uid=.*&first=.*&guid=.*&rnd=.* detector_id: 14
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bredolab "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"controller.php?action=bot&entity_list="; content:"&uid="; content:"&first="; content:"&guid="; content:"&rnd="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*controller\.php\?action=bot&entity_list=.*&uid=.*&first=.*&guid=.*&rnd=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000014; rev:1002;)

# Command&Control: (Trojan) Bredolab - regex: to_server:GET .*controller\.php\?action=report&guid=.*&rnd=.*&uid=.*&entity=.* detector_id: 15
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bredolab"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"controller.php?action=report&guid="; content:"&rnd="; content:"&uid="; content:"&entity="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*controller\.php\?action=report&guid=.*&rnd=.*&uid=.*&entity=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000015; rev:1002;)

# FakeAV: WinFixer - regex: to_server:GET /\?action=.*&type=.*&pc_id=.*&abbr=.*&err=.* detector_id: 16
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: WinFixer"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?action="; content:"&type="; content:"&pc_id="; content:"&abbr="; content:"&err="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?action=.*&type=.*&pc_id=.*&abbr=.*&err=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000016; rev:194;)

# FakeAV: FakeXPA - regex: to_server:GET /admin/cgi-bin/get_domain\.php\?type=.* detector_id: 17
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeXPA"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/admin/cgi-bin/get_domain.php?type="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/admin\/cgi-bin\/get_domain\.php\?type=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000017; rev:1002;)

# Command&Control: (Dropper) Tibs - regex: to_server:GET .*\.php\?adv=\d*&code1=[A-Z]*&code2=\d* detector_id: 18
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Tibs"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?adv="; content:"&code1="; content:"&code2="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php\?adv=\d*&code1=[A-Z]*&code2=\d*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000018; rev:1002;)

# Command&Control: (Dropper) Tibs - regex: to_server:GET .*\.php\?adv=\d*&code1=[A-Z]*&code2=\d*&id=.* detector_id: 19
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Tibs"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?adv="; content:"&code1="; content:"&code2="; content:"&id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php\?adv=\d*&code1=[A-Z]*&code2=\d*&id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000019; rev:1002;)

# Command&Control: (Dropper) Nuwar - regex: to_server:GET .*cntr\.php\?e=.*&x=.*&y=.* detector_id: 20
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Nuwar"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"cntr.php?e="; content:"&x="; content:"&y="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*cntr\.php\?e=.*&x=.*&y=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000020; rev:1002;)

# Command&Control: (Dropper) Renos - regex: to_server:GET /[a-f]{3}9999\.php\?aid=.*&uid=.*&os=.* detector_id: 21
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Renos"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"9999.php?aid="; content:"&uid="; content:"&os="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-f]{3}9999\.php\?aid=.*&uid=.*&os=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000021; rev:1002;)

# Adware: (Downware) KwSearch - regex: to_server:GET .*alive\.php\?ovt=.* detector_id: 22
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) KwSearch"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"alive.php?ovt="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*alive\.php\?ovt=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000022; rev:1002;)

# Command&Control: (Dropper) QQHelper - regex: to_server:GET /barbindsoft/barsetup\.exe\?queryid=.* detector_id: 24
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) QQHelper"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/barbindsoft/barsetup.exe?queryid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/barbindsoft\/barsetup\.exe\?queryid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000024; rev:1002;)

# Command&Control: (Backdoor) Prorat - regex: to_server:GET .*\?bilgisayaradi=.*&ipadresi=.*&serverportu=.*&kurban=.*&servermodeli=.*&serversaati=.*&servertarihi=.*&serversifre=.*&islem= detector_id: 25
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Prorat"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?bilgisayaradi="; content:"&ipadresi="; content:"&serverportu="; content:"&kurban="; content:"&servermodeli="; content:"&serversaati="; content:"&servertarihi="; content:"&serversifre="; content:"&islem="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\?bilgisayaradi=.*&ipadresi=.*&serverportu=.*&kurban=.*&servermodeli=.*&serversaati=.*&servertarihi=.*&serversifre=.*&islem=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000025; rev:316;)

# Command&Control: (Dropper) Seimon - regex: to_server:GET /bin/AGTMKCLS[A-Z]\.php\?key=.* detector_id: 26
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Seimon"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bin/AGTMKCLS"; content:".php?key="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bin\/AGTMKCLS[A-Z]\.php\?key=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000026; rev:1002;)

# Command&Control: (Trojan) Virut_2 - regex: to_server:GET /binaries/installer\.php\?a=.* detector_id: 27
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Virut_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/binaries/installer.php?a="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/binaries\/installer\.php\?a=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000027; rev:1002;)

# Command&Control: (Dropper) Swizzor C2Lop  - regex: to_server:GET /bins/int/.*\.int\?fxp=.* detector_id: 28
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Swizzor C2Lop "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bins/int/"; content:".int?fxp="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bins\/int\/.*\.int\?fxp=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000028; rev:1002;)

# Command&Control: (Dropper) Seimon  - regex: to_server:GET /bin/update\.php\?key=.* detector_id: 29
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Seimon "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bin/update.php?key="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bin\/update\.php\?key=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000029; rev:1002;)

# Command&Control: (Worm) Warezov - regex: to_server:GET /chr/\d*/e/b\?lid=[A-F0-9]*&pt=.* detector_id: 30
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Warezov"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/chr/"; content:"/e/b?lid="; content:"&pt="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/chr\/\d*\/e\/b\?lid=[A-F0-9]*&pt=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000030; rev:184;)

# Command&Control: (Dropper) Tibs - regex: to_server:GET /cc/srtytrewqertytrew\.php\?affid=.*&code1=.*&code2=.* detector_id: 31
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Tibs"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cc/srtytrewqertytrew.php?affid="; content:"&code1="; content:"&code2="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cc\/srtytrewqertytrew\.php\?affid=.*&code1=.*&code2=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000031; rev:1002;)

# Command&Control: (Dropper) Wzhyk - regex: to_server:GET /cd/cd\.php\?id=.*&ver=.* detector_id: 32
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Wzhyk"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cd/cd.php?id="; content:"&ver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cd\/cd\.php\?id=.*&ver=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000032; rev:1002;)

# Command&Control: (Trojan) Papras Ursnif - regex: to_server:GET /cgi-bin/.*\.cgi\?user_id=.*&version_id=.*&passphrase=.*&socks=.*&version=.*&crc=.* detector_id: 33
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Papras Ursnif"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cgi-bin/"; content:".cgi?user_id="; content:"&version_id="; content:"&passphrase="; content:"&socks="; content:"&version="; content:"&crc="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cgi-bin\/.*\.cgi\?user_id=.*&version_id=.*&passphrase=.*&socks=.*&version=.*&crc=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000033; rev:1002;)

# Command&Control: (Dropper) CWS - regex: to_server:GET /cgi-script/receiver\.fcgi\?id=.*&sent=.*&lost=.* detector_id: 34
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) CWS"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cgi-script/receiver.fcgi?id="; content:"&sent="; content:"&lost="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cgi-script\/receiver\.fcgi\?id=.*&sent=.*&lost=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000034; rev:1002;)

# Command&Control: (Trojan) Virut_2 - regex: to_server:GET /checkin\.php\?affid=.*&msg=(success|stamp) detector_id: 35
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Virut_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/checkin.php?affid="; content:"&msg="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/checkin\.php\?affid=.*&msg=(success|stamp)/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000035; rev:1002;)

# Command&Control: (Dropper) Zlob - regex: to_server:GET /cload\.php\?aff=.*&saff=.* detector_id: 36
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Zlob"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cload.php?aff="; content:"&saff="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cload\.php\?aff=.*&saff=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000036; rev:1002;)

# Command&Control: (Dropper) Nuwar - regex: to_server:GET .*cntr\.php\?b=.*&c=.*&d=.* detector_id: 37
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Nuwar"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"cntr.php?b="; content:"&c="; content:"&d="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*cntr\.php\?b=.*&c=.*&d=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000037; rev:1002;)

# FakeAV: FakeXPA - regex: to_server:GET /collection\.php\?step=.*_(install_exe|install_run|expanded|complete|uninstall_complete)&id=.* detector_id: 39
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeXPA"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/collection.php?step="; content:"&id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/collection\.php\?step=.*_(install_exe|install_run|expanded|complete|uninstall_complete)&id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000039; rev:1002;)

# Command&Control: (Dialer) Skintrim - regex: to_server:GET /Common/module\.php\?icp=.*&id_site=.*&referer1=.*&customid=.*&dl_tracker=.* detector_id: 40
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dialer) Skintrim"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Common/module.php?icp="; content:"&id_site="; content:"&referer1="; content:"&customid="; content:"&dl_tracker="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Common\/module\.php\?icp=.*&id_site=.*&referer1=.*&customid=.*&dl_tracker=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000040; rev:1002;)

# Command&Control: (Dialer) Skintrim - regex: to_server:GET /Common/module\.php\?login=.*&brokerid=.*&extlogin=.*&customid=.*&no_product_name=.* detector_id: 41
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dialer) Skintrim"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Common/module.php?login="; content:"&brokerid="; content:"&extlogin="; content:"&customid="; content:"&no_product_name="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Common\/module\.php\?login=.*&brokerid=.*&extlogin=.*&customid=.*&no_product_name=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000041; rev:1002;)

# Command&Control: (Dialer) Skintrim - regex: to_server:GET /Common/module\.php\?login=.*&customid=.*&mediaid=.*&no_product_name=.*&product=.* detector_id: 42
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dialer) Skintrim"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Common/module.php?login="; content:"&customid="; content:"&mediaid="; content:"&no_product_name="; content:"&product="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Common\/module\.php\?login=.*&customid=.*&mediaid=.*&no_product_name=.*&product=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000042; rev:1002;)

# Command&Control: (Dropper) Zlob_1 - regex: to_server:GET /confirm\.php\?aid=.*&said=.*&mac=.*&mn=.* detector_id: 43
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Zlob_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/confirm.php?aid="; content:"&said="; content:"&mac="; content:"&mn="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/confirm\.php\?aid=.*&said=.*&mac=.*&mn=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000043; rev:1002;)

# Command&Control: (Trojan) Mbdis - regex: to_server:GET .*confirm\.php\?num=.*&rev=.*&code=.* detector_id: 44
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Mbdis"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"confirm.php?num="; content:"&rev="; content:"&code="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*confirm\.php\?num=.*&rev=.*&code=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000044; rev:1002;)

# Command&Control: (Dropper) Cekar - regex: to_server:GET /count/count\.asp\?mac=.*&ver=.*&user=.*&pc=.*&md5=.* detector_id: 45
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Cekar"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/count/count.asp?mac="; content:"&ver="; content:"&user="; content:"&pc="; content:"&md5="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/count\/count\.asp\?mac=.*&ver=.*&user=.*&pc=.*&md5=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000045; rev:1002;)

# Command&Control: (Dropper) Renos - regex: to_server:GET /cset\.php\?id=g/7bOK.* detector_id: 46
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Renos"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cset.php?id=g/7bOK"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cset\.php\?id=g\/7bOK.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000046; rev:1002;)

# Command&Control: (Spambot) SdBot - regex: to_server:GET /c/sh/.*\?a=0&g=0&b=0&t=0&c=0&d=0&rnd=.*&s_id=.*&ver=.*&r=.* detector_id: 47
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Spambot) SdBot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/c/sh/"; content:"?a=0&g=0&b=0&t=0&c=0&d=0&rnd="; content:"&s_id="; content:"&ver="; content:"&r="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/c\/sh\/.*\?a=0&g=0&b=0&t=0&c=0&d=0&rnd=.*&s_id=.*&ver=.*&r=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000047; rev:184;)

# Command&Control: (ClickBot) GenericClickBot_3  - regex: to_server:GET /deny\.php\?image=\d*\.jpg detector_id: 48
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (ClickBot) GenericClickBot_3 "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/deny.php?image="; content:".jpg"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/deny\.php\?image=\d*\.jpg/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000048; rev:1002;)

# Command&Control: (Dropper) Beenut - regex: to_server:GET /dl\?w=\d*&a=\d* detector_id: 50
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Beenut"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/dl?w="; content:"&a="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/dl\?w=\d*&a=\d*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000050; rev:184;)

# Adware: (Redirect) PagesInxt - regex: to_server:GET /\?dn=.*&flrdr=yes&nxte=.* detector_id: 51
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Redirect) PagesInxt"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?dn="; content:"&flrdr=yes&nxte="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?dn=.*&flrdr=yes&nxte=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000051; rev:391;)

# Command&Control: (Trojan) GenericTrojan_15 - regex: to_server:GET /server/npopup/.*dnl\.php\?file=.*\.exe detector_id: 52
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_15"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/server/npopup/"; content:"dnl.php?file="; content:".exe"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/server\/npopup\/.*dnl\.php\?file=.*\.exe/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000052; rev:1002;)

# FakeAV: Funshion - regex: to_server:GET .*download.php\?id=.* detector_id: 53
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: Funshion"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"download"; content:"php?id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*download.php\?id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000053; rev:2;)

# FakeAV: FakeScanti - regex: to_server:GET /d_program_all\.cgi\?host=.*&id=.* detector_id: 54
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeScanti"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/d_program_all.cgi?host="; content:"&id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/d_program_all\.cgi\?host=.*&id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000054; rev:1002;)

# Command&Control: (Dropper) Zlob_2 - regex: to_server:GET /dw\.php\?code=.*-.*-.*-.*-.*-.*&hash=.* detector_id: 55
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Zlob_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/dw.php?code="; content:"&hash="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/dw\.php\?code=.*-.*-.*-.*-.*-.*&hash=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000055; rev:1002;)

# Command&Control: (Dropper) GenericDropper_3  - regex: to_server:GET /er2\.txt\?t=\d,\d{6} detector_id: 56
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_3 "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/er2.txt?t="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/er2\.txt\?t=\d,\d{6}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000056; rev:1004;)

# Command&Control: (Dropper) Zlob - regex: to_server:GET /exe/get\.php\?pin=200002 detector_id: 57
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Zlob"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/exe/get.php?pin=200002"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/exe\/get\.php\?pin=200002/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000057; rev:1004;)

# Command&Control: (Trojan) Koobface_1 - regex: to_server:GET .*(first|gen)\.php\?f=0&a=.*&v=.*&c=0&s=.*&l=.*&ck=0&c_fb=0&c_ms=0&c_hi=0&c_tw=0&c_be=0&c_fr=.*&c_yb=.*&c_tg=0&c_nl=0&c_fu=.* detector_id: 58
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Koobface_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?f=0&a="; content:"&v="; content:"&c=0&s="; content:"&l="; content:"&ck=0&c_fb=0&c_ms=0&c_hi=0&c_tw=0&c_be=0&c_fr="; content:"&c_yb="; content:"&c_tg=0&c_nl=0&c_fu="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*(first|gen)\.php\?f=0&a=.*&v=.*&c=0&s=.*&l=.*&ck=0&c_fb=0&c_ms=0&c_hi=0&c_tw=0&c_be=0&c_fr=.*&c_yb=.*&c_tg=0&c_nl=0&c_fu=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000058; rev:1004;)

# Command&Control: (Dropper) GenericDropper_31 - regex: to_server:GET /\?feed=\d+&name=[A-F0-9]{20} detector_id: 59
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_31"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?feed="; content:"&name="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?feed=\d+&name=[A-F0-9]{20}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000059; rev:378;)

# Command&Control: (Dropper) GenericDropper_31 - regex: to_server:GET /\?feed=\d+&pid=\d+&dt=.{10}&v= detector_id: 60
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_31"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?feed="; content:"&pid="; content:"&dt="; content:"&v="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?feed=\d+&pid=\d+&dt=.{10}&v=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000060; rev:378;)

# Command&Control: (Trojan) GenericTrojan_29 - regex: to_server:GET /count\.php\?fid=.*&cid=[A-F0-9]{12}&ver=\d+&tid=\d+&sn= detector_id: 61
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_29"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/count.php?fid="; content:"&cid="; content:"&ver="; content:"&tid="; content:"&sn="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/count\.php\?fid=.*&cid=[A-F0-9]{12}&ver=\d+&tid=\d+&sn=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000061; rev:1004;)

# Adware: (Downware) RapidBlaster IstBar  - regex: to_server:GET .*fl\.run\?f=.*&c=.*User-Agent: MSIE6  detector_id: 62
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) RapidBlaster IstBar "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"fl.run?f="; content:"&c="; content:"User-Agent|3A| MSIE6 "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*fl\.run\?f=.*&c=.*User-Agent: MSIE6 /s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000062; rev:1004;)

# Command&Control: (Backdoor) Prorat - regex: to_server:GET /friendship/email_thank_you\.php\?folder_id=.*&params_count=0&nick_name=.*Pro.*Rat.*&user_email=.*&user_uin=.*&friend_nickname=.*&friend_contact=.*&friend_nickname2=.*&friend_contact2=.*&x=.*&y=.* detector_id: 63
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Prorat"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/friendship/email_thank_you.php?folder_id="; content:"&params_count=0&nick_name="; content:"Pro"; content:"Rat"; content:"&user_email="; content:"&user_uin="; content:"&friend_nickname="; content:"&friend_contact="; content:"&friend_nickname2="; content:"&friend_contact2="; content:"&x="; content:"&y="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/friendship\/email_thank_you\.php\?folder_id=.*&params_count=0&nick_name=.*Pro.*Rat.*&user_email=.*&user_uin=.*&friend_nickname=.*&friend_contact=.*&friend_nickname2=.*&friend_contact2=.*&x=.*&y=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000063; rev:1004;)

# Command&Control: (Dropper) Nurech - regex: to_server:GET /.*/get_exe\.php\?l=.* detector_id: 64
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Nurech"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get_exe.php?l="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\/get_exe\.php\?l=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000064; rev:1004;)

# Command&Control: (Dropper) GenericDropper_18 - regex: to_server:GET /get_frst\.php\?uid=[A-F0-9]{8} detector_id: 65
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_18"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get_frst.php?uid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get_frst\.php\?uid=[A-F0-9]{8}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000065; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_2 - regex: to_server:GET /getmac\.jsp\?x=.{17}&y=.*User-Agent: GOOGLE detector_id: 66
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/getmac.jsp?x="; content:"&y="; content:"User-Agent|3A| GOOGLE"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/getmac\.jsp\?x=.{17}&y=.*User-Agent: GOOGLE/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000066; rev:1004;)

# Command&Control: (Trojan) Alureon_4 - regex: to_server:GET /ctl/get\.php?file=cmds/(main|update) detector_id: 67
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Alureon_4"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ctl/get.ph"; content:"file=cmds/"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ctl\/get\.php?file=cmds\/(main|update)/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000067; rev:1004;)

# FakeAV: GenericFakeAV_7  - regex: to_server:GET /get/\?pin=.*&lnd=.*&type=.* detector_id: 68
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_7 "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get/?pin="; content:"&lnd="; content:"&type="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get\/\?pin=.*&lnd=.*&type=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000068; rev:184;)

# Command&Control: (Dropper) GenericDropper_29  - regex: to_server:GET /getsoft\.php\?id=\d+&soft=\d+ detector_id: 69
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_29 "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/getsoft.php?id="; content:"&soft="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/getsoft\.php\?id=\d+&soft=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000069; rev:1004;)

# Command&Control: (Dropper) GenericDropper_48 - regex: to_server:GET /getswf2/\?wmid=.*&wmcn=.*&lid=.*&slid=.*&vm=.*&d=.*&t=.* detector_id: 70
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_48"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/getswf2/?wmid="; content:"&wmcn="; content:"&lid="; content:"&slid="; content:"&vm="; content:"&d="; content:"&t="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/getswf2\/\?wmid=.*&wmcn=.*&lid=.*&slid=.*&vm=.*&d=.*&t=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000070; rev:194;)

# Command&Control: (Trojan) Cinmus - regex: to_server:GET /geturl\.php\?q=Fam.*&m=.* detector_id: 71
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Cinmus"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/geturl.php?q=Fam"; content:"&m="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/geturl\.php\?q=Fam.*&m=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000071; rev:1004;)

# Command&Control: (Trojan) Cinmus - regex: to_server:GET /geturl\.php\?version=.*&fid=.*&mac=.*&lversion=.*&wversion=.*&day=.*&name=.* detector_id: 72
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Cinmus"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/geturl.php?version="; content:"&fid="; content:"&mac="; content:"&lversion="; content:"&wversion="; content:"&day="; content:"&name="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/geturl\.php\?version=.*&fid=.*&mac=.*&lversion=.*&wversion=.*&day=.*&name=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000072; rev:1004;)

# Adware: (Downware) KwSearch - regex: to_server:GET .*global_xml\.php\?ovt=.* detector_id: 73
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) KwSearch"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"global_xml.php?ovt="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*global_xml\.php\?ovt=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000073; rev:1004;)

# Command&Control: (Dropper) GenericDropper_25 - regex: to_server:GET /icount\.php\?uid=\.[a-f0-9]{32} detector_id: 74
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_25"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/icount.php?uid=."; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/icount\.php\?uid=\.[a-f0-9]{32}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000074; rev:1004;)

# Command&Control: (Dropper) Renos - regex: to_server:GET /(file|script).*\.php\?id=.*&adv=0&uid=.*User-Agent: wget detector_id: 75
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Renos"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?id="; content:"&adv=0&uid="; content:"User-Agent|3A| wget"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(file|script).*\.php\?id=.*&adv=0&uid=.*User-Agent: wget/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000075; rev:1004;)

# Command&Control: (Trojan) Oficla - regex: to_server:GET .*php\?id=.*&v=.*&tm=.*&b=.* detector_id: 76
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Oficla"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"php?id="; content:"&v="; content:"&tm="; content:"&b="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*php\?id=.*&v=.*&tm=.*&b=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000076; rev:194;)

# Command&Control: (Dropper) YaFive - regex: to_server:GET /image/logo\.jpg\?queryid=.* detector_id: 77
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) YaFive"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/image/logo.jpg?queryid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/image\/logo\.jpg\?queryid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000077; rev:1004;)

# Command&Control: (Dropper) Lopin - regex: to_server:GET /images/images\.php\?w=.* detector_id: 78
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Lopin"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/images/images.php?w="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/images\/images\.php\?w=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000078; rev:1004;)

# FakeAV: AntispySolutions - regex: to_server:GET /img/\?fname=.*\.gif detector_id: 79
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: AntispySolutions"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/img/?fname="; content:".gif"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/img\/\?fname=.*\.gif/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000079; rev:1004;)

# Command&Control: (Trojan) Rodecap Cosmu - regex: to_server:GET /img/gt\.cgi\?s=\d*&r=.* detector_id: 80
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Rodecap Cosmu"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/img/gt.cgi?s="; content:"&r="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/img\/gt\.cgi\?s=\d*&r=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000080; rev:1004;)

# Command&Control: (Dropper) GenericDropper_49 - regex: to_server:GET /index\d\.php\?adv=\d+ detector_id: 82
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_49"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index"; content:".php?adv="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\d\.php\?adv=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000082; rev:1004;)

# Command&Control: (Trojan) Korgo - regex: to_server:GET /index\.php\?id=.*&scn=.*&inf=.*&ver=.*&cnt=(AUT|USA) detector_id: 83
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Korgo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?id="; content:"&scn="; content:"&inf="; content:"&ver="; content:"&cnt="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\?id=.*&scn=.*&inf=.*&ver=.*&cnt=(AUT|USA)/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000083; rev:1004;)

# FakeAV: WinWebSec - regex: to_server:GET /in\.php\?url=\d*&affid=\d* detector_id: 84
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: WinWebSec"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/in.php?url="; content:"&affid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/in\.php\?url=\d*&affid=\d*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000084; rev:1004;)

# Command&Control: (Dropper) FraudLoad - regex: to_server:GET /install\.php\?id=[a-f0-9]{32} detector_id: 85
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) FraudLoad"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/install.php?id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/install\.php\?id=[a-f0-9]{32}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000085; rev:1004;)

# Command&Control: (Dropper) GenericDropper_28 - regex: to_server:GET /install/\?track_id=\d{5} detector_id: 86
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_28"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/install/?track_id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/install\/\?track_id=\d{5}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000086; rev:378;)

# Command&Control: (Dropper) Zlob - regex: to_server:GET /inst/index\.php\?affid=.*&subid=.*&guid=.*&ver=.*&key=.* detector_id: 87
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Zlob"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/inst/index.php?affid="; content:"&subid="; content:"&guid="; content:"&ver="; content:"&key="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/inst\/index\.php\?affid=.*&subid=.*&guid=.*&ver=.*&key=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000087; rev:1004;)

# Command&Control: (Dropper) GenericDropper_3  - regex: to_server:GET /inst\.php\?id=\d{2}&sid=\d detector_id: 88
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_3 "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/inst.php?id="; content:"&sid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/inst\.php\?id=\d{2}&sid=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000088; rev:1004;)

# Command&Control: (Trojan) VaxVideo - regex: to_server:GET /inst\.php\?ID=\d*&Q=.* detector_id: 89
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) VaxVideo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/inst.php?ID="; content:"&Q="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/inst\.php\?ID=\d*&Q=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000089; rev:1004;)

# Adware: (Toolbar) ZenoSearch - regex: to_server:GET .*instreport.*\.asp\?uid=.*&ft=.* detector_id: 90
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) ZenoSearch"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"instreport"; content:".asp?uid="; content:"&ft="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*instreport.*\.asp\?uid=.*&ft=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000090; rev:164;)

# Adware: (Toolbar) ZenoSearch - regex: to_server:GET .*irdw2_1\.asp\?uid=.*&ft=.* detector_id: 91
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) ZenoSearch"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"irdw2_1.asp?uid="; content:"&ft="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*irdw2_1\.asp\?uid=.*&ft=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000091; rev:1004;)

# Command&Control: (Dropper) Seimon - regex: to_server:GET /[a-z]*irects\.php\?pid=.* detector_id: 92
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Seimon"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"irects.php?pid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]*irects\.php\?pid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000092; rev:1004;)

# Command&Control: (Trojan) Busky - regex: to_server:GET /K/.*\?a=.*&k=.*&wmid=.*&ucid=.* detector_id: 93
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Busky"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/K/"; content:"?a="; content:"&k="; content:"&wmid="; content:"&ucid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/K\/.*\?a=.*&k=.*&wmid=.*&ucid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000093; rev:194;)

# Command&Control: (Trojan) Qhost - regex: to_server:GET /l3/\?q=counter&id=.*&cid=[a-f0-9]{32} detector_id: 94
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Qhost"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/l3/?q=counter&id="; content:"&cid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/l3\/\?q=counter&id=.*&cid=[a-f0-9]{32}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000094; rev:164;)

# Command&Control: (Trojan) Virut - regex: to_server:GET .*lgate\.php\?n=[A-F0-9]{16} detector_id: 95
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Virut"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"lgate.php?n="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*lgate\.php\?n=[A-F0-9]{16}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000095; rev:1004;)

# FakeAV: FakeSpyProtect - regex: to_server:GET /loads\.php\?r=\d*\.\d*.*User-Agent: Microsoft Internet Explorer detector_id: 96
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeSpyProtect"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/loads.php?r="; content:"User-Agent|3A| Microsoft Internet Explorer"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/loads\.php\?r=\d*\.\d*.*User-Agent: Microsoft Internet Explorer/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000096; rev:1004;)

# Command&Control: (Dropper) Seimon - regex: to_server:GET /log/proc\.php\?key=.* detector_id: 97
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Seimon"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/log/proc.php?key="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/log\/proc\.php\?key=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000097; rev:1004;)

# Command&Control: (Dropper) Seimon - regex: to_server:GET /log/proc\.php\?mode=.*&key=.* detector_id: 98
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Seimon"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/log/proc.php?mode="; content:"&key="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/log\/proc\.php\?mode=.*&key=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000098; rev:1004;)

# Adware: (Game) CasinoOnline - regex: to_server:GET /logs\.asp\?MSGID=\d*&DATA=.* detector_id: 99
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Game) CasinoOnline"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/logs.asp?MSGID="; content:"&DATA="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/logs\.asp\?MSGID=\d*&DATA=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000099; rev:1004;)

# Command&Control: (Dropper) Renos_7 - regex: to_server:GET /lr/.*\.php\?data=z/cJ.* detector_id: 100
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Renos_7"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/lr/"; content:".php?data=z/cJ"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/lr\/.*\.php\?data=z\/cJ.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000100; rev:1004;)

# Command&Control: (Trojan) Cutwail - regex: to_server:GET /s_\d*_\d*\?m=.*&a=.*&os=.* detector_id: 102
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Cutwail"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/s_"; content:"?m="; content:"&a="; content:"&os="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/s_\d*_\d*\?m=.*&a=.*&os=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000102; rev:487;)

# Command&Control: (Dropper) Cekar - regex: to_server:GET .*count\count\.asp\?mac=.*&ver=.*&user=.*&pc=.*&md5=.* detector_id: 103
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Cekar"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"countcount.asp?mac="; content:"&ver="; content:"&user="; content:"&pc="; content:"&md5="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*count\count\.asp\?mac=.*&ver=.*&user=.*&pc=.*&md5=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000103; rev:1004;)

# Command&Control: (Trojan) DogRobot - regex: to_server:GET .*[Cc]ount\.asp\?mac=.*&ver=.*&os=.* detector_id: 104
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) DogRobot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"ount.asp?mac="; content:"&ver="; content:"&os="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*[Cc]ount\.asp\?mac=.*&ver=.*&os=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000104; rev:1004;)

# Command&Control: (Trojan) Sality_1 - regex: to_server:GET /main/(rb|spxx|ptch)\.html\?rnd=.* detector_id: 105
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sality_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/main/"; content:".html?rnd="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/main\/(rb|spxx|ptch)\.html\?rnd=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000105; rev:1004;)

# Command&Control: (Trojan) Koceg Socks - regex: to_server:GET /manda\.php\?id=.*&l=.*&v=.* detector_id: 106
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Koceg Socks"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/manda.php?id="; content:"&l="; content:"&v="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/manda\.php\?id=.*&l=.*&v=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000106; rev:1004;)

# Command&Control: (Trojan) Koceg Socks  - regex: to_server:GET /manda\.php\?id=.*&v=.* detector_id: 107
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Koceg Socks "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/manda.php?id="; content:"&v="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/manda\.php\?id=.*&v=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000107; rev:1004;)

# Command&Control: (Trojan) Koceg Socks  - regex: to_server:GET /manda\.php\?id=.*&v=.*&s=.*&cip=.*&lid=.* detector_id: 108
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Koceg Socks "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/manda.php?id="; content:"&v="; content:"&s="; content:"&cip="; content:"&lid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/manda\.php\?id=.*&v=.*&s=.*&cip=.*&lid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000108; rev:1004;)

# Command&Control: (Dropper) GenericDropper_51 - regex: to_server:GET //m\.php\?aid= detector_id: 109
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_51"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"//m.php?aid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\/m\.php\?aid=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000109; rev:1004;)

# Command&Control: (Worm) Bobax - regex: to_server:GET .*new_array2\.php\?get_tst=.*&randnumba=.*&uptime=.* detector_id: 110
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Bobax"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"new_array2.php?get_tst="; content:"&randnumba="; content:"&uptime="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*new_array2\.php\?get_tst=.*&randnumba=.*&uptime=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000110; rev:1004;)

# Command&Control: (Worm) Bobax - regex: to_server:GET .*new_array2\.php\?randnumba=.*&uptime=.* detector_id: 111
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Bobax"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"new_array2.php?randnumba="; content:"&uptime="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*new_array2\.php\?randnumba=.*&uptime=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000111; rev:1004;)

# Command&Control: (Dropper) Sagnusnagta - regex: to_server:GET /\d*/\?n=.*&id=.*&t=.*&i=.* detector_id: 112
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Sagnusnagta"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?n="; content:"&id="; content:"&t="; content:"&i="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d*\/\?n=.*&id=.*&t=.*&i=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000112; rev:194;)

# Command&Control: (Trojan) Busky - regex: to_server:GET /NL2/\?w=.*&ucid=.*&e=.*&err=.* detector_id: 113
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Busky"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/NL2/?w="; content:"&ucid="; content:"&e="; content:"&err="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/NL2\/\?w=.*&ucid=.*&e=.*&err=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000113; rev:194;)

# Command&Control: (Trojan) GenericTrojan_15 - regex: to_server:GET /NL/.*\?id=.*&e=.*&err=.*&c=.* detector_id: 114
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_15"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/NL/"; content:"?id="; content:"&e="; content:"&err="; content:"&c="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/NL\/.*\?id=.*&e=.*&err=.*&c=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000114; rev:184;)

# Adware: PurityScan - regex: to_server:GET .*notify\.php\?pid=.*&module=.*&v=.*&b=.*&result=.*&message=.*&tag=.* detector_id: 115
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: PurityScan"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"notify.php?pid="; content:"&module="; content:"&v="; content:"&b="; content:"&result="; content:"&message="; content:"&tag="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*notify\.php\?pid=.*&module=.*&v=.*&b=.*&result=.*&message=.*&tag=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000115; rev:1004;)

# Command&Control: (Trojan) Vundo_3 - regex: to_server:GET /pas/apstpldr.dll.html\?affid=.*&uid=.*&guid=.* detector_id: 116
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Vundo_3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/pas/apstpldr"; content:"dll"; content:"html?affid="; content:"&uid="; content:"&guid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/pas\/apstpldr.dll.html\?affid=.*&uid=.*&guid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000116; rev:184;)

# Command&Control: (Dropper) GenericDropper_25 - regex: to_server:GET /pdone\.php\?uid=.*&pcodes=.* detector_id: 117
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_25"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/pdone.php?uid="; content:"&pcodes="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/pdone\.php\?uid=.*&pcodes=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000117; rev:1004;)

# Command&Control: (Dropper) Alphabet - regex: to_server:GET /firststart\.php\?pid=.*&dt=.*&v=.* detector_id: 118
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Alphabet"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/firststart.php?pid="; content:"&dt="; content:"&v="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/firststart\.php\?pid=.*&dt=.*&v=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000118; rev:1004;)

# Command&Control: (Worm) Bagle - regex: to_server:GET .*news\.php\?p=.*&id=.*&e=.*User-Agent: szNotifyIdent detector_id: 119
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Bagle"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"news.php?p="; content:"&id="; content:"&e="; content:"User-Agent|3A| szNotifyIdent"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*news\.php\?p=.*&id=.*&e=.*User-Agent: szNotifyIdent/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000119; rev:1004;)

# Command&Control: (Dropper) GenericDropper_51 - regex: to_server:GET /plist\.php\?uid=[a-f0-9]{32} detector_id: 120
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_51"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/plist.php?uid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/plist\.php\?uid=[a-f0-9]{32}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000120; rev:1004;)

# Command&Control: (Dropper) Harnig - regex: to_server:GET /progs/[a-z]{5,10}/[a-z]{5,10}\.php\?adv=adv\d+&code1=[A-Z]*&code2=\d*&id=.*&exp=.* detector_id: 121
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Harnig"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/progs/"; content:".php?adv=adv"; content:"&code1="; content:"&code2="; content:"&id="; content:"&exp="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/progs\/[a-z]{5,10}\/[a-z]{5,10}\.php\?adv=adv\d+&code1=[A-Z]*&code2=\d*&id=.*&exp=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000121; rev:1004;)

# Command&Control: (Trojan) Shutdowner - regex: to_server:GET /public/index\.php\?cmd=.* detector_id: 122
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Shutdowner"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/public/index.php?cmd="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/public\/index\.php\?cmd=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000122; rev:1004;)

# Command&Control: (Trojan) Shutdowner  - regex: to_server:GET /public/index\.php\?id=.*&cmd=trackers detector_id: 123
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Shutdowner "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/public/index.php?id="; content:"&cmd=trackers"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/public\/index\.php\?id=.*&cmd=trackers/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000123; rev:1004;)

# Command&Control: (Trojan) Shutdowner  - regex: to_server:GET /public/index\.php\?id=.*&cmd=update&ver=.* detector_id: 124
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Shutdowner "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/public/index.php?id="; content:"&cmd=update&ver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/public\/index\.php\?id=.*&cmd=update&ver=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000124; rev:1004;)

# Command&Control: (Trojan) Shutdowner  - regex: to_server:GET /public/index\.php\?register=.* detector_id: 125
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Shutdowner "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/public/index.php?register="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/public\/index\.php\?register=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000125; rev:1004;)

# Command&Control: (Trojan) Tofsee - regex: to_server:GET .*q\.php\?m=.*&a=.*&x=.*&i=.*&v=.*&c= detector_id: 126
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Tofsee"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"q.php?m="; content:"&a="; content:"&x="; content:"&i="; content:"&v="; content:"&c="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*q\.php\?m=.*&a=.*&x=.*&i=.*&v=.*&c=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000126; rev:1004;)

# FakeAV: InternetAntivirus TDSS - regex: to_server:GET /reports/download-report\.php\?prod_id=.* detector_id: 127
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: InternetAntivirus TDSS"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/reports/download-report.php?prod_id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/reports\/download-report\.php\?prod_id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000127; rev:1004;)

# Command&Control: (Trojan) Sality_4 - regex: to_server:GET .*/\?rnd=.*&id=.*User-Agent: KUKU v4 detector_id: 128
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sality_4"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?rnd="; content:"&id="; content:"User-Agent|3A| KUKU v4"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/\?rnd=.*&id=.*User-Agent: KUKU v4/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000128; rev:194;)

# Command&Control: (SpamBot) SdBot - regex: to_server:GET .*\?a=.*&g=.*&b=.*&t=.*&c=.*&d=.*rnd=.*&s_id=.*&ver=.*&r=.*User-Agent: SPM_ID=.* detector_id: 129
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (SpamBot) SdBot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?a="; content:"&g="; content:"&b="; content:"&t="; content:"&c="; content:"&d="; content:"rnd="; content:"&s_id="; content:"&ver="; content:"&r="; content:"User-Agent|3A| SPM_ID="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\?a=.*&g=.*&b=.*&t=.*&c=.*&d=.*rnd=.*&s_id=.*&ver=.*&r=.*User-Agent: SPM_ID=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000129; rev:184;)

# Command&Control: (Trojan) GenericTrojan_21 - regex: to_server:GET .*/robo\.php\?r=\d+ HTTP detector_id: 130
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_21"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/robo.php?r="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/robo\.php\?r=\d+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000130; rev:1004;)

# Command&Control: (Dropper) GenericDropper_18 - regex: to_server:GET /rp\.txt\?uid=.{36}&iam=I&st=Ok detector_id: 131
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_18"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/rp.txt?uid="; content:"&iam=I&st=Ok"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/rp\.txt\?uid=.{36}&iam=I&st=Ok/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000131; rev:1004;)

# Command&Control: (Dropper) GenericDropper_18 - regex: to_server:GET /rp\.txt\?ver.{1,6}&uid=.{36}&iam=I&st=(Ok|DnFl) detector_id: 132
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_18"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/rp.txt?ver"; content:"&uid="; content:"&iam=I&st="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/rp\.txt\?ver.{1,6}&uid=.{36}&iam=I&st=(Ok|DnFl)/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000132; rev:625;)

# Command&Control: (Dropper) GenericDropper_27 - regex: to_server:GET /[a-z]{4,8}/runned\.php\?self=\d{16}&type=.*&key=.* detector_id: 133
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_27"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/runned.php?self="; content:"&type="; content:"&key="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{4,8}\/runned\.php\?self=\d{16}&type=.*&key=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000133; rev:1004;)

# Adware: ScreenBlaze - regex: to_server:GET /scr2\.php\?id=.*&serial=.*&ver=.* detector_id: 134
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: ScreenBlaze"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/scr2.php?id="; content:"&serial="; content:"&ver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/scr2\.php\?id=.*&serial=.*&ver=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000134; rev:1004;)

# Adware: ScreenBlaze - regex: to_server:GET /scrdl\.php\?id=.* detector_id: 135
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: ScreenBlaze"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/scrdl.php?id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/scrdl\.php\?id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000135; rev:1004;)

# Command&Control: (Dropper) GenericDropper_28 - regex: to_server:GET /setup\.php\?track_id=\d{5} detector_id: 136
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_28"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/setup.php?track_id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/setup\.php\?track_id=\d{5}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000136; rev:1004;)

# Adware: (Toolbar) AdRotator - regex: to_server:GET /smb/nsi_install\.php\?inst_result=.*&hwid=.* detector_id: 137
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) AdRotator"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/smb/nsi_install.php?inst_result="; content:"&hwid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/smb\/nsi_install\.php\?inst_result=.*&hwid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000137; rev:1004;)

# Adware: (Downware) KwSearch - regex: to_server:GET .*statics\.php\?maddr=.*&ipaddr=.*&ovt=.*&action=.* detector_id: 138
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) KwSearch"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"statics.php?maddr="; content:"&ipaddr="; content:"&ovt="; content:"&action="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*statics\.php\?maddr=.*&ipaddr=.*&ovt=.*&action=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000138; rev:1004;)

# FakeAV: FakeAntiSpyware - regex: to_server:GET /stat\.php\?func=.*&id=.*&landing=-.* detector_id: 139
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeAntiSpyware"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/stat.php?func="; content:"&id="; content:"&landing=-"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/stat\.php\?func=.*&id=.*&landing=-.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000139; rev:1004;)

# FakeAV: FakeAntiSpyware  - regex: to_server:GET /stat\.php\?func=.*&uid=.*&landing=.* detector_id: 140
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeAntiSpyware "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/stat.php?func="; content:"&uid="; content:"&landing="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/stat\.php\?func=.*&uid=.*&landing=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000140; rev:1004;)

# FakeAV: FakeAntiSpyware  - regex: to_server:GET /stat\.php\?func=ok detector_id: 141
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeAntiSpyware "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/stat.php?func=ok"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/stat\.php\?func=ok/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000141; rev:1004;)

# Command&Control: (Trojan) PasswordStealer_1 - regex: to_server:GET .*\?szclientid=.*&szmac=.*&szusername=.*&szver=.*&mode=.*&value=.*&systype=.* detector_id: 143
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) PasswordStealer_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?szclientid="; content:"&szmac="; content:"&szusername="; content:"&szver="; content:"&mode="; content:"&value="; content:"&systype="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\?szclientid=.*&szmac=.*&szusername=.*&szver=.*&mode=.*&value=.*&systype=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000143; rev:178;)

# Command&Control: (Worm) Warezov - regex: to_server:GET /chr/.*/e/t\d*\?lid=[A-F0-9]* detector_id: 144
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Warezov"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/chr/"; content:"/e/t"; content:"?lid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/chr\/.*\/e\/t\d*\?lid=[A-F0-9]*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000144; rev:185;)

# Command&Control: (Dropper) Harnig - regex: to_server:GET .*/uniq\.php\?id=.* HTTP detector_id: 145
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Harnig"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/uniq.php?id="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/uniq\.php\?id=.* HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000145; rev:711;)

# Command&Control: (Dropper) Harnig - regex: to_server:GET .*/uniq\.php\?id=.*&p=1 detector_id: 146
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Harnig"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/uniq.php?id="; content:"&p=1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/uniq\.php\?id=.*&p=1/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000146; rev:711;)

# Command&Control: (Dropper) Swizzor - regex: to_server:GET /upd/check\?version=.*&fxp=.* detector_id: 147
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Swizzor"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/upd/check?version="; content:"&fxp="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/upd\/check\?version=.*&fxp=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000147; rev:194;)

# Command&Control: (Dropper) Zlob - regex: to_server:GET /up\.php\?advid=4683 detector_id: 148
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Zlob"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/up.php?advid=4683"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/up\.php\?advid=4683/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000148; rev:1004;)

# Command&Control: (Trojan) Emold - regex: to_server:GET .*ld\.php\?v=.*&rs=.*&n=.*&uid=.* detector_id: 149
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Emold"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"ld.php?v="; content:"&rs="; content:"&n="; content:"&uid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*ld\.php\?v=.*&rs=.*&n=.*&uid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000149; rev:1004;)

# Command&Control: (Trojan) Koobface - regex: to_server:GET /v\d*/\?v=.*&s=.*&uid=.*&p=.*&q=.* detector_id: 150
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Koobface"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/v"; content:"/?v="; content:"&s="; content:"&uid="; content:"&p="; content:"&q="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/v\d*\/\?v=.*&s=.*&uid=.*&p=.*&q=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000150; rev:184;)

# Command&Control: (Trojan) GenericTrojan_22 - regex: to_server:GET .*passport\.php\?ver=.*&tgid=.*&address=.*&flag=.*&alexa=.*&List=.* detector_id: 151
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_22"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"passport.php?ver="; content:"&tgid="; content:"&address="; content:"&flag="; content:"&alexa="; content:"&List="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*passport\.php\?ver=.*&tgid=.*&address=.*&flag=.*&alexa=.*&List=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000151; rev:1004;)

# Command&Control: (Dropper) Wadolin LdPinch - regex: to_server:GET .*doit\.php\?v=.*&id=[a-z0-9]*-\d*-\d*-\d*-\d* detector_id: 152
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Wadolin LdPinch"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"doit.php?v="; content:"&id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*doit\.php\?v=.*&id=[a-z0-9]*-\d*-\d*-\d*-\d*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000152; rev:1004;)

# Command&Control: (Dropper) GenericDropper_30 - regex: to_server:GET /freeware/\d/\?wmid=\d+&mid=.*&lndid=\d+&p=\d+ detector_id: 154
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_30"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/freeware/"; content:"/?wmid="; content:"&mid="; content:"&lndid="; content:"&p="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/freeware\/\d\/\?wmid=\d+&mid=.*&lndid=\d+&p=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000154; rev:378;)

# Command&Control: (Dropper) Bravix - regex: to_server:GET /\?wmid=.*&l=.*&it=.*&s=.* detector_id: 155
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Bravix"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?wmid="; content:"&l="; content:"&it="; content:"&s="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?wmid=.*&l=.*&it=.*&s=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000155; rev:194;)

# Command&Control: (Dropper) GenericDropper_29 - regex: to_server:GET /loader_stats\.php\?wm=.*&ucid=.*&e=.*&a=.* detector_id: 156
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_29"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/loader_stats.php?wm="; content:"&ucid="; content:"&e="; content:"&a="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/loader_stats\.php\?wm=.*&ucid=.*&e=.*&a=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000156; rev:1004;)

# Command&Control: (Trojan) Xorpix - regex: to_server:GET /work\.php\?spm=.*&method=.*&tds=.* detector_id: 157
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Xorpix"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/work.php?spm="; content:"&method="; content:"&tds="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/work\.php\?spm=.*&method=.*&tds=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000157; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_2 - regex: to_server:GET .*(helper|getmac)\.asp\?x=.{17}&y=.*&t=\d detector_id: 158
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".asp?x="; content:"&y="; content:"&t="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*(helper|getmac)\.asp\?x=.{17}&y=.*&t=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000158; rev:1004;)

# Adware: (Downware) KwSearch - regex: to_server:GET /xmlup/url_info_xml\.php\?ovt=.* detector_id: 159
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) KwSearch"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/xmlup/url_info_xml.php?ovt="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/xmlup\/url_info_xml\.php\?ovt=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000159; rev:1004;)

# Command&Control: (Dropper) Bofang - regex: to_server:GET /zd/\?v=.*&q=.* detector_id: 160
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Bofang"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/zd/?v="; content:"&q="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/zd\/\?v=.*&q=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000160; rev:443;)

# FakeAV: GenericFakeAV_7 - regex: to_server:HEAD /get/\?pin=.*&lnd=.*&type=.* detector_id: 161
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_7"; flow:established,to_server; content:"HEAD"; nocase; http_method; content:"HEAD "; content:"/get/?pin="; content:"&lnd="; content:"&type="; pcre:"/HEAD (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get\/\?pin=.*&lnd=.*&type=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000161; rev:184;)

# Command&Control: (Dropper) Bofang  - regex: to_server:HEAD /noc/\?v=.*&id=.* detector_id: 162
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Bofang "; flow:established,to_server; content:"HEAD"; nocase; http_method; content:"HEAD "; content:"/noc/?v="; content:"&id="; pcre:"/HEAD (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/noc\/\?v=.*&id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000162; rev:393;)

# Command&Control: (Dropper) Bofang - regex: to_server:HEAD /getsoft/task\.php\?v=.*&q=.* detector_id: 163
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Bofang"; flow:established,to_server; content:"HEAD"; nocase; http_method; content:"HEAD "; content:"/getsoft/task.php?v="; content:"&q="; pcre:"/HEAD (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/getsoft\/task\.php\?v=.*&q=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000163; rev:1004;)

# Command&Control: (Dropper) Renos_4 - regex: to_server:POST .*\.gif.*data=z6pEHas.* detector_id: 164
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Renos_4"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".gif"; content:"data=z6pEHas"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.gif.*data=z6pEHas.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000164; rev:179;)

# Command&Control: (Dropper) Renos_3 - regex: to_server:POST /borders\.php.*data=/CjEf.* detector_id: 166
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Renos_3"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/borders.php"; content:"data=/CjEf"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/borders\.php.*data=\/CjEf.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000166; rev:1004;)

# Adware: (Toolbar) ZenoSearch - regex: to_server:POST /cl/ctip2\.asp\?rnd=.*uid=.*&ref=.*&clid=.*&umode=.*&cn=.*&startup=.* detector_id: 169
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) ZenoSearch"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/cl/ctip2.asp?rnd="; content:"uid="; content:"&ref="; content:"&clid="; content:"&umode="; content:"&cn="; content:"&startup="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cl\/ctip2\.asp\?rnd=.*uid=.*&ref=.*&clid=.*&umode=.*&cn=.*&startup=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000169; rev:1004;)

# Command&Control: (Trojan) Parite - regex: to_server:POST /data\.php.*proc=.*&size=.*&psdata=.* detector_id: 170
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Parite"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/data.php"; content:"proc="; content:"&size="; content:"&psdata="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/data\.php.*proc=.*&size=.*&psdata=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000170; rev:1004;)

# Command&Control: (Trojan) Koobface_1 - regex: to_server:POST .*(first|gen)\.php.*f=.*&a=.*&v=.*&c=.*&s=.*&l=.*&ck=.*&c_fb=.*&c_ms=.*&c_hi=.* detector_id: 171
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Koobface_1"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php"; content:"f="; content:"&a="; content:"&v="; content:"&c="; content:"&s="; content:"&l="; content:"&ck="; content:"&c_fb="; content:"&c_ms="; content:"&c_hi="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*(first|gen)\.php.*f=.*&a=.*&v=.*&c=.*&s=.*&l=.*&ck=.*&c_fb=.*&c_ms=.*&c_hi=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000171; rev:1004;)

# Command&Control: (Trojan) Asprox - regex: to_server:POST /forum.php.*form-data; name=.sid.*name=.up.*name=.wbfl.*name=.v.*name=.ping.*name=.guid.*name=.wv.* detector_id: 172
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Asprox"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/forum"; content:"php"; content:"form-data|3B| name="; content:"sid"; content:"name="; content:"up"; content:"name="; content:"wbfl"; content:"name="; content:"name="; content:"ping"; content:"name="; content:"guid"; content:"name="; content:"wv"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/forum.php.*form-data\; name=.sid.*name=.up.*name=.wbfl.*name=.v.*name=.ping.*name=.guid.*name=.wv.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000172; rev:163;)

# Command&Control: (Trojan) Rustock - regex: to_server:POST .*getcfg\.php.*getp=.*&id=.*&ln=.*&cn=.* detector_id: 173
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Rustock"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"getcfg.php"; content:"getp="; content:"&id="; content:"&ln="; content:"&cn="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*getcfg\.php.*getp=.*&id=.*&ln=.*&cn=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000173; rev:1004;)

# Command&Control: (Dropper) Renos - regex: to_server:POST /icons\.php.*data=/CjEf.* detector_id: 174
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Renos"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/icons.php"; content:"data=/CjEf"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/icons\.php.*data=\/CjEf.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000174; rev:1004;)

# Command&Control: (Trojan) FakeSysdef - regex: to_server:POST .*index\.php.*gd=.*&affid=.*&subid=.*&prov=.* detector_id: 175
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) FakeSysdef"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"index.php"; content:"gd="; content:"&affid="; content:"&subid="; content:"&prov="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*index\.php.*gd=.*&affid=.*&subid=.*&prov=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000175; rev:1004;)

# Command&Control: (Trojan) Koobface_2 - regex: to_server:POST /adm/index\.php.*logs=.* detector_id: 176
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Koobface_2"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/adm/index.php"; content:"logs="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/adm\/index\.php.*logs=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000176; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_15 - regex: to_server:POST /server/npopup/.*ins\.php.*data=[A-F0-9]*&key=.* detector_id: 177
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_15"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/server/npopup/"; content:"ins.php"; content:"data="; content:"&key="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/server\/npopup\/.*ins\.php.*data=[A-F0-9]*&key=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000177; rev:1004;)

# Command&Control: (Trojan) Alureon_1 TDSS - regex: to_server:POST /knock/eye\.php\?id=.*&msg=.* detector_id: 178
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Alureon_1 TDSS"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/knock/eye.php?id="; content:"&msg="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/knock\/eye\.php\?id=.*&msg=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000178; rev:1004;)

# Command&Control: (Dropper) Renos_4 - regex: to_server:POST .*logo\.gif.*data=z6pEHas.* detector_id: 179
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Renos_4"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"logo.gif"; content:"data=z6pEHas"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*logo\.gif.*data=z6pEHas.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000179; rev:1004;)

# Command&Control: (Trojan) Yeltminky - regex: to_server:POST .*Count\.asp.*User-Agent: MyApp.*Mac=.*&Os=.*&Ver=.* detector_id: 180
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Yeltminky"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"Count.asp"; content:"User-Agent|3A| MyApp"; content:"Mac="; content:"&Os="; content:"&Ver="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*Count\.asp.*User-Agent: MyApp.*Mac=.*&Os=.*&Ver=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000180; rev:1004;)

# Command&Control: (Trojan) Koceg Sality - regex: to_server:POST /manda\.php\?ns=.*&id=.*ftp=.* detector_id: 181
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Koceg Sality"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/manda.php?ns="; content:"&id="; content:"ftp="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/manda\.php\?ns=.*&id=.*ftp=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000181; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_20 - regex: to_server:POST .*/\?act=online&s4=\d+&s5=\d+&nickname=.*.*msg_out=.* detector_id: 182
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_20"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/?act=online&s4="; content:"&s5="; content:"&nickname="; content:"msg_out="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/\?act=online&s4=\d+&s5=\d+&nickname=.*.*msg_out=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000182; rev:437;)

# Command&Control: (Dropper) Bebloh - regex: to_server:POST /IT\d*/get\.php.*N=.*&ID=.*&DATA=.* detector_id: 183
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Bebloh"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/IT"; content:"/get.php"; content:"N="; content:"&ID="; content:"&DATA="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/IT\d*\/get\.php.*N=.*&ID=.*&DATA=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000183; rev:1004;)

# Command&Control: (Trojan) Bredolab - regex: to_server:POST .*/receiver/online.*guid=.* detector_id: 184
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bredolab"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/receiver/online"; content:"guid="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/receiver\/online.*guid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000184; rev:194;)

# Command&Control: (Dropper) Renos_5 - regex: to_server:POST .*pepsi\.php.*data=717Out.* detector_id: 187
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Renos_5"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"pepsi.php"; content:"data=717Out"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*pepsi\.php.*data=717Out.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000187; rev:1004;)

# Command&Control: (Dropper) GenericDropper_25 - regex: to_server:POST /plist\.php.*User-Agent: ld.*uid=.* detector_id: 188
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_25"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/plist.php"; content:"User-Agent|3A| ld"; content:"uid="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/plist\.php.*User-Agent: ld.*uid=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000188; rev:1004;)

# Command&Control: (Crawler) Gogulas to be checked - regex: to_server:POST /post\.php.*User-Agent: Gogulas crawl.*t=.*&p=.*&d=.*&Submit=Submit detector_id: 189
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Crawler) Gogulas to be checked"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/post.php"; content:"User-Agent|3A| Gogulas crawl"; content:"t="; content:"&p="; content:"&d="; content:"&Submit=Submit"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/post\.php.*User-Agent: Gogulas crawl.*t=.*&p=.*&d=.*&Submit=Submit/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000189; rev:1004;)

# Command&Control: (Dropper) Renos_2 - regex: to_server:POST /perce/.*/qwerce\.gif.*data=v2[26]M.* detector_id: 191
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Renos_2"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/perce/"; content:"/qwerce.gif"; content:"data=v2"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/perce\/.*\/qwerce\.gif.*data=v2[26]M.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000191; rev:1004;)

# FakeAV: FakeVimes - regex: to_server:POST .*reports/working\.php.*UserID=.*&wv=.*&res=.*&lng=.* detector_id: 192
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeVimes"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"reports/working.php"; content:"UserID="; content:"&wv="; content:"&res="; content:"&lng="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*reports\/working\.php.*UserID=.*&wv=.*&res=.*&lng=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000192; rev:1004;)

# FakeAV: FakeVimes - regex: to_server:POST .*reports/minstalls\.php.*mid=.*&wv=.*&r=.*&tp=.*&exe=.*&ls=.* detector_id: 193
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeVimes"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"reports/minstalls.php"; content:"mid="; content:"&wv="; content:"&r="; content:"&tp="; content:"&exe="; content:"&ls="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*reports\/minstalls\.php.*mid=.*&wv=.*&r=.*&tp=.*&exe=.*&ls=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000193; rev:1004;)

# FakeAV: FakeVimes  - regex: to_server:POST .*reports/minstalls\.php.*mid=.*&wv=.*&r=.*&tp=.*&uid=.*&ls=.* detector_id: 194
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeVimes "; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"reports/minstalls.php"; content:"mid="; content:"&wv="; content:"&r="; content:"&tp="; content:"&uid="; content:"&ls="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*reports\/minstalls\.php.*mid=.*&wv=.*&r=.*&tp=.*&uid=.*&ls=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000194; rev:1004;)

# Command&Control: (Dropper) Renos_3 - regex: to_server:POST /resolution\.php.*data=/CjEf.* detector_id: 195
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Renos_3"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/resolution.php"; content:"data=/CjEf"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/resolution\.php.*data=\/CjEf.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000195; rev:1004;)

# Command&Control: (Dropper) Renos_1 - regex: to_server:POST /senm\.php\?data=v2[26]M.*data=.* detector_id: 197
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Renos_1"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/senm.php?data=v2"; content:"data="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/senm\.php\?data=v2[26]M.*data=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000197; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_15 - regex: to_server:POST /server/npopup/.*upd\.php.*data=[A-F0-9]*&key=.*  detector_id: 198
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_15"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/server/npopup/"; content:"upd.php"; content:"data="; content:"&key="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/server\/npopup\/.*upd\.php.*data=[A-F0-9]*&key=.* /s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000198; rev:1004;)

# Command&Control: (Trojan) Wombot - regex: to_server:POST /accs\.php\?acc_src=.*&report=.*&acc_msg=.*&unblock=.* detector_id: 199
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Wombot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/accs.php?acc_src="; content:"&report="; content:"&acc_msg="; content:"&unblock="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/accs\.php\?acc_src=.*&report=.*&acc_msg=.*&unblock=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000199; rev:1004;)

# Command&Control: (Trojan) BlackEnergy - regex: to_server:POST .*stat\.php.*id=.*&build_id=.* detector_id: 200
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) BlackEnergy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"stat.php"; content:"id="; content:"&build_id="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*stat\.php.*id=.*&build_id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000200; rev:1004;)

# Command&Control: (Dropper) Swizzor - regex: to_server:POST /tba/.*guid=.*&version=.*&clientid=.*&time=.*&idle=.*&locale=.* detector_id: 201
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Swizzor"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/tba/"; content:"guid="; content:"&version="; content:"&clientid="; content:"&time="; content:"&idle="; content:"&locale="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/tba\/.*guid=.*&version=.*&clientid=.*&time=.*&idle=.*&locale=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000201; rev:178;)

# Adware: (Toolbar) Zango - regex: to_server:POST /pte\.aspx.*epostdata=[0-9A-F]{40,} detector_id: 202
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Zango"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/pte.aspx"; content:"epostdata="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/pte\.aspx.*epostdata=[0-9A-F]{40,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000202; rev:715;)

# Command&Control: (Dropper) Renos_2 - regex: to_server:POST /item/.*/titem\.gif.*data=v2[26]M.* detector_id: 204
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Renos_2"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/item/"; content:"/titem.gif"; content:"data=v2"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/item\/.*\/titem\.gif.*data=v2[26]M.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000204; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_15  - regex: to_server:POST /server/npopup/.*upd\.php.*data=.*&key=.* detector_id: 205
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_15 "; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/server/npopup/"; content:"upd.php"; content:"data="; content:"&key="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/server\/npopup\/.*upd\.php.*data=.*&key=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000205; rev:1004;)

# Command&Control: (Dropper) Renos_3 - regex: to_server:POST /udt/.*/utd\.jpg.*data=/CjEf.* detector_id: 206
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Renos_3"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/udt/"; content:"/utd.jpg"; content:"data=/CjEf"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/udt\/.*\/utd\.jpg.*data=\/CjEf.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000206; rev:1004;)

# Command&Control: (Trojan) Padobot - regex: to_server:POST .*(wdds|index|forumdisplay)\.php\?ifc=.*a=.* detector_id: 207
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Padobot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php?ifc="; content:"a="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*(wdds|index|forumdisplay)\.php\?ifc=.*a=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000207; rev:1004;)

# FakeAV: BraveSentry - regex: to_server:GET /download\.php\?&advid=.*&u=.*&p=.* detector_id: 203
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: BraveSentry"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/download.php?&advid="; content:"&u="; content:"&p="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/download\.php\?&advid=.*&u=.*&p=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000203; rev:1004;)

# Command&Control: (Trojan) Sality_1 - regex: to_server:GET /dl/log\.php\?=\d detector_id: 196
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sality_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/dl/log.php?="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/dl\/log\.php\?=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000196; rev:1004;)

# Command&Control: (Dropper) GenericDropper_18 - regex: to_server:GET /gt_bd_\d*\.php\?srky=.*&version=.*&GUID=.*&un=.*&cmd=.*&p=.*&tst=.*&i=.*&x=.* detector_id: 190
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_18"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/gt_bd_"; content:".php?srky="; content:"&version="; content:"&GUID="; content:"&un="; content:"&cmd="; content:"&p="; content:"&tst="; content:"&i="; content:"&x="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/gt_bd_\d*\.php\?srky=.*&version=.*&GUID=.*&un=.*&cmd=.*&p=.*&tst=.*&i=.*&x=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000190; rev:1004;)

# Command&Control: (Dropper) GenericDropper_26 - regex: to_server:GET /in\.cgi\?0032 detector_id: 185
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_26"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/in.cgi?0032"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/in\.cgi\?0032/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000185; rev:1004;)

# Adware: (Downware) RapidBlaster IstBar - regex: to_server:GET .*init\.run\?\d*\|\d*\|.*User-Agent: MSIE6 detector_id: 186
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) RapidBlaster IstBar"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"init.run?"; content:"User-Agent|3A| MSIE6"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*init\.run\?\d*\|\d*\|.*User-Agent: MSIE6/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000186; rev:1004;)

# Command&Control: (Trojan) Koceg Socks - regex: to_server:GET /\?&v=.*&s=.*&cip=.*&lid=.*User-Agent: Mozilla detector_id: 168
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Koceg Socks"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?&v="; content:"&s="; content:"&cip="; content:"&lid="; content:"User-Agent|3A| Mozilla"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?&v=.*&s=.*&cip=.*&lid=.*User-Agent: Mozilla/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000168; rev:164;)

# Command&Control: (Trojan) Koceg Socks - regex: to_server:GET /\?&v=.*&s=.*&cip=.*&lid=.*User-Agent: _ detector_id: 167
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Koceg Socks"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?&v="; content:"&s="; content:"&cip="; content:"&lid="; content:"User-Agent|3A| _"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?&v=.*&s=.*&cip=.*&lid=.*User-Agent: _/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000167; rev:164;)

# Command&Control: (Trojan) Alureon_2 TDSS - regex: to_server:POST /cgi-bin/generator.* detector_id: 153
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Alureon_2 TDSS"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/cgi-bin/generator"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cgi-bin\/generator.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000153; rev:189;)

# Command&Control: (Banker) GenericBanker_1 - regex: to_server:POST (/|.*php).*User-Agent: Mozilla.3.0 \(compatible; Indy Library\).*praquem=.*&titulo=.*&texto=.* detector_id: 208
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_1"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"User-Agent|3A| Mozilla"; content:"0 |28|compatible|3B| Indy Library|29|"; content:"praquem="; content:"&titulo="; content:"&texto="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(\/|.*php).*User-Agent: Mozilla.3.0 \(compatible\; Indy Library\).*praquem=.*&titulo=.*&texto=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000208; rev:185;)

# Command&Control: (Trojan) GenericTrojan_19 - regex: to_server:POST /scripts/worker\.php.*action=get.*script detector_id: 209
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_19"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/scripts/worker.php"; content:"action=get"; content:"script"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/scripts\/worker\.php.*action=get.*script/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000209; rev:1004;)

# Command&Control: (Banker) GenericBanker_4 - regex: to_server:POST /[a-z0-9]*\.php.*tipo=cli&cli=.*& detector_id: 210
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_4"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php"; content:"tipo=cli&cli="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z0-9]*\.php.*tipo=cli&cli=.*&/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000210; rev:377;)

# Command&Control: (Trojan) Gammima Magania, Frethog - regex: to_server:GET /1mg/am\.rar detector_id: 211
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Gammima Magania, Frethog"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/1mg/am.rar"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/1mg\/am\.rar/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000211; rev:1004;)

# Command&Control: (Dropper) GenericDropper_6 - regex: to_server:GET /interface\?action=install&p=.*&code=.*&id=[a-z]{2,3}\d{4} detector_id: 215
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_6"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/interface?action=install&p="; content:"&code="; content:"&id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/interface\?action=install&p=.*&code=.*&id=[a-z]{2,3}\d{4}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000215; rev:378;)

# FakeAV: AdvancedDefender - regex: to_server:GET /activate/.*\?key=.*&email=.*&track_id=.*&time=.*&bill_id=.*&hidden= detector_id: 216
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: AdvancedDefender"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/activate/"; content:"?key="; content:"&email="; content:"&track_id="; content:"&time="; content:"&bill_id="; content:"&hidden="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/activate\/.*\?key=.*&email=.*&track_id=.*&time=.*&bill_id=.*&hidden=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000216; rev:185;)

# Adware: (Toolbar) Zwangi - regex: to_server:GET /\?am=1&au=1&b=.*&se=1&u=1&vn=.* detector_id: 217
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Zwangi"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?am=1&au=1&b="; content:"&se=1&u=1&vn="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?am=1&au=1&b=.*&se=1&u=1&vn=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000217; rev:185;)

# Adware: (Toolbar) AdRotator - regex: to_server:GET /bc/nsi_install\.php\?inst_result=.*&aff_id=.*&id=.* detector_id: 218
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) AdRotator"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bc/nsi_install.php?inst_result="; content:"&aff_id="; content:"&id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bc\/nsi_install\.php\?inst_result=.*&aff_id=.*&id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000218; rev:1004;)

# Command&Control: (Trojan) DigiPog - regex: to_server:GET /catcher\?slice=accept&mac=.* detector_id: 219
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) DigiPog"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/catcher?slice=accept&mac="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/catcher\?slice=accept&mac=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000219; rev:190;)

# Command&Control: (Trojan) Bredolab - regex: to_server:GET .*controller\.php\?action=bot&entity_list=.*&first=.*&rnd=.*&uid=.*&guid=.* detector_id: 220
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bredolab"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"controller.php?action=bot&entity_list="; content:"&first="; content:"&rnd="; content:"&uid="; content:"&guid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*controller\.php\?action=bot&entity_list=.*&first=.*&rnd=.*&uid=.*&guid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000220; rev:1004;)

# Command&Control: (Dropper) Parkchicers - regex: to_server:GET /count_log/log/boot\.php\?p=.*&m=.* detector_id: 221
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Parkchicers"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/count_log/log/boot.php?p="; content:"&m="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/count_log\/log\/boot\.php\?p=.*&m=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000221; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_24  - regex: to_server:GET /countnew/WriteData\.aspx\?id=\d{3}&MAC=.{12}&md5= detector_id: 222
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_24 "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/countnew/WriteData.aspx?id="; content:"&MAC="; content:"&md5="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/countnew\/WriteData\.aspx\?id=\d{3}&MAC=.{12}&md5=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000222; rev:1004;)

# Adware: ScreenBlaze - regex: to_server:GET /curver\.php detector_id: 223
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: ScreenBlaze"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/curver.php"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/curver\.php/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000223; rev:1004;)

# Command&Control: (Dropper) Dracur - regex: to_server:GET /f/\?ping=.*&u=.*&a=.*&i=.*&s= detector_id: 224
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Dracur"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/f/?ping="; content:"&u="; content:"&a="; content:"&i="; content:"&s="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/f\/\?ping=.*&u=.*&a=.*&i=.*&s=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000224; rev:190;)

# Adware: FunTV - regex: to_server:GET /funtv/funtvi\.sys detector_id: 225
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: FunTV"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/funtv/funtvi.sys"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/funtv\/funtvi\.sys/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000225; rev:1004;)

# Command&Control: (Trojan) FakeSysdef - regex: to_server:GET /\?gd=.*&affid=.*&subid=.*&prov=.*&mode=.*&v= detector_id: 226
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) FakeSysdef"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?gd="; content:"&affid="; content:"&subid="; content:"&prov="; content:"&mode="; content:"&v="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?gd=.*&affid=.*&subid=.*&prov=.*&mode=.*&v=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000226; rev:388;)

# FakeAV: WinWebSec - regex: to_server:GET /in\.php\?affid=.*&url=.*&win=.*&sts=.* detector_id: 228
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: WinWebSec"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/in.php?affid="; content:"&url="; content:"&win="; content:"&sts="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/in\.php\?affid=.*&url=.*&win=.*&sts=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000228; rev:1004;)

# Command&Control: (Dropper) Tibs - regex: to_server:GET /maczjwtq/.*\.php\?adv=adv.* detector_id: 229
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Tibs"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/maczjwtq/"; content:".php?adv=adv"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/maczjwtq\/.*\.php\?adv=adv.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000229; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_26 - regex: to_server:GET /mini/qd\.exe detector_id: 230
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_26"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mini/qd.exe"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mini\/qd\.exe/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000230; rev:1004;)

# FakeAV: FakeXPA - regex: to_server:GET /\?mod=lr&id=.* detector_id: 231
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeXPA"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?mod=lr&id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?mod=lr&id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000231; rev:185;)

# FakeAV: FakeXPA - regex: to_server:GET /\?mod=vv.*&id=.* detector_id: 232
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeXPA"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?mod=vv"; content:"&id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?mod=vv.*&id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000232; rev:185;)

# Command&Control: (Trojan) GenericTrojan_25 - regex: to_server:GET /PushFile/\d{14}\.txt detector_id: 233
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_25"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/PushFile/"; content:".txt"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/PushFile\/\d{14}\.txt/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000233; rev:1004;)

# FakeAV: FakeCog - regex: to_server:GET /readdatagateway\.php\?type=stats&affid=.*&subid=.*&version=.* detector_id: 234
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeCog"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/readdatagateway.php?type=stats&affid="; content:"&subid="; content:"&version="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/readdatagateway\.php\?type=stats&affid=.*&subid=.*&version=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000234; rev:1004;)

# Command&Control: (Dropper) Heloag - regex: to_server:GET /reques0\.asp\?kind=.*&mac=.*&key=.* detector_id: 235
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Heloag"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/reques0.asp?kind="; content:"&mac="; content:"&key="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/reques0\.asp\?kind=.*&mac=.*&key=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000235; rev:1004;)

# Command&Control: (Dropper) BaoFa - regex: to_server:GET .*online\d*\?s=.*&v=.*&n=.*&rnd=.* detector_id: 236
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) BaoFa"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"online"; content:"?s="; content:"&v="; content:"&n="; content:"&rnd="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*online\d*\?s=.*&v=.*&n=.*&rnd=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000236; rev:190;)

# Command&Control: (Dropper) Scheduler - regex: to_server:GET /indeh\.php\?u=.*&i=.*&t=.*&v=.*&z=.*&s=.* detector_id: 239
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Scheduler"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/indeh.php?u="; content:"&i="; content:"&t="; content:"&v="; content:"&z="; content:"&s="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/indeh\.php\?u=.*&i=.*&t=.*&v=.*&z=.*&s=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000239; rev:1004;)

# Command&Control: (Dropper) FlowSpirit - regex: to_server:GET /update/update\.dat\?q=.* detector_id: 241
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) FlowSpirit"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/update/update.dat?q="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/update\/update\.dat\?q=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000241; rev:1004;)

# Command&Control: (Trojan) Swisyn - regex: to_server:GET /update/utu\.dat detector_id: 242
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Swisyn"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/update/utu.dat"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/update\/utu\.dat/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000242; rev:1004;)

# Command&Control: (Dropper) FlowSpirit - regex: to_server:GET /urlcore/urlaction\.php\?type=.*&uid=.*&tag=.*&flag=.* detector_id: 243
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) FlowSpirit"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/urlcore/urlaction.php?type="; content:"&uid="; content:"&tag="; content:"&flag="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/urlcore\/urlaction\.php\?type=.*&uid=.*&tag=.*&flag=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000243; rev:1004;)

# Command&Control: (Dropper) FlowSpirit - regex: to_server:GET /urlspirit/urlcore\.exe detector_id: 244
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) FlowSpirit"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/urlspirit/urlcore.exe"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/urlspirit\/urlcore\.exe/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000244; rev:1004;)

# Command&Control: (Dropper) Netins - regex: to_server:POST /debug2\.asp.*count=.*&data=.*&copy=.*&info=.*&act=.* detector_id: 245
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Netins"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/debug2.asp"; content:"count="; content:"&data="; content:"&copy="; content:"&info="; content:"&act="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/debug2\.asp.*count=.*&data=.*&copy=.*&info=.*&act=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000245; rev:1004;)

# Command&Control: (SpamBot) GenericSpamBot_1 - regex: to_server:POST .*/getemails\.php.*ver=\d+&id=\d{10} detector_id: 246
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (SpamBot) GenericSpamBot_1"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/getemails.php"; content:"ver="; content:"&id="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/getemails\.php.*ver=\d+&id=\d{10}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000246; rev:1004;)

# Adware: (Toolbar) AdRotator - regex: to_server:POST /imprss/.*showed=.*&clicked=.*&version=.*&id=.*&tm=.*&aff_id=.*&net_id=.*&safe=.*&redir_success=.*&redir_fail=.* detector_id: 247
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) AdRotator"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/imprss/"; content:"showed="; content:"&clicked="; content:"&version="; content:"&id="; content:"&tm="; content:"&aff_id="; content:"&net_id="; content:"&safe="; content:"&redir_success="; content:"&redir_fail="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/imprss\/.*showed=.*&clicked=.*&version=.*&id=.*&tm=.*&aff_id=.*&net_id=.*&safe=.*&redir_success=.*&redir_fail=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000247; rev:194;)

# Command&Control: (Banker) GenericBanker_3 - regex: to_server:POST .*\.php.*op=.*&servidor=.*&senha=.*&usuario=.*&base=.*&sgdb=.*&nomeexe= detector_id: 248
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_3"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php"; content:"op="; content:"&servidor="; content:"&senha="; content:"&usuario="; content:"&base="; content:"&sgdb="; content:"&nomeexe="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php.*op=.*&servidor=.*&senha=.*&usuario=.*&base=.*&sgdb=.*&nomeexe=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000248; rev:1004;)

# Command&Control: (Trojan) Koobface_2 - regex: to_server:GET /\..*/\?action=ldgen&a=.*&v=.*&c_fb=.* detector_id: 249
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Koobface_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/."; content:"/?action=ldgen&a="; content:"&v="; content:"&c_fb="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\..*\/\?action=ldgen&a=.*&v=.*&c_fb=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000249; rev:159;)

# FakeAV: PrivacyCenter - regex: to_server:GET /avail.*Host privacy.* detector_id: 250
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: PrivacyCenter"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/avail"; content:"Host privacy"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/avail.*Host privacy.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000250; rev:185;)

# Command&Control: (Trojan) DotTorrent - regex: to_server:GET /avails detector_id: 237
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) DotTorrent"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/avails"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/avails/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000237; rev:185;)

# Command&Control: (Dropper) Geral - regex: to_server:GET /b\.jpg.*User-Agent: Agent\d* detector_id: 212
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Geral"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/b.jpg"; content:"User-Agent|3A| Agent"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/b\.jpg.*User-Agent: Agent\d*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000212; rev:1004;)

# Command&Control: (Trojan) Virut_1 - regex: to_server:GET /cj/get\.aspx\?mac=.*&md5=.* detector_id: 213
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Virut_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cj/get.aspx?mac="; content:"&md5="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cj\/get\.aspx\?mac=.*&md5=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000213; rev:1004;)

# Command&Control: (Trojan) Virut_1 - regex: to_server:GET /cj/log\.txt detector_id: 49
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Virut_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cj/log.txt"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cj\/log\.txt/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000049; rev:1004;)

# Command&Control: (Dialer) Skintrim - regex: to_server:GET /Common/module\.php.*country=.*&from_mdl=.*&dialer=.* detector_id: 214
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dialer) Skintrim"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Common/module.php"; content:"country="; content:"&from_mdl="; content:"&dialer="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Common\/module\.php.*country=.*&from_mdl=.*&dialer=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000214; rev:1004;)

# Command&Control: (Trojan) Bredolab  - regex: to_server:GET .*controller\.php\?action=.*&uid=.*&guid=.*&rnd=.*&entity=.* detector_id: 252
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bredolab "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"controller.php?action="; content:"&uid="; content:"&guid="; content:"&rnd="; content:"&entity="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*controller\.php\?action=.*&uid=.*&guid=.*&rnd=.*&entity=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000252; rev:1004;)

# Command&Control: (Dropper) Tibs - regex: to_server:GET /css/pragma/(crfiles|crcmds|srcr.dat) detector_id: 253
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Tibs"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/css/pragma/"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/css\/pragma\/(crfiles|crcmds|srcr.dat)/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000253; rev:187;)

# Command&Control: (Dropper) Cinmus - regex: to_server:GET /get_r\.php\?fid=.*&mac=.*&version=.*&uuid=.* detector_id: 254
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Cinmus"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get_r.php?fid="; content:"&mac="; content:"&version="; content:"&uuid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get_r\.php\?fid=.*&mac=.*&version=.*&uuid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000254; rev:1004;)

# Command&Control: (Dropper) GenericDropper_12 - regex: to_server:GET /httpss/.*v=.*&step=.*&hostid=[A-F0-9]{32} detector_id: 255
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_12"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/httpss/"; content:"v="; content:"&step="; content:"&hostid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/httpss\/.*v=.*&step=.*&hostid=[A-F0-9]{32}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000255; rev:177;)

# Command&Control: (Trojan) Pincav AgentBypass - regex: to_server:GET .*jilu\.asp\?mac=.*&ver=.*&TG=.*&CP=.*&key= detector_id: 256
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Pincav AgentBypass"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"jilu.asp?mac="; content:"&ver="; content:"&TG="; content:"&CP="; content:"&key="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*jilu\.asp\?mac=.*&ver=.*&TG=.*&CP=.*&key=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000256; rev:1004;)

# Command&Control: (Dropper) GenericDropper_45 - regex: to_server:GET /lo\.php.*User-Agent: Download detector_id: 257
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_45"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/lo.php"; content:"User-Agent|3A| Download"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/lo\.php.*User-Agent: Download/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000257; rev:1004;)

# Command&Control: (Dropper) GenericDropper_44 - regex: to_server:GET /msn/software/partner/dh181/tbox03\.exe detector_id: 258
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_44"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/msn/software/partner/dh181/tbox03.exe"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/msn\/software\/partner\/dh181\/tbox03\.exe/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000258; rev:1004;)

# Command&Control: (Dropper) GenericDropper_46 - regex: to_server:GET /online_inst/data\.ini detector_id: 259
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_46"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/online_inst/data.ini"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/online_inst\/data\.ini/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000259; rev:1004;)

# Command&Control: (Dropper) GenericDropper_39 - regex: to_server:GET /pages/[a-z]*un\d{3}\.txt detector_id: 260
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_39"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/pages/"; content:"un"; content:".txt"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/pages\/[a-z]*un\d{3}\.txt/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000260; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_26 - regex: to_server:GET /pw\.txt HTTP detector_id: 261
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_26"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/pw.txt HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/pw\.txt HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000261; rev:722;)

# Command&Control: (Trojan) Bredavi Harnig - regex: to_server:GET /services/install\.php\?uid=.*&site=.* detector_id: 262
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bredavi Harnig"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/services/install.php?uid="; content:"&site="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/services\/install\.php\?uid=.*&site=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000262; rev:1004;)

# FakeAV: WinWebSec - regex: to_server:GET /set\.php\?url=\d*&affid=.*&sts=.*&win=.* detector_id: 263
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: WinWebSec"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/set.php?url="; content:"&affid="; content:"&sts="; content:"&win="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/set\.php\?url=\d*&affid=.*&sts=.*&win=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000263; rev:1004;)

# Command&Control: (Dropper) Tibs - regex: to_server:GET /ufwnltbz/.*php\?adv=adv.* detector_id: 264
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Tibs"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ufwnltbz/"; content:"php?adv=adv"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ufwnltbz\/.*php\?adv=adv.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000264; rev:185;)

# Command&Control: (Dropper) Tibs - regex: to_server:GET /utaigom/.*php\?adv=adv.* detector_id: 265
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Tibs"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/utaigom/"; content:"php?adv=adv"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/utaigom\/.*php\?adv=adv.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000265; rev:185;)

# Command&Control: (Trojan) GenericTrojan_28 - regex: to_server:GET /vmsg\.txt.*Host: www\.dnf detector_id: 266
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_28"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/vmsg.txt"; content:"Host|3A| www.dnf"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/vmsg\.txt.*Host: www\.dnf/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000266; rev:1004;)

# Command&Control: (Dropper) GenericDropper_40 - regex: to_server:GET /Vscript/BInst\.psc\?SC=.*&DN_DATE=.*&CC_SRC=.*&NT_SRC=.*&AD_TYP=.* detector_id: 267
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_40"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Vscript/BInst.psc?SC="; content:"&DN_DATE="; content:"&CC_SRC="; content:"&NT_SRC="; content:"&AD_TYP="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Vscript\/BInst\.psc\?SC=.*&DN_DATE=.*&CC_SRC=.*&NT_SRC=.*&AD_TYP=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000267; rev:1004;)

# Command&Control: (Banker) GenericBanker_3 - regex: to_server:POST .*\.php.*op=.*&servidor=.*&senha=.*&usuario=.*&base=.*&sgdb=.* detector_id: 268
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_3"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php"; content:"op="; content:"&servidor="; content:"&senha="; content:"&usuario="; content:"&base="; content:"&sgdb="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php.*op=.*&servidor=.*&senha=.*&usuario=.*&base=.*&sgdb=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000268; rev:1004;)

# Adware: (Toolbar) Zango - regex: to_server:POST .*\.aspx\?ver=[\d\.]+&rnd=\d+ HTTP.*epostdata=[A-F0-9]{40,} detector_id: 269
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Zango"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".aspx?ver="; content:"&rnd="; content:" HTTP"; content:"epostdata="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.aspx\?ver=[\d\.]+&rnd=\d+ HTTP.*epostdata=[A-F0-9]{40,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000269; rev:715;)

# Command&Control: (Trojan) Desurou - regex: to_server:POST .*count\.asp.*mac=[A-Z0-9]*&ver=.*&flag=.*&userid=.* detector_id: 270
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Desurou"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"count.asp"; content:"mac="; content:"&ver="; content:"&flag="; content:"&userid="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*count\.asp.*mac=[A-Z0-9]*&ver=.*&flag=.*&userid=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000270; rev:1004;)

# Command&Control: (Dropper) Ekafod - regex: to_server:POST .*lin\.asp.*cpname=.*&hardid=.*&netid=.*&user=.* detector_id: 271
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Ekafod"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"lin.asp"; content:"cpname="; content:"&hardid="; content:"&netid="; content:"&user="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*lin\.asp.*cpname=.*&hardid=.*&netid=.*&user=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000271; rev:1004;)

# Command&Control: (Dropper) Renos_1 - regex: to_server:POST .*\.php\?data=v2[26]M.*data=ujnT32O.* detector_id: 272
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Renos_1"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php?data=v2"; content:"data=ujnT32O"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php\?data=v2[26]M.*data=ujnT32O.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000272; rev:1004;)

# Command&Control: (Keylogger) Sisron - regex: to_server:GET /auth/svr\.php\?email=.* detector_id: 273
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Keylogger) Sisron"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/auth/svr.php?email="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/auth\/svr\.php\?email=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000273; rev:1004;)

# Adware: (Toolbar) AdRotator - regex: to_server:GET /bc/nsi_install\.php\?aff_id=.*&inst_result=.*&id=.* detector_id: 274
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) AdRotator"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bc/nsi_install.php?aff_id="; content:"&inst_result="; content:"&id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bc\/nsi_install\.php\?aff_id=.*&inst_result=.*&id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000274; rev:1004;)

# Command&Control: (Dropper) GenericDropper_37 - regex: to_server:GET /bind2\.php\?id= detector_id: 275
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_37"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bind2.php?id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bind2\.php\?id=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000275; rev:1004;)

# Click-Fraud: GenericClickFraud - regex: to_server:GET /click/\?c=.*&s=.*&subid=.* detector_id: 277
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Click-Fraud: GenericClickFraud"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/click/?c="; content:"&s="; content:"&subid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/click\/\?c=.*&s=.*&subid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000277; rev:187;)

# Command&Control: (Dropper) GenericDropper_36 - regex: to_server:GET /counter/insert\.php\?.*c_pid=.{4-12}&c_kind=\d detector_id: 278
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_36"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/counter/insert.php?"; content:"c_pid="; content:"|7B|4-12|7D|&c_kind="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/counter\/insert\.php\?.*c_pid=.{4-12}&c_kind=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000278; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_24 - regex: to_server:GET /countnew/WriteData\.aspx\?id=\d{3}&MAC=[a-f0-9]{12}&md5= detector_id: 279
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_24"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/countnew/WriteData.aspx?id="; content:"&MAC="; content:"&md5="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/countnew\/WriteData\.aspx\?id=\d{3}&MAC=[a-f0-9]{12}&md5=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000279; rev:1004;)

# Command&Control: (Dropper) GenericDropper_35 - regex: to_server:GET /CPAAD\.MDB detector_id: 280
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_35"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/CPAAD.MDB"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/CPAAD\.MDB/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000280; rev:1004;)

# Command&Control: (Exploit) Wmfap - regex: to_server:GET /ecv\d*\.php\?p=.*User-Agent: cv_v.* detector_id: 281
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Exploit) Wmfap"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ecv"; content:".php?p="; content:"User-Agent|3A| cv_v"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ecv\d*\.php\?p=.*User-Agent: cv_v.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000281; rev:1004;)

# Adware: (Toolbar) Sogou - regex: to_server:GET /fastversion\.txt detector_id: 282
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Sogou"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/fastversion.txt"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/fastversion\.txt/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000282; rev:1004;)

# Command&Control: (Trojan) Swizzor - regex: to_server:GET /get_file\.php\?file=.*User-Agent: NSIS detector_id: 283
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Swizzor"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get_file.php?file="; content:"User-Agent|3A| NSIS"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get_file\.php\?file=.*User-Agent: NSIS/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000283; rev:1004;)

# Command&Control: (Trojan) Vilsel - regex: to_server:GET /images/index\.jpg\?nocache=\d+ detector_id: 284
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Vilsel"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/images/index.jpg?nocache="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/images\/index\.jpg\?nocache=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000284; rev:1004;)

# Adware: (Hoax) ArchSMS - regex: to_server:GET /index_1\.php\?user_id=.*&sub_id=.*&zapros=.* detector_id: 286
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) ArchSMS"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index_1.php?user_id="; content:"&sub_id="; content:"&zapros="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index_1\.php\?user_id=.*&sub_id=.*&zapros=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000286; rev:1004;)

# FakeAV: FakeVimes - regex: to_server:GET /index\.php\?def387=kdjf.* detector_id: 287
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeVimes"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?def387=kdjf"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\?def387=kdjf.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000287; rev:1004;)

# Adware: (Hoax) ArchSMS  - regex: to_server:GET /js/payform/gray_a\.css detector_id: 288
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) ArchSMS "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/js/payform/gray_a.css"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/js\/payform\/gray_a\.css/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000288; rev:1004;)

# Adware: (Hoax) ArchSMS  - regex: to_server:GET /js/payform/payform\.js detector_id: 289
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) ArchSMS "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/js/payform/payform.js"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/js\/payform\/payform\.js/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000289; rev:1004;)

# Adware: (Toolbar) SideSearch - regex: to_server:GET /nsi\.php\?aff=.*&act=.* detector_id: 290
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) SideSearch"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/nsi.php?aff="; content:"&act="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/nsi\.php\?aff=.*&act=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000290; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_26 - regex: to_server:GET /qd\.netkill\.com\.cn/pw\.txt detector_id: 291
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_26"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/qd.netkill.com.cn/pw.txt"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/qd\.netkill\.com\.cn\/pw\.txt/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000291; rev:1004;)

# Adware: PlayMP3 - regex: to_server:GET /request2\?stage=.*&application=PlayMP3&campaign=.* detector_id: 292
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: PlayMP3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/request2?stage="; content:"&application=PlayMP3&campaign="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/request2\?stage=.*&application=PlayMP3&campaign=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000292; rev:187;)

# Adware: (Toolbar) Sogou - regex: to_server:GET /sepush\.gif\?h=.*&r=.*&type=.* detector_id: 293
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Sogou"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/sepush.gif?h="; content:"&r="; content:"&type="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/sepush\.gif\?h=.*&r=.*&type=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000293; rev:1004;)

# Adware: (Toolbar) Sogou - regex: to_server:GET /seversion\.txt\?h=.* detector_id: 294
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Sogou"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/seversion.txt?h="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/seversion\.txt\?h=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000294; rev:1004;)

# Adware: (Hoax) Pameseg  - regex: to_server:GET /sync/in/\?referer=.*&data_type=.*&site_id=.*&user_id=.*sub_id=.* detector_id: 296
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) Pameseg "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/sync/in/?referer="; content:"&data_type="; content:"&site_id="; content:"&user_id="; content:"sub_id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/sync\/in\/\?referer=.*&data_type=.*&site_id=.*&user_id=.*sub_id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000296; rev:185;)

# Command&Control: (Dropper) GenericDropper_103 - regex: to_server:GET /web/counter/install.check\.php\?in_pid=.*&in_mac=.* detector_id: 297
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_103"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/web/counter/install"; content:"check.php?in_pid="; content:"&in_mac="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/web\/counter\/install.check\.php\?in_pid=.*&in_mac=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000297; rev:721;)

# Adware: (Downware) YxDown - regex: to_server:GET /yxdown\.htm detector_id: 298
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) YxDown"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/yxdown.htm"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/yxdown\.htm/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000298; rev:1004;)

# FakeAV: FakeVimes  - regex: to_server:HEAD /index\.php\?def387=.* detector_id: 299
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeVimes "; flow:established,to_server; content:"HEAD"; nocase; http_method; content:"HEAD "; content:"/index.php?def387="; pcre:"/HEAD (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\?def387=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000299; rev:1004;)

# Command&Control: (Dropper) Renos_1 - regex: to_server:POST .*\.php\?(ini|id)=v2[26]M.*data=qSrTzGL0.* detector_id: 300
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Renos_1"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php?"; content:"=v2"; content:"data=qSrTzGL0"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php\?(ini|id)=v2[26]M.*data=qSrTzGL0.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000300; rev:1004;)

# Command&Control: (Dropper) GenericDropper_38 - regex: to_server:POST /d\.php.*User-Agent: DivSig detector_id: 301
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_38"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/d.php"; content:"User-Agent|3A| DivSig"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/d\.php.*User-Agent: DivSig/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000301; rev:1004;)

# Command&Control: (Dropper) Renos_6 - regex: to_server:POST /oms\.php.*data=hv7RO.* detector_id: 302
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Renos_6"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/oms.php"; content:"data=hv7RO"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/oms\.php.*data=hv7RO.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000302; rev:1004;)

# Command&Control: (Keylogger) Sisron - regex: to_server:POST /SpyOw/K-LG\.php.*pcUSER=.*&mytxt=.*&DATEx=.*&TIMEx=.*&reciver=.* detector_id: 303
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Keylogger) Sisron"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/SpyOw/K-LG.php"; content:"pcUSER="; content:"&mytxt="; content:"&DATEx="; content:"&TIMEx="; content:"&reciver="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/SpyOw\/K-LG\.php.*pcUSER=.*&mytxt=.*&DATEx=.*&TIMEx=.*&reciver=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000303; rev:1004;)

# Command&Control: (Dropper) Dldsu - regex: to_server:POST /vscript/vercheck\.psc\?pcrc=.* detector_id: 304
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Dldsu"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/vscript/vercheck.psc?pcrc="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/vscript\/vercheck\.psc\?pcrc=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000304; rev:1004;)

# Adware: (Hoax) Pameseg - regex: to_server:GET /syn/pay/\?ajax=.*&go=.*&crypt=.*&is_first=.*&data_type=.*&site_id=.*&user_id=.*&sub_id=.* detector_id: 305
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) Pameseg"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/syn/pay/?ajax="; content:"&go="; content:"&crypt="; content:"&is_first="; content:"&data_type="; content:"&site_id="; content:"&user_id="; content:"&sub_id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/syn\/pay\/\?ajax=.*&go=.*&crypt=.*&is_first=.*&data_type=.*&site_id=.*&user_id=.*&sub_id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000305; rev:187;)

# Command&Control: (Trojan) Koobface_2 - regex: to_server:POST /\.sys/\?action=ldgen&v=.* detector_id: 306
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Koobface_2"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/.sys/?action=ldgen&v="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\.sys\/\?action=ldgen&v=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000306; rev:159;)

# Command&Control: (Dropper) GenericDropper_36 - regex: to_server:GET /counter/insert\.php\?dbserver=.*&c_pcode=.*&c_pid=.{4,12}&c_kind=\d+&c_mac= detector_id: 307
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_36"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/counter/insert.php?dbserver="; content:"&c_pcode="; content:"&c_pid="; content:"&c_kind="; content:"&c_mac="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/counter\/insert\.php\?dbserver=.*&c_pcode=.*&c_pid=.{4,12}&c_kind=\d+&c_mac=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000307; rev:1004;)

# Command&Control: (Trojan) Cycbot - regex: to_server:GET /blog/images/3521\.jpg\?v.*=.*&tq=.* detector_id: 440
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Cycbot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/blog/images/3521.jpg?v"; content:"&tq="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/blog\/images\/3521\.jpg\?v.*=.*&tq=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000440; rev:1004;)

# Adware: (Toolbar) Zugo - regex: to_server:GET /getCountry/.*\?pid=.*&channel=.*&bdate=.*&bversion=.* detector_id: 441
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Zugo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/getCountry/"; content:"?pid="; content:"&channel="; content:"&bdate="; content:"&bversion="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/getCountry\/.*\?pid=.*&channel=.*&bdate=.*&bversion=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000441; rev:159;)

# Command&Control: (Trojan) Stegvob - regex: to_server:GET /\d*/1\.php\?q=.*&ok=.* detector_id: 442
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Stegvob"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/1.php?q="; content:"&ok="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d*\/1\.php\?q=.*&ok=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000442; rev:1004;)

# Command&Control: (Dropper) Karagany - regex: to_server:GET /showthread\.php\?t=.*User-Agent: User-Agent: Opera/10\.60 Presto/2\.2\.30 detector_id: 443
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Karagany"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/showthread.php?t="; content:"User-Agent|3A| User-Agent|3A| Opera/10.60 Presto/2.2.30"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/showthread\.php\?t=.*User-Agent: User-Agent: Opera\/10\.60 Presto\/2\.2\.30/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000443; rev:487;)

# FakeAV: FraudPack - regex: to_server:GET /404\.php\?type=.*&affid=.*&subid=.*&awok detector_id: 444
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FraudPack"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/404.php?type="; content:"&affid="; content:"&subid="; content:"&awok"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/404\.php\?type=.*&affid=.*&subid=.*&awok/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000444; rev:1004;)

# FakeAV: WinWebSec - regex: to_server:GET /i\.php\?affid=.*&data=.*&v=.* detector_id: 445
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: WinWebSec"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/i.php?affid="; content:"&data="; content:"&v="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/i\.php\?affid=.*&data=.*&v=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000445; rev:1004;)

# Command&Control: (Dropper) Ocibt - regex: to_server:GET /down\.php\?i=bdll&aaa=.* detector_id: 446
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Ocibt"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/down.php?i=bdll&aaa="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/down\.php\?i=bdll&aaa=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000446; rev:1004;)

# Command&Control: (Backdoor) Xtreme Xtrat - regex: to_server:GET /1234567890.functions detector_id: 447
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Xtreme Xtrat"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/1234567890"; content:"functions"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/1234567890.functions/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000447; rev:344;)

# Command&Control: (Dropper) GenericDropper_22 - regex: to_server:GET /[a-z]{8,12}/[a-z]{5,12}\.php\?adv=adv\d{3}&id=-\d+&c=-\d detector_id: 448
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_22"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?adv=adv"; content:"&id=-"; content:"&c=-"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{8,12}\/[a-z]{5,12}\.php\?adv=adv\d{3}&id=-\d+&c=-\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000448; rev:1004;)

# Command&Control: (Trojan) Dusvext  - regex: to_server:GET .*\?uid=.*&lan=.*&cmpname=.*&country=.*&cc=.*&idle=.*&ver=.* detector_id: 449
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Dusvext "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?uid="; content:"&lan="; content:"&cmpname="; content:"&country="; content:"&cc="; content:"&idle="; content:"&ver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\?uid=.*&lan=.*&cmpname=.*&country=.*&cc=.*&idle=.*&ver=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000449; rev:169;)

# Command&Control: (Trojan) Cambot  - regex: to_server:GET .*alive\.php\?key=.*&pcuser=.*&pcname=.*&hwid=.*&country=.* detector_id: 450
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Cambot "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"alive.php?key="; content:"&pcuser="; content:"&pcname="; content:"&hwid="; content:"&country="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*alive\.php\?key=.*&pcuser=.*&pcname=.*&hwid=.*&country=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000450; rev:1002;)

# Adware: (Downware) GabPath - regex: to_server:POST /upd\.php.*wtdat=[0-9a-f]{20,} detector_id: 451
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) GabPath"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/upd.php"; content:"wtdat="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/upd\.php.*wtdat=[0-9a-f]{20,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000451; rev:1004;)

# Command&Control: (Trojan) Thutani - regex: to_server:GET .*tj2/count\.asp\?ver=2\.0&mac=.* detector_id: 452
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Thutani"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"tj2/count.asp?ver=2.0&mac="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*tj2\/count\.asp\?ver=2\.0&mac=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000452; rev:1004;)

# Command&Control: (Dropper) Pher Nirava - regex: to_server:GET /install\.asp\?mac=.*&mode=.* detector_id: 453
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Pher Nirava"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/install.asp?mac="; content:"&mode="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/install\.asp\?mac=.*&mode=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000453; rev:1004;)

# command&control: Unknown Malware CC - regex: to_server:POST /.*\.php.*tc=.*&uo=.*&lk=.* detector_id: 454
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: Unknown Malware CC"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php"; content:"tc="; content:"&uo="; content:"&lk="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\.php.*tc=.*&uo=.*&lk=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000454; rev:1004;)

# Command&Control: (Dropper) Pher - regex: to_server:GET /boot\.asp\?mode=.* detector_id: 455
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Pher"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/boot.asp?mode="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/boot\.asp\?mode=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000455; rev:1004;)

# Command&Control: (Dropper) GenericDropper_24 - regex: to_server:GET /bukuaile\.php\?df=q1 detector_id: 456
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_24"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bukuaile.php?df=q1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bukuaile\.php\?df=q1/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000456; rev:1004;)

# Command&Control: (Trojan) Vundo_1 - regex: to_server:GET /nconfirm\.php\?((num=\d+.*rev=\d+)|(rev=\d+.*num=\d+)) detector_id: 457
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Vundo_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/nconfirm.php?"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/nconfirm\.php\?((num=\d+.*rev=\d+)|(rev=\d+.*num=\d+))/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000457; rev:388;)

# Command&Control: (Dropper) Virut_3 - regex: to_server:GET /upd156\.php\?id=.* detector_id: 458
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Virut_3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/upd156.php?id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/upd156\.php\?id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000458; rev:1004;)

# FakeAV: GenericFakeAV_8 - regex: to_server:GET /favicon\.ico\?0=.*&1=.*&2=.*&3=.*&4=.*&5=.*&6=.*&7=.* detector_id: 459
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_8"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/favicon.ico?0="; content:"&1="; content:"&2="; content:"&3="; content:"&4="; content:"&5="; content:"&6="; content:"&7="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/favicon\.ico\?0=.*&1=.*&2=.*&3=.*&4=.*&5=.*&6=.*&7=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000459; rev:1004;)

# FakeAV: GenericFakeAV_9 - regex: to_server:GET /install\.php\?do=.*&coid=.*&fff=.*&IP=.*&lct=.*&v=.* detector_id: 460
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_9"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/install.php?do="; content:"&coid="; content:"&fff="; content:"&IP="; content:"&lct="; content:"&v="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/install\.php\?do=.*&coid=.*&fff=.*&IP=.*&lct=.*&v=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000460; rev:1004;)

# Command&Control: (Banker) GenericBanker_3 - regex: to_server:GET .*\.php\?op=IncluirAviso&macaddress=.*&serialhd=.*&nomeusuario=.*&versaowindows=.*&pcname=.*&versaoatual=.* detector_id: 461
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?op=IncluirAviso&macaddress="; content:"&serialhd="; content:"&nomeusuario="; content:"&versaowindows="; content:"&pcname="; content:"&versaoatual="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php\?op=IncluirAviso&macaddress=.*&serialhd=.*&nomeusuario=.*&versaowindows=.*&pcname=.*&versaoatual=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000461; rev:1004;)

# Adware: (Hoax) Pameseg  - regex: to_server:GET /payarch/ping\.php\?v=.*&cid=.*&s=SCHEME1&wid=.*&fid=.*&step=1 detector_id: 473
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) Pameseg "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/payarch/ping.php?v="; content:"&cid="; content:"&s=SCHEME1&wid="; content:"&fid="; content:"&step=1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/payarch\/ping\.php\?v=.*&cid=.*&s=SCHEME1&wid=.*&fid=.*&step=1/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000473; rev:1004;)

# Command&Control: (Dropper) Pher Nirava - regex: to_server:GET /check/check\.php\?m=b detector_id: 474
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Pher Nirava"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/check/check.php?m=b"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/check\/check\.php\?m=b/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000474; rev:1004;)

# FakeAV: GenericFakeAV_8 - regex: to_server:GET /favicon\.ico\?0=.*&1=.*&2=.*&3=.*&4=.*&5=.*&6=.*&7=.*&8=.*&9=.*&10=.*&11=.*&12=.* detector_id: 475
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_8"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/favicon.ico?0="; content:"&1="; content:"&2="; content:"&3="; content:"&4="; content:"&5="; content:"&6="; content:"&7="; content:"&8="; content:"&9="; content:"&10="; content:"&11="; content:"&12="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/favicon\.ico\?0=.*&1=.*&2=.*&3=.*&4=.*&5=.*&6=.*&7=.*&8=.*&9=.*&10=.*&11=.*&12=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000475; rev:1004;)

# Adware: (Downware) AdMonetizer InstallMonetizer  - regex: to_server:POST /.*pubid=.*&[Cc]b[Ii]d=.*&subid=.*&mid=.*&userid=.*&advDetails=.* detector_id: 476
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) AdMonetizer InstallMonetizer "; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"pubid="; content:"d="; content:"&subid="; content:"&mid="; content:"&userid="; content:"&advDetails="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*pubid=.*&[Cc]b[Ii]d=.*&subid=.*&mid=.*&userid=.*&advDetails=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000476; rev:276;)

# FakeAV: Rena FakeRean  - regex: to_server:GET /images/img\.php\?id=.* detector_id: 477
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: Rena FakeRean "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/images/img.php?id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/images\/img\.php\?id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000477; rev:1004;)

# Adware: (Toolbar) Overtls - regex: to_server:GET .*sidebar\.asp\?bn=.*&qy=.* detector_id: 478
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Overtls"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"sidebar.asp?bn="; content:"&qy="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*sidebar\.asp\?bn=.*&qy=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000478; rev:1004;)

# Command&Control: (Dropper) Winsoft Fosniw - regex: to_server:GET .*app\.asp\?prj=.*&pid=.*&logdata=.*&code=.*&ver=.*&appcheck=.* detector_id: 479
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Winsoft Fosniw"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"app.asp?prj="; content:"&pid="; content:"&logdata="; content:"&code="; content:"&ver="; content:"&appcheck="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*app\.asp\?prj=.*&pid=.*&logdata=.*&code=.*&ver=.*&appcheck=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000479; rev:1004;)

# Adware: (Toolbar) HotBar Zango - regex: to_server:GET /IC/.*/XvidSetup\.exe\?rnd=.* detector_id: 480
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) HotBar Zango"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/IC/"; content:"/XvidSetup.exe?rnd="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/IC\/.*\/XvidSetup\.exe\?rnd=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000480; rev:1004;)

# Adware: (Downware) InstallIQ - regex: to_server:GET /api/detectionrequest\.aspx\?keyid=.* detector_id: 481
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) InstallIQ"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/api/detectionrequest.aspx?keyid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/detectionrequest\.aspx\?keyid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000481; rev:1004;)

# FakeAV: WinWebSec - regex: to_server:POST /install\.php\?affid=.*data=.* detector_id: 482
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: WinWebSec"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/install.php?affid="; content:"data="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/install\.php\?affid=.*data=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000482; rev:1004;)

# Adware: (Downware) MediaGet - regex: to_server:GET /download\.php\?ref_id=.* detector_id: 483
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) MediaGet"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/download.php?ref_id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/download\.php\?ref_id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000483; rev:1004;)

# Command&Control: (Dropper) Winsoft Fosniw - regex: to_server:GET /app/\?prj=.*&pid=.*&mac=.* detector_id: 484
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Winsoft Fosniw"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/app/?prj="; content:"&pid="; content:"&mac="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/app\/\?prj=.*&pid=.*&mac=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000484; rev:193;)

# Command&Control: (Dropper) GenericDropper_10 - regex: to_server:GET /(adv|web)/runremote\.asp\?type=run.*&machinename=.* detector_id: 485
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_10"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/runremote.asp?type=run"; content:"&machinename="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(adv|web)\/runremote\.asp\?type=run.*&machinename=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000485; rev:1002;)

# Adware: (Downware) AdMonetizer InstallMonetizer  - regex: to_server:POST /trackstats\.php.*itemid=.* detector_id: 486
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) AdMonetizer InstallMonetizer "; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/trackstats.php"; content:"itemid="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/trackstats\.php.*itemid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000486; rev:1004;)

# Command&Control: (Dropper) GenericDropper_10 - regex: to_server:GET /web/get_ad\d*\.asp\?type=loadall.*&machinename=.* detector_id: 487
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_10"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/web/get_ad"; content:".asp?type=loadall"; content:"&machinename="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/web\/get_ad\d*\.asp\?type=loadall.*&machinename=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000487; rev:1004;)

# Command&Control: (Dropper) GenericDropper_23 - regex: to_server:GET /file\.aspx\?file=.*User-Agent: ksp/WS detector_id: 488
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_23"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/file.aspx?file="; content:"User-Agent|3A| ksp/WS"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/file\.aspx\?file=.*User-Agent: ksp\/WS/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000488; rev:1004;)

# Adware: (Toolbar) HotBar Zango - regex: to_server:GET /logger/software/hit.*\?v.offer=.*&v.sid=.* detector_id: 489
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) HotBar Zango"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/logger/software/hit"; content:"?v"; content:"offer="; content:"&v"; content:"sid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/logger\/software\/hit.*\?v.offer=.*&v.sid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000489; rev:193;)

# Command&Control: (Trojan) Nedsym - regex: to_server:POST /stat[1-2]\.php.*x\x9C detector_id: 490
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Nedsym"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/stat"; content:".php"; content:"x|9C|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/stat[1-2]\.php.*x\x9C/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000490; rev:1004;)

# Command&Control: (Dropper) GenericDropper_10 - regex: to_server:GET /web/click_log\.asp\?ad_url=.* detector_id: 491
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_10"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/web/click_log.asp?ad_url="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/web\/click_log\.asp\?ad_url=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000491; rev:673;)

# Adware: (Downware) Ticno - regex: to_server:GET /\?ping=schemestep&instid.* detector_id: 492
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Ticno"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?ping=schemestep&instid"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?ping=schemestep&instid.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000492; rev:190;)

# Command&Control: (Dropper) Nekill - regex: to_server:GET /\?&uid=.*Host: \d*.\d*.cn detector_id: 493
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Nekill"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?&uid="; content:"Host|3A| "; content:"cn"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?&uid=.*Host: \d*.\d*.cn/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000493; rev:190;)

# FakeAV: GenericFakeAV_3 - regex: to_server:GET /1043\.exe\?affid=.* detector_id: 494
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/1043.exe?affid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/1043\.exe\?affid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000494; rev:1004;)

# FakeAV: GenericFakeAV_3 - regex: to_server:GET /2010\.exe\?affid=.* detector_id: 495
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/2010.exe?affid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/2010\.exe\?affid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000495; rev:1004;)

# Adware: (Toolbar) Zugo - regex: to_server:GET /getcountry\?pid=.*&channel=.*&bdate=.*&bversion=.*&client=.*&action=.*&user_guid=.* detector_id: 496
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Zugo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/getcountry?pid="; content:"&channel="; content:"&bdate="; content:"&bversion="; content:"&client="; content:"&action="; content:"&user_guid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/getcountry\?pid=.*&channel=.*&bdate=.*&bversion=.*&client=.*&action=.*&user_guid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000496; rev:159;)

# Command&Control: (Dropper) Dadon - regex: to_server:GET /inser\.asp\?Id=lh_.*&Mac=.*&sing=.*&XT=.* detector_id: 497
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Dadon"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/inser.asp?Id=lh_"; content:"&Mac="; content:"&sing="; content:"&XT="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/inser\.asp\?Id=lh_.*&Mac=.*&sing=.*&XT=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000497; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_9 - regex: to_server:GET .*\?action=add&a=.*&c=.*&u=.*&l=.*&p=.* detector_id: 498
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_9"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?action=add&a="; content:"&c="; content:"&u="; content:"&l="; content:"&p="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\?action=add&a=.*&c=.*&u=.*&l=.*&p=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000498; rev:177;)

# FakeAV: Rena FakeRean - regex: to_server:GET /images/thanks_25\.php\?id=.* detector_id: 499
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: Rena FakeRean"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/images/thanks_25.php?id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/images\/thanks_25\.php\?id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000499; rev:1004;)

# FakeAV: WinWebSec - regex: to_server:GET /buy\.php\?affid=.*&data=.*&h=.* detector_id: 500
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: WinWebSec"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/buy.php?affid="; content:"&data="; content:"&h="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/buy\.php\?affid=.*&data=.*&h=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000500; rev:1004;)

# FakeAV: WinWebSec - regex: to_server:GET /r\.php\?affid=.*&data=.*&v=.* detector_id: 501
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: WinWebSec"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/r.php?affid="; content:"&data="; content:"&v="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/r\.php\?affid=.*&data=.*&v=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000501; rev:1004;)

# Command&Control: (Dropper) Phidagem - regex: to_server:GET /images/image\.php\?imageid=.* detector_id: 503
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Phidagem"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/images/image.php?imageid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/images\/image\.php\?imageid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000503; rev:1004;)

# FakeAV FakeYak - regex: to_server:GET /index\.php\?prodclass=.*&do=.* detector_id: 504
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV FakeYak"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?prodclass="; content:"&do="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\?prodclass=.*&do=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000504; rev:1004;)

# Command&Control: (Dropper) Winsoft Fosniw - regex: to_server:GET .*app\.asp\?prj=.*&pid=.*&logdata=MacTryCnt.* detector_id: 505
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Winsoft Fosniw"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"app.asp?prj="; content:"&pid="; content:"&logdata=MacTryCnt"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*app\.asp\?prj=.*&pid=.*&logdata=MacTryCnt.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000505; rev:1004;)

# Adware: (Toolbar) HotBar Zango - regex: to_server:GET /InstallUI/(CPLiteIndirectUI|ShamrockSpring)01.* detector_id: 506
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) HotBar Zango"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/InstallUI/"; content:"01"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/InstallUI\/(CPLiteIndirectUI|ShamrockSpring)01.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000506; rev:369;)

# Command&Control: (Dropper) Winsoft - regex: to_server:GET .*winsoft.*\.com/setup/policy\.dat detector_id: 507
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Winsoft"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"winsoft"; content:".com/setup/policy.dat"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*winsoft.*\.com\/setup\/policy\.dat/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000507; rev:1004;)

# Adware: (Toolbar) HotBar Zango - regex: to_server:GET /uci/software\.js detector_id: 508
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) HotBar Zango"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/uci/software.js"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/uci\/software\.js/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000508; rev:1004;)

# Command&Control: (Dropper) Winsoft Fosniw  - regex: to_server:GET .*r_autoidcnt\.asp\?mer_seq=.*&realid=.* detector_id: 523
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Winsoft Fosniw "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"r_autoidcnt.asp?mer_seq="; content:"&realid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*r_autoidcnt\.asp\?mer_seq=.*&realid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000523; rev:1004;)

# Command&Control: (Dropper) GenericDropper_10 - regex: to_server:GET /(adv|web)/get_ad\.asp\?type=loadall&machinename=.* detector_id: 524
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_10"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get_ad.asp?type=loadall&machinename="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(adv|web)\/get_ad\.asp\?type=loadall&machinename=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000524; rev:1002;)

# FakeAV: Rena FakeRean - regex: to_server:GET /images/s6\.php\?id=.* detector_id: 525
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: Rena FakeRean"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/images/s6.php?id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/images\/s6\.php\?id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000525; rev:1004;)

# FakeAV: Rena FakeRean - regex: to_server:GET /scripts/ss\.php\?id=.* detector_id: 526
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: Rena FakeRean"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/scripts/ss.php?id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/scripts\/ss\.php\?id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000526; rev:1004;)

# Command&Control: (Trojan) Koutodoor - regex: to_server:GET /tt\.php\?[a-f0-9]{8} detector_id: 527
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Koutodoor"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/tt.php?"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/tt\.php\?[a-f0-9]{8}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000527; rev:1004;)

# Adware: (Downware) AdMonetizer InstallMonetizer - regex: to_server:POST /trackstats_v2\.php.*itemid=.* detector_id: 529
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) AdMonetizer InstallMonetizer"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/trackstats_v2.php"; content:"itemid="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/trackstats_v2\.php.*itemid=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000529; rev:1004;)

# Command&Control: (Trojan) Jorik - regex: to_server:GET /update/ero/td\.php\?omh=.*&oic=.* detector_id: 530
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Jorik"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/update/ero/td.php?omh="; content:"&oic="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/update\/ero\/td\.php\?omh=.*&oic=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000530; rev:1004;)

# Command&Control: (Trojan) Jorik - regex: to_server:GET /az\.php\?o=.*&id=.*&vol=.* detector_id: 531
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Jorik"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/az.php?o="; content:"&id="; content:"&vol="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/az\.php\?o=.*&id=.*&vol=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000531; rev:1004;)

# FakeAV: GenericFakeAV_3 - regex: to_server:GET /install\.exe\?affid=.* detector_id: 532
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/install.exe?affid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/install\.exe\?affid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000532; rev:1004;)

# Adware: (Downware) GenericDownware_3 - regex: to_server:GET /dynamic/get_configuration\.php\?installer_id=.* detector_id: 533
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) GenericDownware_3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/dynamic/get_configuration.php?installer_id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/dynamic\/get_configuration\.php\?installer_id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000533; rev:1004;)

# Adware: (Toolbar) Sogou - regex: to_server:GET /version\.php\?h=[0-9A-F]*&r=.* detector_id: 534
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Sogou"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/version.php?h="; content:"&r="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/version\.php\?h=[0-9A-F]*&r=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000534; rev:1004;)

# Adware: (Toolbar) Sogou - regex: to_server:GET /bd_bundle.*/sogou_explorer_.*\.exe detector_id: 535
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Sogou"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bd_bundle"; content:"/sogou_explorer_"; content:".exe"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bd_bundle.*\/sogou_explorer_.*\.exe/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000535; rev:1004;)

# Command&Control: (Dropper) GenericDropper_93 Maybe Mutopy - regex: to_server:GET .*/seek\.cgi\?lin=\d+&db=[a-z0-9]{2,4} HTTP.*User-Agent: Mozilla/5\.0 detector_id: 536
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_93 Maybe Mutopy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/seek.cgi?lin="; content:"&db="; content:" HTTP"; content:"User-Agent|3A| Mozilla/5.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/seek\.cgi\?lin=\d+&db=[a-z0-9]{2,4} HTTP.*User-Agent: Mozilla\/5\.0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000536; rev:484;)

# Command&Control: (Dropper) Guagua - regex: to_server:GET /interface/reg_.*jsp\?ad_id=.* detector_id: 537
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Guagua"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/interface/reg_"; content:"jsp?ad_id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/interface\/reg_.*jsp\?ad_id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000537; rev:158;)

# Adware: (Hoax) ArchSMS - regex: to_server:GET /form_of_payment\.php\?0bvtr=.* detector_id: 538
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) ArchSMS"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/form_of_payment.php?0bvtr="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/form_of_payment\.php\?0bvtr=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000538; rev:1004;)

# Command&Control: (Trojan) Bredolab  - regex: to_server:GET .*task\.php\?bid=.*User-Agent: Our_Agent detector_id: 539
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bredolab "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"task.php?bid="; content:"User-Agent|3A| Our_Agent"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*task\.php\?bid=.*User-Agent: Our_Agent/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000539; rev:722;)

# Adware: OpenCandy - regex: to_server:GET /\?clientv=.*&cltzone=.*&language=.*&method=.*&mstime=.*&os=.*&product_key=.*&v=.*&signature=.* detector_id: 541
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: OpenCandy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?clientv="; content:"&cltzone="; content:"&language="; content:"&method="; content:"&mstime="; content:"&os="; content:"&product_key="; content:"&v="; content:"&signature="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?clientv=.*&cltzone=.*&language=.*&method=.*&mstime=.*&os=.*&product_key=.*&v=.*&signature=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000541; rev:391;)

# Command&Control: (Trojan) Sefnit - regex: to_server:GET /gettasks\.php\?protocol=.*&protoversion=\d detector_id: 542
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sefnit"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/gettasks.php?protocol="; content:"&protoversion="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/gettasks\.php\?protocol=.*&protoversion=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000542; rev:598;)

# Adware: (Hoax) Pameseg  - regex: to_server:GET /new_p_f\.php\?user_id=.*&sub_id=.* detector_id: 543
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) Pameseg "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/new_p_f.php?user_id="; content:"&sub_id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/new_p_f\.php\?user_id=.*&sub_id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000543; rev:1004;)

# Command&Control: (Banker) GenericBanker_3 - regex: to_server:GET /php/index\.php\?op=.*&nomebancodados=.*&macaddress=.*&pcname=.*&nomeusuario=.*&serialhd=.*&versaowindows=.*&versaoatual=.*&arquivosplugins=.*&contaremocao=.*&origem=.* detector_id: 544
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/php/index.php?op="; content:"&nomebancodados="; content:"&macaddress="; content:"&pcname="; content:"&nomeusuario="; content:"&serialhd="; content:"&versaowindows="; content:"&versaoatual="; content:"&arquivosplugins="; content:"&contaremocao="; content:"&origem="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/php\/index\.php\?op=.*&nomebancodados=.*&macaddress=.*&pcname=.*&nomeusuario=.*&serialhd=.*&versaowindows=.*&versaoatual=.*&arquivosplugins=.*&contaremocao=.*&origem=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000544; rev:1004;)

# Command&Control: (Dropper) GenericDropper_43 - regex: to_server:GET /adobe\.php\?ver=\d+&app= detector_id: 545
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_43"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/adobe.php?ver="; content:"&app="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/adobe\.php\?ver=\d+&app=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000545; rev:1004;)

# Command&Control: (Trojan) Vundo_1 - regex: to_server:GET /njob\.php\?((num=\d+.*rev=\d+)|(rev=\d+.*num=\d+)) detector_id: 546
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Vundo_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/njob.php?"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/njob\.php\?((num=\d+.*rev=\d+)|(rev=\d+.*num=\d+))/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000546; rev:388;)

# Command&Control: (Trojan) Sefnit - regex: to_server:GET /gettasks\d*\.php\?protocol=.*&protoversion=.*&o=.*&p=.*&f=.* detector_id: 548
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sefnit"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/gettasks"; content:".php?protocol="; content:"&protoversion="; content:"&o="; content:"&p="; content:"&f="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/gettasks\d*\.php\?protocol=.*&protoversion=.*&o=.*&p=.*&f=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000548; rev:369;)

# Command&Control: (Trojan) Sinowal - regex: to_server:POST /search.*\[System Process\].System.smss.exe.csrss.exe.winlogon.exe.services.exe.lsass.exe detector_id: 549
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sinowal"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/search"; content:"|5B|System Process|5D|"; content:"System"; content:"smss"; content:"exe"; content:"csrss"; content:"exe"; content:"winlogon"; content:"exe"; content:"services"; content:"exe"; content:"lsass"; content:"exe"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/search.*\[System Process\].System.smss.exe.csrss.exe.winlogon.exe.services.exe.lsass.exe/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000549; rev:177;)

# Command&Control: (Dropper) GenericDropper_19 - regex: to_server:GET /download\.php\?version=.*&user_id=.*&skey=.*User-Agent: Mozilla/4\.0 \(compatible; Synapse\) detector_id: 550
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_19"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/download.php?version="; content:"&user_id="; content:"&skey="; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| Synapse|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/download\.php\?version=.*&user_id=.*&skey=.*User-Agent: Mozilla\/4\.0 \(compatible\; Synapse\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000550; rev:1004;)

# Command&Control: (Backdoor) DarkHole - regex: to_server:GET /index\.php\?uid=.*&ver=\d[a-z].*XP detector_id: 551
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) DarkHole"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?uid="; content:"&ver="; content:"XP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\?uid=.*&ver=\d[a-z].*XP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000551; rev:711;)

# Command&Control: (Dropper) GenericDropper_20 - regex: to_server:GET /images/index2\.php\?nocache=\d+ detector_id: 553
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_20"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/images/index2.php?nocache="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/images\/index2\.php\?nocache=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000553; rev:1004;)

# Adware: (Downware) KoreanDownware - regex: to_server:GET /statins\.php\?mac=.*&ip=.*&pid=.*&install=.* detector_id: 554
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) KoreanDownware"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/statins.php?mac="; content:"&ip="; content:"&pid="; content:"&install="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/statins\.php\?mac=.*&ip=.*&pid=.*&install=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000554; rev:733;)

# Command&Control: (Trojan) SpyEye_1 - regex: to_server:GET .*gate\.php\?v=.*&b=.*&r=.* detector_id: 556
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) SpyEye_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"gate.php?v="; content:"&b="; content:"&r="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*gate\.php\?v=.*&b=.*&r=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000556; rev:1002;)

# Command&Control: (Dropper) Karagany - regex: to_server:POST /plugin/xgate\.php.*id=_.* detector_id: 557
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Karagany"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/plugin/xgate.php"; content:"id=_"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/plugin\/xgate\.php.*id=_.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000557; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_1 - regex: to_server:GET .*/index\.php\?action=add&username=.*&password=.*&app=WinKey&pcname=.*&sitename=.* detector_id: 558
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?action=add&username="; content:"&password="; content:"&app=WinKey&pcname="; content:"&sitename="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/index\.php\?action=add&username=.*&password=.*&app=WinKey&pcname=.*&sitename=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000558; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_9 - regex: to_server:GET .*\?action=register&i=.*&o=.*&c=.*&u=.*&f=.* detector_id: 559
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_9"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?action=register&i="; content:"&o="; content:"&c="; content:"&u="; content:"&f="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\?action=register&i=.*&o=.*&c=.*&u=.*&f=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000559; rev:177;)

# Command&Control: (Dropper) GenericDropper_41 - regex: to_server:GET /Count\.asp\?UserID=\d+&MAC=[a-f0-9]*&Process=[a-f0-9]{8} detector_id: 562
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_41"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Count.asp?UserID="; content:"&MAC="; content:"&Process="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Count\.asp\?UserID=\d+&MAC=[a-f0-9]*&Process=[a-f0-9]{8}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000562; rev:1004;)

# Command&Control: (Trojan) Bredolab  - regex: to_server:GET .*task\.php\?bid=.*&os=.*&uptime=.*&rnd=.*User-Agent: Our_Agent detector_id: 563
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bredolab "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"task.php?bid="; content:"&os="; content:"&uptime="; content:"&rnd="; content:"User-Agent|3A| Our_Agent"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*task\.php\?bid=.*&os=.*&uptime=.*&rnd=.*User-Agent: Our_Agent/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000563; rev:722;)

# Command&Control: (Trojan) Bredolab - regex: to_server:GET .*/load\.php\?module=(grabbers|sniffers) detector_id: 564
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bredolab"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/load.php?module="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/load\.php\?module=(grabbers|sniffers)/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000564; rev:722;)

# Command&Control: (Trojan) SpyEye_1 - regex: to_server:GET /.*gate\.php\?v=.*&b=.*&r=.* detector_id: 566
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) SpyEye_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"gate.php?v="; content:"&b="; content:"&r="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*gate\.php\?v=.*&b=.*&r=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000566; rev:1004;)

# Command&Control: (Dropper) GenericDropper_21 - regex: to_server:GET /ginfo\.aspx\?ver=\d\.\d&t=rb&vc=\d\.\d&m=.{17}&p= detector_id: 567
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_21"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ginfo.aspx?ver="; content:"&t=rb&vc="; content:"&m="; content:"&p="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ginfo\.aspx\?ver=\d\.\d&t=rb&vc=\d\.\d&m=.{17}&p=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000567; rev:1004;)

# Command&Control: (Dropper) Chepvil - regex: to_server:GET /ftp/g\.php detector_id: 569
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Chepvil"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ftp/g.php"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ftp\/g\.php/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000569; rev:1004;)

# Command&Control: (Trojan) Smokeloader_1 - regex: to_server:GET /index\.php\?cmd=.*&login=.*&sel=.*&ver=.*&bits=.* detector_id: 570
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Smokeloader_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?cmd="; content:"&login="; content:"&sel="; content:"&ver="; content:"&bits="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\?cmd=.*&login=.*&sel=.*&ver=.*&bits=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000570; rev:1004;)

# Command&Control: (Trojan) Sinowal - regex: to_server:GET /searcho\?fr=altavista&itag=ody&q=.*&kgs=1&kls=0&p=21 detector_id: 576
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sinowal"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/searcho?fr=altavista&itag=ody&q="; content:"&kgs=1&kls=0&p=21"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/searcho\?fr=altavista&itag=ody&q=.*&kgs=1&kls=0&p=21/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000576; rev:159;)

# Command&Control: (Trojan) Asprox - regex: to_server:POST /board.php.*form-data; name=.sid.*name=.up.*name=.wbfl.*name=.v.*name=.ping.*name=.guid.*name=.wv.*  detector_id: 578
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Asprox"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/board"; content:"php"; content:"form-data|3B| name="; content:"sid"; content:"name="; content:"up"; content:"name="; content:"wbfl"; content:"name="; content:"name="; content:"ping"; content:"name="; content:"guid"; content:"name="; content:"wv"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/board.php.*form-data\; name=.sid.*name=.up.*name=.wbfl.*name=.v.*name=.ping.*name=.guid.*name=.wv.* /s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000578; rev:163;)

# Command&Control: (Dropper) GenericDropper_13 - regex: to_server:POST /update\.aspx.*a=u&v=[A-F0-9]{40,} detector_id: 579
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_13"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/update.aspx"; content:"a=u&v="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/update\.aspx.*a=u&v=[A-F0-9]{40,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000579; rev:1004;)

# Adware: (Toolbar) Addendum - regex: to_server:GET .*(instup|upgprg)\.asp\?UID=.*&OSV=.*&IEV=.*&VER=.* detector_id: 580
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Addendum"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".asp?UID="; content:"&OSV="; content:"&IEV="; content:"&VER="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*(instup|upgprg)\.asp\?UID=.*&OSV=.*&IEV=.*&VER=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000580; rev:1004;)

# FakeAV: GenericFakeAV_3 - regex: to_server:GET /api/stats/install/.*\?affid=.*&ver=.* detector_id: 584
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/api/stats/install/"; content:"?affid="; content:"&ver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/stats\/install\/.*\?affid=.*&ver=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000584; rev:177;)

# Command&Control: (Dropper) GenericDropper_10 - regex: to_server:GET /web/getinfo\.asp\?ver=.* detector_id: 586
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_10"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/web/getinfo.asp?ver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/web\/getinfo\.asp\?ver=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000586; rev:1004;)

# Adware: (Toolbar) iBryte - regex: to_server:GET /impression\.do/.*\?user_id=.*&event=.*&spsource=.*&implementation_id=.* detector_id: 588
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) iBryte"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/impression.do/"; content:"?user_id="; content:"&event="; content:"&spsource="; content:"&implementation_id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/impression\.do\/.*\?user_id=.*&event=.*&spsource=.*&implementation_id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000588; rev:1004;)

# Command&Control: (Dropper) GenericDropper_15 - regex: to_server:GET /cfg/crypt1\.php\?id=.* detector_id: 589
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_15"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cfg/crypt1.php?id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cfg\/crypt1\.php\?id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000589; rev:1004;)

# Command&Control: (Trojan) Gamarue_2 - regex: to_server:GET /w\.php\?f=.*&e=.* detector_id: 590
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Gamarue_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/w.php?f="; content:"&e="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/w\.php\?f=.*&e=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000590; rev:195;)

# Command&Control: (Trojan) Carberp - regex: to_server:GET /stat\?uptime=.*&downlink=.*&uplink=.*&id=.*&statpass=.*&version=.*&features=.*&guid=.*&comment=.* detector_id: 591
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Carberp"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/stat?uptime="; content:"&downlink="; content:"&uplink="; content:"&id="; content:"&statpass="; content:"&version="; content:"&features="; content:"&guid="; content:"&comment="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/stat\?uptime=.*&downlink=.*&uplink=.*&id=.*&statpass=.*&version=.*&features=.*&guid=.*&comment=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000591; rev:162;)

# Command&Control: (MDN) Yadro - regex: to_server:GET /hit;click5\?q;q detector_id: 592
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (MDN) Yadro"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/hit|3B|click5?q|3B|q"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/hit\;click5\?q\;q/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000592; rev:163;)

# Command&Control: (Trojan) Vundo_2 - regex: to_server:GET .*/(update|ipinfo)\?v=2\.6(b|c)&c=.*&p=[A-Za-z0-9\+/]+={0,2} detector_id: 593
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Vundo_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?v=2.6"; content:"&c="; content:"&p="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/(update|ipinfo)\?v=2\.6(b|c)&c=.*&p=[A-Za-z0-9\+\/]+={0,2}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000593; rev:1004;)

# Adware: (Toolbar) BaroSearch - regex: to_server:GET /bacon2/(AgtLog|AppLog)\.php\?a=.*&u=.*&m=.*&s=.* detector_id: 594
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) BaroSearch"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bacon2/"; content:".php?a="; content:"&u="; content:"&m="; content:"&s="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bacon2\/(AgtLog|AppLog)\.php\?a=.*&u=.*&m=.*&s=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000594; rev:1004;)

# FakeAV: KoreanFakeAV - regex: to_server:GET .*APP/ck_setup\.php\?m=.*&d=.*&a=.*  detector_id: 595
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: KoreanFakeAV"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"APP/ck_setup.php?m="; content:"&d="; content:"&a="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*APP\/ck_setup\.php\?m=.*&d=.*&a=.* /"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000595; rev:1004;)

# Command&Control: (Trojan) Koobface_2 - regex: to_server:GET /\..*/\?action=captcha&a=.*&i=.*&v=.* detector_id: 596
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Koobface_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/."; content:"/?action=captcha&a="; content:"&i="; content:"&v="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\..*\/\?action=captcha&a=.*&i=.*&v=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000596; rev:159;)

# Command&Control: (Dropper) Karagany - regex: to_server:GET /forum/viewtopic\.php\?f=.*&t=.*&sid=.*User-Agent: User-Agent: Opera/10\.60 Presto/2\.2\.30 detector_id: 598
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Karagany"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/forum/viewtopic.php?f="; content:"&t="; content:"&sid="; content:"User-Agent|3A| User-Agent|3A| Opera/10.60 Presto/2.2.30"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/forum\/viewtopic\.php\?f=.*&t=.*&sid=.*User-Agent: User-Agent: Opera\/10\.60 Presto\/2\.2\.30/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000598; rev:1010;)

# Command&Control: (Trojan) Koobface_2 - regex: to_server:GET /\..*/\?action=bs&v=.*&a=.* detector_id: 599
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Koobface_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/."; content:"/?action=bs&v="; content:"&a="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\..*\/\?action=bs&v=.*&a=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000599; rev:159;)

# FakeAV: KoreanFakeAV  - regex: to_server:GET /value\.php\?strMode=setup&strID=.*&strPC=.*&strSite=.*&strOS=.* detector_id: 600
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: KoreanFakeAV "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/value.php?strMode=setup&strID="; content:"&strPC="; content:"&strSite="; content:"&strOS="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/value\.php\?strMode=setup&strID=.*&strPC=.*&strSite=.*&strOS=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000600; rev:1004;)

# Command&Control: (Trojan) GBot - regex: to_server:GET /gbot/getcmd\.php\?id=.*&traff=.* detector_id: 601
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GBot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/gbot/getcmd.php?id="; content:"&traff="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/gbot\/getcmd\.php\?id=.*&traff=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000601; rev:1004;)

# FakeAV: KoreanFakeAV - regex: to_server:GET /mbk\.php\?v1=.*&v2=.* detector_id: 603
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: KoreanFakeAV"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mbk.php?v1="; content:"&v2="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mbk\.php\?v1=.*&v2=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000603; rev:1522;)

# Command&Control: (Trojan) GenericTrojan_14 - regex: to_server:GET /update\?v=.*&uid=.&os=.*Host:.*.co.cc detector_id: 604
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_14"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/update?v="; content:"&uid="; content:"&os="; content:"Host|3A|"; content:"co"; content:"cc"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/update\?v=.*&uid=.&os=.*Host:.*.co.cc/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000604; rev:177;)

# Command&Control: (Trojan) Bredolab  - regex: to_server:POST .*grabbers\.php.*logs=.*&module=grabbers detector_id: 605
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bredolab "; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"grabbers.php"; content:"logs="; content:"&module=grabbers"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*grabbers\.php.*logs=.*&module=grabbers/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000605; rev:722;)

# Command&Control: (Trojan) Smokeloader_1 - regex: to_server:GET .*index\.php\?cmd=getgrab detector_id: 606
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Smokeloader_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"index.php?cmd=getgrab"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*index\.php\?cmd=getgrab/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000606; rev:1004;)

# Command&Control: (Trojan) Smokeloader_1 - regex: to_server:GET .*index\.php\?cmd=getproxy detector_id: 607
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Smokeloader_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"index.php?cmd=getproxy"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*index\.php\?cmd=getproxy/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000607; rev:1004;)

# Command&Control: (Trojan) Smokeloader_1 - regex: to_server:GET .*index\.php\?cmd=getsocks&login=.*&port=.* detector_id: 608
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Smokeloader_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"index.php?cmd=getsocks&login="; content:"&port="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*index\.php\?cmd=getsocks&login=.*&port=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000608; rev:1004;)

# Command&Control: (Trojan) Smokeloader_1 - regex: to_server:GET .*index\.php\?cmd=getload&login=.*&sel=.*&ver=.* detector_id: 609
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Smokeloader_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"index.php?cmd=getload&login="; content:"&sel="; content:"&ver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*index\.php\?cmd=getload&login=.*&sel=.*&ver=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000609; rev:1004;)

# Command&Control: (Trojan) ZeroAccess Sirefef - regex: to_server:GET /stat\d*\.php\?w=.*&i=.*&a=.* detector_id: 617
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZeroAccess Sirefef"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/stat"; content:".php?w="; content:"&i="; content:"&a="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/stat\d*\.php\?w=.*&i=.*&a=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000617; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_1 - regex: to_server:GET .*/index\.php\?action=add&username=.*&password=.*&app=Windows.*&pcname=.*&sitename=.* detector_id: 622
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?action=add&username="; content:"&password="; content:"&app=Windows"; content:"&pcname="; content:"&sitename="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/index\.php\?action=add&username=.*&password=.*&app=Windows.*&pcname=.*&sitename=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000622; rev:1004;)

# Command&Control: (Trojan) MSUpdater - regex: to_server:GET /microsoftupdate/getupdate/default\.aspx\?ID=.*para1=.*para2=.*para3=.* detector_id: 623
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) MSUpdater"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/microsoftupdate/getupdate/default.aspx?ID="; content:"para1="; content:"para2="; content:"para3="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/microsoftupdate\/getupdate\/default\.aspx\?ID=.*para1=.*para2=.*para3=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000623; rev:1004;)

# Command&Control: (Trojan) MSUpdater - regex: to_server:POST /microsoft/errorpost/default\.aspx\?ID=.* detector_id: 625
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) MSUpdater"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/microsoft/errorpost/default.aspx?ID="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/microsoft\/errorpost\/default\.aspx\?ID=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000625; rev:1004;)

# Command&Control: (Trojan) Matchaldru - regex: to_server:GET /search\d*\?h1=.*&h2=.*&h3=.*&h4=.* detector_id: 626
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Matchaldru"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/search"; content:"?h1="; content:"&h2="; content:"&h3="; content:"&h4="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/search\d*\?h1=.*&h2=.*&h3=.*&h4=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000626; rev:162;)

# Command&Control: (Trojan) Matchaldru - regex: to_server:GET /upload\d*\?h1=.* detector_id: 627
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Matchaldru"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/upload"; content:"?h1="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/upload\d*\?h1=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000627; rev:162;)

# Command&Control: (Trojan) GenericTrojan_11 - regex: to_server:GET /(m2|s3|so31)/isup\.php\?v=.*&sox= detector_id: 628
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_11"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/isup.php?v="; content:"&sox="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(m2|s3|so31)\/isup\.php\?v=.*&sox=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000628; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_11  - regex: to_server:GET /(m2|s3|so31)/ping\.php\?v=.*&sox=.*&lport=.*&rsid=.*&slots=.*&spm= detector_id: 630
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_11 "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ping.php?v="; content:"&sox="; content:"&lport="; content:"&rsid="; content:"&slots="; content:"&spm="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(m2|s3|so31)\/ping\.php\?v=.*&sox=.*&lport=.*&rsid=.*&slots=.*&spm=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000630; rev:1004;)

# Command&Control: (Dropper) GenericDropper_9 - regex: to_server:POST .*/bots\.php.*name=.*&so=.*&pasw=.*&file= detector_id: 632
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_9"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/bots.php"; content:"name="; content:"&so="; content:"&pasw="; content:"&file="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/bots\.php.*name=.*&so=.*&pasw=.*&file=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000632; rev:1004;)

# Command&Control: (Ransomware) Winlocker - regex: to_server:GET .*gate\.php\?hwid=.*&pc=.*&localip=.*&winver=.* detector_id: 633
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) Winlocker"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"gate.php?hwid="; content:"&pc="; content:"&localip="; content:"&winver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*gate\.php\?hwid=.*&pc=.*&localip=.*&winver=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000633; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_12 - regex: to_server:GET /[a-z]{2,8}/index\.php\?cmd=gettask&login=[A-F0-9]{40}&win=.*&ver=.*&bits=.* detector_id: 634
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_12"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?cmd=gettask&login="; content:"&win="; content:"&ver="; content:"&bits="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{2,8}\/index\.php\?cmd=gettask&login=[A-F0-9]{40}&win=.*&ver=.*&bits=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000634; rev:1004;)

# Adware: (Downware) GenericDownware_1 - regex: to_server:GET /cmd/getxml\.php\?PartnerId=.* detector_id: 635
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) GenericDownware_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cmd/getxml.php?PartnerId="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cmd\/getxml\.php\?PartnerId=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000635; rev:1004;)

# Adware: (Downware) GenericDownware_1 - regex: to_server:GET /cmd/report\.php\?PartnerId=.* detector_id: 636
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) GenericDownware_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cmd/report.php?PartnerId="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cmd\/report\.php\?PartnerId=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000636; rev:1004;)

# Adware: (Downware) InstallCore - regex: to_server:POST .*/v\d\.\d\.\d/\?v=\d\.\d&c=\d{8,10} HTTP detector_id: 638
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) InstallCore"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/v"; content:"/?v="; content:"&c="; content:" HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/v\d\.\d\.\d\/\?v=\d\.\d&c=\d{8,10} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000638; rev:552;)

# Adware: (Downware) FileHunter  - regex: to_server:GET /install/filehunter/.* detector_id: 639
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) FileHunter "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/install/filehunter/"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/install\/filehunter\/.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000639; rev:162;)

# Adware: (Downware) Seekmo - regex: to_server:GET /downloads/aa/aa/bb\.htm detector_id: 640
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Seekmo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/downloads/aa/aa/bb.htm"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/downloads\/aa\/aa\/bb\.htm/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000640; rev:1004;)

# Adware: (Downware) GenericDownware_2 - regex: to_server:GET /dl\.php\?.*_Setup\.exe.*User-Agent: DownloadTool/1\.0 detector_id: 642
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) GenericDownware_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/dl.php?"; content:"_Setup.exe"; content:"User-Agent|3A| DownloadTool/1.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/dl\.php\?.*_Setup\.exe.*User-Agent: DownloadTool\/1\.0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000642; rev:1004;)

# Command&Control: (Trojan) Grum Jorik.BlackEnergy - regex: to_server:GET /spm/s_get_host\.php\?ver=.* detector_id: 719
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Grum Jorik.BlackEnergy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/spm/s_get_host.php?ver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/spm\/s_get_host\.php\?ver=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000719; rev:1004;)

# Command&Control: (Dropper) GenericDropper_8 - regex: to_server:GET /(tr|list|now)/(aff|time|view)\.php\?gname=[a-f0-9]{10}&pid=.*&m= detector_id: 731
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_8"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?gname="; content:"&pid="; content:"&m="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(tr|list|now)\/(aff|time|view)\.php\?gname=[a-f0-9]{10}&pid=.*&m=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000731; rev:1004;)

# FakeAV: GenericFakeAV_3 - regex: to_server:GET /api/urls/\?&affid=.* detector_id: 732
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/api/urls/?&affid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/urls\/\?&affid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000732; rev:177;)

# FakeAV: GenericFakeAV_3 - regex: to_server:GET /api/stats/install/\?&affid=.*&ver=.*&group=.* detector_id: 733
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/api/stats/install/?&affid="; content:"&ver="; content:"&group="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/stats\/install\/\?&affid=.*&ver=.*&group=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000733; rev:177;)

# FakeAV: GenericFakeAV_3 - regex: to_server:GET /api/stats/install/\d+/\d+ detector_id: 734
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/api/stats/install/"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/stats\/install\/\d+\/\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000734; rev:177;)

# FakeAV: SmartFortress - regex: to_server:GET /ober\.exe\?&affid=\d+ detector_id: 735
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: SmartFortress"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ober.exe?&affid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ober\.exe\?&affid=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000735; rev:1004;)

# FakeAV: SmartFortress - regex: to_server:GET /ober\.exe\?&affid=.* detector_id: 736
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: SmartFortress"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ober.exe?&affid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ober\.exe\?&affid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000736; rev:1004;)

# Command&Control: (Trojan) Graftor - regex: to_server:GET /install\.aspx\?b=(questbasic|basicscan|questbrowser|resulturl|resultbar|queryscan) detector_id: 737
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Graftor"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/install.aspx?b="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/install\.aspx\?b=(questbasic|basicscan|questbrowser|resulturl|resultbar|queryscan)/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000737; rev:1004;)

# Command&Control: (Trojan) Graftor - regex: to_server:GET /download/(questbasic|basicscan)/\d+_\d+/(questbasic|basicscan)-setup\.exe detector_id: 738
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Graftor"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/download/"; content:"-setup.exe"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/download\/(questbasic|basicscan)\/\d+_\d+\/(questbasic|basicscan)-setup\.exe/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000738; rev:1004;)

# FakeAV: Rena FakeRean  - regex: to_server:GET /images/(s|b)\.php\?id=\d{3,4} detector_id: 739
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: Rena FakeRean "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/images/"; content:".php?id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/images\/(s|b)\.php\?id=\d{3,4}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000739; rev:584;)

# Adware: (Toolbar) iBryte - regex: to_server:GET /impression\.do/.*\?user_id=.*&event=.*&spsource=.*&offer_id=.* detector_id: 741
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) iBryte"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/impression.do/"; content:"?user_id="; content:"&event="; content:"&spsource="; content:"&offer_id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/impression\.do\/.*\?user_id=.*&event=.*&spsource=.*&offer_id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000741; rev:1004;)

# Adware: (Toolbar) iBryte - regex: to_server:GET /impression\.do/.*\?user_id=.*&event=.*&spsource=.*&traffic_source=.*&offer_id=.* detector_id: 742
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) iBryte"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/impression.do/"; content:"?user_id="; content:"&event="; content:"&spsource="; content:"&traffic_source="; content:"&offer_id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/impression\.do\/.*\?user_id=.*&event=.*&spsource=.*&traffic_source=.*&offer_id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000742; rev:1004;)

# Adware: (Toolbar) iBryte - regex: to_server:GET /impression\.do/.*\?user_id=.*&event=.*&spsource=.* detector_id: 743
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) iBryte"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/impression.do/"; content:"?user_id="; content:"&event="; content:"&spsource="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/impression\.do\/.*\?user_id=.*&event=.*&spsource=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000743; rev:1004;)

# Adware: (Toolbar) iBryte - regex: to_server:GET /impression\.do/.*\?user_id=.*&event=.*&spsource=.*&subid=.*&traffic_source=.*&offer_id=.* detector_id: 744
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) iBryte"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/impression.do/"; content:"?user_id="; content:"&event="; content:"&spsource="; content:"&subid="; content:"&traffic_source="; content:"&offer_id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/impression\.do\/.*\?user_id=.*&event=.*&spsource=.*&subid=.*&traffic_source=.*&offer_id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000744; rev:1004;)

# Click-Fraud: GenericClickFraud - regex: to_server:GET /adv\.php\?i=.*&rnd=.* detector_id: 745
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Click-Fraud: GenericClickFraud"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/adv.php?i="; content:"&rnd="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/adv\.php\?i=.*&rnd=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000745; rev:1004;)

# Command&Control: (Trojan) Cleaman - regex: to_server:GET /mshow\.php\?id=.*&aff=.*&data=.*&dl=.*&rc=.* detector_id: 746
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Cleaman"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mshow.php?id="; content:"&aff="; content:"&data="; content:"&dl="; content:"&rc="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mshow\.php\?id=.*&aff=.*&data=.*&dl=.*&rc=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000746; rev:1004;)

# Click-Fraud: GenericClickFraud - regex: to_server:GET /c\.php\?l=.*&p=.* detector_id: 748
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Click-Fraud: GenericClickFraud"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/c.php?l="; content:"&p="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/c\.php\?l=.*&p=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000748; rev:1004;)

# Command&Control: (Trojan) Phdet - regex: to_server:POST /bobo/getcfg\.php.*qlmxop=.* detector_id: 751
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Phdet"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/bobo/getcfg.php"; content:"qlmxop="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bobo\/getcfg\.php.*qlmxop=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000751; rev:1004;)

# Command&Control: (Dropper) GenericDropper_7 - regex: to_server:POST /html/[A-F0-9]{30,}\.aspx.*a=u&v=.*&k0=.* detector_id: 752
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_7"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/html/"; content:".aspx"; content:"a=u&v="; content:"&k0="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/html\/[A-F0-9]{30,}\.aspx.*a=u&v=.*&k0=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000752; rev:1004;)

# Command&Control: (Trojan) ZeroAccess Sirefef - regex: to_server:GET /stat\.php\?w=.*&i=.*&a=.* detector_id: 753
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZeroAccess Sirefef"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/stat.php?w="; content:"&i="; content:"&a="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/stat\.php\?w=.*&i=.*&a=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000753; rev:1004;)

# Adware: (Downware) OneClick - regex: to_server:GET /(country|cdi)\.asp\?st=.*&uid=.*&tuid=.*&sref=.*&bld=.* detector_id: 754
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) OneClick"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".asp?st="; content:"&uid="; content:"&tuid="; content:"&sref="; content:"&bld="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(country|cdi)\.asp\?st=.*&uid=.*&tuid=.*&sref=.*&bld=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000754; rev:1014;)

# FakeAV: Rena FakeRean - regex: to_server:GET /extras/p\.php\?id=\d+ detector_id: 755
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: Rena FakeRean"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/extras/p.php?id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/extras\/p\.php\?id=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000755; rev:1004;)

# FakeAV: Rena FakeRean - regex: to_server:GET /40(4|5)\.php\?id=[0-9\.]{3,4} HTTP detector_id: 756
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: Rena FakeRean"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/40"; content:".php?id="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/40(4|5)\.php\?id=[0-9\.]{3,4} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000756; rev:508;)

# Command&Control: (Trojan) Koobface_2 - regex: to_server:GET /\..*/\?action=bs&v=.*&a=getacc&aol detector_id: 757
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Koobface_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/."; content:"/?action=bs&v="; content:"&a=getacc&aol"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\..*\/\?action=bs&v=.*&a=getacc&aol/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000757; rev:159;)

# Command&Control: (Trojan) Koobface_2 - regex: to_server:GET /\.sys/.*\?action=bs&v=.*&a=.* detector_id: 758
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Koobface_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/.sys/"; content:"?action=bs&v="; content:"&a="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\.sys\/.*\?action=bs&v=.*&a=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000758; rev:159;)

# FakeAV: KoreanFakeAV - regex: to_server:GET .*APP/(update|pf_ck)\.php\?v1=.* detector_id: 759
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: KoreanFakeAV"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"APP/"; content:".php?v1="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*APP\/(update|pf_ck)\.php\?v1=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000759; rev:593;)

# Command&Control: (Ransomware) LockScreen - regex: to_server:GET /loc/gate\.php\?getpic=getpic detector_id: 760
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) LockScreen"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/loc/gate.php?getpic=getpic"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/loc\/gate\.php\?getpic=getpic/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000760; rev:1004;)

# Command&Control: (Dropper) Riprox - regex: to_server:POST .*run\.php.*userandpc=.*@.*&admin=(True|true|False|false)&os=.* detector_id: 761
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Riprox"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"run.php"; content:"userandpc="; content:"&admin="; content:"&os="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*run\.php.*userandpc=.*@.*&admin=(True|true|False|false)&os=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000761; rev:1004;)

# Command&Control: (Trojan) Lebag - regex: to_server:POST /index\.php.*X-Handshake: 2000.*\^\\ detector_id: 762
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Lebag"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/index.php"; content:"X-Handshake|3A| 2000"; content:"|5E||5C|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php.*X-Handshake: 2000.*\^\\/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000762; rev:1004;)

# Adware: (Downware) MultiBar - regex: to_server:GET /\d+/\?act=getinstinfo&lang=.*&wmid=.* detector_id: 765
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) MultiBar"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?act=getinstinfo&lang="; content:"&wmid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d+\/\?act=getinstinfo&lang=.*&wmid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000765; rev:159;)

# Adware: (Downware) MultiBar - regex: to_server:GET /feed/feed_en\.xml detector_id: 767
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) MultiBar"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/feed/feed_en.xml"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/feed\/feed_en\.xml/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000767; rev:1004;)

# Command&Control: (Trojan) Gamarue_1 - regex: to_server:POST /and/image\.php.*[A-za-z0-9/=]{20,} detector_id: 771
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Gamarue_1"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/and/image.php"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/and\/image\.php.*[A-za-z0-9\/=]{20,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000771; rev:1004;)

# Command&Control: (Banker) GenericBanker_6 - regex: to_server:POST /courtdate/images/(flash|M_images)/abc\.php.*BLR=ATT&ATT=.*& detector_id: 776
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_6"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/courtdate/images/"; content:"/abc.php"; content:"BLR=ATT&ATT="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/courtdate\/images\/(flash|M_images)\/abc\.php.*BLR=ATT&ATT=.*&/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000776; rev:1004;)

# Command&Control: (Banker) GenericBanker_6 - regex: to_server:POST /cadastros/servclientes\.php.*BLR=ATT&ATT=.*& detector_id: 777
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_6"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/cadastros/servclientes.php"; content:"BLR=ATT&ATT="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cadastros\/servclientes\.php.*BLR=ATT&ATT=.*&/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000777; rev:1004;)

# Command&Control: (Trojan) Phires - regex: to_server:GET /ietj/\d+\.htm\?\d+ detector_id: 782
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Phires"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ietj/"; content:".htm?"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ietj\/\d+\.htm\?\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000782; rev:1004;)

# Command&Control: (Trojan) Cycbot - regex: to_server:GET /.*\.(jpg|gif|png|ico|php|cgi)\?((sv|v\d+)=\d+&)?(tq|pr)=g.*User-Agent: (chrome|opera|gbot|mozilla|iamx)/\d\.\d+\r\n detector_id: 783
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Cycbot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"=g"; content:"User-Agent|3A| "; content:"|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\.(jpg|gif|png|ico|php|cgi)\?((sv|v\d+)=\d+&)?(tq|pr)=g.*User-Agent: (chrome|opera|gbot|mozilla|iamx)\/\d\.\d+\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000783; rev:731;)

# Adware: (Downware) FileBulldog - regex: to_server:POST /installer/html.*installer_data=.* detector_id: 784
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) FileBulldog"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/installer/html"; content:"installer_data="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/installer\/html.*installer_data=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000784; rev:160;)

# Adware: (Downware) AdMonetizer InstallMonetizer - regex: to_server:POST /DS_trackstats_v1\.php.*itemid=.*&pubid=.*&CbId=.*&subid=.*&status=.*&offid=1&log=.* detector_id: 785
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) AdMonetizer InstallMonetizer"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/DS_trackstats_v1.php"; content:"itemid="; content:"&pubid="; content:"&CbId="; content:"&subid="; content:"&status="; content:"&offid=1&log="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/DS_trackstats_v1\.php.*itemid=.*&pubid=.*&CbId=.*&subid=.*&status=.*&offid=1&log=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000785; rev:1004;)

# Adware: (Downware) AdMonetizer InstallMonetizer - regex: to_server:POST /first_call_v1\.php detector_id: 786
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) AdMonetizer InstallMonetizer"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/first_call_v1.php"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/first_call_v1\.php/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000786; rev:1004;)

# Adware: (Downware) AdMonetizer InstallMonetizer - regex: to_server:POST /DS_IMapplication_v\d\.php.*pubid=.*&CbId=.*&subid=.*&mid=.*&advDetails=.* detector_id: 787
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) AdMonetizer InstallMonetizer"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/DS_IMapplication_v"; content:".php"; content:"pubid="; content:"&CbId="; content:"&subid="; content:"&mid="; content:"&advDetails="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/DS_IMapplication_v\d\.php.*pubid=.*&CbId=.*&subid=.*&mid=.*&advDetails=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000787; rev:1004;)

# Adware: (Downware) Zona - regex: to_server:GET /installer\.html\?guid=.*&mode=installStart&version=.*&os=.*&installId=.* detector_id: 788
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Zona"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/installer.html?guid="; content:"&mode=installStart&version="; content:"&os="; content:"&installId="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/installer\.html\?guid=.*&mode=installStart&version=.*&os=.*&installId=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000788; rev:1004;)

# Adware: (Downware) Zona - regex: to_server:GET /Zona\.7z detector_id: 789
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Zona"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Zona.7z"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Zona\.7z/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000789; rev:1004;)

# Command&Control: (Trojan) Sefbov - regex: to_server:POST .*mgsGetMGList.php.*form-data; name=.socks_id detector_id: 793
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sefbov"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"mgsGetMGList"; content:"php"; content:"form-data|3B| name="; content:"socks_id"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*mgsGetMGList.php.*form-data\; name=.socks_id/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000793; rev:160;)

# Command&Control: (Trojan) Sefbov - regex: to_server:POST .*mgsNewPeer\.php HTTP.*form-data; name=.version detector_id: 794
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sefbov"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"mgsNewPeer.php HTTP"; content:"form-data|3B| name="; content:"version"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*mgsNewPeer\.php HTTP.*form-data\; name=.version/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000794; rev:680;)

# Adware: (Toolbar) iBryte - regex: to_server:GET /bundles/.*/muted_.*\.jpg\?v=\d* detector_id: 804
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) iBryte"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bundles/"; content:"/muted_"; content:".jpg?v="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bundles\/.*\/muted_.*\.jpg\?v=\d*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000804; rev:271;)

# FakeAV: Rena FakeRean  - regex: to_server:GET /(book|logo)/go\.php\?id=.* detector_id: 805
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: Rena FakeRean "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/go.php?id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(book|logo)\/go\.php\?id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000805; rev:1004;)

# Command&Control: (Dropper) GenericDropper_5 - regex: to_server:GET /site/images/\.jb/nb/index\.php\?u=gen detector_id: 806
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_5"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/site/images/.jb/nb/index.php?u=gen"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/site\/images\/\.jb\/nb\/index\.php\?u=gen/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000806; rev:1004;)

# Command&Control: (Dropper) GenericDropper_5 - regex: to_server:GET /newg/a\.php\?s=.*&m=[0-9a-f]{32}&u=.*&g=.*&o=.*&ml=.* detector_id: 807
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_5"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/newg/a.php?s="; content:"&m="; content:"&u="; content:"&g="; content:"&o="; content:"&ml="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/newg\/a\.php\?s=.*&m=[0-9a-f]{32}&u=.*&g=.*&o=.*&ml=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000807; rev:1004;)

# Command&Control: (Trojan) Zusy - regex: to_server:GET /.*\.gif.*User-Agent: Googlebot/2\.1 \(\+http://www\.google\.com/bot\.html\) detector_id: 808
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zusy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".gif"; content:"User-Agent|3A| Googlebot/2.1 |28||2B|http|3A|//www.google.com/bot.html|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\.gif.*User-Agent: Googlebot\/2\.1 \(\+http:\/\/www\.google\.com\/bot\.html\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000808; rev:443;)

# Command&Control: (Dropper) GenericDropper_4 - regex: to_server:GET /[a-z]+/click\.php\?ver=\d&type=prog&key= detector_id: 812
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_4"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/click.php?ver="; content:"&type=prog&key="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]+\/click\.php\?ver=\d&type=prog&key=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000812; rev:1004;)

# FakeAV: GenericFakeAV_6 - regex: to_server:GET /cb_soft\.php\?q=[0-9a-f]{32} detector_id: 813
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_6"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cb_soft.php?q="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cb_soft\.php\?q=[0-9a-f]{32}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000813; rev:1004;)

# Adware: (Downware) FileBulldog - regex: to_server:POST /binsis/xml\?uid=.*&v=.*&affid=.*&sid=.* detector_id: 814
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) FileBulldog"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/binsis/xml?uid="; content:"&v="; content:"&affid="; content:"&sid="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/binsis\/xml\?uid=.*&v=.*&affid=.*&sid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000814; rev:159;)

# Adware: (Downware) FileBulldog - regex: to_server:GET /binsis/get_pre_offering_checks\?uid=.*&v=.*&affid=.*&sid=.* detector_id: 815
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) FileBulldog"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/binsis/get_pre_offering_checks?uid="; content:"&v="; content:"&affid="; content:"&sid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/binsis\/get_pre_offering_checks\?uid=.*&v=.*&affid=.*&sid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000815; rev:159;)

# Adware: (Game) GamePlayLabs - regex: to_server:GET /installer-run/.*/.*/xriderexe/.*/\?pid=.*&sub_id=default&uzid=.*&subid=.*&pid=.* detector_id: 816
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Game) GamePlayLabs"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/installer-run/"; content:"/xriderexe/"; content:"/?pid="; content:"&sub_id=default&uzid="; content:"&subid="; content:"&pid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/installer-run\/.*\/.*\/xriderexe\/.*\/\?pid=.*&sub_id=default&uzid=.*&subid=.*&pid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000816; rev:159;)

# Adware: (Game) GamePlayLabs - regex: to_server:GET /installer\.gif\?action=.*&browser=.*&ver=.*&bic=.*&app=.*&appver=.*&verifier=.*&srcid=.*&subid=.*&zdata=.*&subid=.*&pid=.*&ff=.*&ch=1&default=.*&os=.*&admin=.* detector_id: 817
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Game) GamePlayLabs"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/installer.gif?action="; content:"&browser="; content:"&ver="; content:"&bic="; content:"&app="; content:"&appver="; content:"&verifier="; content:"&srcid="; content:"&subid="; content:"&zdata="; content:"&subid="; content:"&pid="; content:"&ff="; content:"&ch=1&default="; content:"&os="; content:"&admin="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/installer\.gif\?action=.*&browser=.*&ver=.*&bic=.*&app=.*&appver=.*&verifier=.*&srcid=.*&subid=.*&zdata=.*&subid=.*&pid=.*&ff=.*&ch=1&default=.*&os=.*&admin=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000817; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_7 - regex: to_server:POST /upload/gate\.php.*id=.*&version=.*&os=.*&s\d+=.*&done=.* detector_id: 818
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_7"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/upload/gate.php"; content:"id="; content:"&version="; content:"&os="; content:"&s"; content:"&done="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/upload\/gate\.php.*id=.*&version=.*&os=.*&s\d+=.*&done=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000818; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_8 - regex: to_server:GET /IMG_0100\.jpg\?i=.*-_-.* detector_id: 819
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_8"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/IMG_0100.jpg?i="; content:"-_-"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/IMG_0100\.jpg\?i=.*-_-.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000819; rev:1004;)

# Command&Control: (Dropper) VPEye - regex: to_server:GET /dl\.php\?sn=.*User-Agent: VP-EYE Downloader detector_id: 820
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) VPEye"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/dl.php?sn="; content:"User-Agent|3A| VP-EYE Downloader"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/dl\.php\?sn=.*User-Agent: VP-EYE Downloader/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000820; rev:1004;)

# Adware: (Adware) Kraddare - regex: to_server:POST /mine_setproc\.php.*action=setupexec&type=.*&dist=.*&time=.* detector_id: 821
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Kraddare"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/mine_setproc.php"; content:"action=setupexec&type="; content:"&dist="; content:"&time="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mine_setproc\.php.*action=setupexec&type=.*&dist=.*&time=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000821; rev:1004;)

# Adware: (Adware) Kraddare - regex: to_server:POST /mine_report\.php.*action=procdata&mac=.*&dist=.*&nm=.*&adn=.*&ver=.*&win=.*&ie=.*&ck=.*&cwset=.*&ucode=.*&d=.*&_cache=.*&b=.*&d=.* detector_id: 822
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Kraddare"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/mine_report.php"; content:"action=procdata&mac="; content:"&dist="; content:"&nm="; content:"&adn="; content:"&ver="; content:"&win="; content:"&ie="; content:"&ck="; content:"&cwset="; content:"&ucode="; content:"&d="; content:"&_cache="; content:"&b="; content:"&d="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mine_report\.php.*action=procdata&mac=.*&dist=.*&nm=.*&adn=.*&ver=.*&win=.*&ie=.*&ck=.*&cwset=.*&ucode=.*&d=.*&_cache=.*&b=.*&d=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000822; rev:1004;)

# Adware: (Toolbar) HotBar Zango - regex: to_server:GET /IC/GPLRavenBleu.*\.exe\?rnd=.* detector_id: 823
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) HotBar Zango"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/IC/GPLRavenBleu"; content:".exe?rnd="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/IC\/GPLRavenBleu.*\.exe\?rnd=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000823; rev:159;)

# Adware: (Downware) AdMonetizer InstallMonetizer - regex: to_server:POST /IM_getPath_v2\.php detector_id: 824
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) AdMonetizer InstallMonetizer"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/IM_getPath_v2.php"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/IM_getPath_v2\.php/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000824; rev:1004;)

# Command&Control: (Trojan) Smokeloader_1 - regex: to_server:GET .*/index\.php\?cmd=getload&login=.*&file=.*&sel=.*&run=ok detector_id: 825
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Smokeloader_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?cmd=getload&login="; content:"&file="; content:"&sel="; content:"&run=ok"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/index\.php\?cmd=getload&login=.*&file=.*&sel=.*&run=ok/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000825; rev:1004;)

# Adware: (Hoax) ArchSMS - regex: to_server:GET /api/open\.php\?aid=.*&v=.* detector_id: 826
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) ArchSMS"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/api/open.php?aid="; content:"&v="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/open\.php\?aid=.*&v=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000826; rev:1004;)

# Command&Control: (Banker) Banbra - regex: to_server:POST /wp-content/plugins/sntemp\.php.*form-data; name="serie\d+".*exec.* detector_id: 827
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Banbra"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/wp-content/plugins/sntemp.php"; content:"form-data|3B| name=|22|serie"; content:"exec"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/wp-content\/plugins\/sntemp\.php.*form-data\; name="serie\d+".*exec.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000827; rev:1004;)

# Command&Control: (Trojan) Sality_1 - regex: to_server:GET /mrow_pin/\?id.*&rnd=.* detector_id: 828
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sality_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mrow_pin/?id"; content:"&rnd="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mrow_pin\/\?id.*&rnd=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000828; rev:159;)

# Command&Control: (Trojan) Sality_1 - regex: to_server:GET .*/\?id[0-9a-z]*&rnd=\d+.*User-Agent: KUKU v3.* detector_id: 829
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sality_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?id"; content:"&rnd="; content:"User-Agent|3A| KUKU v3"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/\?id[0-9a-z]*&rnd=\d+.*User-Agent: KUKU v3.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000829; rev:271;)

# FakeAV: VirusDoctor 2012-04-12 - regex: to_server:GET /index\.php\?b4c651=.* detector_id: 830
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: VirusDoctor 2012-04-12"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?b4c651="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\?b4c651=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000830; rev:1004;)

# Adware: Funpop Kraddare - regex: to_server:GET .*/bcc\.php\?madd=.*&ptn=.* detector_id: 831
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: Funpop Kraddare"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bcc.php?madd="; content:"&ptn="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/bcc\.php\?madd=.*&ptn=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000831; rev:1004;)

# Adware: (Downware) KoreanDownware - regex: to_server:GET /check_counter\.php\?pid=.{4,15}&mac=.{17}&kind= detector_id: 833
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) KoreanDownware"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/check_counter.php?pid="; content:"&mac="; content:"&kind="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/check_counter\.php\?pid=.{4,15}&mac=.{17}&kind=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000833; rev:1002;)

# Adware: (Downware) GabPath - regex: to_server:GET /gpdcount\.php\?&vinfo=.*&curtime=.*&mac=.*&dbg=.* detector_id: 834
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) GabPath"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/gpdcount.php?&vinfo="; content:"&curtime="; content:"&mac="; content:"&dbg="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/gpdcount\.php\?&vinfo=.*&curtime=.*&mac=.*&dbg=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000834; rev:1004;)

# Command&Control: (Trojan) GBot - regex: to_server:GET .*getcmd\.php\?uid=.*&traf=.* detector_id: 835
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GBot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"getcmd.php?uid="; content:"&traf="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*getcmd\.php\?uid=.*&traf=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000835; rev:1004;)

# Command&Control: (Trojan) GBot - regex: to_server:GET .*getcmd\.php\?.*User-Agent: g-bot detector_id: 836
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GBot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"getcmd.php?"; content:"User-Agent|3A| g-bot"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*getcmd\.php\?.*User-Agent: g-bot/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000836; rev:1004;)

# Command&Control: (Trojan) Shiz - regex: to_server:POST /login.php.*User-Agent:.*Media Center PC 6.0.*Content-Length: 9.*~7.~' detector_id: 838
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Shiz"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/login"; content:"php"; content:"User-Agent|3A|"; content:"Media Center PC 6"; content:"Content-Length|3A| 9"; content:"|7E|7"; content:"|7E||27|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/login.php.*User-Agent:.*Media Center PC 6.0.*Content-Length: 9.*~7.~'/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000838; rev:159;)

# Command&Control: (Trojan) Emudbot - regex: to_server:GET /mars/settings\.cfg\?build=.*&os=.*&new=.* detector_id: 839
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Emudbot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mars/settings.cfg?build="; content:"&os="; content:"&new="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mars\/settings\.cfg\?build=.*&os=.*&new=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000839; rev:1004;)

# Command&Control: (Trojan) Emudbot - regex: to_server:GET /mars/remote\.php\?os=.*&version=.*&build=.*&init=.*&pint=.*&unit=.*&chint=.* detector_id: 840
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Emudbot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mars/remote.php?os="; content:"&version="; content:"&build="; content:"&init="; content:"&pint="; content:"&unit="; content:"&chint="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mars\/remote\.php\?os=.*&version=.*&build=.*&init=.*&pint=.*&unit=.*&chint=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000840; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_6 - regex: to_server:GET /tj\.asp\?id=\d.*Host:.*91mt\.com detector_id: 841
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_6"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/tj.asp?id="; content:"Host|3A|"; content:"91mt.com"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/tj\.asp\?id=\d.*Host:.*91mt\.com/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000841; rev:1004;)

# Command&Control: (Trojan) Gimemo - regex: to_server:POST /atx7/fg\.php\?id=/d+ detector_id: 842
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Gimemo"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/atx7/fg.php?id=/"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/atx7\/fg\.php\?id=\/d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000842; rev:159;)

# Command&Control: (Trojan) Gimemo - regex: to_server:POST /atx7/image\.php.*[A-Za-z0-9/+]*={0,2} detector_id: 843
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Gimemo"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/atx7/image.php"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/atx7\/image\.php.*[A-Za-z0-9\/+]*={0,2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000843; rev:1004;)

# Adware: (Downware) InstallCore - regex: to_server:GET /fxaff/v1\.0.1/\?v=.*&c=.* detector_id: 844
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) InstallCore"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/fxaff/v1.0"; content:"1/?v="; content:"&c="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/fxaff\/v1\.0.1\/\?v=.*&c=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000844; rev:1010;)

# Command&Control: (Worm) Bagle - regex: to_server:GET /xyz\.php\?crc=.* detector_id: 849
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Bagle"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/xyz.php?crc="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/xyz\.php\?crc=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000849; rev:1004;)

# Command&Control: (Trojan) Smokeloader_1 - regex: to_server:GET .*/index\.php\?cmd=getload&login=.*&file=.*&sel=.* detector_id: 850
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Smokeloader_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?cmd=getload&login="; content:"&file="; content:"&sel="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/index\.php\?cmd=getload&login=.*&file=.*&sel=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000850; rev:1004;)

# FakeAV: FakeSysdef - regex: to_server:GET /up\.php\?[A-Za-z0-9/+]{8,}={0,2} detector_id: 851
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeSysdef"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/up.php?"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/up\.php\?[A-Za-z0-9\/+]{8,}={0,2}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000851; rev:1004;)

# Command&Control: (Dropper) Guagua - regex: to_server:GET /interface/reg_page\.jsp\?ad_id=.*&from_type=.*&rec_uid=.*&url=.* detector_id: 852
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Guagua"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/interface/reg_page.jsp?ad_id="; content:"&from_type="; content:"&rec_uid="; content:"&url="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/interface\/reg_page\.jsp\?ad_id=.*&from_type=.*&rec_uid=.*&url=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000852; rev:158;)

# Command&Control: (Dropper) Guagua - regex: to_server:GET /interface/reg_cookie\.jsp\?ad_id=.*&from_type=.*&rec_uid=.*&url=.* detector_id: 853
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Guagua"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/interface/reg_cookie.jsp?ad_id="; content:"&from_type="; content:"&rec_uid="; content:"&url="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/interface\/reg_cookie\.jsp\?ad_id=.*&from_type=.*&rec_uid=.*&url=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000853; rev:158;)

# Adware: (Game) EpicGames GameVance - regex: to_server:GET /etg\?format=plain detector_id: 854
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Game) EpicGames GameVance"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/etg?format=plain"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/etg\?format=plain/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000854; rev:159;)

# Command&Control: (Trojan) Tactslay - regex: to_server:GET /index\.php\?m=\d&m2=\d&c=\d&v=NA&myID=.* detector_id: 855
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Tactslay"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?m="; content:"&m2="; content:"&c="; content:"&v=NA&myID="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\?m=\d&m2=\d&c=\d&v=NA&myID=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000855; rev:1004;)

# FakeAV: FakeSysdef - regex: to_server:GET /up\.php\?0.*= detector_id: 856
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeSysdef"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/up.php?0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/up\.php\?0.*=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000856; rev:1004;)

# Adware: (Downware) DownloadAdmin - regex: to_server:GET /install\?s=.*&c=.*&brand=.*&pid=.*&aid=.*&bc=.*&country=.* detector_id: 857
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) DownloadAdmin"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/install?s="; content:"&c="; content:"&brand="; content:"&pid="; content:"&aid="; content:"&bc="; content:"&country="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/install\?s=.*&c=.*&brand=.*&pid=.*&aid=.*&bc=.*&country=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000857; rev:159;)

# Command&Control: (Trojan) SpyEye_2 - regex: to_server:GET .*gate\.php\?guid=.*&ver=.*&ie=.*&os=.*&ut=.*&ccrc=.*&md5=.*&plg=.*&stat=.* detector_id: 859
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) SpyEye_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"gate.php?guid="; content:"&ver="; content:"&ie="; content:"&os="; content:"&ut="; content:"&ccrc="; content:"&md5="; content:"&plg="; content:"&stat="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*gate\.php\?guid=.*&ver=.*&ie=.*&os=.*&ut=.*&ccrc=.*&md5=.*&plg=.*&stat=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000859; rev:1004;)

# Command&Control: (Trojan) Emudbot - regex: to_server:GET /oly/hello\.php\?i=(ip|list)&b=.* detector_id: 860
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Emudbot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/oly/hello.php?i="; content:"&b="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/oly\/hello\.php\?i=(ip|list)&b=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000860; rev:722;)

# Command&Control: (Trojan) Emudbot - regex: to_server:GET /mars/iLog\.php\?dl=.*&log=Loader.*BB detector_id: 861
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Emudbot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mars/iLog.php?dl="; content:"&log=Loader"; content:"BB"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mars\/iLog\.php\?dl=.*&log=Loader.*BB/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000861; rev:159;)

# Command&Control: (Trojan) Emudbot - regex: to_server:GET /remote/remote\.php\?v=.* detector_id: 862
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Emudbot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/remote/remote.php?v="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/remote\/remote\.php\?v=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000862; rev:1002;)

# Command&Control: (Trojan) Emudbot - regex: to_server:POST /mars/iLog\.php.*hwid=.*&d=.* detector_id: 863
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Emudbot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/mars/iLog.php"; content:"hwid="; content:"&d="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mars\/iLog\.php.*hwid=.*&d=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000863; rev:1004;)

# Command&Control: (Dropper) GenericDropper_2 - regex: to_server:POST /log\.aspx\?v=.*&mid=.*&r1=.*&tm=.*&av=.*&os=.*&uid=.*&cht=.*&sn=.* detector_id: 864
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_2"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/log.aspx?v="; content:"&mid="; content:"&r1="; content:"&tm="; content:"&av="; content:"&os="; content:"&uid="; content:"&cht="; content:"&sn="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/log\.aspx\?v=.*&mid=.*&r1=.*&tm=.*&av=.*&os=.*&uid=.*&cht=.*&sn=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000864; rev:1004;)

# Command&Control: (Trojan) Koobface_2 - regex: to_server:POST /\.sys/\?action=fbgen&v=.*&crc=.* detector_id: 865
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Koobface_2"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/.sys/?action=fbgen&v="; content:"&crc="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\.sys\/\?action=fbgen&v=.*&crc=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000865; rev:159;)

# Adware: (Redirect) Webalta - regex: to_server:POST /s\.php.*p=.*&n=.*&v=.*&e=.*&c=.*&mj=.*&mn=.*&ei=.*&ai=.*&tr=.*&r=.*&f=.* detector_id: 866
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Redirect) Webalta"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/s.php"; content:"p="; content:"&n="; content:"&v="; content:"&e="; content:"&c="; content:"&mj="; content:"&mn="; content:"&ei="; content:"&ai="; content:"&tr="; content:"&r="; content:"&f="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/s\.php.*p=.*&n=.*&v=.*&e=.*&c=.*&mj=.*&mn=.*&ei=.*&ai=.*&tr=.*&r=.*&f=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000866; rev:1004;)

# Command&Control: (Dropper) Pluzoks KiayksayRen - regex: to_server:GET /link/new_config\.php\?pid=.* detector_id: 871
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Pluzoks KiayksayRen"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/link/new_config.php?pid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/link\/new_config\.php\?pid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000871; rev:1004;)

# Command&Control: (Trojan) LdPinch - regex: to_server:GET .*rand/patch\.html\?gname=.*&pid=.*&m=.* detector_id: 872
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) LdPinch"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"rand/patch.html?gname="; content:"&pid="; content:"&m="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*rand\/patch\.html\?gname=.*&pid=.*&m=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000872; rev:1004;)

# Adware: (Adware) Kraddare - regex: to_server:GET /mine_down\.php\?type=version&dist=.*&nm=.*&ver=.*&_cache=.* detector_id: 873
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Kraddare"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mine_down.php?type=version&dist="; content:"&nm="; content:"&ver="; content:"&_cache="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mine_down\.php\?type=version&dist=.*&nm=.*&ver=.*&_cache=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000873; rev:377;)

# Adware: (Adware) Kraddare - regex: to_server:GET /mine_down\.php\?type=.*&mac=.*&dist=.*&nm=.*&adn=.*&ver=.*&win=.*&ie=.*&ck=.*&cwset=.*&ucode=.*&d=.*&_cache=.* detector_id: 874
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Kraddare"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mine_down.php?type="; content:"&mac="; content:"&dist="; content:"&nm="; content:"&adn="; content:"&ver="; content:"&win="; content:"&ie="; content:"&ck="; content:"&cwset="; content:"&ucode="; content:"&d="; content:"&_cache="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mine_down\.php\?type=.*&mac=.*&dist=.*&nm=.*&adn=.*&ver=.*&win=.*&ie=.*&ck=.*&cwset=.*&ucode=.*&d=.*&_cache=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000874; rev:1004;)

# Adware: (Adware) Kraddare - regex: to_server:POST /mine_report\.php.*action=.*&mac=.*&dist=.*&nm=.*&adn=.*&ver=.*&win=.*&ie=.*&ck=.*&cwset=.*&ucode=.*&d=.*&_cache=.*&log_date=.*&r=.*&ts=.* detector_id: 875
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Kraddare"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/mine_report.php"; content:"action="; content:"&mac="; content:"&dist="; content:"&nm="; content:"&adn="; content:"&ver="; content:"&win="; content:"&ie="; content:"&ck="; content:"&cwset="; content:"&ucode="; content:"&d="; content:"&_cache="; content:"&log_date="; content:"&r="; content:"&ts="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mine_report\.php.*action=.*&mac=.*&dist=.*&nm=.*&adn=.*&ver=.*&win=.*&ie=.*&ck=.*&cwset=.*&ucode=.*&d=.*&_cache=.*&log_date=.*&r=.*&ts=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000875; rev:1004;)

# Adware: (Adware) Kraddare - regex: to_server:GET /mine_down.site.php\?type=site&mac=.*&dist=.* detector_id: 876
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Kraddare"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mine_down"; content:"site"; content:"php?type=site&mac="; content:"&dist="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mine_down.site.php\?type=site&mac=.*&dist=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000876; rev:377;)

# Command&Control: (Trojan) Luckycat VBS.Sojax - regex: to_server:GET .*/count\.php\?m=.*&n=.* detector_id: 877
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Luckycat VBS.Sojax"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/count.php?m="; content:"&n="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/count\.php\?m=.*&n=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000877; rev:1004;)

# Command&Control: (Trojan) Luckycat VBS.Sojax - regex: to_server:POST .*/count\.php?m=.*&n=.* detector_id: 878
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Luckycat VBS.Sojax"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/count.ph"; content:"m="; content:"&n="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/count\.php?m=.*&n=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000878; rev:1004;)

# Command&Control: (Trojan) Luckycat VBS.Sojax - regex: to_server:POST .*/loveusa\.php?m=.*&n=.* detector_id: 879
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Luckycat VBS.Sojax"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/loveusa.ph"; content:"m="; content:"&n="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/loveusa\.php?m=.*&n=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000879; rev:1004;)

# Command&Control: (Trojan) Luckycat VBS.Sojax - regex: to_server:GET .*/loveusa\.php\?m=.*&n=.* detector_id: 880
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Luckycat VBS.Sojax"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/loveusa.php?m="; content:"&n="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/loveusa\.php\?m=.*&n=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000880; rev:1004;)

# Command&Control: (Banker) Banz - regex: to_server:POST .*/atendimento\.php.*to=.*&subject=.*&message=.* detector_id: 881
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Banz"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/atendimento.php"; content:"to="; content:"&subject="; content:"&message="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/atendimento\.php.*to=.*&subject=.*&message=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000881; rev:158;)

# Command&Control: (Banker) Bloropac - regex: to_server:POST .*/novo\.php.*to=.*&subject=.*&message=infectado detector_id: 882
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Bloropac"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/novo.php"; content:"to="; content:"&subject="; content:"&message=infectado"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/novo\.php.*to=.*&subject=.*&message=infectado/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000882; rev:178;)

# Command&Control: (Dropper) Geral - regex: to_server:POST /Count\.asp.*user=.*&m=.*&f=.*&pc=.*&l=.* detector_id: 883
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Geral"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/Count.asp"; content:"user="; content:"&m="; content:"&f="; content:"&pc="; content:"&l="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Count\.asp.*user=.*&m=.*&f=.*&pc=.*&l=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000883; rev:1004;)

# Command&Control: (Dropper) Geral - regex: to_server:GET /hosts\.txt.*User-Agent: MyIE/1\.0 detector_id: 884
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Geral"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/hosts.txt"; content:"User-Agent|3A| MyIE/1.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/hosts\.txt.*User-Agent: MyIE\/1\.0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000884; rev:158;)

# Command&Control: (Dropper) Geral - regex: to_server:GET /Lo\d+\.js.*User-Agent: MyIE/1\.0 detector_id: 885
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Geral"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Lo"; content:".js"; content:"User-Agent|3A| MyIE/1.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Lo\d+\.js.*User-Agent: MyIE\/1\.0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000885; rev:158;)

# Command&Control: (Trojan) Sality_2 - regex: to_server:GET /foo\?ip=.*&port=.*&req=.*&proxy=.*&host=.*&ua=.*  detector_id: 886
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sality_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/foo?ip="; content:"&port="; content:"&req="; content:"&proxy="; content:"&host="; content:"&ua="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/foo\?ip=.*&port=.*&req=.*&proxy=.*&host=.*&ua=.* /"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000886; rev:314;)

# Command&Control: (Trojan) Sality_2 - regex: to_server:GET .*logos\.gif\?.*=.*User-Agent: KUKU v5 detector_id: 887
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sality_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"logos.gif?"; content:"User-Agent|3A| KUKU v5"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*logos\.gif\?.*=.*User-Agent: KUKU v5/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000887; rev:271;)

# Command&Control: (Trojan) ZBot - regex: to_server:GET /bot/config\.bin detector_id: 888
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bot/config.bin"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bot\/config\.bin/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000888; rev:730;)

# Command&Control: (Trojan) Cadro - regex: to_server:POST /Get(Grid|Data)\.asp.*SN=.*&SP=.* detector_id: 889
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Cadro"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/Get"; content:".asp"; content:"SN="; content:"&SP="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Get(Grid|Data)\.asp.*SN=.*&SP=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000889; rev:1004;)

# Click-Fraud: GenericClickFraud - regex: to_server:GET /c\.php\?re=.*&r=.*&u=.*&cid=.*&rc=.*&pa=.*&ref1=.*&ref2=.* detector_id: 890
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Click-Fraud: GenericClickFraud"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/c.php?re="; content:"&r="; content:"&u="; content:"&cid="; content:"&rc="; content:"&pa="; content:"&ref1="; content:"&ref2="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/c\.php\?re=.*&r=.*&u=.*&cid=.*&rc=.*&pa=.*&ref1=.*&ref2=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000890; rev:1004;)

# Command&Control: (Trojan) Popureb Popwin - regex: to_server:GET /sms/do\.php\?userid=.*&time=.*&msg=.*&ver=.*&os=.*&fy=.*&pauid=.*&checkId=.* detector_id: 891
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Popureb Popwin"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/sms/do.php?userid="; content:"&time="; content:"&msg="; content:"&ver="; content:"&os="; content:"&fy="; content:"&pauid="; content:"&checkId="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/sms\/do\.php\?userid=.*&time=.*&msg=.*&ver=.*&os=.*&fy=.*&pauid=.*&checkId=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000891; rev:1004;)

# Command&Control: (Trojan) Parkchicers - regex: to_server:GET .*/execute\.php\?m_origin=.*&usr_id=.*&usr_gubun=.*&serialno=.*&Pid=.* detector_id: 892
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Parkchicers"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/execute.php?m_origin="; content:"&usr_id="; content:"&usr_gubun="; content:"&serialno="; content:"&Pid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/execute\.php\?m_origin=.*&usr_id=.*&usr_gubun=.*&serialno=.*&Pid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000892; rev:158;)

# Command&Control: (Trojan) Georbot - regex: to_server:GET /index\d+\.php\?ver=.*&cam=.*&p=.*&id=.* detector_id: 893
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Georbot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index"; content:".php?ver="; content:"&cam="; content:"&p="; content:"&id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\d+\.php\?ver=.*&cam=.*&p=.*&id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000893; rev:1004;)

# FakeAV: GenericFakeAV_1 - regex: to_server:GET /\?0=\d*&1=\d*&2=\d*&3=\d*&4=.*&5=\d*&6=\d*&7=\d*&8=.*&9=\d*&10=\d*&11=\d*&12=.*&14=\d* detector_id: 894
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?0="; content:"&1="; content:"&2="; content:"&3="; content:"&4="; content:"&5="; content:"&6="; content:"&7="; content:"&8="; content:"&9="; content:"&10="; content:"&11="; content:"&12="; content:"&14="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?0=\d*&1=\d*&2=\d*&3=\d*&4=.*&5=\d*&6=\d*&7=\d*&8=.*&9=\d*&10=\d*&11=\d*&12=.*&14=\d*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000894; rev:177;)

# FakeAV: GenericFakeAV_1 - regex: to_server:GET /u/60021057/NPSWF32.z detector_id: 895
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/u/60021057/NPSWF32"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/u\/60021057\/NPSWF32.z/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000895; rev:177;)

# FakeAV: GenericFakeAV_5 - regex: to_server:GET /ea\.php\?p=.*&aid=.* detector_id: 896
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_5"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ea.php?p="; content:"&aid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ea\.php\?p=.*&aid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000896; rev:1004;)

# Command&Control: (Dropper) Dapato_2 - regex: to_server:GET .*/update\.php\?ver=.*&type=prog detector_id: 897
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Dapato_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/update.php?ver="; content:"&type=prog"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/update\.php\?ver=.*&type=prog/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000897; rev:158;)

# Command&Control: (Dropper) Dapato_2 - regex: to_server:GET .*/click\.php\?ver=.*&type=.*&key=.* detector_id: 898
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Dapato_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/click.php?ver="; content:"&type="; content:"&key="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/click\.php\?ver=.*&type=.*&key=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000898; rev:158;)

# Adware: (Toolbar) iBryte - regex: to_server:GET /bundles/.*\.jpg\?v=.* detector_id: 899
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) iBryte"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bundles/"; content:".jpg?v="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bundles\/.*\.jpg\?v=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000899; rev:271;)

# Command&Control: (Trojan) Mutopy - regex: to_server:GET /protocol\.php\?p=\d+&d=.*User-Agent: - detector_id: 900
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Mutopy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/protocol.php?p="; content:"&d="; content:"User-Agent|3A| -"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/protocol\.php\?p=\d+&d=.*User-Agent: -/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000900; rev:399;)

# Command&Control: (Trojan) GenericTrojan_3 - regex: to_server:GET /d/scrp\d{2,4}\.jpg.*User-Agent: - detector_id: 901
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/d/scrp"; content:".jpg"; content:"User-Agent|3A| -"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/d\/scrp\d{2,4}\.jpg.*User-Agent: -/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000901; rev:378;)

# Command&Control: (Trojan) GenericTrojan_3 - regex: to_server:GET /gu\.php.*User-Agent: - detector_id: 902
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/gu.php"; content:"User-Agent|3A| -"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/gu\.php.*User-Agent: -/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000902; rev:177;)

# Command&Control: (Trojan) GenericTrojan_3 - regex: to_server:GET /a\d+a\.php.*User-Agent: - detector_id: 903
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/a"; content:"a.php"; content:"User-Agent|3A| -"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/a\d+a\.php.*User-Agent: -/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000903; rev:378;)

# Adware: (Adware) EZula - regex: to_server:GET /smb/install\.php\?version=.*&afid=.*&user_id=.*&keyid=.* detector_id: 904
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) EZula"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/smb/install.php?version="; content:"&afid="; content:"&user_id="; content:"&keyid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/smb\/install\.php\?version=.*&afid=.*&user_id=.*&keyid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000904; rev:158;)

# FakeAV: GenericFakeAV_3 - regex: to_server:GET /f/1\.exe\?&affid=.* detector_id: 909
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/f/1.exe?&affid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/f\/1\.exe\?&affid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000909; rev:1004;)

# FakeAV: GenericFakeAV_3 - regex: to_server:GET /api/urls/?&affid=.* detector_id: 910
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/api/urls"; content:"&affid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/urls\/?&affid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000910; rev:177;)

# FakeAV: GenericFakeAV_3 - regex: to_server:GET /api/stats/install/?&affid=.*&ver=.*&group=.* detector_id: 911
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/api/stats/install"; content:"&affid="; content:"&ver="; content:"&group="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/stats\/install\/?&affid=.*&ver=.*&group=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000911; rev:177;)

# Command&Control: (Banker) GenericBanker_2 - regex: to_server:POST /php/.*/insertsql\.php\?.*&parametros=.* detector_id: 912
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_2"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/php/"; content:"/insertsql.php?"; content:"&parametros="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/php\/.*\/insertsql\.php\?.*&parametros=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000912; rev:1004;)

# Command&Control: (Trojan) Ertfor - regex: to_server:GET /rz/mn\.php\?ver=.*&vc=.*User-Agent: Mozilla/4\.0 \(SPGK\) detector_id: 913
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ertfor"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/rz/mn.php?ver="; content:"&vc="; content:"User-Agent|3A| Mozilla/4.0 |28|SPGK|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/rz\/mn\.php\?ver=.*&vc=.*User-Agent: Mozilla\/4\.0 \(SPGK\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000913; rev:1004;)

# Command&Control: (Trojan) QQPass - regex: to_server:GET /iceboy\.htm\?id=\d* detector_id: 914
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) QQPass"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/iceboy.htm?id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/iceboy\.htm\?id=\d*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000914; rev:1004;)

# Command&Control: (Trojan) Metsiseyt - regex: to_server:GET /j\.jsp\?.*User-Agent: Mozilla/5\.0 \(compatible; \+Baiduspider/2\.0;\+\+ detector_id: 920
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Metsiseyt"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/j.jsp?"; content:"User-Agent|3A| Mozilla/5.0 |28|compatible|3B| |2B|Baiduspider/2.0|3B||2B||2B|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/j\.jsp\?.*User-Agent: Mozilla\/5\.0 \(compatible\; \+Baiduspider\/2\.0\;\+\+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000920; rev:1004;)

# Command&Control: (Dropper) Mudrop - regex: to_server:GET /lt/load\.php\?file=.* detector_id: 921
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Mudrop"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/lt/load.php?file="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/lt\/load\.php\?file=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000921; rev:158;)

# Command&Control: (Trojan) Luckycat Wimmie - regex: to_server:POST .*/count\.php\?m=c&n=.*_.*_.*@ detector_id: 922
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Luckycat Wimmie"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/count.php?m=c&n="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/count\.php\?m=c&n=.*_.*_.*@/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000922; rev:1004;)

# Command&Control: (Dropper) Mudrop - regex: to_server:GET /\d*/setup\.php\?act=.*&id=.*&log=.* detector_id: 923
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Mudrop"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/setup.php?act="; content:"&id="; content:"&log="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d*\/setup\.php\?act=.*&id=.*&log=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000923; rev:158;)

# Command&Control: (Banker) Cossta - regex: to_server:POST .*infects\.php.*Qualidade=Produto&Produto=.*&nomepc=.* detector_id: 924
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Cossta"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"infects.php"; content:"Qualidade=Produto&Produto="; content:"&nomepc="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*infects\.php.*Qualidade=Produto&Produto=.*&nomepc=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000924; rev:1004;)

# Command&Control: (Trojan) Cutwail Pushdo - regex: to_server:GET /40E800[0-9A-F]{40,} detector_id: 925
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Cutwail Pushdo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/40E800"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/40E800[0-9A-F]{40,}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000925; rev:427;)

# Adware: (Toolbar) BetterInternet - regex: to_server:POST /bi/servlet/Thinstall(Pre|Post) detector_id: 930
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) BetterInternet"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/bi/servlet/Thinstall"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bi\/servlet\/Thinstall(Pre|Post)/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000930; rev:314;)

# FakeAV: VirusDoctor - regex: to_server:GET /index\.php\?[0-9a-f]{6}=.*User-Agent: Mozilla/3\.0 detector_id: 944
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: VirusDoctor"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?"; content:"User-Agent|3A| Mozilla/3.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\?[0-9a-f]{6}=.*User-Agent: Mozilla\/3\.0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000944; rev:1004;)

# Command&Control: (Trojan) Danginex - regex: to_server:GET /h40/u_qftianyan\.html detector_id: 945
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Danginex"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/h40/u_qftianyan.html"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/h40\/u_qftianyan\.html/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000945; rev:1004;)

# FakeAV: GenericFakeAV_2 - regex: to_server:GET /newm002\.exe detector_id: 947
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/newm002.exe"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/newm002\.exe/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000947; rev:1004;)

# Adware: (Game) FenomenGame - regex: to_server:GET /e=80/b=.*/t=.*/h=.*\.exe detector_id: 948
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Game) FenomenGame"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/e=80/b="; content:"/t="; content:"/h="; content:".exe"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/e=80\/b=.*\/t=.*\/h=.*\.exe/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000948; rev:159;)

# Command&Control: (Dropper) Koliks Krament, Lamer - regex: to_server:GET /kills\.txt\?p=.* detector_id: 951
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Koliks Krament, Lamer"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/kills.txt?p="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/kills\.txt\?p=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000951; rev:1004;)

# Command&Control: (Ransomware) Winlocker - regex: to_server:GET /gate\.php\?hwid=.*&pc=.*&localip=.*&winver=.* detector_id: 952
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) Winlocker"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/gate.php?hwid="; content:"&pc="; content:"&localip="; content:"&winver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/gate\.php\?hwid=.*&pc=.*&localip=.*&winver=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000952; rev:1004;)

# Command&Control: (Trojan) Virut - regex: to_server:GET /g1\.php\?u=.*&v=\d*&m=.* detector_id: 953
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Virut"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/g1.php?u="; content:"&v="; content:"&m="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/g1\.php\?u=.*&v=\d*&m=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000953; rev:1004;)

# Command&Control: (Trojan) Virut - regex: to_server:GET /sn\.php\?c=[0-9A-F]*&t=\d\.\d* detector_id: 955
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Virut"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/sn.php?c="; content:"&t="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/sn\.php\?c=[0-9A-F]*&t=\d\.\d*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000955; rev:1004;)

# Command&Control: (Trojan) Virut - regex: to_server:GET /list\.php\?c=[0-9A-F]*&v=\d*&t=\d,\d{5,8} detector_id: 956
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Virut"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/list.php?c="; content:"&v="; content:"&t="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/list\.php\?c=[0-9A-F]*&v=\d*&t=\d,\d{5,8}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000956; rev:1002;)

# Command&Control: (Trojan) Virut - regex: to_server:GET /r\.php\?a=.*&n=.* detector_id: 959
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Virut"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/r.php?a="; content:"&n="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/r\.php\?a=.*&n=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000959; rev:709;)

# Command&Control: (Dropper) Plosa Karagany - regex: to_server:GET /images\.php\?t=.*User-Agent: User-Agent: Opera/10\.60 Presto/2\.2\.30 detector_id: 963
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Plosa Karagany"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/images.php?t="; content:"User-Agent|3A| User-Agent|3A| Opera/10.60 Presto/2.2.30"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/images\.php\?t=.*User-Agent: User-Agent: Opera\/10\.60 Presto\/2\.2\.30/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000963; rev:1010;)

# Command&Control: (Trojan) Ramagedos - regex: to_server:POST .*HTTP/1\.1.*User-Agent: ArmageddoN.*GetList=.* detector_id: 966
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ramagedos"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"HTTP/1.1"; content:"User-Agent|3A| ArmageddoN"; content:"GetList="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*HTTP\/1\.1.*User-Agent: ArmageddoN.*GetList=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000966; rev:1004;)

# Command&Control: (Trojan) Virut - regex: to_server:GET /default\.php\?qry=[0-9a-f]{10,}&tgt=.*&searchKey=.*&skp=.* detector_id: 967
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Virut"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/default.php?qry="; content:"&tgt="; content:"&searchKey="; content:"&skp="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/default\.php\?qry=[0-9a-f]{10,}&tgt=.*&searchKey=.*&skp=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000967; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_11 Isux - regex: to_server:GET /m2/isup\.php\?email=.*&lici=.*&ver= detector_id: 969
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_11 Isux"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/m2/isup.php?email="; content:"&lici="; content:"&ver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/m2\/isup\.php\?email=.*&lici=.*&ver=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000969; rev:1004;)

# Click-Fraud: TDLClickServer - regex: to_server:GET .*Y2xrPT.*aWQ9.*JmFpZD.*aWQ9.*ZD0w.* detector_id: 973
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Click-Fraud: TDLClickServer"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"Y2xrPT"; content:"aWQ9"; content:"JmFpZD"; content:"aWQ9"; content:"ZD0w"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*Y2xrPT.*aWQ9.*JmFpZD.*aWQ9.*ZD0w.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000973; rev:388;)

# Command&Control: (Dropper) Kolilks Krament, Lamer - regex: to_server:GET /kills\.txt\?t\d=\d* detector_id: 974
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Kolilks Krament, Lamer"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/kills.txt?t"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/kills\.txt\?t\d=\d*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000974; rev:1004;)

# Adware: (Toolbar) UBar - regex: to_server:POST .*abc\.php.*ABC=XRE&XRE=.*& detector_id: 975
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) UBar"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"abc.php"; content:"ABC=XRE&XRE="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*abc\.php.*ABC=XRE&XRE=.*&/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000975; rev:1004;)

# FakeAV: KoreanFakeAV - regex: to_server:GET /settle\.php\?strID=.*&strPC=.*&strSite=.* detector_id: 976
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: KoreanFakeAV"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/settle.php?strID="; content:"&strPC="; content:"&strSite="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/settle\.php\?strID=.*&strPC=.*&strSite=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000976; rev:1004;)

# Command&Control: (Trojan) Coco - regex: to_server:GET favicon\.ico.*UA-CPU: x86.*Cookie: [0-9A-F]{12}pc detector_id: 978
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Coco"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"favicon.ico"; content:"UA-CPU|3A| x86"; content:"Cookie|3A| "; content:"pc"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?favicon\.ico.*UA-CPU: x86.*Cookie: [0-9A-F]{12}pc/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000978; rev:1004;)

# Command&Control: (Trojan) ZeroAccess Sirefef - regex: to_server:GET /view\?a=.*(?!User-Agent) detector_id: 980
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZeroAccess Sirefef"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/view?a="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/view\?a=.*(?!User-Agent)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000980; rev:158;)

# Command&Control: (Trojan) Virut - regex: to_server:GET /p\d+\.asp\?MAC=.*&Publicer=.* detector_id: 981
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Virut"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/p"; content:".asp?MAC="; content:"&Publicer="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/p\d+\.asp\?MAC=.*&Publicer=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000981; rev:1004;)

# Command&Control: (ClickBot) GenericClickBot_1 - regex: to_server:GET /p6\.asp\?MAC=.*&Publicer=.* detector_id: 982
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (ClickBot) GenericClickBot_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/p6.asp?MAC="; content:"&Publicer="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/p6\.asp\?MAC=.*&Publicer=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000982; rev:1004;)

# Adware: (Downware) AdMonetizer InstallMonetizer - regex: to_server:POST /(first|second)_call_v\d+\.php.*pubid=.*&CbId=.* detector_id: 983
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) AdMonetizer InstallMonetizer"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"_call_v"; content:".php"; content:"pubid="; content:"&CbId="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(first|second)_call_v\d+\.php.*pubid=.*&CbId=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000983; rev:1004;)

# Command&Control: (Dropper) Dapato_USPS - regex: to_server:GET .*index\.php\?r=gate&id=.*&group=.*&debug=.* detector_id: 998
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Dapato_USPS"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"index.php?r=gate&id="; content:"&group="; content:"&debug="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*index\.php\?r=gate&id=.*&group=.*&debug=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000998; rev:1004;)

# Command&Control: (Dropper) Dapato_1 - regex: to_server:POST /mx5/[A-Z]/in/ detector_id: 999
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Dapato_1"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/mx5/"; content:"/in/"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mx5\/[A-Z]\/in\//"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000999; rev:158;)

# Command&Control: (Trojan) Dusvext - regex: to_server:GET .*adduser\.php\?uid=.*&lan=.*&cmpname=.*&country=.*&cc=.*&idle=.*&ver=v.* detector_id: 1000
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Dusvext"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"adduser.php?uid="; content:"&lan="; content:"&cmpname="; content:"&country="; content:"&cc="; content:"&idle="; content:"&ver=v"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*adduser\.php\?uid=.*&lan=.*&cmpname=.*&country=.*&cc=.*&idle=.*&ver=v.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001000; rev:1004;)

# Command&Control: (Dropper) Umbald - regex: to_server:POST .*/Panel/bot\.php.*mode=\d+&UID=[0-9A-F]{28} detector_id: 1001
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Umbald"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/Panel/bot.php"; content:"mode="; content:"&UID="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/Panel\/bot\.php.*mode=\d+&UID=[0-9A-F]{28}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001001; rev:473;)

# Adware: PurityScan - regex: to_server:POST .*/dispatcher\.php.*User-Agent: CS Fingerprint Module detector_id: 1002
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: PurityScan"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/dispatcher.php"; content:"User-Agent|3A| CS Fingerprint Module"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/dispatcher\.php.*User-Agent: CS Fingerprint Module/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001002; rev:623;)

# Command&Control: (Trojan) Pirminay Ponmocup - regex: to_server:GET /images2/[0-9A-F]{40,} detector_id: 1003
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Pirminay Ponmocup"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/images2/"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/images2\/[0-9A-F]{40,}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001003; rev:158;)

# Command&Control: (Trojan) BlackEnergy Jorik.BlackEnergy - regex: to_server:POST .*getcfg\.php.*[a-z]{3,5}=[0-9a-zA-Z+/=]{20,} detector_id: 1005
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) BlackEnergy Jorik.BlackEnergy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"getcfg.php"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*getcfg\.php.*[a-z]{3,5}=[0-9a-zA-Z+\/=]{20,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001005; rev:1002;)

# Command&Control: (Trojan) Grum Jorik.BlackEnergy - regex: to_server:GET /spm/s_alive\.php\?id=.*&tick=.*&ver=.*&smtp=.* detector_id: 1006
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Grum Jorik.BlackEnergy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/spm/s_alive.php?id="; content:"&tick="; content:"&ver="; content:"&smtp="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/spm\/s_alive\.php\?id=.*&tick=.*&ver=.*&smtp=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001006; rev:1004;)

# Command&Control: (Trojan) Coco - regex: to_server:GET favicon\.ico.*UA-CPU: x86.*Cookie:.*ComputerName detector_id: 1007
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Coco"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"favicon.ico"; content:"UA-CPU|3A| x86"; content:"Cookie|3A|"; content:"ComputerName"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?favicon\.ico.*UA-CPU: x86.*Cookie:.*ComputerName/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001007; rev:1004;)

# Command&Control: (Banker) Banz - regex: to_server:POST .*thumbs\.php.*from=.*INFECT.*&FromMail=.*&destino=.*&assunto=.*&mensagem= detector_id: 1008
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Banz"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"thumbs.php"; content:"from="; content:"INFECT"; content:"&FromMail="; content:"&destino="; content:"&assunto="; content:"&mensagem="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*thumbs\.php.*from=.*INFECT.*&FromMail=.*&destino=.*&assunto=.*&mensagem=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001008; rev:1004;)

# FakeAV: KoreanFakeAV - regex: to_server:GET /value\.php\?strMode=run&strID=.*&strPC=.* detector_id: 1009
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: KoreanFakeAV"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/value.php?strMode=run&strID="; content:"&strPC="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/value\.php\?strMode=run&strID=.*&strPC=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001009; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_11 Isux - regex: to_server:GET /m2/dep\.php\?noxor&file=.*&email=.*&lici=.*&ver=.*&sox=.*&rsid= detector_id: 1010
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_11 Isux"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/m2/dep.php?noxor&file="; content:"&email="; content:"&lici="; content:"&ver="; content:"&sox="; content:"&rsid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/m2\/dep\.php\?noxor&file=.*&email=.*&lici=.*&ver=.*&sox=.*&rsid=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001010; rev:1004;)

# FakeAV: GenericFakeAV_2 - regex: to_server:GET /[a-z]{4,5}\d{3}\.exe.*Host: [a-z]{7,8}\.[re]u detector_id: 1011
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".exe"; content:"Host|3A| "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{4,5}\d{3}\.exe.*Host: [a-z]{7,8}\.[re]u/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001011; rev:177;)

# Command&Control: (Dropper) Dapato_1 Cridex - regex: to_server:POST /rwx/B1_3n9/in/ detector_id: 1012
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Dapato_1 Cridex"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/rwx/B1_3n9/in/"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/rwx\/B1_3n9\/in\//"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001012; rev:158;)

# Drive-by: (ExploitKit) NuclearPack - regex: to_server:GET /server_privileges\.php\?[a-f0-9]{32}=\d detector_id: 1013
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: (ExploitKit) NuclearPack"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/server_privileges.php?"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/server_privileges\.php\?[a-f0-9]{32}=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001013; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_2 - regex: to_server:GET /getmac\.jsp\?x=.{17}&y=.*User-Agent: Ms detector_id: 1014
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/getmac.jsp?x="; content:"&y="; content:"User-Agent|3A| Ms"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/getmac\.jsp\?x=.{17}&y=.*User-Agent: Ms/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001014; rev:1004;)

# Command&Control: (Dropper) Geral - regex: to_server:POST /Count\.asp\?mac=.*&ver=.*&os=.*&dtime=.* detector_id: 1015
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Geral"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/Count.asp?mac="; content:"&ver="; content:"&os="; content:"&dtime="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Count\.asp\?mac=.*&ver=.*&os=.*&dtime=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001015; rev:1004;)

# Command&Control: (Dropper) Geral - regex: to_server:POST /Count\.asp.*user=.*&m=[0-9A-F]*&f=.*&pc=.*&l=.* detector_id: 1016
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Geral"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/Count.asp"; content:"user="; content:"&m="; content:"&f="; content:"&pc="; content:"&l="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Count\.asp.*user=.*&m=[0-9A-F]*&f=.*&pc=.*&l=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001016; rev:1004;)

# FakeAV: GenericFakeAV_4 - regex: to_server:GET /n\.php?h=1&s=mm detector_id: 1017
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_4"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/n.ph"; content:"h=1&s=mm"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/n\.php?h=1&s=mm/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001017; rev:1004;)

# Command&Control: (Trojan) Gamarue_2 - regex: to_server:GET /w\.php\?e=.*&f=.* detector_id: 1018
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Gamarue_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/w.php?e="; content:"&f="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/w\.php\?e=.*&f=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001018; rev:195;)

# Command&Control: (Trojan) Smokeloader_1 - regex: to_server:GET .*index\.php\?cmd=(getload|gettask|getsocks)&login=.* detector_id: 1019
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Smokeloader_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"index.php?cmd="; content:"&login="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*index\.php\?cmd=(getload|gettask|getsocks)&login=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001019; rev:1004;)

# Command&Control: (Trojan) Smokeloader_2 - regex: to_server:POST .*index\.php.*smk=AmFvZj9lZ3ZycG16ew== detector_id: 1020
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Smokeloader_2"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"index.php"; content:"smk=AmFvZj9lZ3ZycG16ew=="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*index\.php.*smk=AmFvZj9lZ3ZycG16ew==/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001020; rev:1004;)

# Command&Control: (Trojan) Smokeloader_2 - regex: to_server:POST .*index\.php.*smk=[A-Za-z0-9/=]{20,} detector_id: 1021
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Smokeloader_2"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"index.php"; content:"smk="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*index\.php.*smk=[A-Za-z0-9\/=]{20,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001021; rev:1004;)

# Command&Control: (Trojan) SpyEye_2 - regex: to_server:GET .*gate\.php\?guid=.*&ver=.*&ie=.*&os=.*&ut=.*&ccrc=.*&md5=.* detector_id: 1022
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) SpyEye_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"gate.php?guid="; content:"&ver="; content:"&ie="; content:"&os="; content:"&ut="; content:"&ccrc="; content:"&md5="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*gate\.php\?guid=.*&ver=.*&ie=.*&os=.*&ut=.*&ccrc=.*&md5=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001022; rev:1004;)

# Command&Control: (Trojan) SpyEye_2 - regex: to_server:GET .*gate\.php\?guid=.*&ver=.*&stat=.*&ccrc=.*&md5=.* detector_id: 1023
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) SpyEye_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"gate.php?guid="; content:"&ver="; content:"&stat="; content:"&ccrc="; content:"&md5="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*gate\.php\?guid=.*&ver=.*&stat=.*&ccrc=.*&md5=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001023; rev:1004;)

# Command&Control: (Trojan) SpyEye_2 - regex: to_server:GET .*gate\.php\?guid=.*&ver=.*&stat=.*&plg=.*&ccrc=.*&md5=.* detector_id: 1024
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) SpyEye_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"gate.php?guid="; content:"&ver="; content:"&stat="; content:"&plg="; content:"&ccrc="; content:"&md5="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*gate\.php\?guid=.*&ver=.*&stat=.*&plg=.*&ccrc=.*&md5=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001024; rev:1004;)

# Command&Control: (Dropper) Dapato_1 Cridex - regex: to_server:POST /za/v_01_[a-z]/in/ detector_id: 1025
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Dapato_1 Cridex"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/za/v_01_"; content:"/in/"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/za\/v_01_[a-z]\/in\//"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001025; rev:160;)

# FakeAV: WinWebSec - regex: to_server:GET /api/urls/\?ts=.*&affid=.* detector_id: 1026
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: WinWebSec"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/api/urls/?ts="; content:"&affid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/urls\/\?ts=.*&affid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001026; rev:293;)

# Command&Control: (Trojan) GenericTrojan_5 - regex: to_server:POST /wmr\.php\?botstatus=(Sent|LoggedIn|AccountBlank|NoLoginFormFound)&report=\d detector_id: 1027
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_5"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/wmr.php?botstatus="; content:"&report="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/wmr\.php\?botstatus=(Sent|LoggedIn|AccountBlank|NoLoginFormFound)&report=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001027; rev:1004;)

# Command&Control: Virut - regex: to_server:POST /forum/[a-f0-9]{32}\.php HTTP.*Data=[a-f0-9]{32,} detector_id: 1028
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: Virut"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/forum/"; content:".php HTTP"; content:"Data="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/forum\/[a-f0-9]{32}\.php HTTP.*Data=[a-f0-9]{32,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001028; rev:625;)

# Command&Control: (Dropper) GenericDropper_73 - regex: to_server:GET /[a-z0-9]{8}\.txt.*User-Agent: Download detector_id: 1029
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_73"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".txt"; content:"User-Agent|3A| Download"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z0-9]{8}\.txt.*User-Agent: Download/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001029; rev:378;)

# Command&Control: (Trojan) Buterat SpyVoltar - regex: to_server:GET /add_img\.php\?div=.*&code=.*&param=.*&id=.*&os=.*(?!User-Agent) detector_id: 1030
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Buterat SpyVoltar"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/add_img.php?div="; content:"&code="; content:"&param="; content:"&id="; content:"&os="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/add_img\.php\?div=.*&code=.*&param=.*&id=.*&os=.*(?!User-Agent)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001030; rev:1004;)

# Command&Control: (Trojan) Buterat SpyVoltar  - regex: to_server:GET /show_item\.php\?id=.*&div=.*&os=.*(?!User-Agent) detector_id: 1031
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Buterat SpyVoltar "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/show_item.php?id="; content:"&div="; content:"&os="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/show_item\.php\?id=.*&div=.*&os=.*(?!User-Agent)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001031; rev:1004;)

# Command&Control: (Trojan) Sinowal - regex: to_server:POST /search\d{0,1}\?fr=altavista&itag=.*&q=.*&kgs=.*&kls=.* detector_id: 1032
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sinowal"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/search"; content:"?fr=altavista&itag="; content:"&q="; content:"&kgs="; content:"&kls="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/search\d{0,1}\?fr=altavista&itag=.*&q=.*&kgs=.*&kls=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001032; rev:505;)

# Command&Control: (Trojan) GenericTrojan_6 - regex: to_server:GET /asp/xg\.asp.*User-Agent: BF detector_id: 1033
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_6"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/asp/xg.asp"; content:"User-Agent|3A| BF"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/asp\/xg\.asp.*User-Agent: BF/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001033; rev:1004;)

# Command&Control: (Dropper) GenericDropper_6 - regex: to_server:GET /new/bf02/default\.html\?from=[a-z]{2,3}\d{4} detector_id: 1034
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_6"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/new/bf02/default.html?from="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/new\/bf02\/default\.html\?from=[a-z]{2,3}\d{4}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001034; rev:1004;)

# Command&Control: (Banker) GenericBanker_6 - regex: to_server:POST .*abc\.php.*BLR=ATT&ATT=pc.*& detector_id: 1035
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_6"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"abc.php"; content:"BLR=ATT&ATT=pc"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*abc\.php.*BLR=ATT&ATT=pc.*&/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001035; rev:1004;)

# Command&Control: (Trojan) XPaj - regex: to_server:POST /[A-Za-z0-9]{4,10}\?[A-Za-z]{5,}=[A-Za-z]{5,}(&[A-Za-z]{5,}=[A-Za-z]{5,})*.*Accept-Encoding: deflate.*Content-Type: application/x-www-form-urlencoded.*Pragma: no-cache.*Connection: close.*filename=.*&data=.* detector_id: 1036
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) XPaj"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"Accept-Encoding|3A| deflate"; content:"Content-Type|3A| application/x-www-form-urlencoded"; content:"Pragma|3A| no-cache"; content:"Connection|3A| close"; content:"filename="; content:"&data="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[A-Za-z0-9]{4,10}\?[A-Za-z]{5,}=[A-Za-z]{5,}(&[A-Za-z]{5,}=[A-Za-z]{5,})*.*Accept-Encoding: deflate.*Content-Type: application\/x-www-form-urlencoded.*Pragma: no-cache.*Connection: close.*filename=.*&data=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001036; rev:463;)

# Command&Control: (Ransomware) LockScreen - regex: to_server:GET /loc/gate\.php\?getip=getip detector_id: 1037
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) LockScreen"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/loc/gate.php?getip=getip"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/loc\/gate\.php\?getip=getip/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001037; rev:1004;)

# Command&Control: (Dropper) Riprox - regex: to_server:POST .*error404\.php.*userandpc=.*@.*&admin=(True|False)&os=.*  detector_id: 1038
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Riprox"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"error404.php"; content:"userandpc="; content:"&admin="; content:"&os="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*error404\.php.*userandpc=.*@.*&admin=(True|False)&os=.* /s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001038; rev:1004;)

# Command&Control: (Trojan) Grum - regex: to_server:GET /spm/s_task\.php\?id=.*&tid=.* detector_id: 1040
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Grum"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/spm/s_task.php?id="; content:"&tid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/spm\/s_task\.php\?id=.*&tid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001040; rev:1004;)

# Command&Control: (Trojan) Grum - regex: to_server:GET /spm/s_report\.php\?task=.*&errors.*&errors.* detector_id: 1041
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Grum"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/spm/s_report.php?task="; content:"&errors"; content:"&errors"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/spm\/s_report\.php\?task=.*&errors.*&errors.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001041; rev:1004;)

# Command&Control: (Trojan) Grum - regex: to_server:GET /spm/page\.php\?id=.*&tick=.*&ver=.*&smtp=.*&task=.* detector_id: 1042
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Grum"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/spm/page.php?id="; content:"&tick="; content:"&ver="; content:"&smtp="; content:"&task="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/spm\/page\.php\?id=.*&tick=.*&ver=.*&smtp=.*&task=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001042; rev:1004;)

# Command&Control: (Trojan) Grum - regex: to_server:GET .*\.php\?ver=.*&id=.*&tick=.*&smtp=.*&task=.* detector_id: 1043
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Grum"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?ver="; content:"&id="; content:"&tick="; content:"&smtp="; content:"&task="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php\?ver=.*&id=.*&tick=.*&smtp=.*&task=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001043; rev:1004;)

# Command&Control: (Trojan) Grum - regex: to_server:GET .*\.php\?id=.*&tick=.*&ver=.*&smtp=.*&task=.*&errors.*&errors.* detector_id: 1044
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Grum"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?id="; content:"&tick="; content:"&ver="; content:"&smtp="; content:"&task="; content:"&errors"; content:"&errors"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php\?id=.*&tick=.*&ver=.*&smtp=.*&task=.*&errors.*&errors.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001044; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_11  - regex: to_server:GET /(m2|s3|so31)/exe\.php\?v=.*&sox=.*&lport=.*&rsid=.*&slots=.*&spm= detector_id: 1045
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_11 "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/exe.php?v="; content:"&sox="; content:"&lport="; content:"&rsid="; content:"&slots="; content:"&spm="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(m2|s3|so31)\/exe\.php\?v=.*&sox=.*&lport=.*&rsid=.*&slots=.*&spm=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001045; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_11  - regex: to_server:GET /(m2|s3|so31)/cfg\.php\?v=.*&sox=.*&lport=.*&rsid=.*&slots=.*&spm= detector_id: 1046
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_11 "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cfg.php?v="; content:"&sox="; content:"&lport="; content:"&rsid="; content:"&slots="; content:"&spm="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(m2|s3|so31)\/cfg\.php\?v=.*&sox=.*&lport=.*&rsid=.*&slots=.*&spm=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001046; rev:1004;)

# Command&Control: (Dropper) GenericDropper_10 - regex: to_server:GET /web/get_ad4\.asp\?type=loadall&machinename=.* detector_id: 1048
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_10"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/web/get_ad4.asp?type=loadall&machinename="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/web\/get_ad4\.asp\?type=loadall&machinename=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001048; rev:1004;)

# Command&Control: (Dropper) GenericDropper_10 - regex: to_server:GET /web/click_log2\.asp\?ad_url=.*&sn=.* detector_id: 1049
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_10"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/web/click_log2.asp?ad_url="; content:"&sn="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/web\/click_log2\.asp\?ad_url=.*&sn=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001049; rev:1004;)

# Command&Control: (Dropper) GenericDropper_11 - regex: to_server:GET /bt\.php\?mod=.*&id=.*&up=.*&mid=.* detector_id: 1050
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_11"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bt.php?mod="; content:"&id="; content:"&up="; content:"&mid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bt\.php\?mod=.*&id=.*&up=.*&mid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001050; rev:1004;)

# FakeAV: KoreanFakeAV - regex: to_server:GET .*APP/ck_setup\.php\?m=.*&d=.*\.co\.kr&a=.*  detector_id: 1051
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: KoreanFakeAV"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"APP/ck_setup.php?m="; content:"&d="; content:".co.kr&a="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*APP\/ck_setup\.php\?m=.*&d=.*\.co\.kr&a=.* /"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001051; rev:1004;)

# Command&Control: (MDN) Yadro - regex: to_server:GET /hit;cash_flow\?t.*;r;s.*;uhttp.* detector_id: 1052
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (MDN) Yadro"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/hit|3B|cash_flow?t"; content:"|3B|r|3B|s"; content:"|3B|uhttp"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/hit\;cash_flow\?t.*\;r\;s.*\;uhttp.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001052; rev:163;)

# Command&Control: (Trojan) Bublik - regex: to_server:POST /was/ui*d*\.php.*[A-Za-z0-9\+/]{20,}={0,2} detector_id: 1053
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bublik"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/was/u"; content:".php"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/was\/ui*d*\.php.*[A-Za-z0-9\+\/]{20,}={0,2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001053; rev:1004;)

# Command&Control: (Dropper) JOER - regex: to_server:GET /CNCGSMSUM\.ASPX\?KU=.* detector_id: 1054
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) JOER"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/CNCGSMSUM.ASPX?KU="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/CNCGSMSUM\.ASPX\?KU=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001054; rev:1004;)

# Command&Control: (Dropper) JOER - regex: to_server:GET /encryption\.aspx\?ku=.*&kp=.*&login=.*&ver=.* detector_id: 1055
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) JOER"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/encryption.aspx?ku="; content:"&kp="; content:"&login="; content:"&ver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/encryption\.aspx\?ku=.*&kp=.*&login=.*&ver=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001055; rev:1004;)

# Adware: (Toolbar) ZenoSearch - regex: to_server:GET /instreport\d_\d\.asp\?uid=.* detector_id: 1057
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) ZenoSearch"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/instreport"; content:".asp?uid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/instreport\d_\d\.asp\?uid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001057; rev:1004;)

# Adware: (Toolbar) Zango - regex: to_server:POST .*\.aspx\?ax=.*&rnd=.*&ver=.*epostdata=[A-F0-9]{40,} detector_id: 1058
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Zango"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".aspx?ax="; content:"&rnd="; content:"&ver="; content:"epostdata="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.aspx\?ax=.*&rnd=.*&ver=.*epostdata=[A-F0-9]{40,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001058; rev:715;)

# Adware: (Toolbar) Zango - regex: to_server:POST .*\.aspx\?ver=.*&rnd=.*epostdata=[A-F0-9]{40,} detector_id: 1059
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Zango"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".aspx?ver="; content:"&rnd="; content:"epostdata="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.aspx\?ver=.*&rnd=.*epostdata=[A-F0-9]{40,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001059; rev:715;)

# Command&Control: (Dropper) GenericDropper_16 - regex: to_server:GET /(4|9)\.php\?safe=.*User-Agent: NSIS_Inetc detector_id: 1060
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_16"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?safe="; content:"User-Agent|3A| NSIS_Inetc"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(4|9)\.php\?safe=.*User-Agent: NSIS_Inetc/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001060; rev:1004;)

# Adware: (Game) EpicGames GameVance - regex: to_server:GET /index\.php\?page=api\.DownloadXmlApi&ticket=.* detector_id: 1061
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Game) EpicGames GameVance"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?page=api.DownloadXmlApi&ticket="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\?page=api\.DownloadXmlApi&ticket=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001061; rev:1004;)

# Adware: (Downware) InstSEO - regex: to_server:GET /insts/listener\.php\?idAsoc=.*&idOf=.*&state=startedInstall&xSoft=.*&xVal=.*&xFrom=.*&of=.*&xos=.*&xnmi=.*&xnot=.*&xdm=.*&xdo=.* detector_id: 1062
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) InstSEO"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/insts/listener.php?idAsoc="; content:"&idOf="; content:"&state=startedInstall&xSoft="; content:"&xVal="; content:"&xFrom="; content:"&of="; content:"&xos="; content:"&xnmi="; content:"&xnot="; content:"&xdm="; content:"&xdo="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/insts\/listener\.php\?idAsoc=.*&idOf=.*&state=startedInstall&xSoft=.*&xVal=.*&xFrom=.*&of=.*&xos=.*&xnmi=.*&xnot=.*&xdm=.*&xdo=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001062; rev:1004;)

# Adware: (Downware) KoreanDownware - regex: to_server:GET /check_counter\.php\?pid=.{4,15}&kind=\d&mid= detector_id: 1063
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) KoreanDownware"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/check_counter.php?pid="; content:"&kind="; content:"&mid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/check_counter\.php\?pid=.{4,15}&kind=\d&mid=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001063; rev:1002;)

# Command&Control: (Worm) Socks  - regex: to_server:GET /shl/\?&v=.*&s=.*&cip=.*&lid=.* detector_id: 1064
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Socks "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/shl/?&v="; content:"&s="; content:"&cip="; content:"&lid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/shl\/\?&v=.*&s=.*&cip=.*&lid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001064; rev:164;)

# Command&Control: (Dropper) GenericDropper_12  - regex: to_server:GET /getfile\.php\?r=.*&p=[A-Za-z0-9+/]*={0,2} detector_id: 1065
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_12 "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/getfile.php?r="; content:"&p="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/getfile\.php\?r=.*&p=[A-Za-z0-9+\/]*={0,2}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001065; rev:1004;)

# Command&Control: (Trojan) ZeuS - regex: to_server:GET /mumu/transert\.bin detector_id: 1066
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZeuS"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mumu/transert.bin"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mumu\/transert\.bin/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001066; rev:1004;)

# Command&Control: (Trojan) ZeuS - regex: to_server:POST /mumu/index\.php detector_id: 1067
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZeuS"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/mumu/index.php"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mumu\/index\.php/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001067; rev:1004;)

# Command&Control: (Dropper) Dapato_1 - regex: to_server:POST /rwx/[A-Z]\d_\d[a-z]\d/in/ detector_id: 1069
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Dapato_1"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/rwx/"; content:"/in/"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/rwx\/[A-Z]\d_\d[a-z]\d\/in\//"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001069; rev:164;)

# Command&Control: (Trojan) GenericTrojan_15  - regex: to_server:GET /server/npopup/.*pop\.php detector_id: 1070
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_15 "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/server/npopup/"; content:"pop.php"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/server\/npopup\/.*pop\.php/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001070; rev:1004;)

# Adware: (Toolbar) IstBar - regex: to_server:GET /ist/scripts/istdownload_config\.php\?cfg=.*&account_id=.* detector_id: 1071
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) IstBar"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ist/scripts/istdownload_config.php?cfg="; content:"&account_id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ist\/scripts\/istdownload_config\.php\?cfg=.*&account_id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001071; rev:1004;)

# FakeAV: Cleaner2009Pro - regex: to_server:GET /\?action=.*&a=keyin&l=keyin&f=keyin&cnt=keyin&lng=keyin&order_id=keyin&lp=keyin&addt=keyin&pc_id=.*&err=0&abbr=.* detector_id: 1072
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: Cleaner2009Pro"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?action="; content:"&a=keyin&l=keyin&f=keyin&cnt=keyin&lng=keyin&order_id=keyin&lp=keyin&addt=keyin&pc_id="; content:"&err=0&abbr="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?action=.*&a=keyin&l=keyin&f=keyin&cnt=keyin&lng=keyin&order_id=keyin&lp=keyin&addt=keyin&pc_id=.*&err=0&abbr=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001072; rev:165;)

# Command&Control: (Trojan) Bublik - regex: to_server:POST /rdc/ptr\.php.*[A-Za-z0-9\+/]{20,}={0,2}  detector_id: 1073
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bublik"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/rdc/ptr.php"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/rdc\/ptr\.php.*[A-Za-z0-9\+\/]{20,}={0,2} /s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001073; rev:1004;)

# Command&Control: (TrojanProxy) Kvadr Dosenjo - regex: to_server:POST /[ls]\.php\?ca[sc]ingDeny=.*GET /frame\.aspx\?u=.* detector_id: 1074
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (TrojanProxy) Kvadr Dosenjo"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php?ca"; content:"ingDeny="; content:"GET /frame.aspx?u="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[ls]\.php\?ca[sc]ingDeny=.*GET \/frame\.aspx\?u=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001074; rev:1004;)

# Command&Control: (Dropper) GenericDropper_19 - regex: to_server:GET /download\.php\?version=.*&user_id=.*&skey=.*User-Agent: PR3 detector_id: 1075
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_19"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/download.php?version="; content:"&user_id="; content:"&skey="; content:"User-Agent|3A| PR3"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/download\.php\?version=.*&user_id=.*&skey=.*User-Agent: PR3/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001075; rev:1004;)

# Command&Control: (Dropper) GenericDropper_21  - regex: to_server:GET /count\.asp\?mac=[A-F0-9]{12}&ver=.*&os=.*&tm=.*&id=.*&hd=.*&jc=.*&jcname=.* detector_id: 1076
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_21 "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/count.asp?mac="; content:"&ver="; content:"&os="; content:"&tm="; content:"&id="; content:"&hd="; content:"&jc="; content:"&jcname="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/count\.asp\?mac=[A-F0-9]{12}&ver=.*&os=.*&tm=.*&id=.*&hd=.*&jc=.*&jcname=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001076; rev:1004;)

# Command&Control: (Dropper) Chepvil - regex: to_server:GET /pusk3\.exe detector_id: 1077
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Chepvil"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/pusk3.exe"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/pusk3\.exe/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001077; rev:1004;)

# Command&Control: (Dropper) Renos - regex: to_server:POST /[a-z0-9]{6,}\.php\?(q|w|id|ini|view|)=v2[26]M.*data=[A-Za-z0-9\+/]{20,}={0,2} detector_id: 1078
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Renos"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php?"; content:"=v2"; content:"data="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z0-9]{6,}\.php\?(q|w|id|ini|view|)=v2[26]M.*data=[A-Za-z0-9\+\/]{20,}={0,2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001078; rev:711;)

# Command&Control: (Trojan) GenericTrojan_11 - regex: to_server:GET /forum/search\.php\?method=dep&noxor&file=.*&mode=.*&email=.*&lici=.*&ver=.*&sox=.*&rsid= detector_id: 1079
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_11"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/forum/search.php?method=dep&noxor&file="; content:"&mode="; content:"&email="; content:"&lici="; content:"&ver="; content:"&sox="; content:"&rsid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/forum\/search\.php\?method=dep&noxor&file=.*&mode=.*&email=.*&lici=.*&ver=.*&sox=.*&rsid=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001079; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_11 - regex: to_server:GET /forum/search\.php\?method=(validate|isup)&mode=.*&email=.*&lici= detector_id: 1080
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_11"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/forum/search.php?method="; content:"&mode="; content:"&email="; content:"&lici="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/forum\/search\.php\?method=(validate|isup)&mode=.*&email=.*&lici=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001080; rev:578;)

# FakeAV: GenericFakeAV_3 - regex: to_server:GET /f/notepad\.exe\?ts=.*&affid=.* detector_id: 1081
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/f/notepad.exe?ts="; content:"&affid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/f\/notepad\.exe\?ts=.*&affid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001081; rev:1004;)

# Adware: (Adware) GenericAdware_1 - regex: to_server:GET /update/(GO|EO)\d*/.*\.ini detector_id: 1082
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) GenericAdware_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/update/"; content:".ini"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/update\/(GO|EO)\d*\/.*\.ini/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001082; rev:177;)

# Adware: (Adware) GenericAdware_1 - regex: to_server:GET /update//.*\.ini detector_id: 1083
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) GenericAdware_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/update//"; content:".ini"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/update\/\/.*\.ini/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001083; rev:177;)

# Command&Control: (Dropper) Gambee - regex: to_server:GET /kzxfz\.asp\?bb=.* detector_id: 1084
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Gambee"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/kzxfz.asp?bb="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/kzxfz\.asp\?bb=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001084; rev:1004;)

# Command&Control: (Trojan) Klovbot - regex: to_server:GET .*/Zombies\.php\?1=.*&2=.*&3=.*&4=.*&5=.*&6=.* detector_id: 1086
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Klovbot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Zombies.php?1="; content:"&2="; content:"&3="; content:"&4="; content:"&5="; content:"&6="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/Zombies\.php\?1=.*&2=.*&3=.*&4=.*&5=.*&6=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001086; rev:1004;)

# Command&Control: (Dropper) Zlob - regex: to_server:GET /confirm\.php\?aid=.*&said=.*&mac=.*&hash=.*&mn=.* detector_id: 1087
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Zlob"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/confirm.php?aid="; content:"&said="; content:"&mac="; content:"&hash="; content:"&mn="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/confirm\.php\?aid=.*&said=.*&mac=.*&hash=.*&mn=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001087; rev:1004;)

# Command&Control: (Banker) Bloropac - regex: to_server:POST .*/add\.php.*to=.*&subject=.*&message=infectado detector_id: 1088
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Bloropac"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/add.php"; content:"to="; content:"&subject="; content:"&message=infectado"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/add\.php.*to=.*&subject=.*&message=infectado/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001088; rev:178;)

# Command&Control: (Banker) Bloropac - regex: to_server:POST .*\.php.*to=.*&subject=.*&message=infectado detector_id: 1089
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Bloropac"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php"; content:"to="; content:"&subject="; content:"&message=infectado"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php.*to=.*&subject=.*&message=infectado/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001089; rev:178;)

# Command&Control: (Trojan) Smokeloader - regex: to_server:POST .*index\.php.*cmd=grab&data=.*&login=.* detector_id: 1090
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Smokeloader"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"index.php"; content:"cmd=grab&data="; content:"&login="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*index\.php.*cmd=grab&data=.*&login=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001090; rev:1004;)

# Command&Control: (Trojan) Sality_1  - regex: to_server:GET /mrow\d*/\?id.*&rnd=.* detector_id: 1091
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sality_1 "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mrow"; content:"/?id"; content:"&rnd="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mrow\d*\/\?id.*&rnd=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001091; rev:178;)

# FakeAV: MalwareAlarm - regex: to_server:GET /madownload\.php\?&advid=.*&u=.*&p=.*&lang=.* detector_id: 1092
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: MalwareAlarm"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/madownload.php?&advid="; content:"&u="; content:"&p="; content:"&lang="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/madownload\.php\?&advid=.*&u=.*&p=.*&lang=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001092; rev:1004;)

# FakeAV: MalwareAlarm - regex: to_server:GET /firstrun\.php\?i=.*&advid=.* detector_id: 1093
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: MalwareAlarm"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/firstrun.php?i="; content:"&advid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/firstrun\.php\?i=.*&advid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001093; rev:1004;)

# Command&Control: (Dropper) GenericDropper_26  - regex: to_server:GET /DONT-TOUCH/.*\.exe detector_id: 1094
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_26 "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/DONT-TOUCH/"; content:".exe"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/DONT-TOUCH\/.*\.exe/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001094; rev:178;)

# Command&Control: (Dropper) Renos_2 - regex: to_server:POST /logos/.*/logo\.gif.*data=v2[26]M.*  detector_id: 1095
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Renos_2"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/logos/"; content:"/logo.gif"; content:"data=v2"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/logos\/.*\/logo\.gif.*data=v2[26]M.* /s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001095; rev:1004;)

# Command&Control: (Dropper) FlowSpirit - regex: to_server:POST /urlcore/.*f=.*&v=.*&c=.*&i=.* detector_id: 1097
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) FlowSpirit"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/urlcore/"; content:"f="; content:"&v="; content:"&c="; content:"&i="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/urlcore\/.*f=.*&v=.*&c=.*&i=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001097; rev:184;)

# Command&Control: (Backdoor) AntiLam - regex: to_server:POST /scripts/WWPMsg\.dll.*from=ALB.*&fromemail=.*&subject=(ALB|AntiLamer).*&body=.*&to=.*&Send= detector_id: 1098
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) AntiLam"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/scripts/WWPMsg.dll"; content:"from=ALB"; content:"&fromemail="; content:"&subject="; content:"&body="; content:"&to="; content:"&Send="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/scripts\/WWPMsg\.dll.*from=ALB.*&fromemail=.*&subject=(ALB|AntiLamer).*&body=.*&to=.*&Send=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001098; rev:721;)

# Adware: (Downware) KoreanDownware - regex: to_server:GET /counter/mac_proc\.php\?cid=.{4,15}&mid=.{17}&kind=\d&domain= detector_id: 1099
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) KoreanDownware"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/counter/mac_proc.php?cid="; content:"&mid="; content:"&kind="; content:"&domain="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/counter\/mac_proc\.php\?cid=.{4,15}&mid=.{17}&kind=\d&domain=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001099; rev:1002;)

# Adware: (Downware) InstSEO - regex: to_server:GET /insts/listener\.php\?idAsoc=.*&idOf=.*&state=startedInstall&xSoft=.*&xVal=.*&xFrom=.*&xOf=.*&xos=.*&xnmi=.*&xnot=.*&xdm=.*&xdo=.* detector_id: 1100
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) InstSEO"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/insts/listener.php?idAsoc="; content:"&idOf="; content:"&state=startedInstall&xSoft="; content:"&xVal="; content:"&xFrom="; content:"&xOf="; content:"&xos="; content:"&xnmi="; content:"&xnot="; content:"&xdm="; content:"&xdo="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/insts\/listener\.php\?idAsoc=.*&idOf=.*&state=startedInstall&xSoft=.*&xVal=.*&xFrom=.*&xOf=.*&xos=.*&xnmi=.*&xnot=.*&xdm=.*&xdo=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001100; rev:1004;)

# Command&Control: (Worm) Bobax - regex: to_server:GET /reg\?u=.*&v=.*&s=.*&su=.*&p=1&e=0&o=0&a=1&wr=.* detector_id: 1101
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Bobax"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/reg?u="; content:"&v="; content:"&s="; content:"&su="; content:"&p=1&e=0&o=0&a=1&wr="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/reg\?u=.*&v=.*&s=.*&su=.*&p=1&e=0&o=0&a=1&wr=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001101; rev:246;)

# Command&Control: (Banker) GenericBanker_5 - regex: to_server:POST /(frutas|traps)/.*/index\.php.*arq=.*&condicao=.* detector_id: 1102
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_5"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/index.php"; content:"arq="; content:"&condicao="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(frutas|traps)\/.*\/index\.php.*arq=.*&condicao=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001102; rev:1004;)

# Adware: (Downware) InstSEO - regex: to_server:GET /insts/instapi\.php\?action=newenduser detector_id: 1103
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) InstSEO"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/insts/instapi.php?action=newenduser"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/insts\/instapi\.php\?action=newenduser/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001103; rev:1004;)

# Adware: (Downware) InstSEO - regex: to_server:GET /insts/pcount\.php\?ypo=.* detector_id: 1104
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) InstSEO"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/insts/pcount.php?ypo="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/insts\/pcount\.php\?ypo=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001104; rev:1004;)

# Command&Control: (Backdoor) Omerta - regex: to_server:GET /omerta/Mail/Mail1\.3\.php\?CN=pc&SN=.*&PT=.*&PW=.*&OS=.*&IP=.*&Cam=No&TO=.*&CS=.* detector_id: 1105
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Omerta"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/omerta/Mail/Mail1.3.php?CN=pc&SN="; content:"&PT="; content:"&PW="; content:"&OS="; content:"&IP="; content:"&Cam=No&TO="; content:"&CS="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/omerta\/Mail\/Mail1\.3\.php\?CN=pc&SN=.*&PT=.*&PW=.*&OS=.*&IP=.*&Cam=No&TO=.*&CS=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001105; rev:1010;)

# Command&Control: (Banker) GenericBanker_3 - regex: to_server:POST /indexavsdb\.php.*op=IncluirAviso&macaddress=.*&pcname=.*&nomeusuario=.*&serialhd=.*&versaowindows=.*&versaoatual=.*&arquivosplugins=.*&contaremocao=.*&origem=.*&praquem=.*&titulo=.*&texto=.* detector_id: 1106
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_3"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/indexavsdb.php"; content:"op=IncluirAviso&macaddress="; content:"&pcname="; content:"&nomeusuario="; content:"&serialhd="; content:"&versaowindows="; content:"&versaoatual="; content:"&arquivosplugins="; content:"&contaremocao="; content:"&origem="; content:"&praquem="; content:"&titulo="; content:"&texto="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/indexavsdb\.php.*op=IncluirAviso&macaddress=.*&pcname=.*&nomeusuario=.*&serialhd=.*&versaowindows=.*&versaoatual=.*&arquivosplugins=.*&contaremocao=.*&origem=.*&praquem=.*&titulo=.*&texto=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001106; rev:1004;)

# Command&Control: (Trojan) GBot - regex: to_server:GET /.*/getcmd\.php\?id=.*&traff=0 detector_id: 1107
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GBot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/getcmd.php?id="; content:"&traff=0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\/getcmd\.php\?id=.*&traff=0/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001107; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_18 - regex: to_server:POST /[a-z0-9]{1,8}/.*m=[A-F0-9]{32}&o=.*&z=\d detector_id: 1108
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_18"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"m="; content:"&o="; content:"&z="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z0-9]{1,8}\/.*m=[A-F0-9]{32}&o=.*&z=\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001108; rev:378;)

# Command&Control: (Dropper) GenericDropper_27 - regex: to_server:GET /[a-z]{4,8}/alive\.php\?self=\d{16}&type=.* detector_id: 1109
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_27"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/alive.php?self="; content:"&type="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{4,8}\/alive\.php\?self=\d{16}&type=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001109; rev:1004;)

# Command&Control: (Dropper) Bofang  - regex: to_server:GET .*/\?v=.*&q=.*User-Agent: Microsoft BITS detector_id: 1110
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Bofang "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?v="; content:"&q="; content:"User-Agent|3A| Microsoft BITS"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/\?v=.*&q=.*User-Agent: Microsoft BITS/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001110; rev:393;)

# Command&Control: (Dropper) GenericDropper_29 - regex: to_server:GET /hash\?url=.*wmid=.*&hid=.*&b=.*&e=.* detector_id: 1111
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_29"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/hash?url="; content:"wmid="; content:"&hid="; content:"&b="; content:"&e="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/hash\?url=.*wmid=.*&hid=.*&b=.*&e=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001111; rev:184;)

# Command&Control: (Spambot) SdBot  - regex: to_server:GET .*/binfo\.php\?rnd=.*&s_id=.*&ver=.*&r=.* detector_id: 1112
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Spambot) SdBot "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/binfo.php?rnd="; content:"&s_id="; content:"&ver="; content:"&r="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/binfo\.php\?rnd=.*&s_id=.*&ver=.*&r=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001112; rev:1004;)

# Command&Control: (Dropper) Wadolin LdPinch  - regex: to_server:GET /.*/hide\.dll detector_id: 1113
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Wadolin LdPinch "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/hide.dll"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\/hide\.dll/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001113; rev:1004;)

# Command&Control: (ClickBot) GenericClickBot_2 - regex: to_server:GET /update\.php\?v=.*&id=[a-z0-9]*-[a-z0-9]*-[a-z0-9]*-[a-z0-9]*-[a-z0-9]* detector_id: 1114
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (ClickBot) GenericClickBot_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/update.php?v="; content:"&id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/update\.php\?v=.*&id=[a-z0-9]*-[a-z0-9]*-[a-z0-9]*-[a-z0-9]*-[a-z0-9]*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001114; rev:1004;)

# Command&Control: (Trojan) Hitpop - regex: to_server:GET .*mydown\.asp\?ver=.*&tgid=.*&address=.* detector_id: 1115
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Hitpop"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"mydown.asp?ver="; content:"&tgid="; content:"&address="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*mydown\.asp\?ver=.*&tgid=.*&address=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001115; rev:1004;)

# Command&Control: (Trojan) Cinmus  - regex: to_server:GET /puturl\.php\?q=Fam.*&m=.* detector_id: 1116
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Cinmus "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/puturl.php?q=Fam"; content:"&m="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/puturl\.php\?q=Fam.*&m=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001116; rev:1004;)

# Command&Control: (ClickBot) GenericClickBot_3 - regex: to_server:GET /klik\.php\?data=.* detector_id: 1117
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (ClickBot) GenericClickBot_3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/klik.php?data="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/klik\.php\?data=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001117; rev:1004;)

# Command&Control: (Dropper) Obvod - regex: to_server:GET /0xabad1dea\.php\?a=.*&b=.*&c=.* detector_id: 1118
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Obvod"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/0xabad1dea.php?a="; content:"&b="; content:"&c="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/0xabad1dea\.php\?a=.*&b=.*&c=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001118; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_23 - regex: to_server:GET .*up_\d*\.asp\?a=[a-f0-9]*&b=.*&c=.* detector_id: 1119
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_23"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"up_"; content:".asp?a="; content:"&b="; content:"&c="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*up_\d*\.asp\?a=[a-f0-9]*&b=.*&c=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001119; rev:1004;)

# Command&Control: (Dropper) GenericDropper_33 - regex: to_server:GET /\d+\?id=[a-b].*Host: .*update.*:8080 detector_id: 1120
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_33"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?id="; content:"Host|3A| "; content:"update"; content:"|3A|8080"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d+\?id=[a-b].*Host: .*update.*:8080/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001120; rev:195;)

# Command&Control: (Dropper) GenericDropper_33 - regex: to_server:GET /t\.php\?id=[a-b].*Host: update.*:8080 detector_id: 1121
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_33"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/t.php?id="; content:"Host|3A| update"; content:"|3A|8080"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/t\.php\?id=[a-b].*Host: update.*:8080/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001121; rev:1004;)

# Command&Control: (Trojan) Hrup - regex: to_server:GET /tj\.aspx\?u=YT.* detector_id: 1122
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Hrup"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/tj.aspx?u=YT"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/tj\.aspx\?u=YT.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001122; rev:1004;)

# FakeAV: KoreanFakeAV - regex: to_server:GET .*APP/download\.php\?m=.*&d=.*&a=.* detector_id: 1123
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: KoreanFakeAV"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"APP/download.php?m="; content:"&d="; content:"&a="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*APP\/download\.php\?m=.*&d=.*&a=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001123; rev:1004;)

# FakeAV: KoreanFakeAV - regex: to_server:GET .*APP/setup\.php\?m=.*&d=.*&a=.* detector_id: 1124
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: KoreanFakeAV"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"APP/setup.php?m="; content:"&d="; content:"&a="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*APP\/setup\.php\?m=.*&d=.*&a=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001124; rev:1004;)

# Command&Control: (Worm) Viking - regex: to_server:GET /\?host=.*2Ecn&refer=.* detector_id: 1125
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Viking"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?host="; content:"2Ecn&refer="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?host=.*2Ecn&refer=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001125; rev:185;)

# Command&Control: (Trojan) Sinowal - regex: to_server:POST /gamma/x25\.php\?id=.*&sv=.*&build=.*&ts=.*&ip=.*&sport=.*&hport=.*&os=.*&cn=.* detector_id: 1126
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sinowal"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/gamma/x25.php?id="; content:"&sv="; content:"&build="; content:"&ts="; content:"&ip="; content:"&sport="; content:"&hport="; content:"&os="; content:"&cn="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/gamma\/x25\.php\?id=.*&sv=.*&build=.*&ts=.*&ip=.*&sport=.*&hport=.*&os=.*&cn=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001126; rev:1004;)

# Command&Control: (Dropper) Renos_1 - regex: to_server:POST .*\.php\?q=v2[26]M.*data=ujnT32O.*  detector_id: 1127
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Renos_1"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php?q=v2"; content:"data=ujnT32O"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php\?q=v2[26]M.*data=ujnT32O.* /s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001127; rev:1004;)

# Command&Control: (Trojan) Phdet - regex: to_server:POST /company/contacts\.php.*oop=.* detector_id: 1128
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Phdet"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/company/contacts.php"; content:"oop="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/company\/contacts\.php.*oop=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001128; rev:1004;)

# Command&Control: (Trojan) Phdet - regex: to_server:POST /company/contacts\.php.*hnp=.* detector_id: 1129
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Phdet"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/company/contacts.php"; content:"hnp="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/company\/contacts\.php.*hnp=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001129; rev:1004;)

# Command&Control: (Trojan) Chiviper - regex: to_server:GET /666blood/post\.asp\?d10=.*&d11=.*&d21=.*&d22=.* detector_id: 1130
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Chiviper"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/666blood/post.asp?d10="; content:"&d11="; content:"&d21="; content:"&d22="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/666blood\/post\.asp\?d10=.*&d11=.*&d21=.*&d22=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001130; rev:1004;)

# FakeAV: FakeVimes - regex: to_server:GET /index\.php\?controller=hash detector_id: 1131
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeVimes"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?controller=hash"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\?controller=hash/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001131; rev:1004;)

# FakeAV: FakeVimes - regex: to_server:GET /index\.php\?controller=.*&abbr=.*&setupType=.*&pid=.* detector_id: 1132
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeVimes"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?controller="; content:"&abbr="; content:"&setupType="; content:"&pid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\?controller=.*&abbr=.*&setupType=.*&pid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001132; rev:1004;)

# Adware: Funpop Kraddare  - regex: to_server:GET .*\.php\?ptn=.*&madd=.*User-Agent: HiSantaSession detector_id: 1133
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: Funpop Kraddare "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?ptn="; content:"&madd="; content:"User-Agent|3A| HiSantaSession"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php\?ptn=.*&madd=.*User-Agent: HiSantaSession/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001133; rev:1004;)

# Command&Control: (Dropper) GenericDropper_34 - regex: to_server:GET /\d+/files/.*/\d+/blob\?user=anon-.*-&download= detector_id: 1134
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_34"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/files/"; content:"/blob?user=anon-"; content:"-&download="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d+\/files\/.*\/\d+\/blob\?user=anon-.*-&download=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001134; rev:378;)

# Command&Control: (Trojan) VaxVideo  - regex: to_server:GET /prlive\.php?g=[a-f0-9]*-[a-f0-9]*-[a-f0-9]*-[a-f0-9]*-[a-f0-9]* detector_id: 1135
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) VaxVideo "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/prlive.ph"; content:"g="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/prlive\.php?g=[a-f0-9]*-[a-f0-9]*-[a-f0-9]*-[a-f0-9]*-[a-f0-9]*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001135; rev:1004;)

# Command&Control: (Dropper) Geral - regex: to_server:GET /t/Count\.asp\?mac=.*&ver=.*&t=.* detector_id: 1136
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Geral"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/t/Count.asp?mac="; content:"&ver="; content:"&t="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/t\/Count\.asp\?mac=.*&ver=.*&t=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001136; rev:1004;)

# Command&Control: (Trojan) DotTorrent  - regex: to_server:GET /m5tools/ip\.php detector_id: 1137
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) DotTorrent "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/m5tools/ip.php"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/m5tools\/ip\.php/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001137; rev:1004;)

# Command&Control: (Trojan) DotTorrent - regex: to_server:GET /m5tools/whois\.php detector_id: 1138
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) DotTorrent"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/m5tools/whois.php"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/m5tools\/whois\.php/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001138; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_24  - regex: to_server:GET /update/update\.xml.*User-Agent: XieHongWei-HttpDown detector_id: 1139
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_24 "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/update/update.xml"; content:"User-Agent|3A| XieHongWei-HttpDown"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/update\/update\.xml.*User-Agent: XieHongWei-HttpDown/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001139; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_25 - regex: to_server:GET /PushFile/nPop.xml\?num=%20.\d{8} detector_id: 1140
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_25"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/PushFile/nPop"; content:"xml?num=|25|20"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/PushFile\/nPop.xml\?num=%20.\d{8}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001140; rev:378;)

# FakeAV: FakeScanti - regex: to_server:GET .*stget2\.cgi\?host=.*&id=.* detector_id: 1141
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeScanti"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"stget2.cgi?host="; content:"&id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*stget2\.cgi\?host=.*&id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001141; rev:1004;)

# Command&Control: (Trojan) Vilsel - regex: to_server:GET /images/.*\.jpg\?nocache=0,\d+ detector_id: 1143
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Vilsel"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/images/"; content:".jpg?nocache=0|2C|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/images\/.*\.jpg\?nocache=0,\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001143; rev:1004;)

# Command&Control: (Dialer) GenericDialer_1 - regex: to_server:GET /install\.php\?id=.*&mt=.*&mn=.*&nt=.*&r=.*&nc=.*,& detector_id: 1144
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dialer) GenericDialer_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/install.php?id="; content:"&mt="; content:"&mn="; content:"&nt="; content:"&r="; content:"&nc="; content:"|2C|&"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/install\.php\?id=.*&mt=.*&mn=.*&nt=.*&r=.*&nc=.*,&/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001144; rev:1004;)

# Command&Control: (Trojan) Bredavi Harnig  - regex: to_server:GET /services/files\.php\?uid=.*&site=.*&unique=.* detector_id: 1146
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bredavi Harnig "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/services/files.php?uid="; content:"&site="; content:"&unique="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/services\/files\.php\?uid=.*&site=.*&unique=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001146; rev:1004;)

# Command&Control: (Dropper) GenericDropper_40  - regex: to_server:GET /MNG/Download/?File=.*:|DATADIR|.*&Start=.*&Size=.*&FC=.* detector_id: 1147
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_40"; flow:established,to_server; content:"GET "; http_method; content:"/MNG/Download/?File="; http_uri; pcre:"/.*:\|DATADIR\|.*&Start=.*&Size=.*&FC=.*/URi"; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001147; rev:0;)

# Command&Control: (Dropper) Winsoft - regex: to_server:GET .*(setup|setup_b)\.asp\?prj=.*&pid=.*&mac=.* detector_id: 1148
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Winsoft"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".asp?prj="; content:"&pid="; content:"&mac="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*(setup|setup_b)\.asp\?prj=.*&pid=.*&mac=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001148; rev:733;)

# Adware: (Downware) GabPath  - regex: to_server:GET /\./data/.*/INSTALLS/.*\.cfg detector_id: 1149
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) GabPath "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/./data/"; content:"/INSTALLS/"; content:".cfg"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\.\/data\/.*\/INSTALLS\/.*\.cfg/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001149; rev:1004;)

# Command&Control: (Trojan) Jorik  - regex: to_server:GET /az\.php\?step=.*&o=.*&id=.* detector_id: 1150
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Jorik "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/az.php?step="; content:"&o="; content:"&id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/az\.php\?step=.*&o=.*&id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001150; rev:1004;)

# Adware: (Toolbar) Overtls - regex: to_server:GET .*ovn_o\.asp detector_id: 1151
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Overtls"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"ovn_o.asp"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*ovn_o\.asp/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001151; rev:1004;)

# Command&Control: (Backdoor) DarkHole - regex: to_server:GET /index\.php\?uid=.*&ver=(Zd|Ze)&mk=.* detector_id: 1152
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) DarkHole"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?uid="; content:"&ver="; content:"&mk="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\?uid=.*&ver=(Zd|Ze)&mk=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001152; rev:711;)

# Command&Control: (Dropper) CWS - regex: to_server:GET /cgi-script/repeatermcm\.fcgi\?n=.*&lastid=.*&Version=.*&smartpic=.*&rand=.* detector_id: 1153
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) CWS"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cgi-script/repeatermcm.fcgi?n="; content:"&lastid="; content:"&Version="; content:"&smartpic="; content:"&rand="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cgi-script\/repeatermcm\.fcgi\?n=.*&lastid=.*&Version=.*&smartpic=.*&rand=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001153; rev:1004;)

# Command&Control: (Dropper) Zlob  - regex: to_server:GET /task\.php\?adv=.*&sdv=.* detector_id: 1154
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Zlob "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/task.php?adv="; content:"&sdv="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/task\.php\?adv=.*&sdv=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001154; rev:1004;)

# Command&Control: (Trojan) Magania - regex: to_server:GET .*get\.asp\?mac=.*&ver=.*&avs=.*User-Agent: Google page detector_id: 1155
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Magania"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"get.asp?mac="; content:"&ver="; content:"&avs="; content:"User-Agent|3A| Google page"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*get\.asp\?mac=.*&ver=.*&avs=.*User-Agent: Google page/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001155; rev:1004;)

# Command&Control: (Trojan) Tobfy - regex: to_server:GET /get\.php\?file=[a-z0-9]*&id=.* detector_id: 1156
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Tobfy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get.php?file="; content:"&id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get\.php\?file=[a-z0-9]*&id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001156; rev:1004;)

# Command&Control: (Trojan) Oficla - regex: to_server:GET .*bb\.php\?id=.*&v=.*&tm=.*&b=.* detector_id: 1157
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Oficla"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"bb.php?id="; content:"&v="; content:"&tm="; content:"&b="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*bb\.php\?id=.*&v=.*&tm=.*&b=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001157; rev:1004;)

# Command&Control: (Dropper) FraudLoad - regex: to_server:GET /install\.php\?id=crossales detector_id: 1158
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) FraudLoad"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/install.php?id=crossales"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/install\.php\?id=crossales/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001158; rev:1004;)

# Adware: (Toolbar) AdRotator  - regex: to_server:GET /bc/nsi_uninstall\.php\?id=.*&aff_id=.* detector_id: 1159
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) AdRotator "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bc/nsi_uninstall.php?id="; content:"&aff_id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bc\/nsi_uninstall\.php\?id=.*&aff_id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001159; rev:1004;)

# Command&Control: (Backdoor) Kykyshka - regex: to_server:GET /upopwin/count\.asp\?mac=.*&ver=.*&user=.*&pc=.*&md5=.*&ProceC=.*&ProceR=.*&ProceI=.*&lang=.* detector_id: 1160
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Kykyshka"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/upopwin/count.asp?mac="; content:"&ver="; content:"&user="; content:"&pc="; content:"&md5="; content:"&ProceC="; content:"&ProceR="; content:"&ProceI="; content:"&lang="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/upopwin\/count\.asp\?mac=.*&ver=.*&user=.*&pc=.*&md5=.*&ProceC=.*&ProceR=.*&ProceI=.*&lang=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001160; rev:1004;)

# Command&Control: (Dropper) GenericDropper_50 - regex: to_server:GET /ctgt\.asp\?mac=.*&ver=.*&makedate=.*&userID=.*&ComPut=.*&os=.*&key=.* detector_id: 1161
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_50"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ctgt.asp?mac="; content:"&ver="; content:"&makedate="; content:"&userID="; content:"&ComPut="; content:"&os="; content:"&key="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ctgt\.asp\?mac=.*&ver=.*&makedate=.*&userID=.*&ComPut=.*&os=.*&key=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001161; rev:1004;)

# Command&Control: (Dropper) GenericDropper_50 - regex: to_server:GET /[a-z]{1}/count\.asp\?mac=.*&ver=.*&makedate=.*&userID=.*&ComPut=.*&os=,*&key=.*&explorer=.* detector_id: 1162
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_50"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/count.asp?mac="; content:"&ver="; content:"&makedate="; content:"&userID="; content:"&ComPut="; content:"&os="; content:"&key="; content:"&explorer="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{1}\/count\.asp\?mac=.*&ver=.*&makedate=.*&userID=.*&ComPut=.*&os=,*&key=.*&explorer=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001162; rev:1004;)

# Adware: (Toolbar) ZenoSearch - regex: to_server:POST /cl/clienthostip\.asp\?rnd=.*uid=.*&ref=.*&clid=.*&umode=.*&cn=.*&startup=.* detector_id: 1163
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) ZenoSearch"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/cl/clienthostip.asp?rnd="; content:"uid="; content:"&ref="; content:"&clid="; content:"&umode="; content:"&cn="; content:"&startup="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cl\/clienthostip\.asp\?rnd=.*uid=.*&ref=.*&clid=.*&umode=.*&cn=.*&startup=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001163; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_30 - regex: to_server:GET /a/Drk\.syn\?adcontext=.*_CHECKIN.*bho=aurora detector_id: 1165
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_30"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/a/Drk.syn?adcontext="; content:"_CHECKIN"; content:"bho=aurora"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/a\/Drk\.syn\?adcontext=.*_CHECKIN.*bho=aurora/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001165; rev:1004;)

# Command&Control: (Trojan) Neurotickat - regex: to_server:GET .*cgi_log\.php\?action=log&ip=.*&port=.*&id=.*&win=.*&rpass=.*&connection=.*&s7pass=.* detector_id: 1167
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Neurotickat"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"cgi_log.php?action=log&ip="; content:"&port="; content:"&id="; content:"&win="; content:"&rpass="; content:"&connection="; content:"&s7pass="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*cgi_log\.php\?action=log&ip=.*&port=.*&id=.*&win=.*&rpass=.*&connection=.*&s7pass=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001167; rev:1004;)

# Command&Control: (Trojan) Busky - regex: to_server:GET .*\?ucid=.*&wmid=.* detector_id: 1168
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Busky"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?ucid="; content:"&wmid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\?ucid=.*&wmid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001168; rev:441;)

# Command&Control: (Trojan)  Dapato_1 - regex: to_server:POST /mx/\d/[A-Z]/in/ detector_id: 1170
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan)  Dapato_1"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/mx/"; content:"/in/"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mx\/\d\/[A-Z]\/in\//"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001170; rev:207;)

# Adware: (Toolbar) iBryte - regex: to_server:GET .*offers\.json\?version=.*&pid=.*&ts=.* detector_id: 1172
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) iBryte"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"offers.json?version="; content:"&pid="; content:"&ts="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*offers\.json\?version=.*&pid=.*&ts=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001172; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_74 - regex: to_server:GET /urlcore/olgjcfgs\.dat\?q=.* detector_id: 1173
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_74"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/urlcore/olgjcfgs.dat?q="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/urlcore\/olgjcfgs\.dat\?q=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001173; rev:1004;)

# Command&Control: (Trojan) Busky - regex: to_server:GET /soft\.php\?wm=.*&log=.*&wmid=.*&err=.* detector_id: 1174
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Busky"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/soft.php?wm="; content:"&log="; content:"&wmid="; content:"&err="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/soft\.php\?wm=.*&log=.*&wmid=.*&err=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001174; rev:1004;)

# Command&Control: (Trojan) Busky - regex: to_server:GET /get/1/1/1\?ucid=.* detector_id: 1175
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Busky"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get/1/1/1?ucid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get\/1\/1\/1\?ucid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001175; rev:208;)

# FakeAV: WinWebSec possibly Fake-Alert SecurityTool - regex: to_server:GET /api/stats/install/.*\?ts=.*&affid=.*&ver=.*&group=.* detector_id: 1176
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: WinWebSec possibly Fake-Alert SecurityTool"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/api/stats/install/"; content:"?ts="; content:"&affid="; content:"&ver="; content:"&group="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/stats\/install\/.*\?ts=.*&affid=.*&ver=.*&group=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001176; rev:208;)

# Command&Control: (Trojan) Banload - regex: to_server:POST .*(index|newaires)\.php.*arq=.*&condicao=.* detector_id: 1177
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Banload"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php"; content:"arq="; content:"&condicao="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*(index|newaires)\.php.*arq=.*&condicao=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001177; rev:733;)

# Command&Control: (Trojan) Daws possibly Systex - regex: to_server:GET /t\.asp\?os=.* detector_id: 1181
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Daws possibly Systex"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/t.asp?os="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/t\.asp\?os=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001181; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_73 - regex: to_server:GET /scripts/view\.asp\?sid=.*&id=.*&ip=.*&ver=.*&name=.* detector_id: 1182
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_73"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/scripts/view.asp?sid="; content:"&id="; content:"&ip="; content:"&ver="; content:"&name="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/scripts\/view\.asp\?sid=.*&id=.*&ip=.*&ver=.*&name=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001182; rev:1004;)

# Adware: (Toolbar) iBryte - regex: to_server:GET .*offers\.json\?version=.*&pid=installer&ts= detector_id: 1183
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) iBryte"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"offers.json?version="; content:"&pid=installer&ts="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*offers\.json\?version=.*&pid=installer&ts=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001183; rev:718;)

# Command&Control: (Trojan) Banload_2 - regex: to_server:POST .*.*op=.*&macaddress=.*&serialhd=.*&serialfisico=.*&nomeusuario=.*&versaowindows=.*&pcname=.*&versaoatual=.*&arquivosplugins=.*&titulo=.*&texto=.* detector_id: 1185
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Banload_2"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"op="; content:"&macaddress="; content:"&serialhd="; content:"&serialfisico="; content:"&nomeusuario="; content:"&versaowindows="; content:"&pcname="; content:"&versaoatual="; content:"&arquivosplugins="; content:"&titulo="; content:"&texto="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*.*op=.*&macaddress=.*&serialhd=.*&serialfisico=.*&nomeusuario=.*&versaowindows=.*&pcname=.*&versaoatual=.*&arquivosplugins=.*&titulo=.*&texto=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001185; rev:217;)

# Command&Control: (Trojan) Jorik - regex: to_server:GET /swidget/26n2qf7pnk0x detector_id: 1186
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Jorik"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/swidget/26n2qf7pnk0x"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/swidget\/26n2qf7pnk0x/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001186; rev:344;)

# Command&Control: (Trojan) Jorik - regex: to_server:GET /small/02/2 detector_id: 1187
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Jorik"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/small/02/2"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/small\/02\/2/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001187; rev:344;)

# Command&Control: (Trojan) Silence_lockbot - regex: to_server:GET /Silence/read\.php\?nm=.* detector_id: 1188
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Silence_lockbot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Silence/read.php?nm="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Silence\/read\.php\?nm=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001188; rev:1004;)

# Command&Control: (Trojan) ChangeUp - regex: to_server:GET /88443\?id=(a|b) HTTP/1\.1 detector_id: 1191
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ChangeUp"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/88443?id="; content:" HTTP/1.1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/88443\?id=(a|b) HTTP\/1\.1/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001191; rev:1004;)

# Adware: ShopAtHome - regex: to_server:GET /1/eabd37c669\?a=.*&qt=0&ap=.*&dc=.*&fe=.*&to=.*&v=.* detector_id: 1192
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: ShopAtHome"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/1/eabd37c669?a="; content:"&qt=0&ap="; content:"&dc="; content:"&fe="; content:"&to="; content:"&v="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/1\/eabd37c669\?a=.*&qt=0&ap=.*&dc=.*&fe=.*&to=.*&v=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001192; rev:228;)

# Command&Control: (Trojan) Cossta - regex: to_server:GET /base/get\.aspx\?guid=.*&os=.*&class=.* detector_id: 1193
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Cossta"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/base/get.aspx?guid="; content:"&os="; content:"&class="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/base\/get\.aspx\?guid=.*&os=.*&class=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001193; rev:1004;)

# Command&Control: (Trojan) Puzlice - regex: to_server:GET /p6\.asp\?tid=.*&aid=.*&Publicer=.*&MAC=.* detector_id: 1194
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Puzlice"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/p6.asp?tid="; content:"&aid="; content:"&Publicer="; content:"&MAC="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/p6\.asp\?tid=.*&aid=.*&Publicer=.*&MAC=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001194; rev:722;)

# Command&Control: (Trojan) ZBot - regex: to_server:GET /config\.bin HTTP detector_id: 1195
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/config.bin HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/config\.bin HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001195; rev:722;)

# Command&Control: (Trojan) Urausy - regex: to_server:GET /555657555E886B detector_id: 1197
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Urausy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/555657555E886B"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/555657555E886B/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001197; rev:487;)

# Command&Control: GenericDropper_53 - regex: to_server:GET /t\.asp\?ver=.*&mac=.*&os= detector_id: 1199
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: GenericDropper_53"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/t.asp?ver="; content:"&mac="; content:"&os="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/t\.asp\?ver=.*&mac=.*&os=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001199; rev:1004;)

# Adware: (Downware) KoreanDownware - regex: to_server:GET /check_counter\.php\?pid=.{4,15}&kind=\d HTTP detector_id: 1201
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) KoreanDownware"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/check_counter.php?pid="; content:"&kind="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/check_counter\.php\?pid=.{4,15}&kind=\d HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001201; rev:1002;)

# Command&Control: (Worm) Pronny - regex: to_server:GET /77822\?a detector_id: 1203
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Pronny"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/77822?a"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/77822\?a/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001203; rev:246;)

# Command&Control: (Trojan) Small - regex: to_server:GET /.*\?unq=.*&version=.*&pais= detector_id: 1204
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Small"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?unq="; content:"&version="; content:"&pais="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\?unq=.*&version=.*&pais=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001204; rev:238;)

# Command&Control: (Worm) Pronny - regex: to_server:GET /77822\?b detector_id: 1205
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Pronny"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/77822?b"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/77822\?b/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001205; rev:246;)

# Command&Control: (Trojan) Busky - regex: to_server:GET /wafugi\?id=.*&w=.*&step=.* detector_id: 1206
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Busky"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/wafugi?id="; content:"&w="; content:"&step="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/wafugi\?id=.*&w=.*&step=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001206; rev:278;)

# Command&Control: (Trojan) Popureb - regex: to_server:GET .*\.php\?userid=.*&time=.*&msg=.*&ver=.*&os=.*&fy=.*&pauid=.*&checkId= detector_id: 1207
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Popureb"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?userid="; content:"&time="; content:"&msg="; content:"&ver="; content:"&os="; content:"&fy="; content:"&pauid="; content:"&checkId="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php\?userid=.*&time=.*&msg=.*&ver=.*&os=.*&fy=.*&pauid=.*&checkId=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001207; rev:1004;)

# Adware: (Downware) InstallMate - regex: to_server:POST /installmate/php/track_installer_products\.php.*data= detector_id: 1208
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) InstallMate"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/installmate/php/track_installer_products.php"; content:"data="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/installmate\/php\/track_installer_products\.php.*data=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001208; rev:1004;)

# Adware: BundleInstaller - regex: to_server:GET /buin/open\.php\?iid=.*&pid=.*&sid=.*&installerid=.*&installerversion=.*&source= detector_id: 1209
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: BundleInstaller"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/buin/open.php?iid="; content:"&pid="; content:"&sid="; content:"&installerid="; content:"&installerversion="; content:"&source="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/buin\/open\.php\?iid=.*&pid=.*&sid=.*&installerid=.*&installerversion=.*&source=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001209; rev:1004;)

# Command&Control: (Trojan) Horst - regex: to_server:GET /check_ver\.php\?version= detector_id: 1211
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Horst"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/check_ver.php?version="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/check_ver\.php\?version=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001211; rev:1002;)

# Command&Control: (Trojan) Virut - regex: to_server:GET /gate\.php\?uid= detector_id: 1212
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Virut"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/gate.php?uid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/gate\.php\?uid=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001212; rev:711;)

# Adware: InstallCore - regex: to_server:GET .*\?s=.*&t=.*&ext= detector_id: 1213
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: InstallCore"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?s="; content:"&t="; content:"&ext="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\?s=.*&t=.*&ext=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001213; rev:442;)

# Command&Control: (Trojan) Chiviper - regex: to_server:GET /tj\d*/(post|count)\.asp\?d10=.*&d11=.*&d21=.*&d22= detector_id: 1216
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Chiviper"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/tj"; content:".asp?d10="; content:"&d11="; content:"&d21="; content:"&d22="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/tj\d*\/(post|count)\.asp\?d10=.*&d11=.*&d21=.*&d22=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001216; rev:1004;)

# Command&Control: (Trojan) Ceeinject - regex: to_server:GET .*/nhbgfudbh/ detector_id: 1217
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ceeinject"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/nhbgfudbh/"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/nhbgfudbh\//"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001217; rev:344;)

# Command&Control: (Trojan) Ceeinject - regex: to_server:GET .*/jhngfccd/ detector_id: 1218
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ceeinject"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/jhngfccd/"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/jhngfccd\//"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001218; rev:344;)

# Command&Control: (Backdoor) Swami - regex: to_server:POST /im/(linux|freebsd|solaris)\.php HTTP.*caaaaaaa detector_id: 1219
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Swami"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/im/"; content:".php HTTP"; content:"caaaaaaa"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/im\/(linux|freebsd|solaris)\.php HTTP.*caaaaaaa/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001219; rev:780;)

# Adware: Media Downloader - regex: to_server:GET /json\.php\?action=prg_download_second&m_id=.*Media Downloader_WinAPI_Installer detector_id: 1220
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: Media Downloader"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/json.php?action=prg_download_second&m_id="; content:"Media Downloader_WinAPI_Installer"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/json\.php\?action=prg_download_second&m_id=.*Media Downloader_WinAPI_Installer/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001220; rev:1004;)

# Command&Control: (Trojan) Mepaow - regex: to_server:GET /PostView\.nhn\?blogId=(cjddms52|windowupdate)&logNo=\d detector_id: 1222
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Mepaow"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/PostView.nhn?blogId="; content:"&logNo="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/PostView\.nhn\?blogId=(cjddms52|windowupdate)&logNo=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001222; rev:1298;)

# Command&Control: (Trojan) Virut - regex: to_server:GET /park/update\.asp\?AppVersion= detector_id: 1223
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Virut"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/park/update.asp?AppVersion="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/park\/update\.asp\?AppVersion=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001223; rev:1004;)

# Command&Control: (Trojan) Fareit - regex: to_server:POST .*CRYPTED0 detector_id: 1224
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OpenBDS Command&Control: (Trojan) Fareit"; flow:established,to_server; content:"POST"; http_method; content:"CRYPTED0"; http_client_body; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001224; rev:0;)

# Adware: (Downware) InstallMate - regex: to_server:GET /installmate/php/get_cfg\.php\?step_id=.*&product_name=.*&browser_id= detector_id: 1225
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) InstallMate"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/installmate/php/get_cfg.php?step_id="; content:"&product_name="; content:"&browser_id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/installmate\/php\/get_cfg\.php\?step_id=.*&product_name=.*&browser_id=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001225; rev:1004;)

# Command&Control: Qakbot - regex: to_server:POST /t HTTP.*v=\d&c= detector_id: 1226
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: Qakbot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/t HTTP"; content:"v="; content:"&c="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/t HTTP.*v=\d&c=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001226; rev:387;)

# Malware Download: Malware Download - regex: to_server:GET /update.1.0.exe\?ts=.*&affid=.* detector_id: 1227
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Malware Download: Malware Download"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/update"; content:"exe?ts="; content:"&affid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/update.1.0.exe\?ts=.*&affid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001227; rev:246;)

# Command&Control: (Trojan) Ceeinject - regex: to_server:GET /knrfkedw detector_id: 1228
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ceeinject"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/knrfkedw"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/knrfkedw/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001228; rev:246;)

# Command&Control: (Trojan) Ceeinject - regex: to_server:GET /ldmexsknfr detector_id: 1229
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ceeinject"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ldmexsknfr"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ldmexsknfr/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001229; rev:246;)

# Command&Control: (Trojan) Ceeinject - regex: to_server:GET /ajbnjcde detector_id: 1230
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ceeinject"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ajbnjcde"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ajbnjcde/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001230; rev:246;)

# Command&Control: (Trojan) Ceeinject - regex: to_server:GET /hbgvfvgfd detector_id: 1231
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ceeinject"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/hbgvfvgfd"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/hbgvfvgfd/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001231; rev:246;)

# Command&Control: (Trojan) Ceeinject - regex: to_server:GET /aincixd detector_id: 1232
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ceeinject"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/aincixd"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/aincixd/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001232; rev:246;)

# Command&Control: (Worm) Pronny - regex: to_server:GET /00192\?a detector_id: 1233
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Pronny"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/00192?a"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/00192\?a/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001233; rev:246;)

# Command&Control: (Worm) Pronny - regex: to_server:GET /65111\?a detector_id: 1234
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Pronny"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/65111?a"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/65111\?a/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001234; rev:246;)

# Command&Control: (Trojan) Ceeinject - regex: to_server:GET /kncyhvkmv detector_id: 1235
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ceeinject"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/kncyhvkmv"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/kncyhvkmv/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001235; rev:246;)

# Command&Control: (Trojan) Ceeinject - regex: to_server:GET /aivbgofdn detector_id: 1236
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ceeinject"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/aivbgofdn"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/aivbgofdn/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001236; rev:246;)

# Command&Control: (Worm) Pronny - regex: to_server:GET /00192\?b detector_id: 1237
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Pronny"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/00192?b"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/00192\?b/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001237; rev:246;)

# Command&Control: (Trojan) Ceeinject - regex: to_server:GET /nhbgfudbh detector_id: 1238
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ceeinject"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/nhbgfudbh"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/nhbgfudbh/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001238; rev:246;)

# Command&Control: (Trojan) Koobface_2 - regex: to_server:GET /.sys/\?action=ldgen&ff= detector_id: 1240
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Koobface_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"sys/?action=ldgen&ff="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.sys\/\?action=ldgen&ff=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001240; rev:247;)

# Command&Control: (Trojan) Bublik - regex: to_server:POST /nwi/tim\.php.*[A-Za-z0-9\+/]{20,}={0,2}  detector_id: 1242
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bublik"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/nwi/tim.php"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/nwi\/tim\.php.*[A-Za-z0-9\+\/]{20,}={0,2} /s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001242; rev:1004;)

# Command&Control: (Dropper) Swizzor - regex: to_server:GET /upd/check\?version=0\.0(znp|unk) detector_id: 1244
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Swizzor"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/upd/check?version=0.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/upd\/check\?version=0\.0(znp|unk)/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001244; rev:597;)

# Command&Control: (Trojan) MayDay - regex: to_server:GET .*cgi-bin/gate\.cgi\?password=[a-z]*&command=report&guid=\{.*\} detector_id: 1245
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) MayDay"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"cgi-bin/gate.cgi?password="; content:"&command=report&guid=|7B|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*cgi-bin\/gate\.cgi\?password=[a-z]*&command=report&guid=\{.*\}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001245; rev:1004;)

# Command&Control: (Trojan) MayDay - regex: to_server:GET .*cgi-bin/gate\.cgi\?password=[a-z]*&command=learn detector_id: 1246
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) MayDay"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"cgi-bin/gate.cgi?password="; content:"&command=learn"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*cgi-bin\/gate\.cgi\?password=[a-z]*&command=learn/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001246; rev:1004;)

# Command&Control: (Dropper) Dluca - regex: to_server:GET /wk/getclientid\.wnk\?srv=.*&ver=.*&pin=.*&OSInfo2=.*&cinfo=.*&smd=mg&rts=.*&GMC=.* detector_id: 1247
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Dluca"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/wk/getclientid.wnk?srv="; content:"&ver="; content:"&pin="; content:"&OSInfo2="; content:"&cinfo="; content:"&smd=mg&rts="; content:"&GMC="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/wk\/getclientid\.wnk\?srv=.*&ver=.*&pin=.*&OSInfo2=.*&cinfo=.*&smd=mg&rts=.*&GMC=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001247; rev:1004;)

# Command&Control: (Trojan) Ertfor - regex: to_server:GET /(dw|ndw)/(dw|ndw)\.php\?id=.*&ver=.*User-Agent: Mozilla/4\.0 \(SP3 WINLD\) detector_id: 1248
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ertfor"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?id="; content:"&ver="; content:"User-Agent|3A| Mozilla/4.0 |28|SP3 WINLD|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(dw|ndw)\/(dw|ndw)\.php\?id=.*&ver=.*User-Agent: Mozilla\/4\.0 \(SP3 WINLD\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001248; rev:1002;)

# Command&Control: (Dropper) Dluca - regex: to_server:GET /wk/getclientid\.wnk\?srv=.*&ver=.*&pin=.*&OSInfo2=.*&cinfo=.*&smd=mg&rts=.*&retryattempt=.*&GMC=.* detector_id: 1249
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Dluca"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/wk/getclientid.wnk?srv="; content:"&ver="; content:"&pin="; content:"&OSInfo2="; content:"&cinfo="; content:"&smd=mg&rts="; content:"&retryattempt="; content:"&GMC="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/wk\/getclientid\.wnk\?srv=.*&ver=.*&pin=.*&OSInfo2=.*&cinfo=.*&smd=mg&rts=.*&retryattempt=.*&GMC=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001249; rev:1004;)

# Command&Control: (Backdoor) Prorat - regex: to_server:GET /wwp/msg/1,,,00\.html\?Uin=.*&Name=ProRat&Send=yes detector_id: 1250
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Prorat"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/wwp/msg/1|2C||2C||2C|00.html?Uin="; content:"&Name=ProRat&Send=yes"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/wwp\/msg\/1,,,00\.html\?Uin=.*&Name=ProRat&Send=yes/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001250; rev:1004;)

# Command&Control: (Backdoor) Netdevil - regex: to_server:GET /wwp/msg/1,,,00\.html\?Uin=.*&Name=\[victim=.*\]\+\[netdevil.*srv\]\+\[IP=.*\].*&Send=yes detector_id: 1251
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Netdevil"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/wwp/msg/1|2C||2C||2C|00.html?Uin="; content:"&Name=|5B|victim="; content:"|5D||2B||5B|netdevil"; content:"srv|5D||2B||5B|IP="; content:"&Send=yes"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/wwp\/msg\/1,,,00\.html\?Uin=.*&Name=\[victim=.*\]\+\[netdevil.*srv\]\+\[IP=.*\].*&Send=yes/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001251; rev:1004;)

# Command&Control: (Dropper) Dofoil - regex: to_server:GET /(fuckbot|krabsburger)/index\.php\?k=[0-9A-F]{32} detector_id: 1252
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Dofoil"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?k="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(fuckbot|krabsburger)\/index\.php\?k=[0-9A-F]{32}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001252; rev:520;)

# Command&Control: (Trojan) Virut - regex: to_server:GET /cuout\d*\.php\?cu=[a-f0-9]{32}&pargs=[a-f0-9]{32} detector_id: 1254
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Virut"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cuout"; content:".php?cu="; content:"&pargs="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cuout\d*\.php\?cu=[a-f0-9]{32}&pargs=[a-f0-9]{32}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001254; rev:1004;)

# Command&Control: (Dropper) Tibs - regex: to_server:GET /exe\.php\?ex=6082 detector_id: 1259
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Tibs"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/exe.php?ex=6082"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/exe\.php\?ex=6082/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001259; rev:1004;)

# Command&Control: (Trojan) Sality  Kashu - regex: to_server:GET /d_mm/\d\?[0-9a-f]{6}=\d{6}&id=\d*&v= detector_id: 1263
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sality  Kashu"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/d_mm/"; content:"&id="; content:"&v="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/d_mm\/\d\?[0-9a-f]{6}=\d{6}&id=\d*&v=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001263; rev:247;)

# Command&Control: (Trojan) Sality - regex: to_server:GET /\?[0-9a-f]{5}=\d+&id=\d+.*User-Agent: KUKU v(4|5) detector_id: 1264
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sality"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?"; content:"&id="; content:"User-Agent|3A| KUKU v"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?[0-9a-f]{5}=\d+&id=\d+.*User-Agent: KUKU v(4|5)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001264; rev:247;)

# Command&Control: (Worm) Stration - regex: to_server:GET /outtask/urlTask._._..txt\?id=[0-9A-F]{20}&flag= detector_id: 1271
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Stration"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/outtask/urlTask"; content:"txt?id="; content:"&flag="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/outtask\/urlTask._._..txt\?id=[0-9A-F]{20}&flag=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001271; rev:247;)

# Command&Control: (Trojan) Banload - regex: to_server:POST .*.*tip=.*&tipo=.*&nomepc=.*&inf=.*& detector_id: 1276
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Banload"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"tip="; content:"&tipo="; content:"&nomepc="; content:"&inf="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*.*tip=.*&tipo=.*&nomepc=.*&inf=.*&/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001276; rev:263;)

# Adware: (Downware) InstallMate - regex: to_server:GET /installmate/php/get_configuration\.php\?installer_id=.*&step_id=.* detector_id: 1277
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) InstallMate"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/installmate/php/get_configuration.php?installer_id="; content:"&step_id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/installmate\/php\/get_configuration\.php\?installer_id=.*&step_id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001277; rev:1004;)

# OpenBDS Test: Sensor Rule (Zbot) - regex: to_server:GET /view\?f89c6263699ecb4716c0ae9e7033d9f2 detector_id: 1278
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS OpenBDS Test: Sensor Rule (Zbot)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/view?f89c6263699ecb4716c0ae9e7033d9f2"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/view\?f89c6263699ecb4716c0ae9e7033d9f2/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001278; rev:377;)

# FakeAV: FakeVimes - regex: to_server:GET /index\.php\?0d40b0=.* detector_id: 1279
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeVimes"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?0d40b0="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\?0d40b0=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001279; rev:1004;)

# Command&Control: (Banker) GenericBanker_7 - regex: to_server:POST /upload\.php.*conteudo=\..&myFile= detector_id: 1280
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_7"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/upload.php"; content:"conteudo=."; content:"&myFile="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/upload\.php.*conteudo=\..&myFile=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001280; rev:1004;)

# Command&Control: (Trojan) BaoFa - regex: to_server:GET /.*/online\d*/\?s=.*&v=.*&n=.*&rnd= detector_id: 1281
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) BaoFa"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/online"; content:"/?s="; content:"&v="; content:"&n="; content:"&rnd="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\/online\d*\/\?s=.*&v=.*&n=.*&rnd=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001281; rev:258;)

# Command&Control: (ClickBot) Hatigh - regex: to_server:GET /fd/sea\.php\?ver=ha\d+ detector_id: 1282
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (ClickBot) Hatigh"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/fd/sea.php?ver=ha"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/fd\/sea\.php\?ver=ha\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001282; rev:1004;)

# Command&Control: (Dropper) Harnig - regex: to_server:GET .*\.php\?exp=\d*&adv=.*&code1=[A-Z]*&code2=\d*&id=.* detector_id: 1283
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Harnig"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?exp="; content:"&adv="; content:"&code1="; content:"&code2="; content:"&id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php\?exp=\d*&adv=.*&code1=[A-Z]*&code2=\d*&id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001283; rev:1004;)

# Command&Control: (Trojan) Vundo - regex: to_server:GET /phpbb/get\.php\?id=.*&key=\d*&av=.*&vm=.*&al=.*&p=\d*&os=.*&z=\d*&hash=.* detector_id: 1284
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Vundo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/phpbb/get.php?id="; content:"&key="; content:"&av="; content:"&vm="; content:"&al="; content:"&p="; content:"&os="; content:"&z="; content:"&hash="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/phpbb\/get\.php\?id=.*&key=\d*&av=.*&vm=.*&al=.*&p=\d*&os=.*&z=\d*&hash=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001284; rev:1004;)

# FakeAV: WinWebSec  - regex: to_server:GET .*/.*\.exe\?ts=.*&affid=\d* detector_id: 1285
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: WinWebSec "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".exe?ts="; content:"&affid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/.*\.exe\?ts=.*&affid=\d*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001285; rev:1004;)

# Command&Control: (Banker) Banz - regex: to_server:POST .*.*remetente=.*&destinatario=.*&assunto=.*&mensagem=.*& detector_id: 1287
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Banz"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"remetente="; content:"&destinatario="; content:"&assunto="; content:"&mensagem="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*.*remetente=.*&destinatario=.*&assunto=.*&mensagem=.*&/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001287; rev:263;)

# Adware: (Downware) GamePlayLabs - regex: to_server:GET /installer\.gif\?action=.*&browser=.*&ver=.*&bic=.*&app=.*&appver=\d*&verifier=.*&srcid=.*&subid=.*&zdata=.*&ff=.*&ch=.*&default=.*&os=.*&admin=.*&type=.*&asw=.* detector_id: 1289
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) GamePlayLabs"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/installer.gif?action="; content:"&browser="; content:"&ver="; content:"&bic="; content:"&app="; content:"&appver="; content:"&verifier="; content:"&srcid="; content:"&subid="; content:"&zdata="; content:"&ff="; content:"&ch="; content:"&default="; content:"&os="; content:"&admin="; content:"&type="; content:"&asw="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/installer\.gif\?action=.*&browser=.*&ver=.*&bic=.*&app=.*&appver=\d*&verifier=.*&srcid=.*&subid=.*&zdata=.*&ff=.*&ch=.*&default=.*&os=.*&admin=.*&type=.*&asw=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001289; rev:1004;)

# Adware: (Post-Checkin) OpenShopper - regex: to_server:POST /mmsv/.*MyMode=[a-z]*&MyPartner=.*&MyValue=.* detector_id: 1290
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Post-Checkin) OpenShopper"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/mmsv/"; content:"MyMode="; content:"&MyPartner="; content:"&MyValue="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mmsv\/.*MyMode=[a-z]*&MyPartner=.*&MyValue=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001290; rev:263;)

# FakeAV: WinWebSec - regex: to_server:GET /install\.php\?affid=\d{5} detector_id: 1293
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: WinWebSec"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/install.php?affid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/install\.php\?affid=\d{5}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001293; rev:1004;)

# Command&Control: (Trojan) Mutopy - regex: to_server:GET /protocol\.php\?p=\d*&d=[a-zA-Z0-9+/=]{40,} detector_id: 1303
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Mutopy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/protocol.php?p="; content:"&d="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/protocol\.php\?p=\d*&d=[a-zA-Z0-9+\/=]{40,}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001303; rev:1004;)

# Adware: (Downware) Wingo - regex: to_server:GET /MIN/log/LogProc\.php\?mode=.*&pCode=\d*&mac=.* detector_id: 1305
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Wingo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/MIN/log/LogProc.php?mode="; content:"&pCode="; content:"&mac="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/MIN\/log\/LogProc\.php\?mode=.*&pCode=\d*&mac=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001305; rev:1004;)

# Adware: (Downware) SoftwareInformer - regex: to_server:GET /wrapper_log\.php\?u=.*&first_run=\d* detector_id: 1306
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) SoftwareInformer"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/wrapper_log.php?u="; content:"&first_run="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/wrapper_log\.php\?u=.*&first_run=\d*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001306; rev:1004;)

# Command&Control: (Trojan) Bredolab - regex: to_server:GET .*/load\.php\?module=avclean detector_id: 1307
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bredolab"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/load.php?module=avclean"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/load\.php\?module=avclean/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001307; rev:722;)

# Adware: (Game) GamePlayLabs - regex: to_server:GET /ie-error\.gif\?action=.*&browser=.*&ver=.*&bic=.*&app=.*&appver=.*&verifier=.*&error=\d*&os=.*&admin=.*&il=.*&rnd=.* detector_id: 1308
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Game) GamePlayLabs"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ie-error.gif?action="; content:"&browser="; content:"&ver="; content:"&bic="; content:"&app="; content:"&appver="; content:"&verifier="; content:"&error="; content:"&os="; content:"&admin="; content:"&il="; content:"&rnd="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ie-error\.gif\?action=.*&browser=.*&ver=.*&bic=.*&app=.*&appver=.*&verifier=.*&error=\d*&os=.*&admin=.*&il=.*&rnd=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001308; rev:1004;)

# Command&Control: (Trojan) Virut - regex: to_server:GET /fftun\.php\?ip=[0-9A-F]{8}&port=[0-9A-F]{4} detector_id: 1309
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Virut"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/fftun.php?ip="; content:"&port="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/fftun\.php\?ip=[0-9A-F]{8}&port=[0-9A-F]{4}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001309; rev:1004;)

# Adware: (Adware) GenericAdware_3 - regex: to_server:GET /logexp.*\.php\?aid=.*&pid=.*&kind=.* detector_id: 1310
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) GenericAdware_3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/logexp"; content:".php?aid="; content:"&pid="; content:"&kind="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/logexp.*\.php\?aid=.*&pid=.*&kind=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001310; rev:1016;)

# Command&Control: (Trojan) Ramagedos - regex: to_server:POST /(arm|bokun)/gs\.php.*User-Agent: ArmageddoN.*id=.*&user=.*&os=.* detector_id: 1311
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ramagedos"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/gs.php"; content:"User-Agent|3A| ArmageddoN"; content:"id="; content:"&user="; content:"&os="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(arm|bokun)\/gs\.php.*User-Agent: ArmageddoN.*id=.*&user=.*&os=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001311; rev:1004;)

# Adware: (Post-Checkin) Nbar - regex: to_server:GET /app/.*\.php\?nid_mac=.*&nid_os_ver=.*&nid_ie_ver=.*&md=.*&state=.*&op=.* detector_id: 1312
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Post-Checkin) Nbar"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/app/"; content:".php?nid_mac="; content:"&nid_os_ver="; content:"&nid_ie_ver="; content:"&md="; content:"&state="; content:"&op="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/app\/.*\.php\?nid_mac=.*&nid_os_ver=.*&nid_ie_ver=.*&md=.*&state=.*&op=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001312; rev:1004;)

# Command&Control: (Trojan) AgentBypass - regex: to_server:GET /zcz/tasks\.php\?getcmd=\d&uid=.*&cn=\d*&port= detector_id: 1313
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) AgentBypass"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/zcz/tasks.php?getcmd="; content:"&uid="; content:"&cn="; content:"&port="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/zcz\/tasks\.php\?getcmd=\d&uid=.*&cn=\d*&port=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001313; rev:1004;)

# FakeAV: KoreanFakeAV - regex: to_server:GET /APP/stat\.php\?v1=.*&v2=.*&v3=.* detector_id: 1314
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: KoreanFakeAV"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/APP/stat.php?v1="; content:"&v2="; content:"&v3="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/APP\/stat\.php\?v1=.*&v2=.*&v3=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001314; rev:1004;)

# Adware: (Downware) InstallIQ - regex: to_server:GET /api/stub/ping\.aspx\?shortname=.*&a=.*&f=.* detector_id: 1316
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) InstallIQ"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/api/stub/ping.aspx?shortname="; content:"&a="; content:"&f="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/stub\/ping\.aspx\?shortname=.*&a=.*&f=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001316; rev:1004;)

# Command&Control: (Trojan) Usteal - regex: to_server:POST /gate/ufr\.php.*Content-Type: application/octet-stream.*UFR! detector_id: 1318
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Usteal"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/gate/ufr.php"; content:"Content-Type|3A| application/octet-stream"; content:"UFR|21|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/gate\/ufr\.php.*Content-Type: application\/octet-stream.*UFR!/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001318; rev:1004;)

# Command&Control: (Trojan) ZeuS - regex: to_server:POST /bruta555/file\.php detector_id: 1320
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZeuS"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/bruta555/file.php"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bruta555\/file\.php/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001320; rev:1004;)

# Adware: (Adware) WinAgir - regex: to_server:POST /runs/do\.php.*_pi=.*&a=.* detector_id: 1327
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) WinAgir"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/runs/do.php"; content:"_pi="; content:"&a="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/runs\/do\.php.*_pi=.*&a=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001327; rev:1004;)

# Adware: (Toolbar) Addendum - regex: to_server:GET /app/neolinfo2\.asp\?mid=.*&ver=.*&etcbr=.*User-Agent: vb wininet detector_id: 1328
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Addendum"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/app/neolinfo2.asp?mid="; content:"&ver="; content:"&etcbr="; content:"User-Agent|3A| vb wininet"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/app\/neolinfo2\.asp\?mid=.*&ver=.*&etcbr=.*User-Agent: vb wininet/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001328; rev:1004;)

# Adware: (Toolbar) CloverPlus - regex: to_server:GET /log_progress\.php\?client=.*&action=.*&target=.* detector_id: 1329
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) CloverPlus"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/log_progress.php?client="; content:"&action="; content:"&target="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/log_progress\.php\?client=.*&action=.*&target=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001329; rev:1004;)

# Adware: (Downware) InstallMate  - regex: to_server:GET /installmate/php/ping\.php\?ping_id=.*&installer_version=.*&os_id=.* detector_id: 1330
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) InstallMate "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/installmate/php/ping.php?ping_id="; content:"&installer_version="; content:"&os_id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/installmate\/php\/ping\.php\?ping_id=.*&installer_version=.*&os_id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001330; rev:711;)

# FakeAV: WinWebSec - regex: to_server:GET /(get|plugins)\.php\?ts=.*&affid=\d+ detector_id: 1331
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: WinWebSec"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?ts="; content:"&affid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(get|plugins)\.php\?ts=.*&affid=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001331; rev:462;)

# Command&Control: (Trojan) Graftor - regex: to_server:GET /.*\?vn=.*&kz5=.*&rea=.*&nn6=.*&cid=.*&blfn1=.*&b=.*&vsge44=.*&ptag=.*&nlm4=.*&av=.*&fgid8=.*&product=.*&fcg41=.*&as=.*&err=.*&try=.* detector_id: 1332
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Graftor"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?vn="; content:"&kz5="; content:"&rea="; content:"&nn6="; content:"&cid="; content:"&blfn1="; content:"&b="; content:"&vsge44="; content:"&ptag="; content:"&nlm4="; content:"&av="; content:"&fgid8="; content:"&product="; content:"&fcg41="; content:"&as="; content:"&err="; content:"&try="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\?vn=.*&kz5=.*&rea=.*&nn6=.*&cid=.*&blfn1=.*&b=.*&vsge44=.*&ptag=.*&nlm4=.*&av=.*&fgid8=.*&product=.*&fcg41=.*&as=.*&err=.*&try=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001332; rev:273;)

# Command&Control: (Trojan) Dishigy - regex: to_server:POST /news\.php.*prosto50\.ru/news\.php detector_id: 1333
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Dishigy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/news.php"; content:"prosto50.ru/news.php"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/news\.php.*prosto50\.ru\/news\.php/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001333; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_36 - regex: to_server:POST .*/bot\.php HTTP.*mode=\d&ident=Administrator(PC|pc) detector_id: 1334
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_36"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/bot.php HTTP"; content:"mode="; content:"&ident=Administrator"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/bot\.php HTTP.*mode=\d&ident=Administrator(PC|pc)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001334; rev:473;)

# Command&Control: (Backdoor) Xvisceral - regex: to_server:GET /ppar/check\.php\?username=.*&id=.*&pcusername=.*&loc=.* detector_id: 1335
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Xvisceral"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ppar/check.php?username="; content:"&id="; content:"&pcusername="; content:"&loc="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ppar\/check\.php\?username=.*&id=.*&pcusername=.*&loc=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001335; rev:1004;)

# Adware: (Adware) Funpop - regex: to_server:GET /.*\?dCode=.*User-Agent: HiSantaSession detector_id: 1336
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Funpop"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?dCode="; content:"User-Agent|3A| HiSantaSession"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\?dCode=.*User-Agent: HiSantaSession/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001336; rev:277;)

# Command&Control: (Worm) Autorun  - regex: to_server:GET /v77/MYC/CT/sv\.php\?s=.* detector_id: 1337
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Autorun "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/v77/MYC/CT/sv.php?s="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/v77\/MYC\/CT\/sv\.php\?s=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001337; rev:1004;)

# Adware: (Installer) Media Downloader - regex: to_server:GET /json\.php\?m_id=.*&action=prg_download_second.*User-Agent: Media Downloader detector_id: 1338
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Installer) Media Downloader"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/json.php?m_id="; content:"&action=prg_download_second"; content:"User-Agent|3A| Media Downloader"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/json\.php\?m_id=.*&action=prg_download_second.*User-Agent: Media Downloader/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001338; rev:1004;)

# Command&Control: (Dropper) Harnig - regex: to_server:GET /dl/dl\.php\?adv=adv\d+.*Host: [a-z]*\.biz detector_id: 1339
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Harnig"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/dl/dl.php?adv=adv"; content:"Host|3A| "; content:".biz"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/dl\/dl\.php\?adv=adv\d+.*Host: [a-z]*\.biz/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001339; rev:1004;)

# Command&Control: (Dropper) Geral - regex: to_server:GET .*/Count\.asp\?ver=.*&Mac=.*&ProcessNum=\d* detector_id: 1340
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Geral"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Count.asp?ver="; content:"&Mac="; content:"&ProcessNum="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/Count\.asp\?ver=.*&Mac=.*&ProcessNum=\d*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001340; rev:1004;)

# Command&Control: (Dropper) Harnig - regex: to_server:GET /progs/[a-z]{5,10}/[a-z]{5,10}\.php\?adv=adv\d+.*User-Agent: .*ver\d.*Host: [a-z]*\.(biz|com) detector_id: 1341
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Harnig"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/progs/"; content:".php?adv=adv"; content:"User-Agent|3A| "; content:"ver"; content:"Host|3A| "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/progs\/[a-z]{5,10}\/[a-z]{5,10}\.php\?adv=adv\d+.*User-Agent: .*ver\d.*Host: [a-z]*\.(biz|com)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001341; rev:1004;)

# Command&Control: (Dropper) Harnig - regex: to_server:GET /progs/[a-z]{5,10}/[a-z]{5,10}\.php\?adv=adv\d+&exp=.*&code1=[A-Z]*&code2=.*&id=.*.*User-Agent: .*ver\d.*Host: [a-z]*\.biz detector_id: 1342
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Harnig"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/progs/"; content:".php?adv=adv"; content:"&exp="; content:"&code1="; content:"&code2="; content:"&id="; content:"User-Agent|3A| "; content:"ver"; content:"Host|3A| "; content:".biz"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/progs\/[a-z]{5,10}\/[a-z]{5,10}\.php\?adv=adv\d+&exp=.*&code1=[A-Z]*&code2=.*&id=.*.*User-Agent: .*ver\d.*Host: [a-z]*\.biz/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001342; rev:1004;)

# Command&Control: (Dropper) GenericDropper_55 - regex: to_server:GET .*/bots\.php\?name=.*&so=.*&zila=.*&mail= detector_id: 1343
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_55"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bots.php?name="; content:"&so="; content:"&zila="; content:"&mail="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/bots\.php\?name=.*&so=.*&zila=.*&mail=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001343; rev:1004;)

# FakeAV: KoreanFakeAV - regex: to_server:GET /value\.php\?strMode=setup&strID=.*&strPC=.*&strSite=.* detector_id: 1344
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: KoreanFakeAV"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/value.php?strMode=setup&strID="; content:"&strPC="; content:"&strSite="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/value\.php\?strMode=setup&strID=.*&strPC=.*&strSite=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001344; rev:1004;)

# Adware: (Toolbar) Sogou - regex: to_server:GET /sh/.*\.gif\?s=.*&v=.*&h=.* detector_id: 1345
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Sogou"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/sh/"; content:".gif?s="; content:"&v="; content:"&h="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/sh\/.*\.gif\?s=.*&v=.*&h=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001345; rev:1004;)

# Command&Control: (Trojan) Allaple - regex: to_server:GET /templates_c/.config/gl.php\?id=\d detector_id: 1346
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Allaple"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/templates_c/"; content:"config/gl"; content:"php?id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/templates_c\/.config\/gl.php\?id=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001346; rev:279;)

# Command&Control: (Dropper) Harnig - regex: to_server:GET /progs/[a-z]{5,10}/[a-z]{5,10}\.php\?adv=adv\d+.*Host: [a-z]*\.biz detector_id: 1347
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Harnig"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/progs/"; content:".php?adv=adv"; content:"Host|3A| "; content:".biz"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/progs\/[a-z]{5,10}\/[a-z]{5,10}\.php\?adv=adv\d+.*Host: [a-z]*\.biz/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001347; rev:1004;)

# Command&Control: (Dropper) Harnig - regex: to_server:GET /progs/[a-z]{5,10}/[a-z]{5,10}\.php\?adv=adv\d+&code1=[A-Z]*&code2=\d*&id=.*.*Host: [a-z]*\.biz detector_id: 1348
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Harnig"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/progs/"; content:".php?adv=adv"; content:"&code1="; content:"&code2="; content:"&id="; content:"Host|3A| "; content:".biz"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/progs\/[a-z]{5,10}\/[a-z]{5,10}\.php\?adv=adv\d+&code1=[A-Z]*&code2=\d*&id=.*.*Host: [a-z]*\.biz/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001348; rev:1004;)

# Command&Control: (Trojan) Banload - regex: to_server:POST .*index\.php.*pcAviso=.*&origemLangu=.*&namesAnti=.* detector_id: 1349
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Banload"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"index.php"; content:"pcAviso="; content:"&origemLangu="; content:"&namesAnti="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*index\.php.*pcAviso=.*&origemLangu=.*&namesAnti=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001349; rev:1004;)

# Adware: (Downware) AdMonetizer InstallMonetizer  - regex: to_server:POST /DS_IMapplication_win32\.php.*cbid=.*&userid=.*&subid=.*&mid=.*&advDetails=.* detector_id: 1350
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) AdMonetizer InstallMonetizer "; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/DS_IMapplication_win32.php"; content:"cbid="; content:"&userid="; content:"&subid="; content:"&mid="; content:"&advDetails="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/DS_IMapplication_win32\.php.*cbid=.*&userid=.*&subid=.*&mid=.*&advDetails=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001350; rev:1004;)

# Adware: (Downware) AdMonetizer InstallMonetizer  - regex: to_server:POST /DS_IMapplication_(Reg|MStub)\.php.*from=.*&type=.*&pubid=.*&CbId=.*&subid=.*&mid=.*&advDetails=.* detector_id: 1351
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) AdMonetizer InstallMonetizer "; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/DS_IMapplication_"; content:".php"; content:"from="; content:"&type="; content:"&pubid="; content:"&CbId="; content:"&subid="; content:"&mid="; content:"&advDetails="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/DS_IMapplication_(Reg|MStub)\.php.*from=.*&type=.*&pubid=.*&CbId=.*&subid=.*&mid=.*&advDetails=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001351; rev:1004;)

# Adware: (Downware) AdMonetizer InstallMonetizer  - regex: to_server:POST /DS_trackstats_v1\.php.*from=.*&type=.*&itemid=.*&pubid=.*&CbId=.*&subid=.*&mid=.*&status=.*&offid=.* detector_id: 1352
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) AdMonetizer InstallMonetizer "; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/DS_trackstats_v1.php"; content:"from="; content:"&type="; content:"&itemid="; content:"&pubid="; content:"&CbId="; content:"&subid="; content:"&mid="; content:"&status="; content:"&offid="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/DS_trackstats_v1\.php.*from=.*&type=.*&itemid=.*&pubid=.*&CbId=.*&subid=.*&mid=.*&status=.*&offid=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001352; rev:1004;)

# FakeAV: FakeSpyProtect - regex: to_server:GET /loads\.php\?code=.*.*Accept: \*/\* detector_id: 1353
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeSpyProtect"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/loads.php?code="; content:"Accept|3A| |2A|/|2A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/loads\.php\?code=.*.*Accept: \*\/\*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001353; rev:1004;)

# Adware: (Downware) AdMonetizer InstallMonetizer  - regex: to_server:POST /first_call_win32\.php.*userid=.*&cbid=.*&subid=.* detector_id: 1354
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) AdMonetizer InstallMonetizer "; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/first_call_win32.php"; content:"userid="; content:"&cbid="; content:"&subid="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/first_call_win32\.php.*userid=.*&cbid=.*&subid=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001354; rev:1004;)

# Adware: (Downware) InstallMate - regex: to_server:HEAD /installmate/php/get_cfg\.php\?step_id=.*&product_name=.*&product_title=.*&installer_file_name=.*&product_file_name=.*&product_download_url=.*&reffer=.*&installer_id=.*&publisher_id=.*&source_id=.*&page_id=.*&affiliate_id=.*&geo_location=.*&locale=.*&browser_id=.* detector_id: 1355
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) InstallMate"; flow:established,to_server; content:"HEAD"; nocase; http_method; content:"HEAD "; content:"/installmate/php/get_cfg.php?step_id="; content:"&product_name="; content:"&product_title="; content:"&installer_file_name="; content:"&product_file_name="; content:"&product_download_url="; content:"&reffer="; content:"&installer_id="; content:"&publisher_id="; content:"&source_id="; content:"&page_id="; content:"&affiliate_id="; content:"&geo_location="; content:"&locale="; content:"&browser_id="; pcre:"/HEAD (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/installmate\/php\/get_cfg\.php\?step_id=.*&product_name=.*&product_title=.*&installer_file_name=.*&product_file_name=.*&product_download_url=.*&reffer=.*&installer_id=.*&publisher_id=.*&source_id=.*&page_id=.*&affiliate_id=.*&geo_location=.*&locale=.*&browser_id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001355; rev:1004;)

# Adware: (Toolbar) Wingo - regex: to_server:GET /MIN/log/LogProc\.php\?pCode=.*&mode=.*&mac=.* detector_id: 1356
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Wingo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/MIN/log/LogProc.php?pCode="; content:"&mode="; content:"&mac="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/MIN\/log\/LogProc\.php\?pCode=.*&mode=.*&mac=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001356; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_37 - regex: to_server:GET /\?a=conf&code=\d.*User-Agent: wget 3\.0 detector_id: 1357
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_37"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?a=conf&code="; content:"User-Agent|3A| wget 3.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?a=conf&code=\d.*User-Agent: wget 3\.0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001357; rev:1004;)

# Command&Control: (Dropper) Bohu - regex: to_server:GET /svr\.asp\?t=.*&u=.*&s=.*.*User-Agent: Lobo Lunar detector_id: 1358
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Bohu"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/svr.asp?t="; content:"&u="; content:"&s="; content:"User-Agent|3A| Lobo Lunar"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/svr\.asp\?t=.*&u=.*&s=.*.*User-Agent: Lobo Lunar/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001358; rev:1004;)

# Adware: (Toolbar) ZenoSearch - regex: to_server:POST /cl/(clienthost|ctdw)\d\.asp.*uid=.*&ref=.*&clid=\d+&umode=\d&umode=\d&commode=\d detector_id: 1359
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) ZenoSearch"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/cl/"; content:".asp"; content:"uid="; content:"&ref="; content:"&clid="; content:"&umode="; content:"&umode="; content:"&commode="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cl\/(clienthost|ctdw)\d\.asp.*uid=.*&ref=.*&clid=\d+&umode=\d&umode=\d&commode=\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001359; rev:1004;)

# Command&Control: (Dropper) Karagany - regex: to_server:GET .*count\.php\?tc=.*&u=.*&e=.*&r=.*&sz=.*.*User-Agent: .*uid=.* detector_id: 1360
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Karagany"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"count.php?tc="; content:"&u="; content:"&e="; content:"&r="; content:"&sz="; content:"User-Agent|3A| "; content:"uid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*count\.php\?tc=.*&u=.*&e=.*&r=.*&sz=.*.*User-Agent: .*uid=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001360; rev:510;)

# Adware: (Adware) GenericAdware_11 WebPingGood - regex: to_server:GET /_app/.*_action.*\.php\?pi=.*&gu=.*&ac=.*  detector_id: 1361
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) GenericAdware_11 WebPingGood"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/_app/"; content:"_action"; content:".php?pi="; content:"&gu="; content:"&ac="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/_app\/.*_action.*\.php\?pi=.*&gu=.*&ac=.* /"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001361; rev:1004;)

# command&control: APT_1 - regex: to_server:GET .*/\?\.[A-Z]{8} detector_id: 1362
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: APT_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?."; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/\?\.[A-Z]{8}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001362; rev:284;)

# Command&Control: (Trojan) Banload - regex: to_server:POST .*.*cli=.*&pcnome=.*&tipo=.* detector_id: 1365
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Banload"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"cli="; content:"&pcnome="; content:"&tipo="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*.*cli=.*&pcnome=.*&tipo=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001365; rev:284;)

# Command&Control: (Dialer) Skintrim - regex: to_server:GET /binaries/bin\.php\?id=.*&plateform=.*&mh=.*&me=.* detector_id: 1366
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dialer) Skintrim"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/binaries/bin.php?id="; content:"&plateform="; content:"&mh="; content:"&me="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/binaries\/bin\.php\?id=.*&plateform=.*&mh=.*&me=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001366; rev:1004;)

# Command&Control: (Banker) Banbra - regex: to_server:GET /.*\?nomepc=.*&osName=.*&netCard=.*&ipp=.* detector_id: 1367
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Banbra"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?nomepc="; content:"&osName="; content:"&netCard="; content:"&ipp="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\?nomepc=.*&osName=.*&netCard=.*&ipp=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001367; rev:285;)

# Command&Control: (Trojan) Desurou - regex: to_server:GET .*/count\.asp\?mac=[A-Z0-9]*&ver=.*&flag=.*&userid=.* detector_id: 1369
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Desurou"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/count.asp?mac="; content:"&ver="; content:"&flag="; content:"&userid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/count\.asp\?mac=[A-Z0-9]*&ver=.*&flag=.*&userid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001369; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_68 - regex: to_server:POST /site/hQGHuMEA\.php.*Accept: \*/\*, \S{4}.*data=.* detector_id: 1370
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_68"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/site/hQGHuMEA.php"; content:"Accept|3A| |2A|/|2A||2C| "; content:"data="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/site\/hQGHuMEA\.php.*Accept: \*\/\*, \S{4}.*data=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001370; rev:1002;)

# Command&Control: (Dropper) Harnig - regex: to_server:GET /progs_.*/[a-z]{5,10}/[a-z]{5,10}\.php\?adv=adv\d+.*Host: [a-z]*\.biz detector_id: 1372
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Harnig"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/progs_"; content:".php?adv=adv"; content:"Host|3A| "; content:".biz"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/progs_.*\/[a-z]{5,10}\/[a-z]{5,10}\.php\?adv=adv\d+.*Host: [a-z]*\.biz/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001372; rev:1004;)

# Command&Control: (Backdoor) Nuclear - regex: to_server:GET .*logger\.php\?action=.*&type=.*&host=.*&port=.*&name=.*&pc=.*&user=.*&ip=.*&version=.* detector_id: 1373
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Nuclear"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"logger.php?action="; content:"&type="; content:"&host="; content:"&port="; content:"&name="; content:"&pc="; content:"&user="; content:"&ip="; content:"&version="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*logger\.php\?action=.*&type=.*&host=.*&port=.*&name=.*&pc=.*&user=.*&ip=.*&version=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001373; rev:1004;)

# Command&Control: (Trojan) Grymegat - regex: to_server:GET /flower\.php\?id=.*&uid=.*&os=.*&vrs=.*&text=.*&Status=.* detector_id: 1374
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Grymegat"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/flower.php?id="; content:"&uid="; content:"&os="; content:"&vrs="; content:"&text="; content:"&Status="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/flower\.php\?id=.*&uid=.*&os=.*&vrs=.*&text=.*&Status=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001374; rev:1004;)

# Command&Control: (Backdoor) Wakeminap - regex: to_server:GET .*/device_.*\.asp\?device_t=\d{10}&key=.*&device_id=.*&cv=[a-z]{17} detector_id: 1376
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Wakeminap"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/device_"; content:".asp?device_t="; content:"&key="; content:"&device_id="; content:"&cv="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/device_.*\.asp\?device_t=\d{10}&key=.*&device_id=.*&cv=[a-z]{17}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001376; rev:1004;)

# Command&Control: (Backdoor) Wakeminap - regex: to_server:POST /images/.*\.asp\?device_t=.*&key=.*&device_id=.*&cv=.*.*connect_num=.*&tcp_port=\d*&device_result=.*&MM_update=.*&button_device_post=.* detector_id: 1377
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Wakeminap"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/images/"; content:".asp?device_t="; content:"&key="; content:"&device_id="; content:"&cv="; content:"connect_num="; content:"&tcp_port="; content:"&device_result="; content:"&MM_update="; content:"&button_device_post="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/images\/.*\.asp\?device_t=.*&key=.*&device_id=.*&cv=.*.*connect_num=.*&tcp_port=\d*&device_result=.*&MM_update=.*&button_device_post=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001377; rev:1004;)

# Command&Control: (Dropper) GenericDropper_81 - regex: to_server:GET /tbr/sbar\.exe\?id=\d{3} detector_id: 1378
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_81"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/tbr/sbar.exe?id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/tbr\/sbar\.exe\?id=\d{3}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001378; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_40 - regex: to_server:GET /\S*count/count\.asp\?mac=[a-f0-9]{12}&ver=\d{10} detector_id: 1379
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_40"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"count/count.asp?mac="; content:"&ver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\S*count\/count\.asp\?mac=[a-f0-9]{12}&ver=\d{10}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001379; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_41 - regex: to_server:GET /traff\d*/stat/uniq\.php\?adv=[a-z]{16}&num=[a-z]{7}.*User-Agent: IE 1\.0 detector_id: 1380
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_41"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/traff"; content:"/stat/uniq.php?adv="; content:"&num="; content:"User-Agent|3A| IE 1.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/traff\d*\/stat\/uniq\.php\?adv=[a-z]{16}&num=[a-z]{7}.*User-Agent: IE 1\.0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001380; rev:1004;)

# Command&Control: (Trojan) Opachki  - regex: to_server:POST /news/z\.php.*ch=\d detector_id: 1381
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Opachki "; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/news/z.php"; content:"ch="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/news\/z\.php.*ch=\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001381; rev:1004;)

# Command&Control: (TrojanProxy) Dugenpal - regex: to_server:POST /\+855\d\.html.*.*User-Agent: Mozilla detector_id: 1382
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (TrojanProxy) Dugenpal"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/|2B|855"; content:".html"; content:"User-Agent|3A| Mozilla"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\+855\d\.html.*.*User-Agent: Mozilla/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001382; rev:1004;)

# Command&Control: (Backdoor) Xema - regex: to_server:POST /cgi-bin/Owpq4\.cgi.* detector_id: 1383
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Xema"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/cgi-bin/Owpq4.cgi"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cgi-bin\/Owpq4\.cgi.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001383; rev:1004;)

# Adware: (Adware) Kraddare - regex: to_server:POST /mine_svc\.php.*_pi=.*&action=.*&mac=.*&dist=.*&nm=.*&adn=.*&ver=.*&win=.*&ie=.*&ck=.*&cwset=.*&ucode=.*&d=.*&_cache=.* detector_id: 1384
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Kraddare"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/mine_svc.php"; content:"_pi="; content:"&action="; content:"&mac="; content:"&dist="; content:"&nm="; content:"&adn="; content:"&ver="; content:"&win="; content:"&ie="; content:"&ck="; content:"&cwset="; content:"&ucode="; content:"&d="; content:"&_cache="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mine_svc\.php.*_pi=.*&action=.*&mac=.*&dist=.*&nm=.*&adn=.*&ver=.*&win=.*&ie=.*&ck=.*&cwset=.*&ucode=.*&d=.*&_cache=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001384; rev:1004;)

# Adware: (Adware) Kraddare - regex: to_server:POST /mine_report\.php.*_pi=.*&action=.*&mac=.*&dist=.*&nm=.*&adn=.*&ver=.*&win=.*&ie=.*&ck=.*&cwset=.*&ucode=.*&d=.*&_cache=.*&success=.*&errortype=.*&encdata=.* detector_id: 1385
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Kraddare"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/mine_report.php"; content:"_pi="; content:"&action="; content:"&mac="; content:"&dist="; content:"&nm="; content:"&adn="; content:"&ver="; content:"&win="; content:"&ie="; content:"&ck="; content:"&cwset="; content:"&ucode="; content:"&d="; content:"&_cache="; content:"&success="; content:"&errortype="; content:"&encdata="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mine_report\.php.*_pi=.*&action=.*&mac=.*&dist=.*&nm=.*&adn=.*&ver=.*&win=.*&ie=.*&ck=.*&cwset=.*&ucode=.*&d=.*&_cache=.*&success=.*&errortype=.*&encdata=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001385; rev:1004;)

# Adware: (Hoax) Pameseg - regex: to_server:POST /_sfx_api/params\.php\?aid=.* detector_id: 1386
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) Pameseg"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/_sfx_api/params.php?aid="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/_sfx_api\/params\.php\?aid=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001386; rev:1004;)

# Command&Control: (Trojan) Alureon - regex: to_server:GET /cgi-bin/get_exe\.pl\?adv=.*&p=.* detector_id: 1387
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Alureon"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cgi-bin/get_exe.pl?adv="; content:"&p="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cgi-bin\/get_exe\.pl\?adv=.*&p=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001387; rev:1004;)

# Command&Control: (Backdoor) GenericBackdoor_1 - regex: to_server:POST /post\.asp.*d=.*&p1=.*&p2=.*&p3=.*&p4=.*&p5=.* detector_id: 1388
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) GenericBackdoor_1"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/post.asp"; content:"d="; content:"&p1="; content:"&p2="; content:"&p3="; content:"&p4="; content:"&p5="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/post\.asp.*d=.*&p1=.*&p2=.*&p3=.*&p4=.*&p5=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001388; rev:1004;)

# FakeAV: KoreanFakeAV  - regex: to_server:GET /value\.php\?strID=.*&strPC=.*&strMode=.*&strSite=.*&strOS=.* detector_id: 1389
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: KoreanFakeAV "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/value.php?strID="; content:"&strPC="; content:"&strMode="; content:"&strSite="; content:"&strOS="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/value\.php\?strID=.*&strPC=.*&strMode=.*&strSite=.*&strOS=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001389; rev:1004;)

# Command&Control: (Trojan) Pluzoks - regex: to_server:GET /rank/update\.php\?pid=.*.*User-Agent: Mozilla/3\.0 \(compatible; Indy Library\) detector_id: 1390
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Pluzoks"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/rank/update.php?pid="; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/rank\/update\.php\?pid=.*.*User-Agent: Mozilla\/3\.0 \(compatible\; Indy Library\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001390; rev:1004;)

# Command&Control: (Trojan) Matcash - regex: to_server:GET /retadpu\.exe\?affID=\d+.*User-Agent: faserx detector_id: 1391
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Matcash"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/retadpu.exe?affID="; content:"User-Agent|3A| faserx"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/retadpu\.exe\?affID=\d+.*User-Agent: faserx/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001391; rev:1004;)

# Command&Control: (Backdoor) Farfli - regex: to_server:GET .*/.*\.php\?clid=[a-z0-9]*&conid=.*&ver=\d+ detector_id: 1392
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Farfli"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?clid="; content:"&conid="; content:"&ver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/.*\.php\?clid=[a-z0-9]*&conid=.*&ver=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001392; rev:722;)

# Command&Control: (Trojan) Koceg - regex: to_server:GET /.*\?&v=.*.*User-Agent: _ detector_id: 1393
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Koceg"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?&v="; content:"User-Agent|3A| _"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\?&v=.*.*User-Agent: _/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001393; rev:319;)

# Adware: (Hoax) Pameseg - regex: to_server:GET /new_p_f\.php\?sub_id=.*&user_id=.* detector_id: 1394
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) Pameseg"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/new_p_f.php?sub_id="; content:"&user_id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/new_p_f\.php\?sub_id=.*&user_id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001394; rev:1004;)

# Adware: (Adware) Eorezo  - regex: to_server:GET /cgi-bin/get_dyn_load\.cgi\?action_id=GET_.*&product_id=.*&ids=.* detector_id: 1395
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Eorezo "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cgi-bin/get_dyn_load.cgi?action_id=GET_"; content:"&product_id="; content:"&ids="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cgi-bin\/get_dyn_load\.cgi\?action_id=GET_.*&product_id=.*&ids=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001395; rev:1004;)

# Adware: (Adware) Eorezo - regex: to_server:GET /cgi-bin/get_dyn_load\.cgi\?action_id=GET_.*&product_id=.* detector_id: 1396
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Eorezo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cgi-bin/get_dyn_load.cgi?action_id=GET_"; content:"&product_id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cgi-bin\/get_dyn_load\.cgi\?action_id=GET_.*&product_id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001396; rev:1004;)

# Command&Control: (Dropper) Tibs - regex: to_server:GET /bin/read_i\.php\?a1=.*&a2=.*&a3=.*&a4=\+ detector_id: 1397
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Tibs"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bin/read_i.php?a1="; content:"&a2="; content:"&a3="; content:"&a4=|2B|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bin\/read_i\.php\?a1=.*&a2=.*&a3=.*&a4=\+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001397; rev:1004;)

# FakeAV: FraudPack - regex: to_server:GET /404\.php\?type=.*&affid=.*&subid=.*&iruns.*User-Agent: IE detector_id: 1398
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FraudPack"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/404.php?type="; content:"&affid="; content:"&subid="; content:"&iruns"; content:"User-Agent|3A| IE"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/404\.php\?type=.*&affid=.*&subid=.*&iruns.*User-Agent: IE/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001398; rev:1004;)

# Adware: (Adware) AdMatching - regex: to_server:GET /admatching/urlmatchlist.*\.php\?pid=ad\d*&cid=\d* detector_id: 1399
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) AdMatching"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/admatching/urlmatchlist"; content:".php?pid=ad"; content:"&cid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/admatching\/urlmatchlist.*\.php\?pid=ad\d*&cid=\d*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001399; rev:733;)

# Adware: (Adware) AdMatching - regex: to_server:GET /admatching/matchsitelist\.php\?pid=ad\d*&cid=525400123456\d* detector_id: 1400
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) AdMatching"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/admatching/matchsitelist.php?pid=ad"; content:"&cid=525400123456"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/admatching\/matchsitelist\.php\?pid=ad\d*&cid=525400123456\d*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001400; rev:1004;)

# Adware: (Adware) AdMatching - regex: to_server:GET /admatching/ovt_log\.php\?pid=(baseapp|ad\d*)&cid=\d*&type=[A-Z]{1} detector_id: 1401
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) AdMatching"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/admatching/ovt_log.php?pid="; content:"&cid="; content:"&type="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/admatching\/ovt_log\.php\?pid=(baseapp|ad\d*)&cid=\d*&type=[A-Z]{1}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001401; rev:1002;)

# Adware: (Adware) AdMatching - regex: to_server:GET /admatching/(info|update_nw)\.php\?pid=ad\d*&cid=\d* detector_id: 1402
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) AdMatching"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/admatching/"; content:".php?pid=ad"; content:"&cid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/admatching\/(info|update_nw)\.php\?pid=ad\d*&cid=\d*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001402; rev:1004;)

# Adware: (Adware) AdMatching - regex: to_server:GET /admatching/(update_mb|update)\.php\?pid=ad\d*&cid=\d* detector_id: 1403
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) AdMatching"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/admatching/"; content:".php?pid=ad"; content:"&cid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/admatching\/(update_mb|update)\.php\?pid=ad\d*&cid=\d*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001403; rev:1002;)

# Command&Control: (Trojan) Small - regex: to_server:GET /cgi-bin/rleadmin\.cgi\?getexe=.*.*User-Agent: EELoader.* detector_id: 1404
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Small"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cgi-bin/rleadmin.cgi?getexe="; content:"User-Agent|3A| EELoader"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cgi-bin\/rleadmin\.cgi\?getexe=.*.*User-Agent: EELoader.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001404; rev:1004;)

# Command&Control: (Banker) GenericBanker_8 - regex: to_server:POST /Avisar/informa\.php.*tabel=.*&name=.*.*User-Agent: Mozilla/3\.0 \(compatible; Indy Library\) detector_id: 1405
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_8"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/Avisar/informa.php"; content:"tabel="; content:"&name="; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Avisar\/informa\.php.*tabel=.*&name=.*.*User-Agent: Mozilla\/3\.0 \(compatible\; Indy Library\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001405; rev:1004;)

# Command&Control: (Backdoor) SixMuch - regex: to_server:GET /cike\.php\?fid=[a-z0-9]{3,4}&cid=[0-9A-F]{12}&ver=\d*&tid=\d*&sn=\d* detector_id: 1406
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) SixMuch"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cike.php?fid="; content:"&cid="; content:"&ver="; content:"&tid="; content:"&sn="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cike\.php\?fid=[a-z0-9]{3,4}&cid=[0-9A-F]{12}&ver=\d*&tid=\d*&sn=\d*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001406; rev:1004;)

# Command&Control: (Trojan) Flashback - regex: to_server:GET /owncheck/.*User-Agent: [0-9a-zA-Z]{48} detector_id: 1407
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Flashback"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/owncheck/"; content:"User-Agent|3A| "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/owncheck\/.*User-Agent: [0-9a-zA-Z]{48}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001407; rev:293;)

# Command&Control: (Trojan) StartPage - regex: to_server:POST /count/xml\.php.*appTitle=.*&strLink=.*&proFirstTime=.*&proLastTime=.*&proRunNum=\d&appName=.*&isAdvUser=.*&KillList=.* detector_id: 1408
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) StartPage"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/count/xml.php"; content:"appTitle="; content:"&strLink="; content:"&proFirstTime="; content:"&proLastTime="; content:"&proRunNum="; content:"&appName="; content:"&isAdvUser="; content:"&KillList="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/count\/xml\.php.*appTitle=.*&strLink=.*&proFirstTime=.*&proLastTime=.*&proRunNum=\d&appName=.*&isAdvUser=.*&KillList=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001408; rev:1004;)

# Adware: (Toolbar) Enumerate - regex: to_server:GET /cnt/index\.php\?pid=.*&type=\d.*User-Agent: HTTP detector_id: 1409
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Enumerate"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cnt/index.php?pid="; content:"&type="; content:"User-Agent|3A| HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cnt\/index\.php\?pid=.*&type=\d.*User-Agent: HTTP/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001409; rev:1004;)

# Adware: (Hoax) Pameseg  - regex: to_server:POST /_sfx_api/test\.php.*User-Agent: [a-z0-9]{10,} detector_id: 1410
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) Pameseg "; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/_sfx_api/test.php"; content:"User-Agent|3A| "; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/_sfx_api\/test\.php.*User-Agent: [a-z0-9]{10,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001410; rev:1004;)

# Command&Control: (Backdoor) Xema - regex: to_server:POST /cgi-bin/Clnpp5\.cgi.*/Cmwhite detector_id: 1411
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Xema"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/cgi-bin/Clnpp5.cgi"; content:"/Cmwhite"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cgi-bin\/Clnpp5\.cgi.*\/Cmwhite/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001411; rev:1004;)

# Command&Control: (Dropper) GenericDropper_75 - regex: to_server:GET .*/admin\.php\?1=[A-F0-9]{16}&v=\d&q=\d&b=.*User-Agent: Mozilla/4\.0 \(compatible; Synapse\) detector_id: 1412
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_75"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/admin.php?1="; content:"&v="; content:"&q="; content:"&b="; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| Synapse|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/admin\.php\?1=[A-F0-9]{16}&v=\d&q=\d&b=.*User-Agent: Mozilla\/4\.0 \(compatible\; Synapse\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001412; rev:1004;)

# Command&Control: (Backdoor) GenericBackdoor_2 - regex: to_server:GET /xjl/mmcount\.aspx\?mm=.*&randcode=.*.*User-Agent: ([a-z0-9]{9,}|helper) detector_id: 1413
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) GenericBackdoor_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/xjl/mmcount.aspx?mm="; content:"&randcode="; content:"User-Agent|3A| "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/xjl\/mmcount\.aspx\?mm=.*&randcode=.*.*User-Agent: ([a-z0-9]{9,}|helper)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001413; rev:501;)

# FakeAV: GenericFakeAV_10 - regex: to_server:GET /bbs/m_read\.php\?AxT92yP=.*&GQsb3Nn=.* detector_id: 1414
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_10"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bbs/m_read.php?AxT92yP="; content:"&GQsb3Nn="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bbs\/m_read\.php\?AxT92yP=.*&GQsb3Nn=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001414; rev:1004;)

# Command&Control: (Banker) Banload - regex: to_server:POST /log\.php\?tipo=.*&nome=wXP_.*\.txt detector_id: 1415
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Banload"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/log.php?tipo="; content:"&nome=wXP_"; content:".txt"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/log\.php\?tipo=.*&nome=wXP_.*\.txt/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001415; rev:1004;)

# Command&Control: (Trojan) Matsnu - regex: to_server:GET /(UTP402HEAD|typo3|guest)\.php\?ltype=.*&ccr=.*&id=.*&stat=.*&ver=\d*&loc=.*&os=.* detector_id: 1416
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Matsnu"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?ltype="; content:"&ccr="; content:"&id="; content:"&stat="; content:"&ver="; content:"&loc="; content:"&os="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(UTP402HEAD|typo3|guest)\.php\?ltype=.*&ccr=.*&id=.*&stat=.*&ver=\d*&loc=.*&os=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001416; rev:514;)

# FakeAV: WinFixer - regex: to_server:GET /.*\?action=\d{1,2}&type=.*&pc_id=.*&abbr=.* detector_id: 1417
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: WinFixer"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?action="; content:"&type="; content:"&pc_id="; content:"&abbr="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\?action=\d{1,2}&type=.*&pc_id=.*&abbr=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001417; rev:409;)

# Command&Control: (Trojan) Tobfy Ransomware - regex: to_server:GET /get\.php\?i=\d+.*Host: [a-z]{9,}\.[a-z]{9,}\.info detector_id: 1418
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Tobfy Ransomware"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get.php?i="; content:"Host|3A| "; content:".info"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get\.php\?i=\d+.*Host: [a-z]{9,}\.[a-z]{9,}\.info/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001418; rev:1004;)

# Adware: (Adware) WindViewer - regex: to_server:GET .*/report_exe\.php\?idt=.*&pid=.*&mac=.*&code=.*&ver=.*&firstrun=.*&ndt=.*&appname=wind.*&recovery=.* detector_id: 1419
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) WindViewer"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/report_exe.php?idt="; content:"&pid="; content:"&mac="; content:"&code="; content:"&ver="; content:"&firstrun="; content:"&ndt="; content:"&appname=wind"; content:"&recovery="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/report_exe\.php\?idt=.*&pid=.*&mac=.*&code=.*&ver=.*&firstrun=.*&ndt=.*&appname=wind.*&recovery=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001419; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_11 - regex: to_server:GET /forum/search\.php\?method=(checkport|all|ping|exe|cfg)&mode=.*&v=.*&sox=.*&lport=.*&rsid=.*&slots=.*&spm= detector_id: 1420
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_11"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/forum/search.php?method="; content:"&mode="; content:"&v="; content:"&sox="; content:"&lport="; content:"&rsid="; content:"&slots="; content:"&spm="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/forum\/search\.php\?method=(checkport|all|ping|exe|cfg)&mode=.*&v=.*&sox=.*&lport=.*&rsid=.*&slots=.*&spm=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001420; rev:484;)

# FakeAV: FakeSysdef  - regex: to_server:POST .*/bos/up\.php.*name=pc\d detector_id: 1421
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeSysdef "; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/bos/up.php"; content:"name=pc"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/bos\/up\.php.*name=pc\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001421; rev:1004;)

# Adware: (Toolbar) WinAgir - regex: to_server:GET /do\.php\?a=[a-z0-9]*&st=A detector_id: 1422
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) WinAgir"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/do.php?a="; content:"&st=A"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/do\.php\?a=[a-z0-9]*&st=A/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001422; rev:1004;)

# Command&Control: (Dropper) GenericDropper_76 - regex: to_server:POST /get\.cgi.*134068cb289c2b820= detector_id: 1423
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_76"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/get.cgi"; content:"134068cb289c2b820="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get\.cgi.*134068cb289c2b820=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001423; rev:1004;)

# Adware: (Adware) SoftwareInformer - regex: to_server:GET /log\.php\?id=\d+.*User-Agent: FDMuiless detector_id: 1424
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) SoftwareInformer"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/log.php?id="; content:"User-Agent|3A| FDMuiless"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/log\.php\?id=\d+.*User-Agent: FDMuiless/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001424; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_43 - regex: to_server:GET /GetIpInfo\.aspx\?act=\d+.*User-Agent: C Technology detector_id: 1425
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_43"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/GetIpInfo.aspx?act="; content:"User-Agent|3A| C Technology"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/GetIpInfo\.aspx\?act=\d+.*User-Agent: C Technology/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001425; rev:1004;)

# Adware: (Adware) Kraddare - regex: to_server:GET /mine_down\.php\?_pi=.*&type=.*&dist=.*&nm=.*&ver=.*&_cache=.* detector_id: 1428
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Kraddare"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mine_down.php?_pi="; content:"&type="; content:"&dist="; content:"&nm="; content:"&ver="; content:"&_cache="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mine_down\.php\?_pi=.*&type=.*&dist=.*&nm=.*&ver=.*&_cache=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001428; rev:1004;)

# Command&Control: (ClickBot) GenericClickBot_4 - regex: to_server:GET /bf/click/click\?gid=\d{5}&mid=xiaogb detector_id: 1429
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (ClickBot) GenericClickBot_4"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bf/click/click?gid="; content:"&mid=xiaogb"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bf\/click\/click\?gid=\d{5}&mid=xiaogb/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001429; rev:378;)

# Command&Control: (Trojan) Egapel - regex: to_server:POST /index\.php.*Cs\d+.*z.*Content-Type: application/hprose detector_id: 1430
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Egapel"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/index.php"; content:"Cs"; content:"Content-Type|3A| application/hprose"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php.*Cs\d+.*z.*Content-Type: application\/hprose/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001430; rev:1004;)

# Adware: (Hoax) Pameseg - regex: to_server:GET /functions/soft_zf\.php\?name=.*&fname=.*.*User-Agent: JEDI-VCL detector_id: 1432
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) Pameseg"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/functions/soft_zf.php?name="; content:"&fname="; content:"User-Agent|3A| JEDI-VCL"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/functions\/soft_zf\.php\?name=.*&fname=.*.*User-Agent: JEDI-VCL/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001432; rev:1004;)

# Command&Control: (MDN) Yadro - regex: to_server:GET /hit;click5\?q detector_id: 1433
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (MDN) Yadro"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/hit|3B|click5?q"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/hit\;click5\?q/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001433; rev:300;)

# Adware: (Toolbar) SideTab - regex: to_server:GET /install\.asp\?version=.*&id=.*&mac=.*.*User-Agent: microsoft detector_id: 1434
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) SideTab"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/install.asp?version="; content:"&id="; content:"&mac="; content:"User-Agent|3A| microsoft"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/install\.asp\?version=.*&id=.*&mac=.*.*User-Agent: microsoft/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001434; rev:1004;)

# Command&Control: (Trojan) Banload - regex: to_server:GET /contador\.php\?p=\d+ detector_id: 1435
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Banload"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/contador.php?p="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/contador\.php\?p=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001435; rev:1004;)

# Adware: (Adware) GenericAdware_5 - regex: to_server:GET /check_counter\.php\?pi=.*&gu=.*&ac=.* detector_id: 1436
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) GenericAdware_5"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/check_counter.php?pi="; content:"&gu="; content:"&ac="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/check_counter\.php\?pi=.*&gu=.*&ac=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001436; rev:1004;)

# Command&Control: (Dropper) GenericDropper_58 - regex: to_server:GET /\?&publicid=.{36}&domainname=.*User-Agent: - detector_id: 1437
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_58"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?&publicid="; content:"&domainname="; content:"User-Agent|3A| -"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?&publicid=.{36}&domainname=.*User-Agent: -/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001437; rev:378;)

# Command&Control: (Trojan) GenericTrojan_11 - regex: to_server:GET /forum/search\.php\?method=(validate|isup)&mode=.*&v=.*&sox= detector_id: 1438
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_11"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/forum/search.php?method="; content:"&mode="; content:"&v="; content:"&sox="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/forum\/search\.php\?method=(validate|isup)&mode=.*&v=.*&sox=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001438; rev:1002;)

# Command&Control: (Banker) GenericBanker_3  - regex: to_server:POST /(14IrgWK|UYk4gQ).*op=IncluirAvisos&HostBD=.*&SenhaBD=.*&UsuarioBD=.*&DatabaseBD=.*&sgdb= detector_id: 1439
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_3 "; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"op=IncluirAvisos&HostBD="; content:"&SenhaBD="; content:"&UsuarioBD="; content:"&DatabaseBD="; content:"&sgdb="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(14IrgWK|UYk4gQ).*op=IncluirAvisos&HostBD=.*&SenhaBD=.*&UsuarioBD=.*&DatabaseBD=.*&sgdb=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001439; rev:562;)

# Adware: (Adware) WdSearch - regex: to_server:GET .*\.php\?ver=\d,.*&instdate=.*&pid=.*A~&mac=.* detector_id: 1441
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) WdSearch"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?ver="; content:"&instdate="; content:"&pid="; content:"A|7E|&mac="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php\?ver=\d,.*&instdate=.*&pid=.*A~&mac=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001441; rev:1004;)

# Command&Control: (Backdoor) Draggdor - regex: to_server:GET /aptitude/login\.asp\?admin_un=.* detector_id: 1442
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Draggdor"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/aptitude/login.asp?admin_un="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/aptitude\/login\.asp\?admin_un=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001442; rev:1004;)

# Adware: (Adware) Kraddare ClickPang - regex: to_server:POST /c/c\.php.*m=.*&mac=.*&f=.*.*User-Agent: User-Agent:.* detector_id: 1443
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Kraddare ClickPang"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/c/c.php"; content:"m="; content:"&mac="; content:"&f="; content:"User-Agent|3A| User-Agent|3A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/c\/c\.php.*m=.*&mac=.*&f=.*.*User-Agent: User-Agent:.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001443; rev:1004;)

# Command&Control: (TrojanProxy) Repsamo - regex: to_server:GET /(countme|takeme2)/\?a=\d&b=.*&c=\d+&d=.*&sid=[A-Z0-9]+&now detector_id: 1444
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (TrojanProxy) Repsamo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?a="; content:"&b="; content:"&c="; content:"&d="; content:"&sid="; content:"&now"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(countme|takeme2)\/\?a=\d&b=.*&c=\d+&d=.*&sid=[A-Z0-9]+&now/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001444; rev:535;)

# Command&Control: (Banker) Banbra - regex: to_server:POST /freedos\.php.*subject=Administrator detector_id: 1445
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Banbra"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/freedos.php"; content:"subject=Administrator"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/freedos\.php.*subject=Administrator/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001445; rev:1004;)

# Command&Control: (Dropper) Karagany - regex: to_server:GET /showthread\.php\?t=\d{6}.*Host: [a-z0-9]{2,}\.(cz|cu|vv)\.cc.*Connection: Keep-Alive detector_id: 1446
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Karagany"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/showthread.php?t="; content:"Host|3A| "; content:".cc"; content:"Connection|3A| Keep-Alive"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/showthread\.php\?t=\d{6}.*Host: [a-z0-9]{2,}\.(cz|cu|vv)\.cc.*Connection: Keep-Alive/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001446; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_45 - regex: to_server:POST .*/InsertCliente\.php HTTP.*IP=.*&LOGIN=.*&PASS=.*&USER=.*&NAME_CLIENTE=.*&CIDADE_CLIENTE=.*&ESTADO_CLIENTE=.*&PAIS_CLIENTE=.*&IP_CLIENTE=.*&NET_CLIENTE=.*&MAC_CLIENTE=.*&VOL_CLIENTE=.*&W_CLIENTE=.*&IE_CLIENTE= detector_id: 1447
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_45"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/InsertCliente.php HTTP"; content:"IP="; content:"&LOGIN="; content:"&PASS="; content:"&USER="; content:"&NAME_CLIENTE="; content:"&CIDADE_CLIENTE="; content:"&ESTADO_CLIENTE="; content:"&PAIS_CLIENTE="; content:"&IP_CLIENTE="; content:"&NET_CLIENTE="; content:"&MAC_CLIENTE="; content:"&VOL_CLIENTE="; content:"&W_CLIENTE="; content:"&IE_CLIENTE="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/InsertCliente\.php HTTP.*IP=.*&LOGIN=.*&PASS=.*&USER=.*&NAME_CLIENTE=.*&CIDADE_CLIENTE=.*&ESTADO_CLIENTE=.*&PAIS_CLIENTE=.*&IP_CLIENTE=.*&NET_CLIENTE=.*&MAC_CLIENTE=.*&VOL_CLIENTE=.*&W_CLIENTE=.*&IE_CLIENTE=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001447; rev:493;)

# Command&Control: (Dropper) Karagany Post-Checkin - regex: to_server:GET /cnt\.php\?e=\d*&u=.*&r=.*&sz=.*&uid=\d* detector_id: 1448
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Karagany Post-Checkin"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cnt.php?e="; content:"&u="; content:"&r="; content:"&sz="; content:"&uid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cnt\.php\?e=\d*&u=.*&r=.*&sz=.*&uid=\d*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001448; rev:1004;)

# Click-Fraud: GenericClickFraud  - regex: to_server:GET /api/work\.aspx\?cmd=[A-Z0-9]{30,} detector_id: 1449
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Click-Fraud: GenericClickFraud "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/api/work.aspx?cmd="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/work\.aspx\?cmd=[A-Z0-9]{30,}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001449; rev:1004;)

# Command&Control: (Banker) GenericBanker_14 - regex: to_server:POST /site/tamplet1\.php.*operacao=.*&data=.*&versao=.*&mac=.*&pc=.*& detector_id: 1450
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_14"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/site/tamplet1.php"; content:"operacao="; content:"&data="; content:"&versao="; content:"&mac="; content:"&pc="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/site\/tamplet1\.php.*operacao=.*&data=.*&versao=.*&mac=.*&pc=.*&/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001450; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_46 - regex: to_server:POST /ipcool/p\.asp.*d22=.*Host: .*:(99|8181) detector_id: 1451
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_46"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ipcool/p.asp"; content:"d22="; content:"Host|3A| "; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ipcool\/p\.asp.*d22=.*Host: .*:(99|8181)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001451; rev:1004;)

# Command&Control: (Keylogger) Sisron - regex: to_server:GET /tongji/123321/count\.asp\?mac=.*&iever=.*&os=.* detector_id: 1452
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Keylogger) Sisron"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/tongji/123321/count.asp?mac="; content:"&iever="; content:"&os="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/tongji\/123321\/count\.asp\?mac=.*&iever=.*&os=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001452; rev:1004;)

# Command&Control: (Dropper) Netins - regex: to_server:POST /(gateway|interface)\.asp.*User-Agent: \(CustomSpy\).*count=.*&data=.*&copy=.*&info= detector_id: 1453
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Netins"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".asp"; content:"User-Agent|3A| |28|CustomSpy|29|"; content:"count="; content:"&data="; content:"&copy="; content:"&info="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(gateway|interface)\.asp.*User-Agent: \(CustomSpy\).*count=.*&data=.*&copy=.*&info=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001453; rev:515;)

# Command&Control: (Keylogger) GenericKeylogger Cradex - regex: to_server:POST /veri/send\.php.*to=.*&cap=Cradex.*&msg=.* detector_id: 1454
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Keylogger) GenericKeylogger Cradex"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/veri/send.php"; content:"to="; content:"&cap=Cradex"; content:"&msg="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/veri\/send\.php.*to=.*&cap=Cradex.*&msg=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001454; rev:1004;)

# Command&Control: (Keylogger) MyKeyloggerOnline - regex: to_server:POST /log\.php.*User-Agent: Internet Explorer.*m=.*&u=.*&s=.*&d=.* detector_id: 1455
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Keylogger) MyKeyloggerOnline"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/log.php"; content:"User-Agent|3A| Internet Explorer"; content:"m="; content:"&u="; content:"&s="; content:"&d="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/log\.php.*User-Agent: Internet Explorer.*m=.*&u=.*&s=.*&d=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001455; rev:722;)

# Command&Control: (Dropper) GenericDropper_60 - regex: to_server:GET /videos/sky\d*/skydl\d*\.php\?cid=[a-z0-9]{16}&id=.*&file=.*\.exe detector_id: 1456
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_60"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/videos/sky"; content:"/skydl"; content:".php?cid="; content:"&id="; content:"&file="; content:".exe"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/videos\/sky\d*\/skydl\d*\.php\?cid=[a-z0-9]{16}&id=.*&file=.*\.exe/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001456; rev:1004;)

# Command&Control: (Banker) GenericBanker_9 - regex: to_server:GET //update/rb\.php\?hello detector_id: 1457
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_9"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"//update/rb.php?hello"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\/update\/rb\.php\?hello/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001457; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_47 - regex: to_server:GET /tagger\.php\?id=.*&name=.*&version=\d\.\d\.\d.*User-Agent: http.* detector_id: 1458
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_47"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/tagger.php?id="; content:"&name="; content:"&version="; content:"User-Agent|3A| http"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/tagger\.php\?id=.*&name=.*&version=\d\.\d\.\d.*User-Agent: http.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001458; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_48 - regex: to_server:GET /jsp/dis\.jsp\?cmd=w&p=\d{4} detector_id: 1459
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_48"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/jsp/dis.jsp?cmd=w&p="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/jsp\/dis\.jsp\?cmd=w&p=\d{4}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001459; rev:1004;)

# Command&Control: (PasswordStealer) Alipay - regex: to_server:GET /msg\.asp\?Uid=[a-z0-9]{8}-[a-z0-9]{8}-[a-z0-9]{8}-[a-z0-9]{8} detector_id: 1460
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (PasswordStealer) Alipay"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/msg.asp?Uid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/msg\.asp\?Uid=[a-z0-9]{8}-[a-z0-9]{8}-[a-z0-9]{8}-[a-z0-9]{8}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001460; rev:1004;)

# Command&Control: (Ransomware) Blocker - regex: to_server:GET .*\?id=[A-Z0-9]*&compname=.*&os=.*&interval=.*&memory=.*&processor=.*&webcam=.* detector_id: 1461
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) Blocker"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?id="; content:"&compname="; content:"&os="; content:"&interval="; content:"&memory="; content:"&processor="; content:"&webcam="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\?id=[A-Z0-9]*&compname=.*&os=.*&interval=.*&memory=.*&processor=.*&webcam=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001461; rev:350;)

# Command&Control: (Trojan) GenericTrojan_49 - regex: to_server:GET /[Cc]ount1\.asp\?info=TWFj detector_id: 1462
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_49"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"ount1.asp?info=TWFj"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[Cc]ount1\.asp\?info=TWFj/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001462; rev:523;)

# Adware: (Toolbar) Adkubru - regex: to_server:POST /install\.php.*i=.*&source=bundle&timestamp=\d.*&product=.*&sign= detector_id: 1463
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Adkubru"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/install.php"; content:"i="; content:"&source=bundle&timestamp="; content:"&product="; content:"&sign="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/install\.php.*i=.*&source=bundle&timestamp=\d.*&product=.*&sign=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001463; rev:1004;)

# FakeAV: GenericFakeAV_3 - regex: to_server:GET /api/ping\?stage=\d&uid=[a-z0-9]{30} detector_id: 1464
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/api/ping?stage="; content:"&uid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/ping\?stage=\d&uid=[a-z0-9]{30}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001464; rev:421;)

# Command&Control: (Trojan) ZeroAccess - regex: to_server:GET /count\.php\?id=\d*&c=\d+&d=\d+&s=.*User-Agent: Opera/9 detector_id: 1465
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZeroAccess"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/count.php?id="; content:"&c="; content:"&d="; content:"&s="; content:"User-Agent|3A| Opera/9"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/count\.php\?id=\d*&c=\d+&d=\d+&s=.*User-Agent: Opera\/9/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001465; rev:733;)

# Command&Control: (Banker) GenericBanker_10 - regex: to_server:GET .*/infect/inf\d*/\?chave=xchave&url=pc.* detector_id: 1466
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_10"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/infect/inf"; content:"/?chave=xchave&url=pc"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/infect\/inf\d*\/\?chave=xchave&url=pc.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001466; rev:377;)

# Command&Cntrol: (Trojan) Banload - regex: to_server:POST .*rkoy\.php.*arq=.*&condicao=cmtk&texto=.* detector_id: 1467
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Cntrol: (Trojan) Banload"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"rkoy.php"; content:"arq="; content:"&condicao=cmtk&texto="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*rkoy\.php.*arq=.*&condicao=cmtk&texto=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001467; rev:1004;)

# Click-Fraud: GenericClickFraud_1 - regex: to_server:GET /popup\.do\?cmd=redirect_list.*Mozilla/3\.0 \(compatible; Indy Library\) detector_id: 1468
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Click-Fraud: GenericClickFraud_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/popup.do?cmd=redirect_list"; content:"Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/popup\.do\?cmd=redirect_list.*Mozilla\/3\.0 \(compatible\; Indy Library\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001468; rev:1004;)

# Adware: (Hoax) ArchSMS - regex: to_server:GET /c1/app_launch\.php\?id_user=.*&id_flow=.*&id_project=.*&id_dwn=\d+ detector_id: 1469
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) ArchSMS"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/c1/app_launch.php?id_user="; content:"&id_flow="; content:"&id_project="; content:"&id_dwn="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/c1\/app_launch\.php\?id_user=.*&id_flow=.*&id_project=.*&id_dwn=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001469; rev:1004;)

# Command&Control: (Trojan) Yeltminky - regex: to_server:POST .*[Cc]ount\.asp.*Mac=.*&Os=.*&Ver=.*&Key=.*.*User-Agent: MyApp detector_id: 1470
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Yeltminky"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"ount.asp"; content:"Mac="; content:"&Os="; content:"&Ver="; content:"&Key="; content:"User-Agent|3A| MyApp"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*[Cc]ount\.asp.*Mac=.*&Os=.*&Ver=.*&Key=.*.*User-Agent: MyApp/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001470; rev:1002;)

# Command&Control: (Trojan) StartPage - regex: to_server:POST /count/xml\.php.*appTitle=.*&strLink=.*&proFirstTime=.*&proLastTime=.*&proRunNum=.*&appName=.*&default_Url=.*&isAdvUser=.*& detector_id: 1471
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) StartPage"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/count/xml.php"; content:"appTitle="; content:"&strLink="; content:"&proFirstTime="; content:"&proLastTime="; content:"&proRunNum="; content:"&appName="; content:"&default_Url="; content:"&isAdvUser="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/count\/xml\.php.*appTitle=.*&strLink=.*&proFirstTime=.*&proLastTime=.*&proRunNum=.*&appName=.*&default_Url=.*&isAdvUser=.*&/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001471; rev:1004;)

# Adware: (Adware) CouponAmazing - regex: to_server:POST /log HTTP.*User-Agent: NSIS_Inetc.*a=\d{1,2}&g=[A-F0-9\-]{36}&s=.*&t=\d detector_id: 1472
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) CouponAmazing"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/log HTTP"; content:"User-Agent|3A| NSIS_Inetc"; content:"a="; content:"&g="; content:"&s="; content:"&t="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/log HTTP.*User-Agent: NSIS_Inetc.*a=\d{1,2}&g=[A-F0-9\-]{36}&s=.*&t=\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001472; rev:477;)

# Command&Control: (Trojan) Ertfor - regex: to_server:GET /[a-z]{2}/[a-z]{2}\.php\?ver=H\d HTTP.*User-Agent: Mozilla/4\.0 \(SPGK\) detector_id: 1473
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ertfor"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?ver=H"; content:" HTTP"; content:"User-Agent|3A| Mozilla/4.0 |28|SPGK|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{2}\/[a-z]{2}\.php\?ver=H\d HTTP.*User-Agent: Mozilla\/4\.0 \(SPGK\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001473; rev:516;)

# Command&Control: (Trojan) StartPage - regex: to_server:POST /count/xml\.php.*appTitle=.*&strLink=.*&proRunNum=.*&appName=.*&default_Url=.*&isAdvUser=.*&KillList=.*& detector_id: 1474
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) StartPage"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/count/xml.php"; content:"appTitle="; content:"&strLink="; content:"&proRunNum="; content:"&appName="; content:"&default_Url="; content:"&isAdvUser="; content:"&KillList="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/count\/xml\.php.*appTitle=.*&strLink=.*&proRunNum=.*&appName=.*&default_Url=.*&isAdvUser=.*&KillList=.*&/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001474; rev:1004;)

# Command&Control: (Ransomware) LockScreen - regex: to_server:GET /ftsri\.php\?get&(version|exe|download).*User-Agent: fortis detector_id: 1475
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) LockScreen"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ftsri.php?get&"; content:"User-Agent|3A| fortis"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ftsri\.php\?get&(version|exe|download).*User-Agent: fortis/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001475; rev:1004;)

# Command&Control: (Ransomware) LockScreen - regex: to_server:GET /ftsri\.php\?get&module=.* detector_id: 1476
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) LockScreen"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ftsri.php?get&module="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ftsri\.php\?get&module=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001476; rev:1004;)

# Command&Control: (Trojan) Virut_4 - regex: to_server:POST /adm/statzbot\.php.*username=.*&winwer=.*&id=.* detector_id: 1477
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Virut_4"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/adm/statzbot.php"; content:"username="; content:"&winwer="; content:"&id="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/adm\/statzbot\.php.*username=.*&winwer=.*&id=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001477; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_50 - regex: to_server:GET /plug/doSelect\.asp\?CMD=[A-Z0-9]{34} detector_id: 1478
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_50"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/plug/doSelect.asp?CMD="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/plug\/doSelect\.asp\?CMD=[A-Z0-9]{34}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001478; rev:1004;)

# Adware: (Downware) CnsMin - regex: to_server:GET /download/autolive\.ini\?0\|CF83&t=\d* detector_id: 1479
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) CnsMin"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/download/autolive.ini?0|7C|CF83&t="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/download\/autolive\.ini\?0\|CF83&t=\d*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001479; rev:1004;)

# Command&Control: (Trojan) Hitpop - regex: to_server:GET .*/mydown\.asp\?reg=.*&ver=.*&tgid=.*&address=.*&mydo=.*&flag=.* detector_id: 1480
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Hitpop"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mydown.asp?reg="; content:"&ver="; content:"&tgid="; content:"&address="; content:"&mydo="; content:"&flag="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/mydown\.asp\?reg=.*&ver=.*&tgid=.*&address=.*&mydo=.*&flag=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001480; rev:1004;)

# Command&Control: (Backdoor) DarkHole - regex: to_server:GET .*/\?uid=\d{5,8}&ver=[A-Za-z0-9]{5} HTTP.*User-Agent: darkness detector_id: 1481
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) DarkHole"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?uid="; content:"&ver="; content:" HTTP"; content:"User-Agent|3A| darkness"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/\?uid=\d{5,8}&ver=[A-Za-z0-9]{5} HTTP.*User-Agent: darkness/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001481; rev:707;)

# Adware: (Adware) GenericAdware_8 IESignKey - regex: to_server:GET /app_new/.*_new\.php\?u=.*&a=.*&m=.*&s=.*\d*&aff=.* detector_id: 1482
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) GenericAdware_8 IESignKey"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/app_new/"; content:"_new.php?u="; content:"&a="; content:"&m="; content:"&s="; content:"&aff="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/app_new\/.*_new\.php\?u=.*&a=.*&m=.*&s=.*\d*&aff=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001482; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_51 - regex: to_server:GET /clientregister\.php\?type=EXE&uniqid=\d{20}&winver=.*&version=.*&compusername=.*&compnetname=.* detector_id: 1483
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_51"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/clientregister.php?type=EXE&uniqid="; content:"&winver="; content:"&version="; content:"&compusername="; content:"&compnetname="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/clientregister\.php\?type=EXE&uniqid=\d{20}&winver=.*&version=.*&compusername=.*&compnetname=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001483; rev:1004;)

# Command&Control: (Dropper) GenericDropper_61 - regex: to_server:GET /data\.asp\?rnd=\d,\d{6}.*&antisp=\d detector_id: 1484
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_61"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/data.asp?rnd="; content:"&antisp="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/data\.asp\?rnd=\d,\d{6}.*&antisp=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001484; rev:1004;)

# Command&Control: (Trojan) Mepaow - regex: to_server:GET /config/update3\.asp\?action=yes detector_id: 1485
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Mepaow"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/config/update3.asp?action=yes"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/config\/update3\.asp\?action=yes/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001485; rev:1004;)

# Command&Control: (Trojan) Kontou - regex: to_server:POST /file/index\.php.*save=.*&computer=.*&user=.*&filename=.*&data= detector_id: 1486
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Kontou"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/file/index.php"; content:"save="; content:"&computer="; content:"&user="; content:"&filename="; content:"&data="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/file\/index\.php.*save=.*&computer=.*&user=.*&filename=.*&data=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001486; rev:1004;)

# Command&Control: (Trojan) Daws - regex: to_server:GET /list\.php\?db=kbaksan_\d&p=\d detector_id: 1487
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Daws"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/list.php?db=kbaksan_"; content:"&p="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/list\.php\?db=kbaksan_\d&p=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001487; rev:1004;)

# Command&Control: (Trojan) Daws - regex: to_server:POST /write\.php.*[snip].*db=kbaksan_\d&ch=19 detector_id: 1488
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Daws"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/write.php"; content:"db=kbaksan_"; content:"&ch=19"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/write\.php.*[snip].*db=kbaksan_\d&ch=19/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001488; rev:1004;)

# Adware: (Toolbar) ArcadeWeb  - regex: to_server:GET /psconf\.php\?qs=cHNpZD.* detector_id: 1489
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) ArcadeWeb "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/psconf.php?qs=cHNpZD"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/psconf\.php\?qs=cHNpZD.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001489; rev:1004;)

# Command&Control: (Trojan) StartPage - regex: to_server:POST /count/yx85\.php.*APPname=.*&appTitle=.*&defaultUrl=.*& detector_id: 1491
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) StartPage"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/count/yx85.php"; content:"APPname="; content:"&appTitle="; content:"&defaultUrl="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/count\/yx85\.php.*APPname=.*&appTitle=.*&defaultUrl=.*&/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001491; rev:1004;)

# Command&Control: (Trojan) Dursg - regex: to_server:GET /tools/parser\.php\?user.*id=.*&pcid=.*&OS=.*&key.*name=.*&add.* detector_id: 1492
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Dursg"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/tools/parser.php?user"; content:"id="; content:"&pcid="; content:"&OS="; content:"&key"; content:"name="; content:"&add"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/tools\/parser\.php\?user.*id=.*&pcid=.*&OS=.*&key.*name=.*&add.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001492; rev:1004;)

# Command&Control: (Trojan) Collti - regex: to_server:POST /act_002\.php.*[A-Za-z0-9\+/]*={0,2} detector_id: 1493
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Collti"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/act_002.php"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/act_002\.php.*[A-Za-z0-9\+\/]*={0,2}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001493; rev:1004;)

# Adware: (Adware) Hebogo - regex: to_server:GET /Config/ServerList\.asp\?uno=\d+ detector_id: 1494
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Hebogo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Config/ServerList.asp?uno="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Config\/ServerList\.asp\?uno=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001494; rev:1004;)

# Command&Control: (PasswordStealer) Kapod - regex: to_server:GET /regsid\.php\?windows_name=.*&email_name=.*&email_address=.*@.*&url_a=.* detector_id: 1495
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (PasswordStealer) Kapod"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/regsid.php?windows_name="; content:"&email_name="; content:"&email_address="; content:"&url_a="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/regsid\.php\?windows_name=.*&email_name=.*&email_address=.*@.*&url_a=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001495; rev:1004;)

# Adware: (Hoax) ArchSMS - regex: to_server:GET /.*/app_launch\.php\?id_user=.*&enc_potok=.*&id_project=.*&id_dwn=\d+ detector_id: 1496
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) ArchSMS"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/app_launch.php?id_user="; content:"&enc_potok="; content:"&id_project="; content:"&id_dwn="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\/app_launch\.php\?id_user=.*&enc_potok=.*&id_project=.*&id_dwn=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001496; rev:1004;)

# Command&Control: (Trojan) Magania - regex: to_server:GET .*count\.asp\?mac=.*&userid=.*&jinchengshu=\d*.*Host: .*:8081 detector_id: 1497
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Magania"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"count.asp?mac="; content:"&userid="; content:"&jinchengshu="; content:"Host|3A| "; content:"|3A|8081"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*count\.asp\?mac=.*&userid=.*&jinchengshu=\d*.*Host: .*:8081/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001497; rev:1004;)

# Command&Control: (Banker) GenericBanker_11 - regex: to_server:POST /getfile3\.php\?slots=.*&value1=\d&value2=\d detector_id: 1498
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_11"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/getfile3.php?slots="; content:"&value1="; content:"&value2="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/getfile3\.php\?slots=.*&value1=\d&value2=\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001498; rev:1004;)

# Command&Control: (Ransomware) Reveton - regex: to_server:POST /sol\.php.*uuid=[a-z0-9]*&os=.* detector_id: 1499
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) Reveton"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/sol.php"; content:"uuid="; content:"&os="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/sol\.php.*uuid=[a-z0-9]*&os=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001499; rev:1004;)

# Adware: (Adware) GenericAdware_9 - regex: to_server:GET /log/.*\?modeAct=.*&imac=\d*&icode=.* detector_id: 1501
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) GenericAdware_9"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/log/"; content:"?modeAct="; content:"&imac="; content:"&icode="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/log\/.*\?modeAct=.*&imac=\d*&icode=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001501; rev:377;)

# Adware: (Downware) MultiBar - regex: to_server:GET /\d+/\?wmid=.*&act=getinstinfo&ref=.*&lang=.*&pbm=.* detector_id: 1502
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) MultiBar"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?wmid="; content:"&act=getinstinfo&ref="; content:"&lang="; content:"&pbm="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d+\/\?wmid=.*&act=getinstinfo&ref=.*&lang=.*&pbm=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001502; rev:321;)

# Adware: (Adware) Hebogo - regex: to_server:GET /Config/ProgramGuard\.asp\?uno=.*&ver=\d+&wver=\d detector_id: 1503
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Hebogo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Config/ProgramGuard.asp?uno="; content:"&ver="; content:"&wver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Config\/ProgramGuard\.asp\?uno=.*&ver=\d+&wver=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001503; rev:1004;)

# Command&Control: (Trojan) Rofin - regex: to_server:GET .*/.*\.(exe|txt)\?ver=\d.*&uid=.*&lip=.*&mac=[A-F0-9]{12}&p=.*&b=.* detector_id: 1504
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Rofin"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?ver="; content:"&uid="; content:"&lip="; content:"&mac="; content:"&p="; content:"&b="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/.*\.(exe|txt)\?ver=\d.*&uid=.*&lip=.*&mac=[A-F0-9]{12}&p=.*&b=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001504; rev:1538;)

# Adware: (Redirect) Webalta - regex: to_server:POST /wa\.php.*v=.*&p=.*&ai=.*&ei=.*&tr=.*&u=.*&id=.*&oei=.*&oai=.*&otr=.*&c=.*&mj=.*&mn=.*&fp1=.*&fp2=.*&fp3=.*&fp4=.*&fe1=.*&fe2=.*&fe3=.*&fe4=.*&fsf=.*&fsn=.* detector_id: 1505
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Redirect) Webalta"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/wa.php"; content:"v="; content:"&p="; content:"&ai="; content:"&ei="; content:"&tr="; content:"&u="; content:"&id="; content:"&oei="; content:"&oai="; content:"&otr="; content:"&c="; content:"&mj="; content:"&mn="; content:"&fp1="; content:"&fp2="; content:"&fp3="; content:"&fp4="; content:"&fe1="; content:"&fe2="; content:"&fe3="; content:"&fe4="; content:"&fsf="; content:"&fsn="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/wa\.php.*v=.*&p=.*&ai=.*&ei=.*&tr=.*&u=.*&id=.*&oei=.*&oai=.*&otr=.*&c=.*&mj=.*&mn=.*&fp1=.*&fp2=.*&fp3=.*&fp4=.*&fe1=.*&fe2=.*&fe3=.*&fe4=.*&fsf=.*&fsn=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001505; rev:1004;)

# Command&Control: (Banker) Bloropac - regex: to_server:POST .*\.php.*to=.*&subject=.*pc\d+&message=.* detector_id: 1506
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Bloropac"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php"; content:"to="; content:"&subject="; content:"pc"; content:"&message="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php.*to=.*&subject=.*pc\d+&message=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001506; rev:321;)

# Adware: (Game) GamePlayLabs - regex: to_server:GET /ce9237be57719933386c8a88b67bf7a5/install.*\.xml\?pid=\d+ detector_id: 1507
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Game) GamePlayLabs"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ce9237be57719933386c8a88b67bf7a5/install"; content:".xml?pid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ce9237be57719933386c8a88b67bf7a5\/install.*\.xml\?pid=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001507; rev:1004;)

# Command&Control: (Trojan) Bublik - regex: to_server:POST /A1PY/nht\.php.*[A-Za-z0-9\+/]{20,}={0,2} detector_id: 1509
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bublik"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/A1PY/nht.php"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/A1PY\/nht\.php.*[A-Za-z0-9\+\/]{20,}={0,2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001509; rev:1004;)

# Command&Control: (Trojan) Virut - regex: to_server:GET /x/getc\.php\?getcmd=\d detector_id: 1510
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Virut"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/x/getc.php?getcmd="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/x\/getc\.php\?getcmd=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001510; rev:1004;)

# Command&Control: (PasswordStealer) Tepfer - regex: to_server:POST /netod4309/index\.php detector_id: 1511
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (PasswordStealer) Tepfer"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/netod4309/index.php"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/netod4309\/index\.php/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001511; rev:715;)

# Command&Control: (Dropper) GenericDropper_74 - regex: to_server:GET /[a-z]{3}/set[a-z0-9]{1,2}\.exe.*Host: [a-z]{2,3}stat\d{3}\.com detector_id: 1512
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_74"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/set"; content:".exe"; content:"Host|3A| "; content:"stat"; content:".com"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{3}\/set[a-z0-9]{1,2}\.exe.*Host: [a-z]{2,3}stat\d{3}\.com/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001512; rev:1004;)

# Adware: (Downware) AdMonetizer InstallMonetizer  - regex: to_server:POST /DS_trackstats_v1\.php.*itemid=.*&pubid=.*&CbId=.*&subid=.*&status=.*&offid=1 detector_id: 1513
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) AdMonetizer InstallMonetizer "; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/DS_trackstats_v1.php"; content:"itemid="; content:"&pubid="; content:"&CbId="; content:"&subid="; content:"&status="; content:"&offid=1"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/DS_trackstats_v1\.php.*itemid=.*&pubid=.*&CbId=.*&subid=.*&status=.*&offid=1/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001513; rev:1004;)

# Adware: (Downware) InstallMate - regex: to_server:GET /installmate/php/get_cfg\.php\?step_id=.*&reffer=.*&installer_id=.*&publisher_id=.*&source_id=.*&page_id=.*&affiliate_id=.*&geo_location=.*&locale=.* detector_id: 1514
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) InstallMate"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/installmate/php/get_cfg.php?step_id="; content:"&reffer="; content:"&installer_id="; content:"&publisher_id="; content:"&source_id="; content:"&page_id="; content:"&affiliate_id="; content:"&geo_location="; content:"&locale="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/installmate\/php\/get_cfg\.php\?step_id=.*&reffer=.*&installer_id=.*&publisher_id=.*&source_id=.*&page_id=.*&affiliate_id=.*&geo_location=.*&locale=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001514; rev:718;)

# Command&Control: (KeyLogger) GenericKeylogger_1 LimitlessLogger - regex: to_server:GET .*\?to=.*&subject=.*&message=Limitless.*&from=.* detector_id: 1515
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (KeyLogger) GenericKeylogger_1 LimitlessLogger"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?to="; content:"&subject="; content:"&message=Limitless"; content:"&from="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\?to=.*&subject=.*&message=Limitless.*&from=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001515; rev:323;)

# Command&Control: (Trojan) GenericTrojan_54 - regex: to_server:GET .*/root\.php\?cname=.*&str=.*\d*&file=.* detector_id: 1516
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_54"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/root.php?cname="; content:"&str="; content:"&file="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/root\.php\?cname=.*&str=.*\d*&file=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001516; rev:591;)

# Command&Control: (Dropper) Geral - regex: to_server:GET /count\.asp\?mac=.*&UserID=.*&ProcessNum=\d+&Type=.* detector_id: 1518
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Geral"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/count.asp?mac="; content:"&UserID="; content:"&ProcessNum="; content:"&Type="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/count\.asp\?mac=.*&UserID=.*&ProcessNum=\d+&Type=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001518; rev:1004;)

# Command&Control: (Backdoor) GenericBackdoor_3 - regex: to_server:GET /QRTF96\.jsp\?[A-Za-z0-9\+/=]* detector_id: 1519
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) GenericBackdoor_3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/QRTF96.jsp?"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/QRTF96\.jsp\?[A-Za-z0-9\+\/=]*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001519; rev:1004;)

# Command&Control: (Dropper) Geral - regex: to_server:GET /tj/Count\.asp\?mac=.* detector_id: 1520
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Geral"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/tj/Count.asp?mac="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/tj\/Count\.asp\?mac=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001520; rev:1004;)

# Command&Control: (Trojan) AgentBypass - regex: to_server:GET /plus/cfg/.*\.bin\?ver=\d.*&lip=.*&mac=.* detector_id: 1521
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) AgentBypass"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/plus/cfg/"; content:".bin?ver="; content:"&lip="; content:"&mac="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/plus\/cfg\/.*\.bin\?ver=\d.*&lip=.*&mac=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001521; rev:399;)

# Adware: (Adware) Kraddare - regex: to_server:GET /mine_report\.php\?action=.*&mac=.*&dist=.*&ov=.*&adn=.*&ver=.*&win=.*&ie=.*&ck=.*&adset=.*&cwset=.*&ucode=.*&debug=.*&_cache=.*&log_date=.*&ts=.* detector_id: 1522
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Kraddare"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mine_report.php?action="; content:"&mac="; content:"&dist="; content:"&ov="; content:"&adn="; content:"&ver="; content:"&win="; content:"&ie="; content:"&ck="; content:"&adset="; content:"&cwset="; content:"&ucode="; content:"&debug="; content:"&_cache="; content:"&log_date="; content:"&ts="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mine_report\.php\?action=.*&mac=.*&dist=.*&ov=.*&adn=.*&ver=.*&win=.*&ie=.*&ck=.*&adset=.*&cwset=.*&ucode=.*&debug=.*&_cache=.*&log_date=.*&ts=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001522; rev:1004;)

# Command&Control: (Backdoor) Spyrat - regex: to_server:GET /sqlite3\.dll\?[a-z0-9]{8}.*Connection: Keep-Alive detector_id: 1523
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Spyrat"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/sqlite3.dll?"; content:"Connection|3A| Keep-Alive"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/sqlite3\.dll\?[a-z0-9]{8}.*Connection: Keep-Alive/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001523; rev:1004;)

# Adware: (Adware) NetOptimizer - regex: to_server:POST /conf/xml/.*ver=.*&rid=.*&cls=.*&ser=.*&signint=.*&installt=.*&rmods=.*&mods=.*&iea=.*&speed=.* detector_id: 1524
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) NetOptimizer"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/conf/xml/"; content:"ver="; content:"&rid="; content:"&cls="; content:"&ser="; content:"&signint="; content:"&installt="; content:"&rmods="; content:"&mods="; content:"&iea="; content:"&speed="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/conf\/xml\/.*ver=.*&rid=.*&cls=.*&ser=.*&signint=.*&installt=.*&rmods=.*&mods=.*&iea=.*&speed=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001524; rev:326;)

# Command&Control: (ClickBot) Clidak - regex: to_server:POST /~pete19c/r\.php.*d=.*&i=.* detector_id: 1525
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (ClickBot) Clidak"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/|7E|pete19c/r.php"; content:"d="; content:"&i="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/~pete19c\/r\.php.*d=.*&i=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001525; rev:1004;)

# Command&Control: (Banker) Bancos - regex: to_server:GET /businesscontador/gravaInfo\.asp\?name=.* detector_id: 1527
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Bancos"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/businesscontador/gravaInfo.asp?name="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/businesscontador\/gravaInfo\.asp\?name=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001527; rev:1004;)

# Command&Control: (TrojanProxy) GenericTrojan_56 - regex: to_server:GET /updateg\.php\?p=\d+.*User-Agent: Mozilla/4\.75 \[en\] detector_id: 1528
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (TrojanProxy) GenericTrojan_56"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/updateg.php?p="; content:"User-Agent|3A| Mozilla/4.75 |5B|en|5D|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/updateg\.php\?p=\d+.*User-Agent: Mozilla\/4\.75 \[en\]/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001528; rev:1004;)

# Command&Control: (Banker) GenericBanker_12 - regex: to_server:POST .*/index\.php.*valor=(verde|branco|vermelho|azul) detector_id: 1529
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_12"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/index.php"; content:"valor="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/index\.php.*valor=(verde|branco|vermelho|azul)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001529; rev:565;)

# Command&Control: (TrojanProxy) Pramro - regex: to_server:GET /utest/\?jutr=\d{5}&oo=\d{1,2}&[a-f0-9]{5}=[a-f0-9]{5,6}&ra=\d HTTP detector_id: 1530
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (TrojanProxy) Pramro"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/utest/?jutr="; content:"&oo="; content:"&ra="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/utest\/\?jutr=\d{5}&oo=\d{1,2}&[a-f0-9]{5}=[a-f0-9]{5,6}&ra=\d HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001530; rev:587;)

# Command&Control: (Banker) Banbra - regex: to_server:POST /peaviso\.php.*IncluirAviso.* detector_id: 1531
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Banbra"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/peaviso.php"; content:"IncluirAviso"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/peaviso\.php.*IncluirAviso.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001531; rev:1004;)

# Adware: (Adware) GenericAdware_10 SearchStar - regex: to_server:GET /toolbarinfo/install\.php\?toolbar_id=.*&partner=searchstar detector_id: 1532
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) GenericAdware_10 SearchStar"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/toolbarinfo/install.php?toolbar_id="; content:"&partner=searchstar"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/toolbarinfo\/install\.php\?toolbar_id=.*&partner=searchstar/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001532; rev:1004;)

# Adware: (Toolbar) GenericAdware Tabbar - regex: to_server:POST /fchk\.php.*code=.*.*User-Agent: count detector_id: 1533
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) GenericAdware Tabbar"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/fchk.php"; content:"code="; content:"User-Agent|3A| count"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/fchk\.php.*code=.*.*User-Agent: count/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001533; rev:1004;)

# Command&Control: (Trojan) SpyRecon - regex: to_server:GET /spyrecon/.*\?onrID=.*&vnrID=.*&serialNo=.*&vnc=.* detector_id: 1535
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) SpyRecon"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/spyrecon/"; content:"?onrID="; content:"&vnrID="; content:"&serialNo="; content:"&vnc="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/spyrecon\/.*\?onrID=.*&vnrID=.*&serialNo=.*&vnc=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001535; rev:329;)

# Click-Fraud: Phishing - regex: to_server:GET /d/p/m4e2d29512\?r= detector_id: 1536
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Click-Fraud: Phishing"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/d/p/m4e2d29512?r="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/d\/p\/m4e2d29512\?r=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001536; rev:329;)

# Adware: (Game) EpicGames GameVance - regex: to_server:GET /cmn\?p=.*.*User-Agent: tl_v.* detector_id: 1537
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Game) EpicGames GameVance"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cmn?p="; content:"User-Agent|3A| tl_v"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cmn\?p=.*.*User-Agent: tl_v.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001537; rev:329;)

# Command&Control: (Dropper) Harnig - regex: to_server:GET /dl/dluniq1\.php\?adv=adv\d+&code1=[A-Z]*&code2=\d+.*Host: [a-z]*\.biz  detector_id: 1538
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Harnig"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/dl/dluniq1.php?adv=adv"; content:"&code1="; content:"&code2="; content:"Host|3A| "; content:".biz "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/dl\/dluniq1\.php\?adv=adv\d+&code1=[A-Z]*&code2=\d+.*Host: [a-z]*\.biz /s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001538; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_66 - regex: to_server:GET /x/botstart\.php\?arch=.*&win=.*&cname=.* detector_id: 1539
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_66"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/x/botstart.php?arch="; content:"&win="; content:"&cname="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/x\/botstart\.php\?arch=.*&win=.*&cname=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001539; rev:1004;)

# Command&Control: (Ransomware) Foreign - regex: to_server:POST /ftsri\.php\?reg&ver=.*&comp=.*&addinfo= detector_id: 1540
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) Foreign"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ftsri.php?reg&ver="; content:"&comp="; content:"&addinfo="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ftsri\.php\?reg&ver=.*&comp=.*&addinfo=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001540; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_67 - regex: to_server:POST /humex/1\.php\?id=[a-f0-9]{8}.*os=.*&ver=.*&hash=.* detector_id: 1541
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_67"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/humex/1.php?id="; content:"os="; content:"&ver="; content:"&hash="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/humex\/1\.php\?id=[a-f0-9]{8}.*os=.*&ver=.*&hash=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001541; rev:1004;)

# Command&Control: (Dropper) Dofoil - regex: to_server:POST /suwhtfg/index\.php.*AAA detector_id: 1542
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Dofoil"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/suwhtfg/index.php"; content:"AAA"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/suwhtfg\/index\.php.*AAA/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001542; rev:722;)

# Command&Control: (Dropper) Dofoil - regex: to_server:POST /wsoej/index\.php.*AAA detector_id: 1543
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Dofoil"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/wsoej/index.php"; content:"AAA"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/wsoej\/index\.php.*AAA/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001543; rev:722;)

# Command&Control: (Dropper) GenericDropper_56 - regex: to_server:GET /[A-Za-z]{8,9}\?[a-f] HTTP/1\.1.*Host: .*\.noip2\.at detector_id: 1544
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_56"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP/1.1"; content:"Host|3A| "; content:".noip2.at"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[A-Za-z]{8,9}\?[a-f] HTTP\/1\.1.*Host: .*\.noip2\.at/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001544; rev:1004;)

# Command&Control: (Ransomware) Foreign - regex: to_server:GET /ftsri\.php\?get&download detector_id: 1545
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) Foreign"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ftsri.php?get&download"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ftsri\.php\?get&download/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001545; rev:1004;)

# Command&Control: (Ransomware) Foreign - regex: to_server:GET /ftsri\.php\?get&version detector_id: 1546
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) Foreign"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ftsri.php?get&version"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ftsri\.php\?get&version/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001546; rev:1004;)

# Command&Control: (Dropper) GenericDropper_57 - regex: to_server:GET /extra-malware/register\.php\?id=.*&ver=.*&comp= detector_id: 1547
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_57"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/extra-malware/register.php?id="; content:"&ver="; content:"&comp="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/extra-malware\/register\.php\?id=.*&ver=.*&comp=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001547; rev:1004;)

# Command&Control: (Dropper) GenericDropper_57 - regex: to_server:GET /extra-malware/download\.txt detector_id: 1548
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_57"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/extra-malware/download.txt"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/extra-malware\/download\.txt/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001548; rev:1004;)

# Command&Control: (Dropper) GenericDropper_57 - regex: to_server:GET /extra-malware/version\.txt detector_id: 1549
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_57"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/extra-malware/version.txt"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/extra-malware\/version\.txt/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001549; rev:1004;)

# Command&Control: (Worm) Tupym - regex: to_server:GET /poojasharma\d/setting\.ini detector_id: 1554
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Tupym"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/poojasharma"; content:"/setting.ini"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/poojasharma\d\/setting\.ini/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001554; rev:1004;)

# Adware: (Installer) OpenCandy - regex: to_server:GET .*\?bn=.*&bv=.*&clientv=.*&cltzone=.*&language=.*&method=.*&mstime=.*&os=.*&product_key=.*&v=.*&signature=.* detector_id: 1556
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Installer) OpenCandy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?bn="; content:"&bv="; content:"&clientv="; content:"&cltzone="; content:"&language="; content:"&method="; content:"&mstime="; content:"&os="; content:"&product_key="; content:"&v="; content:"&signature="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\?bn=.*&bv=.*&clientv=.*&cltzone=.*&language=.*&method=.*&mstime=.*&os=.*&product_key=.*&v=.*&signature=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001556; rev:330;)

# Command&Control: (Banker) GenericBanker_2 - regex: to_server:POST /(base\d+|imgs)/insertsql\.php\?.*&parametros=.* detector_id: 1558
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_2"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/insertsql.php?"; content:"&parametros="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(base\d+|imgs)\/insertsql\.php\?.*&parametros=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001558; rev:1004;)

# Command&Control: (Keylogger) CryptoSuite - regex: to_server:GET /logekle\.php\?kullanici=.*&dosya=.*&tur=.*&yazi=.*.*User-Agent: LOGGING detector_id: 1559
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Keylogger) CryptoSuite"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/logekle.php?kullanici="; content:"&dosya="; content:"&tur="; content:"&yazi="; content:"User-Agent|3A| LOGGING"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/logekle\.php\?kullanici=.*&dosya=.*&tur=.*&yazi=.*.*User-Agent: LOGGING/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001559; rev:1004;)

# Command&Control: (Trojan) Pexnod - regex: to_server:POST /(mainpage|web|aboutus)\.php.*pcname=.*&note=.*&country=.*&user=.*&log=.* detector_id: 1560
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Pexnod"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php"; content:"pcname="; content:"&note="; content:"&country="; content:"&user="; content:"&log="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(mainpage|web|aboutus)\.php.*pcname=.*&note=.*&country=.*&user=.*&log=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001560; rev:721;)

# Command&Control: (TrojanProxy) Mitglieder - regex: to_server:GET /.*\?p=\d+&id=\d+&trafficid=.*&v=.*.*User-Agent: SO detector_id: 1561
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (TrojanProxy) Mitglieder"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?p="; content:"&id="; content:"&trafficid="; content:"&v="; content:"User-Agent|3A| SO"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\?p=\d+&id=\d+&trafficid=.*&v=.*.*User-Agent: SO/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001561; rev:330;)

# Command&Control: (Dropper) Heloag - regex: to_server:GET /reg\.asp\?port=.*&mac=.*&key=.* detector_id: 1562
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Heloag"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/reg.asp?port="; content:"&mac="; content:"&key="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/reg\.asp\?port=.*&mac=.*&key=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001562; rev:1004;)

# Command&Control: (Banker) GenericBanker_13 - regex: to_server:POST /php/cont\.php.*dados=.* detector_id: 1563
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_13"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/php/cont.php"; content:"dados="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/php\/cont\.php.*dados=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001563; rev:1004;)

# Command&Control: (Trojan) ZBot - regex: to_server:POST /citdl/newmixplfiit/cfgpl\.bin detector_id: 1564
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/citdl/newmixplfiit/cfgpl.bin"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/citdl\/newmixplfiit\/cfgpl\.bin/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001564; rev:730;)

# Adware: (Downware) Kraddare - regex: to_server:GET /log/\?modeAct=(run|install)&iMAC=.{12}&iPID=10\d{2} detector_id: 1565
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Kraddare"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/log/?modeAct="; content:"&iMAC="; content:"&iPID=10"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/log\/\?modeAct=(run|install)&iMAC=.{12}&iPID=10\d{2}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001565; rev:445;)

# Command&Control: (Trojan) Lanaur - regex: to_server:GET /avisa\.php\?usuario=.*&pc=.*&serial=.*&versao=.* detector_id: 1566
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Lanaur"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/avisa.php?usuario="; content:"&pc="; content:"&serial="; content:"&versao="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/avisa\.php\?usuario=.*&pc=.*&serial=.*&versao=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001566; rev:1004;)

# Command&Control: (Banker) Banload - regex: to_server:POST /contador/leo\.php.*leo=.* detector_id: 1567
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Banload"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/contador/leo.php"; content:"leo="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/contador\/leo\.php.*leo=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001567; rev:1004;)

# FakeAV: PCCleanerPro - regex: to_server:GET /get_lic\.php\?action=.*&wmid=.*&event=.*&uid=.*&i1=.*&i2=.* detector_id: 1568
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: PCCleanerPro"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get_lic.php?action="; content:"&wmid="; content:"&event="; content:"&uid="; content:"&i1="; content:"&i2="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get_lic\.php\?action=.*&wmid=.*&event=.*&uid=.*&i1=.*&i2=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001568; rev:1004;)

# Command&Control: (Trojan) Neurotickat - regex: to_server:GET /cgi-bin/RAlog\.cgi\?action=.*&ip=.*&port=\d*&win=.*&rpass=.*&ServerType=.* detector_id: 1569
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Neurotickat"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cgi-bin/RAlog.cgi?action="; content:"&ip="; content:"&port="; content:"&win="; content:"&rpass="; content:"&ServerType="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cgi-bin\/RAlog\.cgi\?action=.*&ip=.*&port=\d*&win=.*&rpass=.*&ServerType=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001569; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_70 - regex: to_server:GET /gate\.php\?username=.*&country=.*&OS=.* detector_id: 1570
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_70"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/gate.php?username="; content:"&country="; content:"&OS="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/gate\.php\?username=.*&country=.*&OS=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001570; rev:1004;)

# Command&Control: (Trojan) Gpcode - regex: to_server:GET .*login_ok\.php\?no=.*&id=B9.*&sn=\d*&sc=.* detector_id: 1571
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Gpcode"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"login_ok.php?no="; content:"&id=B9"; content:"&sn="; content:"&sc="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*login_ok\.php\?no=.*&id=B9.*&sn=\d*&sc=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001571; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_53 - regex: to_server:POST /[a-z]{1,8}/cmd\.php.*User-Agent: YZF.*id=.*&bits=.*&username=.*&os=.*&status=.*&mod=.* detector_id: 1572
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_53"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/cmd.php"; content:"User-Agent|3A| YZF"; content:"id="; content:"&bits="; content:"&username="; content:"&os="; content:"&status="; content:"&mod="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{1,8}\/cmd\.php.*User-Agent: YZF.*id=.*&bits=.*&username=.*&os=.*&status=.*&mod=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001572; rev:1004;)

# Command&Control: (Trojan) Bublik - regex: to_server:POST /max/null\.php.*[A-Za-z0-9\+/]{20,}={0,2} detector_id: 1573
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bublik"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/max/null.php"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/max\/null\.php.*[A-Za-z0-9\+\/]{20,}={0,2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001573; rev:1004;)

# Command&Control: (Trojan) Smokeloader_3 - regex: to_server:POST .*cmd=grab&data=[A-Za-z0-9/=]*&login=.* detector_id: 1574
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Smokeloader_3"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"cmd=grab&data="; content:"&login="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*cmd=grab&data=[A-Za-z0-9\/=]*&login=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001574; rev:337;)

# Command&Control: (Trojan) GenericTrojan_38 - regex: to_server:POST /acher/cmd\.php.*status=get detector_id: 1575
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_38"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/acher/cmd.php"; content:"status=get"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/acher\/cmd\.php.*status=get/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001575; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_38 - regex: to_server:GET /acher/sys/(UserAgent|Referer|Accept)\.png detector_id: 1576
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_38"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/acher/sys/"; content:".png"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/acher\/sys\/(UserAgent|Referer|Accept)\.png/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001576; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_38 - regex: to_server:GET /acher/dll\.php\?dllpass=[a-zA-Z]{7} detector_id: 1577
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_38"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/acher/dll.php?dllpass="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/acher\/dll\.php\?dllpass=[a-zA-Z]{7}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001577; rev:1004;)

# Command&Control: (Trojan) StartPage - regex: to_server:POST /Install/verify\.php.*uid=\d*&key=x.*&mac=.* detector_id: 1578
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) StartPage"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/Install/verify.php"; content:"uid="; content:"&key=x"; content:"&mac="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Install\/verify\.php.*uid=\d*&key=x.*&mac=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001578; rev:1004;)

# Command&Control: (Dropper) Kanav - regex: to_server:POST /pro\.asp.*a1=.*&a2=[a-f0-9]*&a3=.*&a4= detector_id: 1580
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Kanav"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/pro.asp"; content:"a1="; content:"&a2="; content:"&a3="; content:"&a4="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/pro\.asp.*a1=.*&a2=[a-f0-9]*&a3=.*&a4=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001580; rev:721;)

# Command&Control: (Dropper) GenericDropper_77 - regex: to_server:GET /mtUrl.xml\?num=%20.\d+ detector_id: 1581
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_77"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mtUrl"; content:"xml?num=|25|20"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mtUrl.xml\?num=%20.\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001581; rev:378;)

# Command&Control: (Dropper) Pelfpoi - regex: to_server:GET /ctrl/getid\.php\?prog=\[Poket_\(ks\)\]\.exe detector_id: 1582
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OpenBDS Command&Control: (Dropper) Pelfpoi"; flow:established,to_server; content:"GET "; http_method; content:"/ctrl/getid.php?prog=[Poket_(ks)].exe"; nocase; http_uri; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001582; rev:0;)

# Command&Control: (Trojan) Sacanph - regex: to_server:POST .*creater\.php HTTP.*form-data; name="programm".*(Windows Key|CoreFTP) detector_id: 1583
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sacanph"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"creater.php HTTP"; content:"form-data|3B| name=|22|programm|22|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*creater\.php HTTP.*form-data\; name="programm".*(Windows Key|CoreFTP)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001583; rev:536;)

# Command&Control: (Dropper) Dofoil - regex: to_server:POST /dfdswed/index\.php.*AAA detector_id: 1584
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Dofoil"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/dfdswed/index.php"; content:"AAA"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/dfdswed\/index\.php.*AAA/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001584; rev:722;)

# Command&Control: (Dropper) Dofoil - regex: to_server:POST /smoke/index\.php.*AAA detector_id: 1585
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Dofoil"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/smoke/index.php"; content:"AAA"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/smoke\/index\.php.*AAA/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001585; rev:722;)

# Command&Control: (Trojan) Smokeloader - regex: to_server:GET .*/index\.php\?r=gate&gh=[a-f0-9]{8}&group=\d{4}rcm&debug=\d detector_id: 1586
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Smokeloader"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?r=gate&gh="; content:"&group="; content:"rcm&debug="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/index\.php\?r=gate&gh=[a-f0-9]{8}&group=\d{4}rcm&debug=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001586; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_42 - regex: to_server:GET /in\.php\?selid=\d&mac=.{12}&dfhaegeh=\d, detector_id: 1587
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_42"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/in.php?selid="; content:"&mac="; content:"&dfhaegeh="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/in\.php\?selid=\d&mac=.{12}&dfhaegeh=\d,/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001587; rev:1004;)

# Adware: (Adware) Funpop - regex: to_server:GET /app_count/bc_process_count\.php\?mac=.*&pid=.*.*User-Agent: HiSantaSession detector_id: 1588
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Funpop"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/app_count/bc_process_count.php?mac="; content:"&pid="; content:"User-Agent|3A| HiSantaSession"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/app_count\/bc_process_count\.php\?mac=.*&pid=.*.*User-Agent: HiSantaSession/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001588; rev:1004;)

# Command&Control: (Trojan) Magania - regex: to_server:GET .*(get|post|mail)\.asp\?mac=.*&os=.*&avs=.*&ps=.*&ver=.*.*User-Agent: Google page detector_id: 1590
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Magania"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".asp?mac="; content:"&os="; content:"&avs="; content:"&ps="; content:"&ver="; content:"User-Agent|3A| Google page"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*(get|post|mail)\.asp\?mac=.*&os=.*&avs=.*&ps=.*&ver=.*.*User-Agent: Google page/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001590; rev:485;)

# Command&Control: (Trojan) Daws possibly Systex  - regex: to_server:GET /./t.asp\?os=.*&ver=\d+&mac=.* detector_id: 1591
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Daws possibly Systex "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/t"; content:"asp?os="; content:"&ver="; content:"&mac="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.\/t.asp\?os=.*&ver=\d+&mac=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001591; rev:341;)

# Command&Control: (Dropper) GenericDropper_65 - regex: to_server:GET /se\.jpg\?id=\d{10}&cn=\d{4}&v=\d{10}&ss=\d&mac=.*&osv=\d&osm=\d&sp=\d&osst=.*&iev=.*&vt=.*&ale=\d+&exe=.* detector_id: 1592
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_65"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/se.jpg?id="; content:"&cn="; content:"&v="; content:"&ss="; content:"&mac="; content:"&osv="; content:"&osm="; content:"&sp="; content:"&osst="; content:"&iev="; content:"&vt="; content:"&ale="; content:"&exe="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/se\.jpg\?id=\d{10}&cn=\d{4}&v=\d{10}&ss=\d&mac=.*&osv=\d&osm=\d&sp=\d&osst=.*&iev=.*&vt=.*&ale=\d+&exe=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001592; rev:1004;)

# Command&Control: (KeyLogger) GenericKeylogger_1 LimitlessLogger  - regex: to_server:POST /Limitless/Login/submit_log\.php.*content=.*&user=.*&title=Limitless.*&path=.* detector_id: 1593
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (KeyLogger) GenericKeylogger_1 LimitlessLogger "; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/Limitless/Login/submit_log.php"; content:"content="; content:"&user="; content:"&title=Limitless"; content:"&path="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Limitless\/Login\/submit_log\.php.*content=.*&user=.*&title=Limitless.*&path=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001593; rev:1004;)

# Command&Control: (Trojan) Sisproc - regex: to_server:POST /bbs/api/top/x\.asp.*pc=.* detector_id: 1594
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sisproc"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/bbs/api/top/x.asp"; content:"pc="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bbs\/api\/top\/x\.asp.*pc=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001594; rev:1004;)

# Command&Control: (Dropper) Scudy - regex: to_server:GET /online\.php\?c=.*&u=.*&v=\d&s=.*&p=.*&t=\d*&hi=.* detector_id: 1595
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Scudy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/online.php?c="; content:"&u="; content:"&v="; content:"&s="; content:"&p="; content:"&t="; content:"&hi="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/online\.php\?c=.*&u=.*&v=\d&s=.*&p=.*&t=\d*&hi=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001595; rev:1004;)

# Command&Control: (Dropper) GenericDropper_66 - regex: to_server:GET /ws\.php\?x=[a-z0-9]{25}.*User-Agent: \?\?\?\?\d detector_id: 1596
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_66"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ws.php?x="; content:"User-Agent|3A| ????"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ws\.php\?x=[a-z0-9]{25}.*User-Agent: \?\?\?\?\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001596; rev:1004;)

# Adware: (Downware) InstallMate - regex: to_server:GET /\?step_id=.*&installer_id=.*&publisher_id=.*&source_id=\d+&page_id=\d+&country_code=.*&locale= detector_id: 1597
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) InstallMate"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?step_id="; content:"&installer_id="; content:"&publisher_id="; content:"&source_id="; content:"&page_id="; content:"&country_code="; content:"&locale="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?step_id=.*&installer_id=.*&publisher_id=.*&source_id=\d+&page_id=\d+&country_code=.*&locale=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001597; rev:650;)

# command&control: GenericDropper_67 - regex: to_server:GET /hygkifndcjcds detector_id: 1598
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: GenericDropper_67"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/hygkifndcjcds"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/hygkifndcjcds/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001598; rev:350;)

# Command&Control: (Banker) Bancos - regex: to_server:POST /cmm/command\.php.*OPC=.*&ADM=.*&PC=.*&MC=.*&LG=.*&SI=.*&IE=.*&AV=.* detector_id: 1599
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Bancos"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/cmm/command.php"; content:"OPC="; content:"&ADM="; content:"&PC="; content:"&MC="; content:"&LG="; content:"&SI="; content:"&IE="; content:"&AV="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cmm\/command\.php.*OPC=.*&ADM=.*&PC=.*&MC=.*&LG=.*&SI=.*&IE=.*&AV=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001599; rev:1004;)

# Adware: (Adware) Pointad - regex: to_server:GET /Application/Access\.php\?info=i&MyValue=.*&code=.* detector_id: 1600
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Pointad"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Application/Access.php?info=i&MyValue="; content:"&code="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Application\/Access\.php\?info=i&MyValue=.*&code=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001600; rev:1004;)

# Command&Control: (Worm) Viking - regex: to_server:GET /fuck\.html\?rand=[a-z]{4}.*User-Agent: baidugoogle detector_id: 1601
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Viking"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/fuck.html?rand="; content:"User-Agent|3A| baidugoogle"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/fuck\.html\?rand=[a-z]{4}.*User-Agent: baidugoogle/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001601; rev:1004;)

# Command&Control: (Trojan) ZeroAccess Sirefef  - regex: to_server:GET /bad\.php\?w=\d+&fail=\d&i=\d+ detector_id: 1603
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZeroAccess Sirefef "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bad.php?w="; content:"&fail="; content:"&i="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bad\.php\?w=\d+&fail=\d&i=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001603; rev:1004;)

# Command&Control: (Trojan) Qhost - regex: to_server:GET /stat/tuk/\d.*Host: \d*\.\d*\.\d*\.\d*:1999 detector_id: 1604
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Qhost"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/stat/tuk/"; content:"Host|3A| "; content:"|3A|1999"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/stat\/tuk\/\d.*Host: \d*\.\d*\.\d*\.\d*:1999/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001604; rev:1004;)

# Command&Control: (Trojan) XPaj_2 - regex: to_server:POST /nymain/[a-z]{2}\d+/index\.php.*filename=[a-z]+\.[a-z]{3}&data=.* detector_id: 1605
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) XPaj_2"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/nymain/"; content:"/index.php"; content:"filename="; content:"&data="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/nymain\/[a-z]{2}\d+\/index\.php.*filename=[a-z]+\.[a-z]{3}&data=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001605; rev:1004;)

# Command&Control: (Dropper) GenericDropper_82 - regex: to_server:GET /mac/home/count\.php\?mac=[a-f0-9]{8}&custom=\d+&os=\d+&cpu=.*&inner_ip= detector_id: 1606
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_82"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mac/home/count.php?mac="; content:"&custom="; content:"&os="; content:"&cpu="; content:"&inner_ip="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mac\/home\/count\.php\?mac=[a-f0-9]{8}&custom=\d+&os=\d+&cpu=.*&inner_ip=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001606; rev:1004;)

# Command&Control: (Dropper) GenericDropper_68 - regex: to_server:GET /down\.asp\?action=(down|install)&u=.*&p=.*&t=.*Host: .*:(82|99|9) detector_id: 1607
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_68"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/down.asp?action="; content:"&u="; content:"&p="; content:"&t="; content:"Host|3A| "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/down\.asp\?action=(down|install)&u=.*&p=.*&t=.*Host: .*:(82|99|9)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001607; rev:1004;)

# Adware: (Downware) CrossRider - regex: to_server:GET /chrome-enabler\.gif\?action=started&bic=.*&os=.*&rnd=\d{7,} detector_id: 1608
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_69"; flow:established,to_server; content:"GET "; http_method; content:"/chrome-enabler.gif?action=started&bic="; http_uri; pcre:"/.*&os=.*&rnd=\d{7,}/URi"; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001608; rev:0;)

# Command&Control: (Banker) Banbra - regex: to_server:GET .*wp-env\.php\?nomepc=.*&osName=.*&ipp=.* detector_id: 1609
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Banbra"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"wp-env.php?nomepc="; content:"&osName="; content:"&ipp="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*wp-env\.php\?nomepc=.*&osName=.*&ipp=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001609; rev:1004;)

# Adware: (Toolbar) SideTab - regex: to_server:GET /install\.asp\?version=\d\.\d\.\d\.\d&id=.*&mac=\d+&iever=\d detector_id: 1610
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) SideTab"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/install.asp?version="; content:"&id="; content:"&mac="; content:"&iever="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/install\.asp\?version=\d\.\d\.\d\.\d&id=.*&mac=\d+&iever=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001610; rev:1004;)

# Command&Control: (Dropper) GenericDropper_70 - regex: to_server:GET /\S{7}\.exe HTTP/1\.0.*Host: [a-z]{8}\.ru$ detector_id: 1611
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_70"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".exe HTTP/1.0"; content:"Host|3A| "; content:".ru"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\S{7}\.exe HTTP\/1\.0.*Host: [a-z]{8}\.ru$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001611; rev:384;)

# Command&Control: (Banker) GenericBanker_3 - regex: to_server:POST /Avisar/avisando\.php.*tabel=.*&name=.*& detector_id: 1612
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_3"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/Avisar/avisando.php"; content:"tabel="; content:"&name="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Avisar\/avisando\.php.*tabel=.*&name=.*&/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001612; rev:1004;)

# Command&Control: (Dropper) GenericDropper_71 - regex: to_server:GET /stone\d{6,9}/r\.php\?i=.*&s=\d+&o=\d&c=.*&v=.*&h=.*&l=\d+&a=.*&ip=.*&win=.*&un=.*&x=.* detector_id: 1613
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_71"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/stone"; content:"/r.php?i="; content:"&s="; content:"&o="; content:"&c="; content:"&v="; content:"&h="; content:"&l="; content:"&a="; content:"&ip="; content:"&win="; content:"&un="; content:"&x="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/stone\d{6,9}\/r\.php\?i=.*&s=\d+&o=\d&c=.*&v=.*&h=.*&l=\d+&a=.*&ip=.*&win=.*&un=.*&x=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001613; rev:1004;)

# Command&Control: (Trojan) Scar - regex: to_server:POST .*sedo\.php.*id=.*&s5_uidx=\d+&os=.*&s5=\d detector_id: 1614
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Scar"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"sedo.php"; content:"id="; content:"&s5_uidx="; content:"&os="; content:"&s5="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*sedo\.php.*id=.*&s5_uidx=\d+&os=.*&s5=\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001614; rev:1004;)

# Command&Control: (Trojan) Banload_2 - regex: to_server:POST /.*op=.*&macaddress=.*&pcname=.*&nomeusuario=.*&serialhd=.*&versaowindows=.*&versaoatual=.*&arquivosplugins=.*&contaremocao=.*&origem=.*&praquem=.*&titulo=.*&texto=.* detector_id: 1615
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Banload_2"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"op="; content:"&macaddress="; content:"&pcname="; content:"&nomeusuario="; content:"&serialhd="; content:"&versaowindows="; content:"&versaoatual="; content:"&arquivosplugins="; content:"&contaremocao="; content:"&origem="; content:"&praquem="; content:"&titulo="; content:"&texto="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*op=.*&macaddress=.*&pcname=.*&nomeusuario=.*&serialhd=.*&versaowindows=.*&versaoatual=.*&arquivosplugins=.*&contaremocao=.*&origem=.*&praquem=.*&titulo=.*&texto=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001615; rev:352;)

# Command&Control: (Dropper) Riprox - regex: to_server:POST .*run\.php.*userandpc=.*&admin=.*&os=.*&hwid=.*&ownerid=\d+&version=.* detector_id: 1616
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Riprox"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"run.php"; content:"userandpc="; content:"&admin="; content:"&os="; content:"&hwid="; content:"&ownerid="; content:"&version="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*run\.php.*userandpc=.*&admin=.*&os=.*&hwid=.*&ownerid=\d+&version=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001616; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_72 - regex: to_server:POST /samuel/sam\.php.*act=.*&b=.*&c=.*&v=.*&p=.*&= detector_id: 1617
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_72"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/samuel/sam.php"; content:"act="; content:"&b="; content:"&c="; content:"&v="; content:"&p="; content:"&="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/samuel\/sam\.php.*act=.*&b=.*&c=.*&v=.*&p=.*&=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001617; rev:1004;)

# Adware: (Downware) OneClick - regex: to_server:GET /(country|cdi)\.asp\?st=.*&uid=.*&tuid=\d+&sref=.*&vmdt=.*&bld=.* detector_id: 1618
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) OneClick"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".asp?st="; content:"&uid="; content:"&tuid="; content:"&sref="; content:"&vmdt="; content:"&bld="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(country|cdi)\.asp\?st=.*&uid=.*&tuid=\d+&sref=.*&vmdt=.*&bld=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001618; rev:1014;)

# Command&Control: (Dropper) Bohu - regex: to_server:GET /svr\.asp\?c=.*&t=.*&u=.*&s=.*User-Agent: Lobo Lunar detector_id: 1619
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Bohu"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/svr.asp?c="; content:"&t="; content:"&u="; content:"&s="; content:"User-Agent|3A| Lobo Lunar"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/svr\.asp\?c=.*&t=.*&u=.*&s=.*User-Agent: Lobo Lunar/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001619; rev:1004;)

# Command&Control: (Dropper) Swizzor C2Lop - regex: to_server:GET /tba/p\?guid=.*&version=.*&clientid=.*&time=.*&locale=.*&idle=.*&crc=.* detector_id: 1620
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Swizzor C2Lop"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/tba/p?guid="; content:"&version="; content:"&clientid="; content:"&time="; content:"&locale="; content:"&idle="; content:"&crc="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/tba\/p\?guid=.*&version=.*&clientid=.*&time=.*&locale=.*&idle=.*&crc=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001620; rev:355;)

# Command&Control: (Trojan) ZeroAccess - regex: to_server:GET /\d+-[0-9A-F]/counter\.img\?theme=\d&digits=\d+&siteId=\d+.*User-Agent: Opera/9 detector_id: 1621
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZeroAccess"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/counter.img?theme="; content:"&digits="; content:"&siteId="; content:"User-Agent|3A| Opera/9"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d+-[0-9A-F]\/counter\.img\?theme=\d&digits=\d+&siteId=\d+.*User-Agent: Opera\/9/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001621; rev:733;)

# Command&Control: (PasswordStealer) GamesThief - regex: to_server:GET /cs0719 HTTP.*User-Agent: Mozilla/4\.0 (compatible) detector_id: 1622
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (PasswordStealer) GamesThief"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cs0719 HTTP"; content:"User-Agent|3A| Mozilla/4.0 "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cs0719 HTTP.*User-Agent: Mozilla\/4\.0 (compatible)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001622; rev:1004;)

# Adware: (Hoax) ArchSMS - regex: to_server:GET .*app_launch\.php\?id_user=.*&enc_potok=.*&id_project=.*&id_d1=\d+ detector_id: 1623
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) ArchSMS"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"app_launch.php?id_user="; content:"&enc_potok="; content:"&id_project="; content:"&id_d1="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*app_launch\.php\?id_user=.*&enc_potok=.*&id_project=.*&id_d1=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001623; rev:1004;)

# Command&Control: (Ransomware) Foreign - regex: to_server:GET /update\d*/(updatelist|followup)\.php\?mac=.*.*User-Agent: DF_Down detector_id: 1624
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) Foreign"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/update"; content:".php?mac="; content:"User-Agent|3A| DF_Down"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/update\d*\/(updatelist|followup)\.php\?mac=.*.*User-Agent: DF_Down/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001624; rev:1004;)

# Command&Control: (Banker) Banbra - regex: to_server:GET /teste/dongle HTTP/1\.1 detector_id: 1625
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Banbra"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/teste/dongle HTTP/1.1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/teste\/dongle HTTP\/1\.1/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001625; rev:1004;)

# Command&Control: (Trojan) Cutwail - regex: to_server:POST /\?ptrxcz_[a-z0-9A-Z]{30} detector_id: 1626
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OpenBDS Command&Control: (Dropper) Cutwail"; flow:to_server,established; content:"POST"; http_method; urilen:39; content:"/?ptrxcz_"; http_uri; pcre:"/^\/\?ptrxcz_[a-z0-9A-Z]{30}$/U"; reference:md5,58ffe2b79be4e789be80f92b7f96e20c; classtype:trojan-activity; sid:1001626; rev:0;)

# Adware: (Adware) PurityScan - regex: to_server:POST .*query\.php.*v=\d+&b=\d+&vt=.*&c=.*&os=.*&lang=.*&pl=.*&z=.* detector_id: 1628
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) PurityScan"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"query.php"; content:"v="; content:"&b="; content:"&vt="; content:"&c="; content:"&os="; content:"&lang="; content:"&pl="; content:"&z="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*query\.php.*v=\d+&b=\d+&vt=.*&c=.*&os=.*&lang=.*&pl=.*&z=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001628; rev:1004;)

# Command&Control: (Trojan) AgentBypass  - regex: to_server:GET .*getstatistic\.php\?getcmd=\d+&uid=.*.*Host: .*:76 detector_id: 1629
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) AgentBypass "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"getstatistic.php?getcmd="; content:"&uid="; content:"Host|3A| "; content:"|3A|76"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*getstatistic\.php\?getcmd=\d+&uid=.*.*Host: .*:76/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001629; rev:1002;)

# Adware: (Toolbar) OneTab - regex: to_server:GET .*\?ptag=.*&cid=.*&product=.*&rea=.*&b=OneTab&vn=\d detector_id: 1630
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) OneTab"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?ptag="; content:"&cid="; content:"&product="; content:"&rea="; content:"&b=OneTab&vn="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\?ptag=.*&cid=.*&product=.*&rea=.*&b=OneTab&vn=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001630; rev:356;)

# Command&Control: (Dropper) GenericDropper_72 - regex: to_server:GET /mactj\.asp\?mac=\d{12}&uname=.*User-Agent: vb   wininet detector_id: 1631
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_72"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mactj.asp?mac="; content:"&uname="; content:"User-Agent|3A| vb   wininet"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mactj\.asp\?mac=\d{12}&uname=.*User-Agent: vb   wininet/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001631; rev:1004;)

# Command&Control: (Dropper) GenericDropper_79 - regex: to_server:GET /post\.php\?a=\d&mac=.*&os=.*&ie=.*&pid=.*&starttotal=\d&version=.* detector_id: 1632
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_79"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/post.php?a="; content:"&mac="; content:"&os="; content:"&ie="; content:"&pid="; content:"&starttotal="; content:"&version="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/post\.php\?a=\d&mac=.*&os=.*&ie=.*&pid=.*&starttotal=\d&version=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001632; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_58 - regex: to_server:GET /report/installed/\?os=.*&browsers=.*&aff=\d+&subaff=\d+&ver=\d+&uid=[A-F0-9]{16} detector_id: 1633
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_58"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/report/installed/?os="; content:"&browsers="; content:"&aff="; content:"&subaff="; content:"&ver="; content:"&uid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/report\/installed\/\?os=.*&browsers=.*&aff=\d+&subaff=\d+&ver=\d+&uid=[A-F0-9]{16}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001633; rev:378;)

# Command&Control: (Trojan) Yeltminky - regex: to_server:GET /shell\.asp\?id=.*&mac=.*&os=.*&ver=\d+ detector_id: 1634
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Yeltminky"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/shell.asp?id="; content:"&mac="; content:"&os="; content:"&ver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/shell\.asp\?id=.*&mac=.*&os=.*&ver=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001634; rev:1004;)

# Adware: (Hoax) ArchSMS - regex: to_server:GET /openarch\.php\?aid=\d{4,}&uncv=.*&skey=.* detector_id: 1635
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) ArchSMS"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/openarch.php?aid="; content:"&uncv="; content:"&skey="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/openarch\.php\?aid=\d{4,}&uncv=.*&skey=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001635; rev:594;)

# Command&Control: (Dropper) CWS Maybe Tibs - regex: to_server:GET /d4\.fcgi\?v=\d.*&act=.*&aid=.*&skid=.*&langid=.* detector_id: 1636
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) CWS Maybe Tibs"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/d4.fcgi?v="; content:"&act="; content:"&aid="; content:"&skid="; content:"&langid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/d4\.fcgi\?v=\d.*&act=.*&aid=.*&skid=.*&langid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001636; rev:1004;)

# Command&Control: (Trojan) Jorik  - regex: to_server:GET /pab\.php\?b=.*&idf=.*&v=\d+&o=.* detector_id: 1637
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Jorik "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/pab.php?b="; content:"&idf="; content:"&v="; content:"&o="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/pab\.php\?b=.*&idf=.*&v=\d+&o=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001637; rev:1004;)

# Command&Control: (Trojan) Cinmus - regex: to_server:GET /geturl\.php\?version=.*&fid=.*&mac=.*&lversion=.*&wversion=.*&day=.*&name=.*&recent=.*&yversion=.*&vpc=.*&run=.*.*Host: .*:1207 detector_id: 1638
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Cinmus"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/geturl.php?version="; content:"&fid="; content:"&mac="; content:"&lversion="; content:"&wversion="; content:"&day="; content:"&name="; content:"&recent="; content:"&yversion="; content:"&vpc="; content:"&run="; content:"Host|3A| "; content:"|3A|1207"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/geturl\.php\?version=.*&fid=.*&mac=.*&lversion=.*&wversion=.*&day=.*&name=.*&recent=.*&yversion=.*&vpc=.*&run=.*.*Host: .*:1207/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001638; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_71 - regex: to_server:GET /[a-z]*/gate/req\.php\?id=[A-Za-z0-9]{17,21}&os=.*&version=.* detector_id: 1640
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_71"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/gate/req.php?id="; content:"&os="; content:"&version="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]*\/gate\/req\.php\?id=[A-Za-z0-9]{17,21}&os=.*&version=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001640; rev:1004;)

# Command&Control: (Dropper) GenericDropper_10 - regex: to_server:GET /web/get_core_infov3\.asp\?type=url&machinename=.* detector_id: 1641
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_10"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/web/get_core_infov3.asp?type=url&machinename="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/web\/get_core_infov3\.asp\?type=url&machinename=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001641; rev:1004;)

# Command&Control: (Trojan) Scar - regex: to_server:POST .*/(knck|gate|stat)\.php.*id=.*&version=\d+&os=.*&s5=\d detector_id: 1642
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Scar"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php"; content:"id="; content:"&version="; content:"&os="; content:"&s5="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/(knck|gate|stat)\.php.*id=.*&version=\d+&os=.*&s5=\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001642; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_60 - regex: to_server:POST .*gate\.php.*bot_id=.*&botnet=.*&bot_version= detector_id: 1643
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_60"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"gate.php"; content:"bot_id="; content:"&botnet="; content:"&bot_version="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*gate\.php.*bot_id=.*&botnet=.*&bot_version=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001643; rev:1004;)

# Command&Control: (Trojan) Rustock - regex: to_server:POST /getcfg\.php.*id=.*&bid=.*&getp=.* detector_id: 1644
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Rustock"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/getcfg.php"; content:"id="; content:"&bid="; content:"&getp="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/getcfg\.php.*id=.*&bid=.*&getp=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001644; rev:1004;)

# Command&Control: (Trojan) Banload - regex: to_server:POST /jml/help/css/Auth\.php.*Assunto=.*&Dados=.* detector_id: 1646
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Banload"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/jml/help/css/Auth.php"; content:"Assunto="; content:"&Dados="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/jml\/help\/css\/Auth\.php.*Assunto=.*&Dados=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001646; rev:1004;)

# Command&Control: (Trojan) Banload_2 - regex: to_server:POST /banners/envia\.php.*praquem=.*&praquem=.*&titulo=.*&texto=.* detector_id: 1647
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Banload_2"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/banners/envia.php"; content:"praquem="; content:"&praquem="; content:"&titulo="; content:"&texto="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/banners\/envia\.php.*praquem=.*&praquem=.*&titulo=.*&texto=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001647; rev:1004;)

# Command&Control: (Trojan) Koobface - regex: to_server:POST /\.[a-z0-9]+/\?action=fbgen&v=.*&crc=.*  detector_id: 1648
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Koobface"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/."; content:"/?action=fbgen&v="; content:"&crc="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\.[a-z0-9]+\/\?action=fbgen&v=.*&crc=.* /s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001648; rev:359;)

# Command&Control: (Trojan) Cutwail - regex: to_server:POST /\?xclzve_[a-z0-9A-Z]{30} detector_id: 1649
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Cutwail"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/?xclzve_"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?xclzve_[a-z0-9A-Z]{30}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001649; rev:428;)

# Command&Control: (Trojan) Zonebac - regex: to_server:GET .*\d+\.html\?cid=\d+&aid=.*&time=\d+&fw=\d+&v=.*&m=.* detector_id: 1650
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zonebac"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".html?cid="; content:"&aid="; content:"&time="; content:"&fw="; content:"&v="; content:"&m="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\d+\.html\?cid=\d+&aid=.*&time=\d+&fw=\d+&v=.*&m=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001650; rev:1004;)

# Command&Control: (Trojan) Chiviper - regex: to_server:GET .*/(post|count)\.asp\?d(01|10)=.*&d11=.*&d21=.*&d(30|22)=.*User-Agent: Example detector_id: 1651
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Chiviper"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".asp?d"; content:"&d11="; content:"&d21="; content:"&d"; content:"User-Agent|3A| Example"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/(post|count)\.asp\?d(01|10)=.*&d11=.*&d21=.*&d(30|22)=.*User-Agent: Example/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001651; rev:570;)

# Adware: (Hoax) ArchSMS - regex: to_server:POST /api\.php.*alt_api_base_url=.*&archive_desc=.*&archive_id=.*&archive_name=.*&archive_namefromexe=.*&check=.*&disable_anticheat=.*&hostdate=.*&hwid=.*&is_eng=.*&langid=.*&m=.*&owner_id=.*&passtype=.*&payment_altprice=.*&payment_arc_mt_settings=.*&payment_methods=.*&payment_mt_settings=.*&payment_showcost=.*&payment_sms_altcostmode=.*&payment_sms_cost=.*&payment_sms_count=.*&payment_sms_minpercent=.*&payment_subform_only=.*&payment_usdprice=.*&payment_use_subs=.*&skin_enfields=.*&skin_fields=.*&skin_pwd=.*&skin_subversion=.*&skin_type=.*&skin_version=.*&toolbars=.*&v=.*&version=.*&sign=.*& detector_id: 1652
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) ArchSMS"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/api.php"; content:"alt_api_base_url="; content:"&archive_desc="; content:"&archive_id="; content:"&archive_name="; content:"&archive_namefromexe="; content:"&check="; content:"&disable_anticheat="; content:"&hostdate="; content:"&hwid="; content:"&is_eng="; content:"&langid="; content:"&m="; content:"&owner_id="; content:"&passtype="; content:"&payment_altprice="; content:"&payment_arc_mt_settings="; content:"&payment_methods="; content:"&payment_mt_settings="; content:"&payment_showcost="; content:"&payment_sms_altcostmode="; content:"&payment_sms_cost="; content:"&payment_sms_count="; content:"&payment_sms_minpercent="; content:"&payment_subform_only="; content:"&payment_usdprice="; content:"&payment_use_subs="; content:"&skin_enfields="; content:"&skin_fields="; content:"&skin_pwd="; content:"&skin_subversion="; content:"&skin_type="; content:"&skin_version="; content:"&toolbars="; content:"&v="; content:"&version="; content:"&sign="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\.php.*alt_api_base_url=.*&archive_desc=.*&archive_id=.*&archive_name=.*&archive_namefromexe=.*&check=.*&disable_anticheat=.*&hostdate=.*&hwid=.*&is_eng=.*&langid=.*&m=.*&owner_id=.*&passtype=.*&payment_altprice=.*&payment_arc_mt_settings=.*&payment_methods=.*&payment_mt_settings=.*&payment_showcost=.*&payment_sms_altcostmode=.*&payment_sms_cost=.*&payment_sms_count=.*&payment_sms_minpercent=.*&payment_subform_only=.*&payment_usdprice=.*&payment_use_subs=.*&skin_enfields=.*&skin_fields=.*&skin_pwd=.*&skin_subversion=.*&skin_type=.*&skin_version=.*&toolbars=.*&v=.*&version=.*&sign=.*&/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001652; rev:1004;)

# Adware: (Hoax) ArchSMS - regex: to_server:POST /pc/pc\.php.*data=.*.*User-Agent: IE6 detector_id: 1653
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) ArchSMS"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/pc/pc.php"; content:"data="; content:"User-Agent|3A| IE6"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/pc\/pc\.php.*data=.*.*User-Agent: IE6/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001653; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_61 - regex: to_server:GET /count\.aspx\?i=[a-f0-9]{100}.*Host: .*:8001 detector_id: 1654
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_61"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/count.aspx?i="; content:"Host|3A| "; content:"|3A|8001"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/count\.aspx\?i=[a-f0-9]{100}.*Host: .*:8001/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001654; rev:1004;)

# Adware: (Adware) SmitFraud - regex: to_server:GET /redirect-settings\.php\?sid=.*&aid=.*&pn=.*&said=.*&version=\d HTTP.*User-Agent: unknown detector_id: 1655
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) SmitFraud"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/redirect-settings.php?sid="; content:"&aid="; content:"&pn="; content:"&said="; content:"&version="; content:" HTTP"; content:"User-Agent|3A| unknown"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/redirect-settings\.php\?sid=.*&aid=.*&pn=.*&said=.*&version=\d HTTP.*User-Agent: unknown/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001655; rev:514;)

# Command&Control: (Trojan) GenericTrojan_62 - regex: to_server:GET .*/log\.php\?p4=\d{4}&p5=\d{4}&hs=\d{4} detector_id: 1656
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_62"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/log.php?p4="; content:"&p5="; content:"&hs="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/log\.php\?p4=\d{4}&p5=\d{4}&hs=\d{4}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001656; rev:1002;)

# Command&Control: (Backdoor) Dreamy - regex: to_server:GET /stat/stata\.php\?win=.*&id=.*&lip=.*&s5=\d+&h=.*&v=.* detector_id: 1657
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Dreamy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/stat/stata.php?win="; content:"&id="; content:"&lip="; content:"&s5="; content:"&h="; content:"&v="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/stat\/stata\.php\?win=.*&id=.*&lip=.*&s5=\d+&h=.*&v=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001657; rev:1004;)

# Command&Control: (Dropper) GenericDropper_53 - regex: to_server:GET /t\.asp\?Action=Szir.*Host: .*:7777 detector_id: 1658
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_53"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/t.asp?Action=Szir"; content:"Host|3A| "; content:"|3A|7777"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/t\.asp\?Action=Szir.*Host: .*:7777/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001658; rev:1004;)

# Adware: (Hoax) ArchSMS - regex: to_server:GET .*/(start|app_launch)\.php\?id_user=.*&id_flow=.*&id_project=.*&id_download=.*&info=.* detector_id: 1659
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) ArchSMS"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?id_user="; content:"&id_flow="; content:"&id_project="; content:"&id_download="; content:"&info="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/(start|app_launch)\.php\?id_user=.*&id_flow=.*&id_project=.*&id_download=.*&info=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001659; rev:1004;)

# Command&Control: (Trojan) GBot - regex: to_server:GET .*getcmd\.php\?uid=\d+&ver=.*&traff=.* detector_id: 1660
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GBot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"getcmd.php?uid="; content:"&ver="; content:"&traff="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*getcmd\.php\?uid=\d+&ver=.*&traff=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001660; rev:1004;)

# Command&Control: (Trojan) BlackMonay - regex: to_server:GET /Api/163/Post\.Php\?UserName=.*&Bank=.*&Money=\d+ detector_id: 1661
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) BlackMonay"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Api/163/Post.Php?UserName="; content:"&Bank="; content:"&Money="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Api\/163\/Post\.Php\?UserName=.*&Bank=.*&Money=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001661; rev:1004;)

# Adware: (Downware) AdMonetizer InstallMonetizer  - regex: to_server:GET /gamescenter/services/report\.php\?guid=.*&action=.*&agent=.*&sid=InstallMonetizer&pid=.* detector_id: 1662
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) AdMonetizer InstallMonetizer "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/gamescenter/services/report.php?guid="; content:"&action="; content:"&agent="; content:"&sid=InstallMonetizer&pid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/gamescenter\/services\/report\.php\?guid=.*&action=.*&agent=.*&sid=InstallMonetizer&pid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001662; rev:1004;)

# Adware: (Hoax) ArchSMS - regex: to_server:GET /excount-new\.php\?file_id=\d+&hwid=.*&ver=\d detector_id: 1663
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) ArchSMS"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/excount-new.php?file_id="; content:"&hwid="; content:"&ver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/excount-new\.php\?file_id=\d+&hwid=.*&ver=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001663; rev:1004;)

# Command&Control: (Dropper) Zlob - regex: to_server:GET /image/qsdyuioff/pubenmgfuy/ifgmzdjl\.php\?param=.* detector_id: 1664
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Zlob"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/image/qsdyuioff/pubenmgfuy/ifgmzdjl.php?param="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/image\/qsdyuioff\/pubenmgfuy\/ifgmzdjl\.php\?param=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001664; rev:1004;)

# Command&Control: (Trojan) Whirep - regex: to_server:GET /white\.php\?aid=[a-f0-9]{32}.*User-Agent: wget 3\.0 detector_id: 1665
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Whirep"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/white.php?aid="; content:"User-Agent|3A| wget 3.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/white\.php\?aid=[a-f0-9]{32}.*User-Agent: wget 3\.0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001665; rev:1004;)

# Click-Fraud: GenericClickFraud - regex: to_server:GET /bin/findwhat\.dll\?clickthrough&y=\d+&x=.* detector_id: 1666
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Click-Fraud: GenericClickFraud"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bin/findwhat.dll?clickthrough&y="; content:"&x="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bin\/findwhat\.dll\?clickthrough&y=\d+&x=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001666; rev:1004;)

# Command&Control: (Trojan) SniperSpy - regex: to_server:POST /arewelive\.php\?username=.*&status=1.*User-Agent: MyBrowser detector_id: 1672
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) SniperSpy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/arewelive.php?username="; content:"&status=1"; content:"User-Agent|3A| MyBrowser"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/arewelive\.php\?username=.*&status=1.*User-Agent: MyBrowser/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001672; rev:721;)

# Command&Control: (TrojanProxy) Daemonize - regex: to_server:GET /show\.php\?v=\d+&rnd=.*&u=.*&s=\d+&id=.* detector_id: 1673
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (TrojanProxy) Daemonize"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/show.php?v="; content:"&rnd="; content:"&u="; content:"&s="; content:"&id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/show\.php\?v=\d+&rnd=.*&u=.*&s=\d+&id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001673; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_53 - regex: to_server:POST /y/cmd\.php.*status=.*User-Agent: YZF detector_id: 1674
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_53"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/y/cmd.php"; content:"status="; content:"User-Agent|3A| YZF"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/y\/cmd\.php.*status=.*User-Agent: YZF/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001674; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_69 - regex: to_server:GET /Aztongji\.aspx\?enid=.*&soft=.*Host: .*:83 detector_id: 1675
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_69"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Aztongji.aspx?enid="; content:"&soft="; content:"Host|3A| "; content:"|3A|83"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Aztongji\.aspx\?enid=.*&soft=.*Host: .*:83/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001675; rev:1004;)

# Command&Control: (Trojan) Oficla - regex: to_server:GET /(arc|lxmax)/bb\.php\?v=.*&id=.*&b=.*&tm=\d detector_id: 1676
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Oficla"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bb.php?v="; content:"&id="; content:"&b="; content:"&tm="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(arc|lxmax)\/bb\.php\?v=.*&id=.*&b=.*&tm=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001676; rev:1004;)

# Command&Control: (Trojan) Hitpop - regex: to_server:GET .*install\.asp\?ver=.*&tgid=.*&address=.*&regk=.*&flag=.*&frandom=.*&alreg=.* detector_id: 1677
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Hitpop"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"install.asp?ver="; content:"&tgid="; content:"&address="; content:"&regk="; content:"&flag="; content:"&frandom="; content:"&alreg="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*install\.asp\?ver=.*&tgid=.*&address=.*&regk=.*&flag=.*&frandom=.*&alreg=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001677; rev:1004;)

# Command&Control: (Dropper) Dorifel - regex: to_server:GET /js/way\.php\?000[0-9A-H]{5}&pin=[A-H0-9]{16} detector_id: 1681
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Dorifel"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/js/way.php?000"; content:"&pin="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/js\/way\.php\?000[0-9A-H]{5}&pin=[A-H0-9]{16}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001681; rev:1004;)

# Command&Control: (Backdoor) Beksnoc - regex: to_server:POST /query2\.php.*q=.*&id=.*&o=.*&v=\d.*&u=.* detector_id: 1683
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Beksnoc"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/query2.php"; content:"q="; content:"&id="; content:"&o="; content:"&v="; content:"&u="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/query2\.php.*q=.*&id=.*&o=.*&v=\d.*&u=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001683; rev:1004;)

# Command&Control: (Trojan) Redonc - regex: to_server:GET /encoder\.txt\?[0-9]{6,7}.*Host: .*\..*\.org detector_id: 1684
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Redonc"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/encoder.txt?"; content:"Host|3A| "; content:".org"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/encoder\.txt\?[0-9]{6,7}.*Host: .*\..*\.org/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001684; rev:1004;)

# Adware: (Adware) Conducent - regex: to_server:GET .*/scripts/BootstrapServer\.dll\?ABBS&u=.*&v=\d* detector_id: 1686
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Conducent"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/scripts/BootstrapServer.dll?ABBS&u="; content:"&v="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/scripts\/BootstrapServer\.dll\?ABBS&u=.*&v=\d*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001686; rev:1004;)

# Command&Control: (Backdoor) Omerta - regex: to_server:GET /omerta/Mail/Mail\.php\?cn=pc&sn=.*&pt=.*&pw=.*&to=.* detector_id: 1688
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Omerta"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/omerta/Mail/Mail.php?cn=pc&sn="; content:"&pt="; content:"&pw="; content:"&to="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/omerta\/Mail\/Mail\.php\?cn=pc&sn=.*&pt=.*&pw=.*&to=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001688; rev:1004;)

# OpenBDS test: OpenBDS test - regex: to_server:GET /\?709f7e3e4edc2e40069a49efbc288026 detector_id: 1689
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS OpenBDS test: OpenBDS test"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?709f7e3e4edc2e40069a49efbc288026"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?709f7e3e4edc2e40069a49efbc288026/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001689; rev:370;)

# Adware: (Software Bundler) OpenCandy - regex: to_server:GET /.*\?clientv=.*&language=.*&machine_code=.*&method=.*&os=.*&product_key=.*&v=.*&signature=.* detector_id: 1690
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Software Bundler) OpenCandy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?clientv="; content:"&language="; content:"&machine_code="; content:"&method="; content:"&os="; content:"&product_key="; content:"&v="; content:"&signature="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\?clientv=.*&language=.*&machine_code=.*&method=.*&os=.*&product_key=.*&v=.*&signature=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001690; rev:370;)

# Command&Control: (Trojan) SpyEye_2 - regex: to_server:GET .*/bt_version_checker\.php\?guid=.*&ver=.*&stat=.*&ie=.*&os=.*&ut=.*&cpu=\d+ detector_id: 1691
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) SpyEye_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bt_version_checker.php?guid="; content:"&ver="; content:"&stat="; content:"&ie="; content:"&os="; content:"&ut="; content:"&cpu="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/bt_version_checker\.php\?guid=.*&ver=.*&stat=.*&ie=.*&os=.*&ut=.*&cpu=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001691; rev:486;)

# Command&Control: (Trojan) GenericTrojan_6  - regex: to_server:POST /tj\.php.*o=\d+&m=[A-F0-9]{12}&t=[a-f0-9]{32}&n1=\d+&n2=\d+&v=.*&sn=.*&ag=.*&pa=.*&pb=.*&c=.* detector_id: 1692
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_6 "; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/tj.php"; content:"o="; content:"&m="; content:"&t="; content:"&n1="; content:"&n2="; content:"&v="; content:"&sn="; content:"&ag="; content:"&pa="; content:"&pb="; content:"&c="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/tj\.php.*o=\d+&m=[A-F0-9]{12}&t=[a-f0-9]{32}&n1=\d+&n2=\d+&v=.*&sn=.*&ag=.*&pa=.*&pb=.*&c=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001692; rev:1004;)

# Adware: (Toolbar) EasyPrediction - regex: to_server:GET /RegInst\.ashx\?pver=.*&app=.*&cver=.*&cnum=.*&unum=.*&disid=.*&cdate=.*&os=.*&defb=.*&bver=.* detector_id: 1693
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) EasyPrediction"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/RegInst.ashx?pver="; content:"&app="; content:"&cver="; content:"&cnum="; content:"&unum="; content:"&disid="; content:"&cdate="; content:"&os="; content:"&defb="; content:"&bver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/RegInst\.ashx\?pver=.*&app=.*&cver=.*&cnum=.*&unum=.*&disid=.*&cdate=.*&os=.*&defb=.*&bver=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001693; rev:1004;)

# Command&Control: (Dropper) GenericDropper_80 - regex: to_server:GET /url/g1\.asp\?dfeh=[A-F0-9]{8}&fdgmac=.{17}&bdfu= detector_id: 1694
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_80"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/url/g1.asp?dfeh="; content:"&fdgmac="; content:"&bdfu="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/url\/g1\.asp\?dfeh=[A-F0-9]{8}&fdgmac=.{17}&bdfu=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001694; rev:1004;)

# Command&Control: (Trojan) Small - regex: to_server:GET /insidious/k\.php\?i=.*&u=.*&o=.*&l=.*&f=.*&a=.* detector_id: 1695
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Small"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/insidious/k.php?i="; content:"&u="; content:"&o="; content:"&l="; content:"&f="; content:"&a="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/insidious\/k\.php\?i=.*&u=.*&o=.*&l=.*&f=.*&a=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001695; rev:1004;)

# Adware: (Adware) StatBlaster - regex: to_server:GET /mdt\.php\?session=[0-9a-z]{28,33}.*User-Agent: update detector_id: 1696
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) StatBlaster"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mdt.php?session="; content:"User-Agent|3A| update"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mdt\.php\?session=[0-9a-z]{28,33}.*User-Agent: update/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001696; rev:1004;)

# Command&Control: (Trojan) Danginex - regex: to_server:GET /system\.asp\?username=[a-z]*&banben=\d\.\d\.\d\.\d detector_id: 1697
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Danginex"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/system.asp?username="; content:"&banben="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/system\.asp\?username=[a-z]*&banben=\d\.\d\.\d\.\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001697; rev:1004;)

# Command&Control: (Backdoor) Beksnoc - regex: to_server:POST .*.*q=[a-z]{1}&id=.*&o=.*&v=.*&me=.*&tk=.*&u=.* detector_id: 1698
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Beksnoc"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"q="; content:"&id="; content:"&o="; content:"&v="; content:"&me="; content:"&tk="; content:"&u="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*.*q=[a-z]{1}&id=.*&o=.*&v=.*&me=.*&tk=.*&u=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001698; rev:377;)

# Adware: (Adware) EZula - regex: to_server:GET .*UVid\.asp\?PubName=.*&UserID=.*&ErrCode=.*&Stub=.*&geo=true detector_id: 1699
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) EZula"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"UVid.asp?PubName="; content:"&UserID="; content:"&ErrCode="; content:"&Stub="; content:"&geo=true"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*UVid\.asp\?PubName=.*&UserID=.*&ErrCode=.*&Stub=.*&geo=true/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001699; rev:1004;)

# Adware: (Toolbar) SideTab - regex: to_server:GET /update\.asp\?version=.*&id=.*&mac=.*&oldversion=.* detector_id: 1700
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) SideTab"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/update.asp?version="; content:"&id="; content:"&mac="; content:"&oldversion="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/update\.asp\?version=.*&id=.*&mac=.*&oldversion=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001700; rev:1004;)

# Command&Control: (Dropper) GenericDropper_78 - regex: to_server:POST /connect\.php.*pcname=.*&botver=.*&country=.*&winver=.*&hwid=.*&ip= detector_id: 1701
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_78"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/connect.php"; content:"pcname="; content:"&botver="; content:"&country="; content:"&winver="; content:"&hwid="; content:"&ip="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/connect\.php.*pcname=.*&botver=.*&country=.*&winver=.*&hwid=.*&ip=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001701; rev:1004;)

# Command&Control: (Dropper) Bravix - regex: to_server:GET /members/link\.php\?wmid=.*&l=.*&it=.*&ad=.*&s=.* detector_id: 1702
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Bravix"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/members/link.php?wmid="; content:"&l="; content:"&it="; content:"&ad="; content:"&s="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/members\/link\.php\?wmid=.*&l=.*&it=.*&ad=.*&s=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001702; rev:1004;)

# Adware: (Toolbar) Hiu - regex: to_server:GET /pop\d*/add\.asp\?mac=.*&u=\d+.*User-Agent: Register detector_id: 1703
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Hiu"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/pop"; content:"/add.asp?mac="; content:"&u="; content:"User-Agent|3A| Register"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/pop\d*\/add\.asp\?mac=.*&u=\d+.*User-Agent: Register/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001703; rev:1002;)

# Command&Control: (Dropper) GenericDropper_29 - regex: to_server:GET /r\.php\?wm=.*&ucid=.*&e=.*&a=.* detector_id: 1705
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_29"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/r.php?wm="; content:"&ucid="; content:"&e="; content:"&a="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/r\.php\?wm=.*&ucid=.*&e=.*&a=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001705; rev:1004;)

# Command&Control: (Trojan) Banload - regex: to_server:POST /access/en\.php.*tipo=.*&tip=.*&inf=.*& detector_id: 1706
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Banload"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/access/en.php"; content:"tipo="; content:"&tip="; content:"&inf="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/access\/en\.php.*tipo=.*&tip=.*&inf=.*&/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001706; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_63 - regex: to_server:GET /g\.php\?a=l&n=.*.*User-Agent: Mozilla/3\.0 \(compatible; Indy Library\) detector_id: 1707
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_63"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/g.php?a=l&n="; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/g\.php\?a=l&n=.*.*User-Agent: Mozilla\/3\.0 \(compatible\; Indy Library\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001707; rev:1004;)

# Command&Control: (Trojan) Grum - regex: to_server:GET /spm/s_alive\.php\?id=.*&tick=.*&ver=.*&smtp=.*&sl=.*&fw=.*&pn=.*&psr=.* detector_id: 1708
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Grum"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/spm/s_alive.php?id="; content:"&tick="; content:"&ver="; content:"&smtp="; content:"&sl="; content:"&fw="; content:"&pn="; content:"&psr="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/spm\/s_alive\.php\?id=.*&tick=.*&ver=.*&smtp=.*&sl=.*&fw=.*&pn=.*&psr=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001708; rev:1004;)

# Command&Control: (Ransomware) Foreign - regex: to_server:GET /update/installed\d*\.php\?mac=.*&alreadyinstalled=\d detector_id: 1709
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) Foreign"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/update/installed"; content:".php?mac="; content:"&alreadyinstalled="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/update\/installed\d*\.php\?mac=.*&alreadyinstalled=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001709; rev:1002;)

# Command&Control: (Trojan) GenericTrojan_64 - regex: to_server:GET /GuidSystem/core\.php\?serial=.*&session=.*&key=.*&psetting=.*&computer=.*&fetching=.* detector_id: 1710
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_64"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/GuidSystem/core.php?serial="; content:"&session="; content:"&key="; content:"&psetting="; content:"&computer="; content:"&fetching="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/GuidSystem\/core\.php\?serial=.*&session=.*&key=.*&psetting=.*&computer=.*&fetching=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001710; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_65 - regex: to_server:GET /index\.php\?id=.*&co=.*&us=.*&os=.*&vr=.*&av=.*&dt=.* detector_id: 1711
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_65"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?id="; content:"&co="; content:"&us="; content:"&os="; content:"&vr="; content:"&av="; content:"&dt="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\?id=.*&co=.*&us=.*&os=.*&vr=.*&av=.*&dt=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001711; rev:1004;)

# Command&Control: (Dropper) Dluca - regex: to_server:GET /wk/getclientid\.wnk\?srv=.*&ver=.*&pin=.*&OSInfo2=.*&cinfo=.*&rts=.*&GMC=.* detector_id: 1712
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Dluca"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/wk/getclientid.wnk?srv="; content:"&ver="; content:"&pin="; content:"&OSInfo2="; content:"&cinfo="; content:"&rts="; content:"&GMC="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/wk\/getclientid\.wnk\?srv=.*&ver=.*&pin=.*&OSInfo2=.*&cinfo=.*&rts=.*&GMC=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001712; rev:1004;)

# Command&Control: (Dropper) Harnig - regex: to_server:GET /djmdyf/rvmusz.php\?id=.\d{9,10}&p=1 detector_id: 1713
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Harnig"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/djmdyf/rvmusz"; content:"php?id="; content:"&p=1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/djmdyf\/rvmusz.php\?id=.\d{9,10}&p=1/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001713; rev:380;)

# Adware: (Installer) HotBar Zango - regex: to_server:GET /versionconfig\.aspx\?did=\d+&ver=.*&brand=zango&os=.* detector_id: 1714
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Installer) HotBar Zango"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/versionconfig.aspx?did="; content:"&ver="; content:"&brand=zango&os="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/versionconfig\.aspx\?did=\d+&ver=.*&brand=zango&os=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001714; rev:1004;)

# Command&Control: (Dropper) GenericDropper_83 - regex: to_server:POST /Socks\.asp.*0=.*&1=.*&2=.*&3=\d*&4=\d*.*Host: .*:666 detector_id: 1715
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_83"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/Socks.asp"; content:"0="; content:"&1="; content:"&2="; content:"&3="; content:"&4="; content:"Host|3A| "; content:"|3A|666"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Socks\.asp.*0=.*&1=.*&2=.*&3=\d*&4=\d*.*Host: .*:666/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001715; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_75 - regex: to_server:GET .*/qwezxtyu/gdcds/.*/.*\.php\?id=[a-z0-9]{8} detector_id: 1716
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_75"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/qwezxtyu/gdcds/"; content:".php?id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/qwezxtyu\/gdcds\/.*\/.*\.php\?id=[a-z0-9]{8}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001716; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_76 - regex: to_server:GET /client_hujILILili/info\.php\?frevny=.*&bf=KC-FC\d*&qrynl=.*&ire=.*&hcqngvzr=.* detector_id: 1717
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_76"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/client_hujILILili/info.php?frevny="; content:"&bf=KC-FC"; content:"&qrynl="; content:"&ire="; content:"&hcqngvzr="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/client_hujILILili\/info\.php\?frevny=.*&bf=KC-FC\d*&qrynl=.*&ire=.*&hcqngvzr=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001717; rev:1004;)

# Command&Control: (Banker) GenericBanker_15 - regex: to_server:POST .*comunic\.php.*ext=.*&cliente=.*&mensagem=.*&tipo=.*&ftipo=.*&status=.* detector_id: 1718
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_15"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"comunic.php"; content:"ext="; content:"&cliente="; content:"&mensagem="; content:"&tipo="; content:"&ftipo="; content:"&status="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*comunic\.php.*ext=.*&cliente=.*&mensagem=.*&tipo=.*&ftipo=.*&status=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001718; rev:1002;)

# Command&Control: (Dropper) Winsoft Fosniw  - regex: to_server:GET .*r_autoidcnt\.asp\?mer_seq=.*&realid=.*&mac=.*&logdata=MacTryCnt.* detector_id: 1719
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Winsoft Fosniw "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"r_autoidcnt.asp?mer_seq="; content:"&realid="; content:"&mac="; content:"&logdata=MacTryCnt"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*r_autoidcnt\.asp\?mer_seq=.*&realid=.*&mac=.*&logdata=MacTryCnt.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001719; rev:1004;)

# Command&Control: (Dropper) GenericDropper_84 - regex: to_server:POST /acesso1\.php HTTP.*User-Agent: HTTP Client.*windows= detector_id: 1720
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_84"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/acesso1.php HTTP"; content:"User-Agent|3A| HTTP Client"; content:"windows="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/acesso1\.php HTTP.*User-Agent: HTTP Client.*windows=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001720; rev:660;)

# Command&Control: (Trojan) Agsurbot - regex: to_server:GET /google/new\.php\?code=[A-Z0-9]{10,14}&name=.*&version=\d{1,3} detector_id: 1721
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Agsurbot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/google/new.php?code="; content:"&name="; content:"&version="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/google\/new\.php\?code=[A-Z0-9]{10,14}&name=.*&version=\d{1,3}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001721; rev:1004;)

# Command&Control: (Trojan) Koobface - regex: to_server:GET /v\d*/search.php\?p=\d{4,6}&s=.*&v=\d+&uid=.\d{7,9}&q= detector_id: 1722
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Koobface"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/v"; content:"/search"; content:"php?p="; content:"&s="; content:"&v="; content:"&uid="; content:"&q="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/v\d*\/search.php\?p=\d{4,6}&s=.*&v=\d+&uid=.\d{7,9}&q=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001722; rev:384;)

# Command&Control: (Trojan) GenericTrojan_77 - regex: to_server:POST .*getc\.php.*i=.*&o=.*&wv=.*&uln=.*&uls=.*&ulf=.*&db=.*&cn=.*&hv=.*&raz=.* detector_id: 1723
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_77"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"getc.php"; content:"i="; content:"&o="; content:"&wv="; content:"&uln="; content:"&uls="; content:"&ulf="; content:"&db="; content:"&cn="; content:"&hv="; content:"&raz="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*getc\.php.*i=.*&o=.*&wv=.*&uln=.*&uls=.*&ulf=.*&db=.*&cn=.*&hv=.*&raz=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001723; rev:1002;)

# Adware: (Adware) NetOptimizer - regex: to_server:GET /conf/signin/.*\?tac=\d&ser=.*&ver=\d\.\d\.\d&rid=.*&cls=.* detector_id: 1724
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) NetOptimizer"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/conf/signin/"; content:"?tac="; content:"&ser="; content:"&ver="; content:"&rid="; content:"&cls="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/conf\/signin\/.*\?tac=\d&ser=.*&ver=\d\.\d\.\d&rid=.*&cls=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001724; rev:1004;)

# Command&Control: (Dropper) GenericDropper_85 - regex: to_server:POST /gateway/index.*botver=.*&build=.*&profile=.* detector_id: 1725
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_85"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/gateway/index"; content:"botver="; content:"&build="; content:"&profile="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/gateway\/index.*botver=.*&build=.*&profile=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001725; rev:384;)

# Adware: (Hoax) ArchSMS - regex: to_server:GET /(excount-new|excount)\.php\?file_id=\d{6}&hwid=[a-f0-9]{32} detector_id: 1730
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) ArchSMS"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?file_id="; content:"&hwid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(excount-new|excount)\.php\?file_id=\d{6}&hwid=[a-f0-9]{32}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001730; rev:1002;)

# Command&Control: (Dropper) GenericDropper_86 - regex: to_server:GET /Act/Ver1/active/active_count\.php\?mac=.*&pid=.* detector_id: 1731
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_86"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Act/Ver1/active/active_count.php?mac="; content:"&pid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Act\/Ver1\/active\/active_count\.php\?mac=.*&pid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001731; rev:1004;)

# Command&Control: (Dropper) Nflog - regex: to_server:POST /NfLog/Nfile\.asp.*GetFile detector_id: 1732
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Nflog"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/NfLog/Nfile.asp"; content:"GetFile"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/NfLog\/Nfile\.asp.*GetFile/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001732; rev:1004;)

# Command&Control: (Dialer) InstantAccess - regex: to_server:GET /Common/show_module\.php\?IsAutoGeneratedPage=.*&asked_billing_id=.*&original_asked_billing_id=.*&brokerid=.*&country=.*&customid=.*&product=.*&base=.*&mediaid=.*&custom_param=.*&extparam=.*&nums=.* detector_id: 1734
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dialer) InstantAccess"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Common/show_module.php?IsAutoGeneratedPage="; content:"&asked_billing_id="; content:"&original_asked_billing_id="; content:"&brokerid="; content:"&country="; content:"&customid="; content:"&product="; content:"&base="; content:"&mediaid="; content:"&custom_param="; content:"&extparam="; content:"&nums="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Common\/show_module\.php\?IsAutoGeneratedPage=.*&asked_billing_id=.*&original_asked_billing_id=.*&brokerid=.*&country=.*&customid=.*&product=.*&base=.*&mediaid=.*&custom_param=.*&extparam=.*&nums=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001734; rev:1004;)

# Command&Control: (Dropper) GenericDropper_87 - regex: to_server:GET .*stat\.php\?id=\d{9,11}&v=\d\.\d.*User-Agent: SickleBot detector_id: 1739
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_87"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"stat.php?id="; content:"&v="; content:"User-Agent|3A| SickleBot"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*stat\.php\?id=\d{9,11}&v=\d\.\d.*User-Agent: SickleBot/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001739; rev:1004;)

# Command&Control: (Trojan) Vundo - regex: to_server:GET /phpbb/slog\.php\?install=.*&ver=\d{1,3} detector_id: 1740
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Vundo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/phpbb/slog.php?install="; content:"&ver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/phpbb\/slog\.php\?install=.*&ver=\d{1,3}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001740; rev:591;)

# Command&Control: (Trojan) Quyl - regex: to_server:POST /cgi-bin/qylkernel\.cgi.*User-Agent: p2pinstkernel detector_id: 1741
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Quyl"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/cgi-bin/qylkernel.cgi"; content:"User-Agent|3A| p2pinstkernel"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cgi-bin\/qylkernel\.cgi.*User-Agent: p2pinstkernel/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001741; rev:1004;)

# Command&Control: (Trojan) Qhost - regex: to_server:POST /images/srvr/partner/(send|download_dll)\.php HTTP.*cparam=[a-zA-Z0-9\+/=]{40,} detector_id: 1742
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Qhost"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/images/srvr/partner/"; content:".php HTTP"; content:"cparam="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/images\/srvr\/partner\/(send|download_dll)\.php HTTP.*cparam=[a-zA-Z0-9\+\/=]{40,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001742; rev:491;)

# Command&Control: (Dropper) Nflog - regex: to_server:POST /norton/NfStart\.asp?ClientId=.*&Nick=.*&dtime=.* detector_id: 1743
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Nflog"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/norton/NfStart.as"; content:"ClientId="; content:"&Nick="; content:"&dtime="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/norton\/NfStart\.asp?ClientId=.*&Nick=.*&dtime=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001743; rev:1004;)

# Command&Control: (Dropper) GenericDropper_88 - regex: to_server:GET .*snwd\.php\?tp=\d&tg=.*&tv=Error.*&ts=.*&mt=.*&tr=.* detector_id: 1745
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_88"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"snwd.php?tp="; content:"&tg="; content:"&tv=Error"; content:"&ts="; content:"&mt="; content:"&tr="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*snwd\.php\?tp=\d&tg=.*&tv=Error.*&ts=.*&mt=.*&tr=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001745; rev:1004;)

# Adware: (Adware) Ithink - regex: to_server:GET /install\.asp\?version=\d\.\d\.\d\.\d&mac=[A-Z0-9]{12}&scode=s\d{4} detector_id: 3950
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Ithink"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/install.asp?version="; content:"&mac="; content:"&scode=s"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/install\.asp\?version=\d\.\d\.\d\.\d&mac=[A-Z0-9]{12}&scode=s\d{4}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1003950; rev:1004;)

# Command&Control: (Dropper) Gozi - regex: to_server:GET /system/sendmail\.py/options\?user_id=\d*&version_id=.*&crc=.*&uptime=.*&port=\d+&ip=.*&mark=.* detector_id: 3951
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Gozi"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/system/sendmail.py/options?user_id="; content:"&version_id="; content:"&crc="; content:"&uptime="; content:"&port="; content:"&ip="; content:"&mark="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/system\/sendmail\.py\/options\?user_id=\d*&version_id=.*&crc=.*&uptime=.*&port=\d+&ip=.*&mark=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1003951; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_78 - regex: to_server:GET /ksrun\.asp\?game=.*&mac=.*.*User-Agent: WebForm 1 detector_id: 3952
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_78"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ksrun.asp?game="; content:"&mac="; content:"User-Agent|3A| WebForm 1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ksrun\.asp\?game=.*&mac=.*.*User-Agent: WebForm 1/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1003952; rev:1004;)

# Command&Control: (Keylogger) MyKeyloggerOnline - regex: to_server:POST /log\.php HTTP.*User-Agent: Internet Explorer.*m=.*&u=.*&s=.*&d=.* detector_id: 5002
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Keylogger) MyKeyloggerOnline"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/log.php HTTP"; content:"User-Agent|3A| Internet Explorer"; content:"m="; content:"&u="; content:"&s="; content:"&d="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/log\.php HTTP.*User-Agent: Internet Explorer.*m=.*&u=.*&s=.*&d=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1005002; rev:722;)

# Command&Control: (Trojan) GenericTrojan_79 - regex: to_server:GET /(odin|ft)/si\.php\?get&exe&comp=.* detector_id: 5003
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_79"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/si.php?get&exe&comp="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(odin|ft)\/si\.php\?get&exe&comp=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1005003; rev:573;)

# command&control: GenericTrojan_80 - regex: to_server:POST /interface\.asp.*count=.*&data=.*&copy=.*&info=.* detector_id: 5004
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: GenericTrojan_80"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/interface.asp"; content:"count="; content:"&data="; content:"&copy="; content:"&info="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/interface\.asp.*count=.*&data=.*&copy=.*&info=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1005004; rev:1004;)

# command&control: Vobfus - regex: to_server:GET /1\?b HTTP detector_id: 5005
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: Vobfus"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/1?b HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/1\?b HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1005005; rev:394;)

# Adware: (Downware) InstallRex - regex: to_server:GET /get/\?data=.*&version=.*User-Agent: win32 detector_id: 5006
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) InstallRex"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get/?data="; content:"&version="; content:"User-Agent|3A| win32"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get\/\?data=.*&version=.*User-Agent: win32/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1005006; rev:771;)

# command&control: GBot - regex: to_server:GET /gbot/r\.php\?q=.* detector_id: 5007
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: GBot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/gbot/r.php?q="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/gbot\/r\.php\?q=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1005007; rev:1004;)

# command&control: Vobfus - regex: to_server:GET /1\?d HTTP detector_id: 5008
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: Vobfus"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/1?d HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/1\?d HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1005008; rev:394;)

# command&control: GBot - regex: to_server:GET /gbot/p\.php\?q=.* detector_id: 5009
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: GBot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/gbot/p.php?q="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/gbot\/p\.php\?q=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1005009; rev:1004;)

# command&control: GBot - regex: to_server:GET /gbot/t\.php\?q=.* detector_id: 5010
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: GBot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/gbot/t.php?q="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/gbot\/t\.php\?q=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1005010; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_83 - regex: to_server:GET .*/(nettraveler|dochunter)\.asp\?hostid=[A-F0-9]{8}&hostname=.*&hostip=.*&filename=.*&filestart=.*&filetext= detector_id: 5013
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_83"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".asp?hostid="; content:"&hostname="; content:"&hostip="; content:"&filename="; content:"&filestart="; content:"&filetext="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/(nettraveler|dochunter)\.asp\?hostid=[A-F0-9]{8}&hostname=.*&hostip=.*&filename=.*&filestart=.*&filetext=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1005013; rev:733;)

# Command&Control: (Dropper) GenericDropper_89 - regex: to_server:GET /bot/cmd6\.php\?guid=\{.*\}&os=.*&ver=\d\.\d detector_id: 5014
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_89"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bot/cmd6.php?guid=|7B|"; content:"|7D|&os="; content:"&ver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bot\/cmd6\.php\?guid=\{.*\}&os=.*&ver=\d\.\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1005014; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_84 - regex: to_server:GET .*all_good\.php\?id_good=.*&path_exe=.*&name_exe=.*.*User-Agent: DM detector_id: 5015
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_84"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"all_good.php?id_good="; content:"&path_exe="; content:"&name_exe="; content:"User-Agent|3A| DM"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*all_good\.php\?id_good=.*&path_exe=.*&name_exe=.*.*User-Agent: DM/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1005015; rev:1004;)

# Command&Control: (Backdoor) Protux - regex: to_server:POST .*/(ggBwkFNqDu1869|PHqgHumeay5705)\.(avi|mp3).*User-Agent: Mozilla/4\.8\.20 \(compatible; MSIE 5\.0\.2; Win32\) detector_id: 5016
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Protux"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"User-Agent|3A| Mozilla/4.8.20 |28|compatible|3B| MSIE 5.0.2|3B| Win32|29|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/(ggBwkFNqDu1869|PHqgHumeay5705)\.(avi|mp3).*User-Agent: Mozilla\/4\.8\.20 \(compatible\; MSIE 5\.0\.2\; Win32\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1005016; rev:652;)

# Adware: (Adware) GabPath - regex: to_server:POST /cfg\.php.*cfg_ver=.*&gz=.*&hwd=.*&ac=.*&sac=.*&ver=\d*&pop=.*&vinfo=.*&his=.* detector_id: 5017
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) GabPath"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/cfg.php"; content:"cfg_ver="; content:"&gz="; content:"&hwd="; content:"&ac="; content:"&sac="; content:"&ver="; content:"&pop="; content:"&vinfo="; content:"&his="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cfg\.php.*cfg_ver=.*&gz=.*&hwd=.*&ac=.*&sac=.*&ver=\d*&pop=.*&vinfo=.*&his=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1005017; rev:1004;)

# Command&Control: (Dropper) GenericDropper_90 - regex: to_server:GET /jiangjun/mibao\.asp\?act=.*.*Host: .*:733 detector_id: 5018
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_90"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/jiangjun/mibao.asp?act="; content:"Host|3A| "; content:"|3A|733"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/jiangjun\/mibao\.asp\?act=.*.*Host: .*:733/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1005018; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_85 - regex: to_server:GET /.*\?id=.*&t=.*&k=.*&c=.*.*User-Agent: My APP.*Host: .*:8080 detector_id: 7092
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_85"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?id="; content:"&t="; content:"&k="; content:"&c="; content:"User-Agent|3A| My APP"; content:"Host|3A| "; content:"|3A|8080"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\?id=.*&t=.*&k=.*&c=.*.*User-Agent: My APP.*Host: .*:8080/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1007092; rev:393;)

# Adware: (Downware) Kepma - regex: to_server:GET /xml\.php\?xcode=bcr[a-z]&iMAC=[a-f0-9]{12} detector_id: 7093
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Kepma"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/xml.php?xcode=bcr"; content:"&iMAC="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/xml\.php\?xcode=bcr[a-z]&iMAC=[a-f0-9]{12}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1007093; rev:1002;)

# command&control: Vobfus - regex: to_server:GET /1\?a HTTP detector_id: 7094
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: Vobfus"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/1?a HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/1\?a HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1007094; rev:394;)

# Command&Control: (Dropper) GenericDropper_91 - regex: to_server:GET /url/g3\.asp\?hjftcv=[0-9A-F]{6,9}&mgs=\d{2}.*&usdfsf=.* detector_id: 7095
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_91"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/url/g3.asp?hjftcv="; content:"&mgs="; content:"&usdfsf="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/url\/g3\.asp\?hjftcv=[0-9A-F]{6,9}&mgs=\d{2}.*&usdfsf=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1007095; rev:1004;)

# Command&Control: (Trojan) Eaghouse - regex: to_server:GET .*/ret\.php\?&name=.*&ip1=.*&ftpport=.*&ftpuser=.*&ftppass=.*&proxyport= detector_id: 7096
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Eaghouse"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ret.php?&name="; content:"&ip1="; content:"&ftpport="; content:"&ftpuser="; content:"&ftppass="; content:"&proxyport="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/ret\.php\?&name=.*&ip1=.*&ftpport=.*&ftpuser=.*&ftppass=.*&proxyport=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1007096; rev:635;)

# Command&Control: (Dropper) Bofang - regex: to_server:HEAD /zd/\?v=.*&q=.* detector_id: 7097
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Bofang"; flow:established,to_server; content:"HEAD"; nocase; http_method; content:"HEAD "; content:"/zd/?v="; content:"&q="; pcre:"/HEAD (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/zd\/\?v=.*&q=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1007097; rev:393;)

# Command&Control: (Dropper) Bofang - regex: to_server:GET /getsoft/task\.php\?v=.*&q=.* detector_id: 7098
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Bofang"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/getsoft/task.php?v="; content:"&q="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/getsoft\/task\.php\?v=.*&q=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1007098; rev:1004;)

# Command&Control: (Dropper) Bofang - regex: to_server:GET /noc/\?v=.*&id=.* detector_id: 7099
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Bofang"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/noc/?v="; content:"&id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/noc\/\?v=.*&id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1007099; rev:393;)

# Command&Control: (Dropper) Bofang - regex: to_server:HEAD .*/\?v=.*&q=.*User-Agent: Microsoft BITS detector_id: 7100
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Bofang"; flow:established,to_server; content:"HEAD"; nocase; http_method; content:"HEAD "; content:"/?v="; content:"&q="; content:"User-Agent|3A| Microsoft BITS"; pcre:"/HEAD (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/\?v=.*&q=.*User-Agent: Microsoft BITS/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1007100; rev:393;)

# command&control: GenericDropper_38 (Command&Control: (Dropper) GenericDropper_38) - regex: to_server:GET /d\.php.*User-Agent: DivSig detector_id: 7101
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: GenericDropper_38 (Command&Control: (Dropper) GenericDropper_38)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/d.php"; content:"User-Agent|3A| DivSig"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/d\.php.*User-Agent: DivSig/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1007101; rev:1004;)

# Command&Control: (Ransomware) Reveton_1 - regex: to_server:POST /top2/connor/zs1\.php.*mode=.*&UID=.*&version=.* detector_id: 7102
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) Reveton_1"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/top2/connor/zs1.php"; content:"mode="; content:"&UID="; content:"&version="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/top2\/connor\/zs1\.php.*mode=.*&UID=.*&version=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1007102; rev:1004;)

# Command&Control: (Dialer) Holistyc - regex: to_server:GET /HolistycServlets/HolistycDownload\.aspx\?dialler_id=.*&website_id=.*&locale=.*&inUSA=.*&connection=.*&downloadrate=.*&ispcode=.*&affiliate_number=.* detector_id: 7103
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dialer) Holistyc"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/HolistycServlets/HolistycDownload.aspx?dialler_id="; content:"&website_id="; content:"&locale="; content:"&inUSA="; content:"&connection="; content:"&downloadrate="; content:"&ispcode="; content:"&affiliate_number="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/HolistycServlets\/HolistycDownload\.aspx\?dialler_id=.*&website_id=.*&locale=.*&inUSA=.*&connection=.*&downloadrate=.*&ispcode=.*&affiliate_number=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1007103; rev:1004;)

# Command&Control: (Dropper) GenericDropper_92 - regex: to_server:POST /share/check\.asp.*Serial=[A-F0-9]{5,8}&name=.* detector_id: 7104
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_92"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/share/check.asp"; content:"Serial="; content:"&name="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/share\/check\.asp.*Serial=[A-F0-9]{5,8}&name=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1007104; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_87 - regex: to_server:GET /input\.do\?hotNm=.*&usId=.*&pCd=[A-Z]{1}\d+ detector_id: 8129
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_87"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/input.do?hotNm="; content:"&usId="; content:"&pCd="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/input\.do\?hotNm=.*&usId=.*&pCd=[A-Z]{1}\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1008129; rev:1004;)

# Command&Control: (TrojanProxy) Mitglieder - regex: to_server:GET /manager_old/images/.*\.php?p=\d*&id=.*.*User-Agent: szNotifyIdent detector_id: 12198
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (TrojanProxy) Mitglieder"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/manager_old/images/"; content:".ph"; content:"p="; content:"&id="; content:"User-Agent|3A| szNotifyIdent"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/manager_old\/images\/.*\.php?p=\d*&id=.*.*User-Agent: szNotifyIdent/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1012198; rev:1004;)

# Adware: (Adware) OpenShopper - regex: to_server:POST /opendb/mmsv\.php.*opp=.*&opver=\d.*&opc=.* detector_id: 12199
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) OpenShopper"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/opendb/mmsv.php"; content:"opp="; content:"&opver="; content:"&opc="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/opendb\/mmsv\.php.*opp=.*&opver=\d.*&opc=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1012199; rev:1004;)

# Adware: (Hoax) ArchSMS_1 - regex: to_server:POST /api\.php.*archive=.*&m=gettariffs.*&v=\d&version=\d*&sign=.*& detector_id: 12200
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) ArchSMS_1"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/api.php"; content:"archive="; content:"&m=gettariffs"; content:"&v="; content:"&version="; content:"&sign="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\.php.*archive=.*&m=gettariffs.*&v=\d&version=\d*&sign=.*&/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1012200; rev:1004;)

# Command&Control: (TrojanProxy) Kvadr Dosenjo - regex: to_server:GET /s\.html\?cachingDeny=.*&id=.*.*User-Agent: Kvadrlson \d\.\d detector_id: 19733
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (TrojanProxy) Kvadr Dosenjo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/s.html?cachingDeny="; content:"&id="; content:"User-Agent|3A| Kvadrlson "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/s\.html\?cachingDeny=.*&id=.*.*User-Agent: Kvadrlson \d\.\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1019733; rev:1004;)

# Adware: (Hoax) ArchSMS_1 - regex: to_server:GET /showthread\.php\?cgna=\d{6}&w2zu=[a-z0-9]{32}&l4=\d detector_id: 19734
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) ArchSMS_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/showthread.php?cgna="; content:"&w2zu="; content:"&l4="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/showthread\.php\?cgna=\d{6}&w2zu=[a-z0-9]{32}&l4=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1019734; rev:1004;)

# Command&Control: (Dropper) Kolbot - regex: to_server:GET .*/(genimg|index)\.php\?action=register&tr=\d&vr=\d{1,2}&wvr=\d detector_id: 19735
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Kolbot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?action=register&tr="; content:"&vr="; content:"&wvr="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/(genimg|index)\.php\?action=register&tr=\d&vr=\d{1,2}&wvr=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1019735; rev:583;)

# Command&Control: (Trojan) GenericTrojan_88 - regex: to_server:POST /stats/insert\.php.*uname=.*&hwid=.*&username=.*&osv=.*&osl=.*&mac=.*&ip=.* detector_id: 19736
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_88"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/stats/insert.php"; content:"uname="; content:"&hwid="; content:"&username="; content:"&osv="; content:"&osl="; content:"&mac="; content:"&ip="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/stats\/insert\.php.*uname=.*&hwid=.*&username=.*&osv=.*&osl=.*&mac=.*&ip=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1019736; rev:1004;)

# Command&Control: (Ransomware) LockScreen_1 - regex: to_server:GET /knock\?uid=.*&os=.*&partner_id=.*&hostname=.*&account=.*&language=[A-Z]{3}&codepage=.* detector_id: 21855
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) LockScreen_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/knock?uid="; content:"&os="; content:"&partner_id="; content:"&hostname="; content:"&account="; content:"&language="; content:"&codepage="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/knock\?uid=.*&os=.*&partner_id=.*&hostname=.*&account=.*&language=[A-Z]{3}&codepage=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1021855; rev:399;)

# Command&Control: (Trojan) GenericTrojan_89 - regex: to_server:POST /System/bots\.php.*iNameS=.*&iSOTipex=.*&STLftpsLogers=.*&PisMails=.*&IeStels=.*&Infos=.* detector_id: 22112
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_89"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/System/bots.php"; content:"iNameS="; content:"&iSOTipex="; content:"&STLftpsLogers="; content:"&PisMails="; content:"&IeStels="; content:"&Infos="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/System\/bots\.php.*iNameS=.*&iSOTipex=.*&STLftpsLogers=.*&PisMails=.*&IeStels=.*&Infos=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022112; rev:1004;)

# Command&Control: (Trojan) Scar_1 - regex: to_server:POST /ping/\d/nigh\.php.*id=.*&version=\d+&os=\d*&s5=\d detector_id: 22113
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Scar_1"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ping/"; content:"/nigh.php"; content:"id="; content:"&version="; content:"&os="; content:"&s5="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ping\/\d\/nigh\.php.*id=.*&version=\d+&os=\d*&s5=\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022113; rev:1004;)

# Command&Control: (Dropper) GenericDropper_94 - regex: to_server:POST /b/info\.php.*uuid=.*&wv=.*&cargo=.*&check=.* detector_id: 22116
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_94"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/b/info.php"; content:"uuid="; content:"&wv="; content:"&cargo="; content:"&check="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/b\/info\.php.*uuid=.*&wv=.*&cargo=.*&check=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022116; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_90 - regex: to_server:GET /ggbh/ggbh\.cgi\?position=.*.*User-Agent: Internet Explorer 6\.0 detector_id: 22120
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_90"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ggbh/ggbh.cgi?position="; content:"User-Agent|3A| Internet Explorer 6.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ggbh\/ggbh\.cgi\?position=.*.*User-Agent: Internet Explorer 6\.0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022120; rev:1004;)

# Adware: (Adware) EZula - regex: to_server:GET .*UVid\.asp\?PubName=.*&UserID=.*&ErrCode=.*&Stub=.*.*User-Agent: (eZula|mez) detector_id: 22121
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) EZula"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"UVid.asp?PubName="; content:"&UserID="; content:"&ErrCode="; content:"&Stub="; content:"User-Agent|3A| "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*UVid\.asp\?PubName=.*&UserID=.*&ErrCode=.*&Stub=.*.*User-Agent: (eZula|mez)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022121; rev:1002;)

# Command&Control: (Trojan) ServStart - regex: to_server:GET /count\.asp\?uid=\d+&mac=.{12}&pn=.*&type=.*.*User-Agent: Google \+\+ detector_id: 22122
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ServStart"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/count.asp?uid="; content:"&mac="; content:"&pn="; content:"&type="; content:"User-Agent|3A| Google |2B||2B|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/count\.asp\?uid=\d+&mac=.{12}&pn=.*&type=.*.*User-Agent: Google \+\+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022122; rev:1004;)

# Command&Control: (Trojan) Cycbot - regex: to_server:GET /images/logo\.png\?tq=g.*HoLmEqQ detector_id: 22123
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Cycbot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/images/logo.png?tq=g"; content:"HoLmEqQ"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/images\/logo\.png\?tq=g.*HoLmEqQ/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022123; rev:1004;)

# Command&Control: (Trojan) Sednit - regex: to_server:POST /~maxx/cgi-bin/[a-z]{3,4}\.cgi.*T0s= detector_id: 22127
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sednit"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/|7E|maxx/cgi-bin/"; content:".cgi"; content:"T0s="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/~maxx\/cgi-bin\/[a-z]{3,4}\.cgi.*T0s=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022127; rev:1004;)

# Adware: (Adware) Sodui - regex: to_server:GET .*/[A-F]{1}\.ini\?clid=.*&conid=.*&ver=.*.*User-Agent: updatesodui detector_id: 22128
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Sodui"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".ini?clid="; content:"&conid="; content:"&ver="; content:"User-Agent|3A| updatesodui"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/[A-F]{1}\.ini\?clid=.*&conid=.*&ver=.*.*User-Agent: updatesodui/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022128; rev:1004;)

# FakeAV: FakeInit - regex: to_server:GET /cgi-bin/download\.pl\?code=000\d{4} detector_id: 22129
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeInit"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cgi-bin/download.pl?code=000"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cgi-bin\/download\.pl\?code=000\d{4}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022129; rev:1004;)

# Command&Control: (Trojan) Yeltminky - regex: to_server:POST /Count\.asp.*Name=.*&SystemOS=.*.*User-Agent: MyApp detector_id: 22130
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Yeltminky"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/Count.asp"; content:"Name="; content:"&SystemOS="; content:"User-Agent|3A| MyApp"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Count\.asp.*Name=.*&SystemOS=.*.*User-Agent: MyApp/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022130; rev:1004;)

# Adware: (Adware) PlayMP3 - regex: to_server:GET /request/.*\?stage=setup&application=PlayMP3&campaign=.*&code=.*&version=.* detector_id: 22131
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) PlayMP3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/request/"; content:"?stage=setup&application=PlayMP3&campaign="; content:"&code="; content:"&version="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/request\/.*\?stage=setup&application=PlayMP3&campaign=.*&code=.*&version=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022131; rev:405;)

# FakeAV: FakeVimes - regex: to_server:HEAD /download\.php\?put=nogui&abbr=[A-Z]{4,6}&file=.* detector_id: 22132
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeVimes"; flow:established,to_server; content:"HEAD"; nocase; http_method; content:"HEAD "; content:"/download.php?put=nogui&abbr="; content:"&file="; pcre:"/HEAD (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/download\.php\?put=nogui&abbr=[A-Z]{4,6}&file=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022132; rev:1004;)

# Command&Control: (Dropper) Renos_8 - regex: to_server:GET /firstrun\.php\?product=.*&aff=.*&update=\d{4}.* detector_id: 22133
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Renos_8"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/firstrun.php?product="; content:"&aff="; content:"&update="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/firstrun\.php\?product=.*&aff=.*&update=\d{4}.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022133; rev:1004;)

# Command&Control: (Dropper) Fluknion - regex: to_server:GET /external/kfm/get\.php\?id=\d+&forcedownload=1 detector_id: 22134
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Fluknion"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/external/kfm/get.php?id="; content:"&forcedownload=1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/external\/kfm\/get\.php\?id=\d+&forcedownload=1/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022134; rev:1004;)

# Command&Control: (Backdoor) GenericBackdoor_4 - regex: to_server:GET .*/work\.php\?method=.*&port=\d+&type=.*&winver=.* detector_id: 22135
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) GenericBackdoor_4"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/work.php?method="; content:"&port="; content:"&type="; content:"&winver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/work\.php\?method=.*&port=\d+&type=.*&winver=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022135; rev:1004;)

# Command&Control: (Dropper) Anedl - regex: to_server:GET [/a-z]*/(g|gate)\.php\?id=\d{6,9} HTTP.*User-Agent: al detector_id: 22136
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Anedl"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?id="; content:" HTTP"; content:"User-Agent|3A| al"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?[\/a-z]*\/(g|gate)\.php\?id=\d{6,9} HTTP.*User-Agent: al/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022136; rev:606;)

# Command&Control: (TrojanProxy) GenericTrojan_91 - regex: to_server:GET /sam/report\.php\?sp=\d*&clsid=.*&vers=.*&new=.*&rid=.*&osi=.* detector_id: 22138
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (TrojanProxy) GenericTrojan_91"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/sam/report.php?sp="; content:"&clsid="; content:"&vers="; content:"&new="; content:"&rid="; content:"&osi="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/sam\/report\.php\?sp=\d*&clsid=.*&vers=.*&new=.*&rid=.*&osi=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022138; rev:1004;)

# Command&Control: (Trojan) Diofopi - regex: to_server:POST /newimage\.asp\?imageid=.*&type=\d&resid=\d+.*User-Agent: iexplorer detector_id: 22139
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Diofopi"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/newimage.asp?imageid="; content:"&type="; content:"&resid="; content:"User-Agent|3A| iexplorer"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/newimage\.asp\?imageid=.*&type=\d&resid=\d+.*User-Agent: iexplorer/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022139; rev:1002;)

# Command&Control: (Trojan) Cinmus - regex: to_server:GET /getdll\.php\?version=\d\.\d\.\d&mac=.*&fid=\d{4,6} detector_id: 22140
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Cinmus"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/getdll.php?version="; content:"&mac="; content:"&fid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/getdll\.php\?version=\d\.\d\.\d&mac=.*&fid=\d{4,6}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022140; rev:1004;)

# Command&Control: (Trojan) Zonebac - regex: to_server:GET .*/checkin\.php\?cid=.*&aid=.*&time=.*&fw=.*&v=\d*&m=.*&vm=.* detector_id: 22141
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zonebac"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/checkin.php?cid="; content:"&aid="; content:"&time="; content:"&fw="; content:"&v="; content:"&m="; content:"&vm="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/checkin\.php\?cid=.*&aid=.*&time=.*&fw=.*&v=\d*&m=.*&vm=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022141; rev:1004;)

# Adware: (Adware) SmartBrowser - regex: to_server:GET /updatex/updateZ\.asp\?ip=.*&id=.*&bw=.*&yoy=.*&goy=.* detector_id: 22142
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) SmartBrowser"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/updatex/updateZ.asp?ip="; content:"&id="; content:"&bw="; content:"&yoy="; content:"&goy="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/updatex\/updateZ\.asp\?ip=.*&id=.*&bw=.*&yoy=.*&goy=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022142; rev:1004;)

# Click-Fraud: GenericClickFraud_1 - regex: to_server:GET .*hailiang\.(asp|aspx)\?action=install&ver=.*&mac=.*&lianmeng=.*&shada=.*&system=.*&ie=.*&alexa=.*&lang=.* detector_id: 22144
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Click-Fraud: GenericClickFraud_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"hailiang."; content:"?action=install&ver="; content:"&mac="; content:"&lianmeng="; content:"&shada="; content:"&system="; content:"&ie="; content:"&alexa="; content:"&lang="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*hailiang\.(asp|aspx)\?action=install&ver=.*&mac=.*&lianmeng=.*&shada=.*&system=.*&ie=.*&alexa=.*&lang=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022144; rev:1002;)

# FakeAV: FraudPack - regex: to_server:GET /404\.php\?type=.*&affid=.*&subid=.*&version=\d\.\d&installok detector_id: 22145
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FraudPack"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/404.php?type="; content:"&affid="; content:"&subid="; content:"&version="; content:"&installok"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/404\.php\?type=.*&affid=.*&subid=.*&version=\d\.\d&installok/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022145; rev:1002;)

# Command&Control: (Banker) GenericBanker_16 - regex: to_server:POST .*enviador\.php HTTP.*he=.*&topo=.*&msg=.*& detector_id: 22146
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_16"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"enviador.php HTTP"; content:"he="; content:"&topo="; content:"&msg="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*enviador\.php HTTP.*he=.*&topo=.*&msg=.*&/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022146; rev:722;)

# Command&Control: (Banker) Bancos_1 - regex: to_server:POST /mengol/sntemp\.php.*name="serie\d" detector_id: 22147
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Bancos_1"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/mengol/sntemp.php"; content:"name=|22|serie"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mengol\/sntemp\.php.*name="serie\d"/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022147; rev:1002;)

# FakeAV: FakeVimes - regex: to_server:GET /download\.php\?put=nogui&abbr=.*&file=.*&getsize=.* detector_id: 22148
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeVimes"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/download.php?put=nogui&abbr="; content:"&file="; content:"&getsize="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/download\.php\?put=nogui&abbr=.*&file=.*&getsize=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022148; rev:1004;)

# Command&Control: (Trojan) GenericTrojan_92 - regex: to_server:GET /Project1\.dll\?[a-z0-9]{7,9}.*User-Agent: Microsoft Internet Explorer detector_id: 22149
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_92"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Project1.dll?"; content:"User-Agent|3A| Microsoft Internet Explorer"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Project1\.dll\?[a-z0-9]{7,9}.*User-Agent: Microsoft Internet Explorer/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022149; rev:1004;)

# Command&Control: (Trojan) PasswordStealer_2 - regex: to_server:POST .*count\.asp.*Id=\d{2}-\d{2}-\d{2}-\d{2}-\d{2}-\d{2}&Exe=.*.*User-Agent: MzApp detector_id: 22154
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) PasswordStealer_2"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"count.asp"; content:"Id="; content:"&Exe="; content:"User-Agent|3A| MzApp"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*count\.asp.*Id=\d{2}-\d{2}-\d{2}-\d{2}-\d{2}-\d{2}&Exe=.*.*User-Agent: MzApp/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022154; rev:1002;)

# Command&Control: (Trojan) GenericTrojan_93 - regex: to_server:GET .*/api/process\.php\?xy=[A-Za-z0-9]{80,120}.*User-Agent: PCICompliant/\d\.\d{1,2} detector_id: 22155
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_93"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/api/process.php?xy="; content:"User-Agent|3A| PCICompliant/"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/api\/process\.php\?xy=[A-Za-z0-9]{80,120}.*User-Agent: PCICompliant\/\d\.\d{1,2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022155; rev:498;)

# Adware: (Adware) SurfAccuracy - regex: to_server:GET .*sacc\.cfg\.php\?cfg_ver=nocfg&gz=.*&hwd=.*&ac=.*&sac=.*&ver=\d*&pop=.*&his=.* detector_id: 22156
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) SurfAccuracy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"sacc.cfg.php?cfg_ver=nocfg&gz="; content:"&hwd="; content:"&ac="; content:"&sac="; content:"&ver="; content:"&pop="; content:"&his="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*sacc\.cfg\.php\?cfg_ver=nocfg&gz=.*&hwd=.*&ac=.*&sac=.*&ver=\d*&pop=.*&his=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022156; rev:1002;)

# Command&Control: (Trojan) Rustock - regex: to_server:POST .*getcfg\.php.*id=.*&ln=.*&cn=.*&nt=.*&bid=.* detector_id: 22157
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Rustock"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"getcfg.php"; content:"id="; content:"&ln="; content:"&cn="; content:"&nt="; content:"&bid="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*getcfg\.php.*id=.*&ln=.*&cn=.*&nt=.*&bid=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022157; rev:1002;)

# Command&Control: (Trojan) Cosmu - regex: to_server:GET /GoGo\.ashx\?Mac=.*&UserId=\d+&Bate=\d\.\d{1,2} detector_id: 22158
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Cosmu"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/GoGo.ashx?Mac="; content:"&UserId="; content:"&Bate="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/GoGo\.ashx\?Mac=.*&UserId=\d+&Bate=\d\.\d{1,2}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022158; rev:718;)

# Malware Distribution: Malicious Redirection Endpoint - regex: to_server:GET .*/components/\.[0-9a-z]{6}\.php\?receipt=(ss00_323|8\d{2}_\d{7,9}) detector_id: 22159
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Malware Distribution: Malicious Redirection Endpoint"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/components/."; content:".php?receipt="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/components\/\.[0-9a-z]{6}\.php\?receipt=(ss00_323|8\d{2}_\d{7,9})/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022159; rev:413;)

# Command&Control: (Trojan) Koceg Socks - regex: to_server:GET .*manda\.php\?id=\d{6,}&v=.*&s=.*.*User-Agent: _ detector_id: 22160
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Koceg Socks"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"manda.php?id="; content:"&v="; content:"&s="; content:"User-Agent|3A| _"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*manda\.php\?id=\d{6,}&v=.*&s=.*.*User-Agent: _/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022160; rev:1002;)

# Adware: (Toolbar) Ourxin - regex: to_server:GET /cfs/reguser\.php\?guid=[A-Z0-9]*&vdr=[A-Z0-9]{1,6} detector_id: 22161
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Ourxin"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cfs/reguser.php?guid="; content:"&vdr="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cfs\/reguser\.php\?guid=[A-Z0-9]*&vdr=[A-Z0-9]{1,6}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022161; rev:486;)

# Command&Control: (Dropper) Zdesnado - regex: to_server:GET /xpsystem/report\.php\?user_id=\d+&status=.*&country_id=\d*&platform=\d*&minor=\d*&major=\d* detector_id: 22162
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Zdesnado"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/xpsystem/report.php?user_id="; content:"&status="; content:"&country_id="; content:"&platform="; content:"&minor="; content:"&major="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/xpsystem\/report\.php\?user_id=\d+&status=.*&country_id=\d*&platform=\d*&minor=\d*&major=\d*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022162; rev:1002;)

# Command&Control: (Backdoor) Nuclear - regex: to_server:GET /logger\.php\?action=log&type=.*&host=.*&port=\d*\/\d*&name=.*&pc=.*&user=.* detector_id: 22163
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Nuclear"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/logger.php?action=log&type="; content:"&host="; content:"&port="; content:"&name="; content:"&pc="; content:"&user="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/logger\.php\?action=log&type=.*&host=.*&port=\d*\/\d*&name=.*&pc=.*&user=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022163; rev:1002;)

# Command&Control: (Dropper) Chekafev - regex: to_server:GET .*/get\.asp\?mac=.*&makedate=.*&comput=Home&ver=\d*&userid=.* detector_id: 22164
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Chekafev"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get.asp?mac="; content:"&makedate="; content:"&comput=Home&ver="; content:"&userid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/get\.asp\?mac=.*&makedate=.*&comput=Home&ver=\d*&userid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022164; rev:718;)

# Command&Control: (Dropper) GenericDropper_60 - regex: to_server:GET /videos/skydl\d*\.php\?cid=[a-z0-9]{16}&id=.*&file=.*\.exe detector_id: 22165
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_60"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/videos/skydl"; content:".php?cid="; content:"&id="; content:"&file="; content:".exe"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/videos\/skydl\d*\.php\?cid=[a-z0-9]{16}&id=.*&file=.*\.exe/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022165; rev:1004;)

# Command&Control: (Worm) Bobax - regex: to_server:GET /reg\?u=[A-Z0-9]{8}&v=\d{2,4}&s=\d+&su=\d*&p=1&e=0&o=0 detector_id: 22166
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Bobax"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/reg?u="; content:"&v="; content:"&s="; content:"&su="; content:"&p=1&e=0&o=0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/reg\?u=[A-Z0-9]{8}&v=\d{2,4}&s=\d+&su=\d*&p=1&e=0&o=0/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022166; rev:415;)

# Adware: (Adware) SurfSideKick - regex: to_server:GET /iinfo\.htm\?host=.*&action=update&ver=.*&bundle=.*&client=.*&bp_id=.*&prmerr=.*&crc=.*&ir=\d detector_id: 22167
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) SurfSideKick"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/iinfo.htm?host="; content:"&action=update&ver="; content:"&bundle="; content:"&client="; content:"&bp_id="; content:"&prmerr="; content:"&crc="; content:"&ir="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/iinfo\.htm\?host=.*&action=update&ver=.*&bundle=.*&client=.*&bp_id=.*&prmerr=.*&crc=.*&ir=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022167; rev:1002;)

# Command&Control: (Dropper) Hupigon - regex: to_server:GET /mfp/do\.asp\?eve=get&username=.*&anma=[a-z]*&ver=\d{2,5} detector_id: 22168
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Hupigon"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mfp/do.asp?eve=get&username="; content:"&anma="; content:"&ver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mfp\/do\.asp\?eve=get&username=.*&anma=[a-z]*&ver=\d{2,5}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022168; rev:538;)

# Command&Control: (Trojan) GenericTrojan_94 - regex: to_server:GET /rouhostsip2008\.txt\?sid=\d{6} detector_id: 22169
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_94"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/rouhostsip2008.txt?sid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/rouhostsip2008\.txt\?sid=\d{6}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022169; rev:1002;)

# Command&Control: (Backdoor) Beksnoc - regex: to_server:POST .*.*q=[a-z]{1}&id=.*&o=.*&v=\d\.\d\.\d{1,2}&me=.*&pck=.*&u=.* detector_id: 22170
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Beksnoc"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"q="; content:"&id="; content:"&o="; content:"&v="; content:"&me="; content:"&pck="; content:"&u="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*.*q=[a-z]{1}&id=.*&o=.*&v=\d\.\d\.\d{1,2}&me=.*&pck=.*&u=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022170; rev:416;)

# Command&Control: (Trojan) Zlob_3 - regex: to_server:GET .*\.php\?Code=\d+&V=.*&ID=.{40}&.{6} detector_id: 22171
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zlob_3"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?Code="; content:"&V="; content:"&ID="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php\?Code=\d+&V=.*&ID=.{40}&.{6}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022171; rev:1002;)

# Command&Control: (Trojan) FakeSysdef - regex: to_server:GET /s\.php\?0Q9[A-Za-z0-9\+/]*={0,2} detector_id: 22172
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) FakeSysdef"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/s.php?0Q9"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/s\.php\?0Q9[A-Za-z0-9\+\/]*={0,2}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022172; rev:1002;)

# Command&Control: (Trojan) Hitpop - regex: to_server:GET .*active\.asp\?ver=\d+&tgid=.*&address=.*&old=[0-1]{1}&flag=.*&alexa=[0-1]{1} detector_id: 22173
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Hitpop"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"active.asp?ver="; content:"&tgid="; content:"&address="; content:"&old="; content:"&flag="; content:"&alexa="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*active\.asp\?ver=\d+&tgid=.*&address=.*&old=[0-1]{1}&flag=.*&alexa=[0-1]{1}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022173; rev:1002;)

# Command&Control: (Trojan) Alureon_5 TDSS - regex: to_server:GET /seneka/engine/engine\.php\?d=[A-Za-z0-9\+/]{25,}={0,2} detector_id: 22174
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Alureon_5 TDSS"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/seneka/engine/engine.php?d="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/seneka\/engine\/engine\.php\?d=[A-Za-z0-9\+\/]{25,}={0,2}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022174; rev:1002;)

# Adware: (Toolbar) AdRotator_1 - regex: to_server:POST /bc/123kah\.php.*showed=.*&clicked=.*&version=.*&id=.*&tm=.*&tail=.* detector_id: 22175
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) AdRotator_1"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/bc/123kah.php"; content:"showed="; content:"&clicked="; content:"&version="; content:"&id="; content:"&tm="; content:"&tail="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bc\/123kah\.php.*showed=.*&clicked=.*&version=.*&id=.*&tm=.*&tail=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022175; rev:1002;)

# Command&Control: (Banker) GenericBanker_17 - regex: to_server:POST .*conta_infects\.php.*pcnome=.*&pcmacadress=.*&pcip=.*&pcserial=.*&veros=.*& detector_id: 22253
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_17"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"conta_infects.php"; content:"pcnome="; content:"&pcmacadress="; content:"&pcip="; content:"&pcserial="; content:"&veros="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*conta_infects\.php.*pcnome=.*&pcmacadress=.*&pcip=.*&pcserial=.*&veros=.*&/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022253; rev:1002;)

# Command&Control: (Trojan) Neurotickat - regex: to_server:GET /cgi-bin/blah\.cgi\?action=log&ip=.*&port=\d+.*&id=.*&win=.*&rpass=.*&connection=.* detector_id: 22254
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Neurotickat"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cgi-bin/blah.cgi?action=log&ip="; content:"&port="; content:"&id="; content:"&win="; content:"&rpass="; content:"&connection="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cgi-bin\/blah\.cgi\?action=log&ip=.*&port=\d+.*&id=.*&win=.*&rpass=.*&connection=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022254; rev:1002;)

# Command&Control: (Backdoor) Ciadoor - regex: to_server:GET /add\.php\?action=.*&ip=.*&port=\d+&vicname=.*&usrname=.*&server=.*&password=.*&opsys=.*&country=.*&webcam=.* detector_id: 22255
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Ciadoor"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/add.php?action="; content:"&ip="; content:"&port="; content:"&vicname="; content:"&usrname="; content:"&server="; content:"&password="; content:"&opsys="; content:"&country="; content:"&webcam="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/add\.php\?action=.*&ip=.*&port=\d+&vicname=.*&usrname=.*&server=.*&password=.*&opsys=.*&country=.*&webcam=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022255; rev:1002;)

# Adware: (Adware) ABetterInternet - regex: to_server:GET /.*\?UID=.*&VERSION=.*&ATL=.*&fstat=\d*&affid=\d+&pid=.*&level=.*&hdd=.*&macd=.*.*User-Agent: IEP detector_id: 22256
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) ABetterInternet"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?UID="; content:"&VERSION="; content:"&ATL="; content:"&fstat="; content:"&affid="; content:"&pid="; content:"&level="; content:"&hdd="; content:"&macd="; content:"User-Agent|3A| IEP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\?UID=.*&VERSION=.*&ATL=.*&fstat=\d*&affid=\d+&pid=.*&level=.*&hdd=.*&macd=.*.*User-Agent: IEP/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022256; rev:420;)

# Command&Control: (Trojan) Hitpop - regex: to_server:GET /install\.asp\?ver=\d*&tgid=.*&address=.*&regk=1&flag=.*&frandom=\d* detector_id: 22257
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Hitpop"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/install.asp?ver="; content:"&tgid="; content:"&address="; content:"&regk=1&flag="; content:"&frandom="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/install\.asp\?ver=\d*&tgid=.*&address=.*&regk=1&flag=.*&frandom=\d*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022257; rev:1002;)

# FakeAV: FakeAntiSpyware - regex: to_server:GET /stat\.php\?func=install&pid=.*&ip=.*&landing=.* detector_id: 22258
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeAntiSpyware"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/stat.php?func=install&pid="; content:"&ip="; content:"&landing="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/stat\.php\?func=install&pid=.*&ip=.*&landing=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022258; rev:1002;)

# Command&Control: (Trojan) Kovter - regex: to_server:GET /form\.php\?mode=\d&UID=.*&OS=.*&OSbit=x(32|64) detector_id: 22259
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Kovter"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/form.php?mode="; content:"&UID="; content:"&OS="; content:"&OSbit=x"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/form\.php\?mode=\d&UID=.*&OS=.*&OSbit=x(32|64)/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022259; rev:1002;)

# Command&Control: (Trojan) GenericTrojan_95 - regex: to_server:GET /insert\.asp\?uid=.*&bh=.*&t=.*&Cha=.*.*User-Agent: IE6\.O detector_id: 22260
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_95"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/insert.asp?uid="; content:"&bh="; content:"&t="; content:"&Cha="; content:"User-Agent|3A| IE6.O"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/insert\.asp\?uid=.*&bh=.*&t=.*&Cha=.*.*User-Agent: IE6\.O/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022260; rev:1002;)

# FakeAV: WinWebSec - regex: to_server:GET /in\.php\?affid=\d{5}&url=\d&win=.* detector_id: 22267
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: WinWebSec"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/in.php?affid="; content:"&url="; content:"&win="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/in\.php\?affid=\d{5}&url=\d&win=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022267; rev:1002;)

# Command&Control: (Dropper) GenericDropper_95 - regex: to_server:GET /css/install\.asp\?mac=[a-f0-9]{5,9}.*User-Agent: MyAgent\d+ detector_id: 22268
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_95"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/css/install.asp?mac="; content:"User-Agent|3A| MyAgent"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/css\/install\.asp\?mac=[a-f0-9]{5,9}.*User-Agent: MyAgent\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022268; rev:1002;)

# Adware: (Toolbar) Mirar - regex: to_server:GET /report\.cgi\?APP=.*&BUILDNAME=\d+&ID=.*&VERSION=\d+&LOG=.*&OS=.*&IEVERSION=\d+&TID=.*&INSTALLED=[0-1]{1} detector_id: 22269
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Mirar"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/report.cgi?APP="; content:"&BUILDNAME="; content:"&ID="; content:"&VERSION="; content:"&LOG="; content:"&OS="; content:"&IEVERSION="; content:"&TID="; content:"&INSTALLED="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/report\.cgi\?APP=.*&BUILDNAME=\d+&ID=.*&VERSION=\d+&LOG=.*&OS=.*&IEVERSION=\d+&TID=.*&INSTALLED=[0-1]{1}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022269; rev:1002;)

# Command&Control: (Dropper) GenericDropper_96 - regex: to_server:GET /ack\.php\?uid=.*&version=\d{2,5}&actionname=.*&action=.*&success=.*&debug=.*&nocache=\d+ detector_id: 22270
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_96"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ack.php?uid="; content:"&version="; content:"&actionname="; content:"&action="; content:"&success="; content:"&debug="; content:"&nocache="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ack\.php\?uid=.*&version=\d{2,5}&actionname=.*&action=.*&success=.*&debug=.*&nocache=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022270; rev:1002;)

# Command&Control: (Trojan) GenericTrojan_96 - regex: to_server:GET /SelectTaskENC\.ashx\?t=.*&rnd=[a-zA-Z]{5}&hash=[a-f0-9]{32} detector_id: 22271
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_96"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/SelectTaskENC.ashx?t="; content:"&rnd="; content:"&hash="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/SelectTaskENC\.ashx\?t=.*&rnd=[a-zA-Z]{5}&hash=[a-f0-9]{32}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022271; rev:1002;)

# Command&Control: (Trojan) Jorik - regex: to_server:GET /pab\.php\?omh=[a-z0-9]{8}&oic=.*&s=\d{2,4}&mhj=.* detector_id: 22278
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Jorik"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/pab.php?omh="; content:"&oic="; content:"&s="; content:"&mhj="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/pab\.php\?omh=[a-z0-9]{8}&oic=.*&s=\d{2,4}&mhj=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022278; rev:1002;)

# Command&Control: (Trojan) GenericTrojan_97 - regex: to_server:GET /recv\.php\?key=.*&compname=.*&ipaddress=.*.*User-Agent: Open detector_id: 22279
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_97"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/recv.php?key="; content:"&compname="; content:"&ipaddress="; content:"User-Agent|3A| Open"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/recv\.php\?key=.*&compname=.*&ipaddress=.*.*User-Agent: Open/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022279; rev:1002;)

# Command&Control: (Banker) GenericBanker_18 - regex: to_server:GET /victim/.*\?act=add&appdata=\d+&hd=.*&mac=.*&computador=.* detector_id: 22280
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_18"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/victim/"; content:"?act=add&appdata="; content:"&hd="; content:"&mac="; content:"&computador="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/victim\/.*\?act=add&appdata=\d+&hd=.*&mac=.*&computador=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022280; rev:427;)

# Command&Control: (Dropper) GenericDropper_97 - regex: to_server:POST /asp/download\.asp.*privateIP=.*.*Host: .*:20101 detector_id: 22281
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_97"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/asp/download.asp"; content:"privateIP="; content:"Host|3A| "; content:"|3A|20101"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/asp\/download\.asp.*privateIP=.*.*Host: .*:20101/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022281; rev:1002;)

# Command&Control: (Dropper) Quyl_1 - regex: to_server:GET /qyl\.exe\?p=.*.*User-Agent: Microsoft Internet Explorer detector_id: 22282
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Quyl_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/qyl.exe?p="; content:"User-Agent|3A| Microsoft Internet Explorer"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/qyl\.exe\?p=.*.*User-Agent: Microsoft Internet Explorer/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022282; rev:1002;)

# Command&Control: (Trojan) Swisyn_1 - regex: to_server:GET /AddSetup\.asp\?id=\d{1,2}&localID=[A-Z]{2}.*&isqq=\d detector_id: 22283
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Swisyn_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/AddSetup.asp?id="; content:"&localID="; content:"&isqq="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/AddSetup\.asp\?id=\d{1,2}&localID=[A-Z]{2}.*&isqq=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022283; rev:1002;)

# Command&Control: (Trojan) AgentByPass - regex: to_server:GET /selectport\d*\.php\?id=.*User-Agent: MSIE9 detector_id: 22284
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) AgentByPass"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/selectport"; content:".php?id="; content:"User-Agent|3A| MSIE9"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/selectport\d*\.php\?id=.*User-Agent: MSIE9/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022284; rev:1538;)

# Command&Control: (Backdoor) Mosucker - regex: to_server:GET .*put\.php\?ip=.*&port=\+\d*&nick=.*&country=.*&visible=.*&protected=.*&about=.* detector_id: 22285
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Mosucker"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"put.php?ip="; content:"&port=|2B|"; content:"&nick="; content:"&country="; content:"&visible="; content:"&protected="; content:"&about="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*put\.php\?ip=.*&port=\+\d*&nick=.*&country=.*&visible=.*&protected=.*&about=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022285; rev:1002;)

# Command&Control: (Dropper) GenericDropper_98 - regex: to_server:GET /[a-z]*/(popup\.exe|minie\.exe|urlnav\.dll)\?ver=\d.*uid=.*lip=.*mac=.*p=.*b= detector_id: 22286
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_98"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?ver="; content:"uid="; content:"lip="; content:"mac="; content:"p="; content:"b="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]*\/(popup\.exe|minie\.exe|urlnav\.dll)\?ver=\d.*uid=.*lip=.*mac=.*p=.*b=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022286; rev:1004;)

# Command&Control: (Trojan) Ebod - regex: to_server:GET .*o3h289\.php\?adduser=.*&owner_id=.*&macaddress=.*&logonid=.*\\\\.* detector_id: 22287
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ebod"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"o3h289.php?adduser="; content:"&owner_id="; content:"&macaddress="; content:"&logonid="; content:"|5C||5C|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*o3h289\.php\?adduser=.*&owner_id=.*&macaddress=.*&logonid=.*\\\\.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022287; rev:1002;)

# Command&Control: (Trojan) Stwoyle - regex: to_server:GET .*uprav\.php\?v=\d*&in=\{.*&cn=.*&la=.*&tk=.*&sg=\d&vie=\d&vu=\d&l=.* detector_id: 22288
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Stwoyle"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"uprav.php?v="; content:"&in=|7B|"; content:"&cn="; content:"&la="; content:"&tk="; content:"&sg="; content:"&vie="; content:"&vu="; content:"&l="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*uprav\.php\?v=\d*&in=\{.*&cn=.*&la=.*&tk=.*&sg=\d&vie=\d&vu=\d&l=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022288; rev:1002;)

# Command&Control: (Dropper) Karagany_1 - regex: to_server:POST .*qrqweZ0p8r\.php.*User-Agent: Opera/11\.01 Presto/2\.2\.30 detector_id: 22289
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Karagany_1"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"qrqweZ0p8r.php"; content:"User-Agent|3A| Opera/11.01 Presto/2.2.30"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*qrqweZ0p8r\.php.*User-Agent: Opera\/11\.01 Presto\/2\.2\.30/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022289; rev:1002;)

# Adware: (Adware) MediaMotor - regex: to_server:GET /log3\.php\?c=\{.*\}&what=newinstall&aff=.*&country=.* detector_id: 22290
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) MediaMotor"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/log3.php?c=|7B|"; content:"|7D|&what=newinstall&aff="; content:"&country="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/log3\.php\?c=\{.*\}&what=newinstall&aff=.*&country=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022290; rev:1002;)

# Command&Control: (Dropper) Renos_9 - regex: to_server:GET /download_main\.php\?aid=\d{3}.*User-Agent: Mozilla/4\.0 \(compatible; MSIE 5\.0; Windows 98\) detector_id: 22291
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Renos_9"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/download_main.php?aid="; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 5.0|3B| Windows 98|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/download_main\.php\?aid=\d{3}.*User-Agent: Mozilla\/4\.0 \(compatible\; MSIE 5\.0\; Windows 98\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022291; rev:1002;)

# Adware: (Toolbar) Webbuying - regex: to_server:GET .*/inst\.php\?d=0&cl=.*&l=.*&e=.*&v=.*&uid=.*&time=.*&win=.*&un=\d*&st=\d* detector_id: 22292
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Webbuying"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/inst.php?d=0&cl="; content:"&l="; content:"&e="; content:"&v="; content:"&uid="; content:"&time="; content:"&win="; content:"&un="; content:"&st="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/inst\.php\?d=0&cl=.*&l=.*&e=.*&v=.*&uid=.*&time=.*&win=.*&un=\d*&st=\d*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022292; rev:1002;)

# Command&Control: (TrojanProxy) GenericTrojan_99 - regex: to_server:GET /register\.php\?id=[a-zA-Z]*&port=\d+&connect=.*&ver=\d*&intip=.*.*User-Agent: WinProxy detector_id: 22293
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (TrojanProxy) GenericTrojan_99"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/register.php?id="; content:"&port="; content:"&connect="; content:"&ver="; content:"&intip="; content:"User-Agent|3A| WinProxy"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/register\.php\?id=[a-zA-Z]*&port=\d+&connect=.*&ver=\d*&intip=.*.*User-Agent: WinProxy/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022293; rev:1002;)

# Command&Control: (Worm) Psyokym - regex: to_server:GET /extract\.php\?x=.*&ip=.*&un=.*&exe=\d{3,}.*User-Agent: VB OpenUrl detector_id: 22294
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Psyokym"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/extract.php?x="; content:"&ip="; content:"&un="; content:"&exe="; content:"User-Agent|3A| VB OpenUrl"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/extract\.php\?x=.*&ip=.*&un=.*&exe=\d{3,}.*User-Agent: VB OpenUrl/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022294; rev:1002;)

# Command&Control: (Trojan) Carberp - regex: to_server:POST /set/first\.html.*id=.*&os=.*&plist=.* detector_id: 22295
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Carberp"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/set/first.html"; content:"id="; content:"&os="; content:"&plist="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/set\/first\.html.*id=.*&os=.*&plist=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022295; rev:1002;)

# Command&Control: (Ransomware) Krap - regex: to_server:GET /_req/.*\?type=.*&sid=.*&sw=.*&ostype=.*&ossp=.*&osbits=\d*&osfwtype=.*&osrights=.* detector_id: 22296
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) Krap"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/_req/"; content:"?type="; content:"&sid="; content:"&sw="; content:"&ostype="; content:"&ossp="; content:"&osbits="; content:"&osfwtype="; content:"&osrights="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/_req\/.*\?type=.*&sid=.*&sw=.*&ostype=.*&ossp=.*&osbits=\d*&osfwtype=.*&osrights=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022296; rev:431;)

# Command&Control: (Backdoor) GenericBackdoor_5 - regex: to_server:GET .*TZL_AT\.php\?hl=.*&cpv=.*&tm=.*&dh=.*&dw=.*&wt=.*&wl=.*&chost=.*&inurl=.*&rep=.*&swh=.* detector_id: 22297
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) GenericBackdoor_5"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"TZL_AT.php?hl="; content:"&cpv="; content:"&tm="; content:"&dh="; content:"&dw="; content:"&wt="; content:"&wl="; content:"&chost="; content:"&inurl="; content:"&rep="; content:"&swh="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*TZL_AT\.php\?hl=.*&cpv=.*&tm=.*&dh=.*&dw=.*&wt=.*&wl=.*&chost=.*&inurl=.*&rep=.*&swh=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022297; rev:1002;)

# Command&Control: (Dropper) Winsoft Fosniw - regex: to_server:GET .*/config/\?prj=.*&pid=.*&mac=.*&logdata=MacTryCnt.*&code=default&ver=.*&idt=.* detector_id: 22298
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Winsoft Fosniw"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/config/?prj="; content:"&pid="; content:"&mac="; content:"&logdata=MacTryCnt"; content:"&code=default&ver="; content:"&idt="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/config\/\?prj=.*&pid=.*&mac=.*&logdata=MacTryCnt.*&code=default&ver=.*&idt=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022298; rev:434;)

# FakeAV: Cleaner2009Pro - regex: to_server:GET /.*\?action=\d*&a=.*&l=.*&f=.*&p=.*&addt=.*&pc_id=.*&abbr=.*.*User-Agent: Statistican detector_id: 22299
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: Cleaner2009Pro"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?action="; content:"&a="; content:"&l="; content:"&f="; content:"&p="; content:"&addt="; content:"&pc_id="; content:"&abbr="; content:"User-Agent|3A| Statistican"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\?action=\d*&a=.*&l=.*&f=.*&p=.*&addt=.*&pc_id=.*&abbr=.*.*User-Agent: Statistican/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022299; rev:434;)

# Command&Control: (TrojanProxy) GenericTrojan_103 - regex: to_server:GET /cgi-bin/update\.pl\?p=.*&id=.*.*User-Agent: s0cks4 detector_id: 22300
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (TrojanProxy) GenericTrojan_103"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cgi-bin/update.pl?p="; content:"&id="; content:"User-Agent|3A| s0cks4"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cgi-bin\/update\.pl\?p=.*&id=.*.*User-Agent: s0cks4/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022300; rev:733;)

# Command&Control: (Worm) Passma - regex: to_server:GET /secure/test_pattern\.txt\?Rand=\d*.*User-Agent: Smileware Connection detector_id: 22301
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Passma"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/secure/test_pattern.txt?Rand="; content:"User-Agent|3A| Smileware Connection"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/secure\/test_pattern\.txt\?Rand=\d*.*User-Agent: Smileware Connection/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022301; rev:1002;)

# Adware: (Toolbar) HotBar Zango - regex: to_server:POST /php/rpc_uci\.php.*User-Agent: ZC XML-RPC C\+\+ Client detector_id: 22302
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) HotBar Zango"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/php/rpc_uci.php"; content:"User-Agent|3A| ZC XML-RPC C|2B||2B| Client"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/php\/rpc_uci\.php.*User-Agent: ZC XML-RPC C\+\+ Client/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022302; rev:1002;)

# Command&Control: (Trojan) GenericTrojan_101 - regex: to_server:GET .*stat\.php\?nick=.*&info=.*.*User-Agent: SUiCiDE/1\.5 detector_id: 22303
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_101"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"stat.php?nick="; content:"&info="; content:"User-Agent|3A| SUiCiDE/1.5"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*stat\.php\?nick=.*&info=.*.*User-Agent: SUiCiDE\/1\.5/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022303; rev:1002;)

# Command&Control: (Dropper) Heloag - regex: to_server:GET /reg\.asp\?port=\d{3,4}.*User-Agent: helloAgent detector_id: 22304
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Heloag"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/reg.asp?port="; content:"User-Agent|3A| helloAgent"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/reg\.asp\?port=\d{3,4}.*User-Agent: helloAgent/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022304; rev:1002;)

# Adware: (Toolbar) GenericAdware_12 QQHelper - regex: to_server:GET .*ADService\.asmx/SendSoftInfo2\?SoftName=.*\.exe&SoftVersion=.*&UserIP=.*&Mac=.* detector_id: 22305
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) GenericAdware_12 QQHelper"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"ADService.asmx/SendSoftInfo2?SoftName="; content:".exe&SoftVersion="; content:"&UserIP="; content:"&Mac="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*ADService\.asmx\/SendSoftInfo2\?SoftName=.*\.exe&SoftVersion=.*&UserIP=.*&Mac=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022305; rev:1002;)

# Command&Control: (Dropper) GenericDropper_99 - regex: to_server:GET .*\?a=.*&c=.*.*User-Agent: ver:.*\|os:.*\|admin:.*\|arch:.*\|conf:.*\|port:\d* detector_id: 22306
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_99"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?a="; content:"&c="; content:"User-Agent|3A| ver|3A|"; content:"|7C|os|3A|"; content:"|7C|admin|3A|"; content:"|7C|arch|3A|"; content:"|7C|conf|3A|"; content:"|7C|port|3A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\?a=.*&c=.*.*User-Agent: ver:.*\|os:.*\|admin:.*\|arch:.*\|conf:.*\|port:\d*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022306; rev:437;)

# Command&Control: (Dropper) Small_1 - regex: to_server:GET .*ind\.php\?p=.*&uid=.*&aid=.*.*User-Agent: Mozilla/4\.0 \(compatible; MSIE 4\.0; Windows 95\) detector_id: 22307
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Small_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"ind.php?p="; content:"&uid="; content:"&aid="; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 4.0|3B| Windows 95|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*ind\.php\?p=.*&uid=.*&aid=.*.*User-Agent: Mozilla\/4\.0 \(compatible\; MSIE 4\.0\; Windows 95\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022307; rev:1002;)

# Command&Control: (Trojan) Matcash_1 - regex: to_server:GET /rp\.txt\?iam=.*&v=.*&m=.*.*User-Agent: Windows \d\.\d \(\d*\); DMCP.* detector_id: 22308
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Matcash_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/rp.txt?iam="; content:"&v="; content:"&m="; content:"User-Agent|3A| Windows "; content:" |28|"; content:"|29||3B| DMCP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/rp\.txt\?iam=.*&v=.*&m=.*.*User-Agent: Windows \d\.\d \(\d*\)\; DMCP.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022308; rev:1002;)

# FakeAV: FraudLoad - regex: to_server:GET /admin/cgi-bin/check_update\.php\?type=site detector_id: 22309
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FraudLoad"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/admin/cgi-bin/check_update.php?type=site"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/admin\/cgi-bin\/check_update\.php\?type=site/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022309; rev:1002;)

# Command&Control: (Trojan) Ranbyus - regex: to_server:GET /[a-z]{1}/index\.php\?id=.*&session=\d+&v=.*&name=.*&mj=.*&mi=.*&pt=.*&b=.* detector_id: 22310
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ranbyus"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?id="; content:"&session="; content:"&v="; content:"&name="; content:"&mj="; content:"&mi="; content:"&pt="; content:"&b="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{1}\/index\.php\?id=.*&session=\d+&v=.*&name=.*&mj=.*&mi=.*&pt=.*&b=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022310; rev:1002;)

# Command&Control: (Dropper) GenericDropper_78 - regex: to_server:POST .*connect\.php.*pcname=.*&botver=.*&country=.*&winver=.*&hwid=.* detector_id: 22311
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_78"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"connect.php"; content:"pcname="; content:"&botver="; content:"&country="; content:"&winver="; content:"&hwid="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*connect\.php.*pcname=.*&botver=.*&country=.*&winver=.*&hwid=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022311; rev:1002;)

# Command&Control: (Trojan) Gozi_1 - regex: to_server:GET /system/prinimalka\.py/options\?user_id=.*&version_id=.*&crc=.*&uptime=.*&port=\d+&ip= detector_id: 22312
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Gozi_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/system/prinimalka.py/options?user_id="; content:"&version_id="; content:"&crc="; content:"&uptime="; content:"&port="; content:"&ip="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/system\/prinimalka\.py\/options\?user_id=.*&version_id=.*&crc=.*&uptime=.*&port=\d+&ip=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022312; rev:1002;)

# FakeAV: FakeXPA_1 - regex: to_server:GET /supportcheck/udb/.*\?i=[a-f0-9]{32}&p=.*&res=.* detector_id: 22313
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeXPA_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/supportcheck/udb/"; content:"?i="; content:"&p="; content:"&res="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/supportcheck\/udb\/.*\?i=[a-f0-9]{32}&p=.*&res=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022313; rev:438;)

# Command&Control: (Trojan) Riberow - regex: to_server:POST /ppp/postit3\.php.*Content-Type: multipart/form-data; boundary=.* detector_id: 22314
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Riberow"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ppp/postit3.php"; content:"Content-Type|3A| multipart/form-data|3B| boundary="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ppp\/postit3\.php.*Content-Type: multipart\/form-data\; boundary=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022314; rev:1002;)

# Adware: (Adware) SurfSideKick - regex: to_server:GET /rinfo\.htm\?host=.*&action=update&ver=.*&bundle=.*&client=SSK.*&bp_id=.*&po_id=.*&guid=.*&win=.*&ie=.*&def=.*&reg=.*&ch=.* detector_id: 22315
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) SurfSideKick"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/rinfo.htm?host="; content:"&action=update&ver="; content:"&bundle="; content:"&client=SSK"; content:"&bp_id="; content:"&po_id="; content:"&guid="; content:"&win="; content:"&ie="; content:"&def="; content:"&reg="; content:"&ch="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/rinfo\.htm\?host=.*&action=update&ver=.*&bundle=.*&client=SSK.*&bp_id=.*&po_id=.*&guid=.*&win=.*&ie=.*&def=.*&reg=.*&ch=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022315; rev:1002;)

# Command&Control: (Backdoor) SixMuch - regex: to_server:GET /cike\.php\?fid=.{3,4}&cid=.{12}&ver=\d*&tid=\d&sn=.*&wc=.* detector_id: 22316
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) SixMuch"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cike.php?fid="; content:"&cid="; content:"&ver="; content:"&tid="; content:"&sn="; content:"&wc="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cike\.php\?fid=.{3,4}&cid=.{12}&ver=\d*&tid=\d&sn=.*&wc=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022316; rev:1002;)

# Command&Control: (Dropper) Wzhyk_1 - regex: to_server:GET /cd/un2\.php\?id=[A-F0-9\-]{15,17}&ver=.* detector_id: 22317
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Wzhyk_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cd/un2.php?id="; content:"&ver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cd\/un2\.php\?id=[A-F0-9\-]{15,17}&ver=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022317; rev:1002;)

# Command&Control: (Dropper) Chekafe - regex: to_server:GET /admin/count\.php\?id=.*&isInst=.*&lockcode=.*&mac=.*&PcType=.*&AvName=.*&ProCount=.* detector_id: 22318
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Chekafe"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/admin/count.php?id="; content:"&isInst="; content:"&lockcode="; content:"&mac="; content:"&PcType="; content:"&AvName="; content:"&ProCount="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/admin\/count\.php\?id=.*&isInst=.*&lockcode=.*&mac=.*&PcType=.*&AvName=.*&ProCount=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022318; rev:718;)

# Command&Control: (Banker) Banbra_1 - regex: to_server:GET /hyoga\.php\?nomepc=.*&osName=.* detector_id: 22319
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Banbra_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/hyoga.php?nomepc="; content:"&osName="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/hyoga\.php\?nomepc=.*&osName=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022319; rev:1002;)

# Command&Control: (Trojan) GenericTrojan_79 - regex: to_server:POST /ft/si\.php\?enc&comp=.*&ext=.*\.[a-z]{3} detector_id: 22320
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_79"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ft/si.php?enc&comp="; content:"&ext="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ft\/si\.php\?enc&comp=.*&ext=.*\.[a-z]{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022320; rev:711;)

# Command&Control: (Trojan) AgentBypass - regex: to_server:POST /(par|index|test)/bfg\.php HTTP.*User-Agent: PARADISE.*status= detector_id: 22321
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) AgentBypass"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/bfg.php HTTP"; content:"User-Agent|3A| PARADISE"; content:"status="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(par|index|test)\/bfg\.php HTTP.*User-Agent: PARADISE.*status=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022321; rev:598;)

# Adware: (Adware) WhenU - regex: to_server:GET .*/save\.cfg\.php\?cfg_ver=nocfg&gz=.*&idn=.*&hwd=.*&ac=.*&sac=.*&campaign=.*&ver=.* detector_id: 22322
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) WhenU"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/save.cfg.php?cfg_ver=nocfg&gz="; content:"&idn="; content:"&hwd="; content:"&ac="; content:"&sac="; content:"&campaign="; content:"&ver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/save\.cfg\.php\?cfg_ver=nocfg&gz=.*&idn=.*&hwd=.*&ac=.*&sac=.*&campaign=.*&ver=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022322; rev:1002;)

# Command&Control: (Dialer) GenericDialer_2 - regex: to_server:GET .*login\.cfm\?IDDIALER=.*&IPLOCAL=.*&SYSOP=.*&NAVEG=.* detector_id: 22323
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dialer) GenericDialer_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"login.cfm?IDDIALER="; content:"&IPLOCAL="; content:"&SYSOP="; content:"&NAVEG="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*login\.cfm\?IDDIALER=.*&IPLOCAL=.*&SYSOP=.*&NAVEG=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022323; rev:1002;)

# Adware: (Adware) SecondThought - regex: to_server:GET /bundles\.php\?id=.*&exename=.*\.exe.*User-Agent: Internet Explorer detector_id: 22324
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) SecondThought"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bundles.php?id="; content:"&exename="; content:".exe"; content:"User-Agent|3A| Internet Explorer"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bundles\.php\?id=.*&exename=.*\.exe.*User-Agent: Internet Explorer/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022324; rev:1002;)

# Command&Control: (Backdoor) Zegost - regex: to_server:GET /cgi/online\.asp\?hostname=.*&httptype=\[1\]\[.*\] detector_id: 22325
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Zegost"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cgi/online.asp?hostname="; content:"&httptype=|5B|1|5D||5B|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cgi\/online\.asp\?hostname=.*&httptype=\[1\]\[.*\]/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022325; rev:1002;)

# Adware: (Downware) InstallRex - regex: to_server:POST /get/ HTTP/1\.1\r\n.*\r\n\r\ndata=[a-zA-Z0-9%/]+&version=2 detector_id: 22326
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) InstallRex"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/get/ HTTP/1.1|0D||0A|"; content:"|0D||0A||0D||0A|data="; content:"&version=2"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get\/ HTTP\/1\.1\r\n.*\r\n\r\ndata=[a-zA-Z0-9%\/]+&version=2/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022326; rev:590;)

# Command&Control: (Ransomware) Foreign_1 - regex: to_server:GET /images\.php\?id=[A-F0-9]{20}&cvr=\d*&ver=.*&ltype=.*&stat=.* detector_id: 22327
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) Foreign_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/images.php?id="; content:"&cvr="; content:"&ver="; content:"&ltype="; content:"&stat="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/images\.php\?id=[A-F0-9]{20}&cvr=\d*&ver=.*&ltype=.*&stat=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022327; rev:1002;)

# Command&Control: (Trojan) Simda - regex: to_server:GET /\?[a-zA-Z0-9]{5,10}=%96%[^&]* HTTP.*Host: report\.[0-9a-z]{15,20}\.com detector_id: 22328
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Simda"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?"; content:"=|25|96|25|"; content:" HTTP"; content:"Host|3A| report."; content:".com"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?[a-zA-Z0-9]{5,10}=%96%[^&]* HTTP.*Host: report\.[0-9a-z]{15,20}\.com/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022328; rev:1004;)

# Adware: (Downware) Kepma - regex: to_server:GET /log/\?modeAct=(run|install)&iMAC=.{12}&iPID=brc[a-z] detector_id: 22329
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Kepma"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/log/?modeAct="; content:"&iMAC="; content:"&iPID=brc"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/log\/\?modeAct=(run|install)&iMAC=.{12}&iPID=brc[a-z]/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022329; rev:445;)

# Adware: (Downware) Kraddare - regex: to_server:GET /log/\?modeAct=INSTALL&iMAC=.{12}&iPID=part\d detector_id: 22330
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Kraddare"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/log/?modeAct=INSTALL&iMAC="; content:"&iPID=part"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/log\/\?modeAct=INSTALL&iMAC=.{12}&iPID=part\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022330; rev:445;)

# Adware: (Downware) Kraddare - regex: to_server:GET /xml\.php\?xcode=10\d{2}&iMAC=[a-f0-9]{12}  detector_id: 22331
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Kraddare"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/xml.php?xcode=10"; content:"&iMAC="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/xml\.php\?xcode=10\d{2}&iMAC=[a-f0-9]{12} /"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022331; rev:1002;)

# Command&Control: (Dropper) Haed - regex: to_server:GET /cjtest/conf\.jsp\?v=\d&pk=\d{4,6}&uid=.* detector_id: 22332
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Haed"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cjtest/conf.jsp?v="; content:"&pk="; content:"&uid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cjtest\/conf\.jsp\?v=\d&pk=\d{4,6}&uid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022332; rev:1002;)

# Adware: (Hoax) ArchSMS_1 - regex: to_server:GET /api/archive_api\?method=stats&regos=.*.*Host: .*:81 detector_id: 22333
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) ArchSMS_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/api/archive_api?method=stats&regos="; content:"Host|3A| "; content:"|3A|81"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/archive_api\?method=stats&regos=.*.*Host: .*:81/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022333; rev:448;)

# Command&Control: (Trojan) Bredolab - regex: to_server:GET .*controller\.php\?action=bot&entity_list=.*&first=\d*&guid=.*&rnd=.* detector_id: 22334
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bredolab"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"controller.php?action=bot&entity_list="; content:"&first="; content:"&guid="; content:"&rnd="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*controller\.php\?action=bot&entity_list=.*&first=\d*&guid=.*&rnd=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022334; rev:1002;)

# Command&Control: (Ransomware) Revoyem - regex: to_server:GET .*in\.php\?id=[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}&os=\d\.\d.*&bot_id=.* detector_id: 22335
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) Revoyem"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"in.php?id="; content:"&os="; content:"&bot_id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*in\.php\?id=[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}&os=\d\.\d.*&bot_id=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022335; rev:1002;)

# Command&Control: (Trojan) Oficla - regex: to_server:GET /(forum|img)\.php\?v=\d&id=.*&b=.*&tm=.*&os=.*&av=.*&br=.*& detector_id: 22336
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Oficla"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?v="; content:"&id="; content:"&b="; content:"&tm="; content:"&os="; content:"&av="; content:"&br="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(forum|img)\.php\?v=\d&id=.*&b=.*&tm=.*&os=.*&av=.*&br=.*&/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022336; rev:721;)

# Command&Control: (Banker) GenericBanker_19 - regex: to_server:POST /inff\.php HTTP/1\.0.*User-Agent: Mozilla/3\.0 \(compatible; Indy Library\).*op=info&informacao= detector_id: 22337
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_19"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/inff.php HTTP/1.0"; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; content:"op=info&informacao="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/inff\.php HTTP\/1\.0.*User-Agent: Mozilla\/3\.0 \(compatible\; Indy Library\).*op=info&informacao=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022337; rev:784;)

# Command&Control: (Trojan) Sality_5 - regex: to_server:GET /new/.*\?add&ver=\d\.\d&hwid=.*&pc=.*&user=.*&os=\d\.\d&arch=\d* detector_id: 22338
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sality_5"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/new/"; content:"?add&ver="; content:"&hwid="; content:"&pc="; content:"&user="; content:"&os="; content:"&arch="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/new\/.*\?add&ver=\d\.\d&hwid=.*&pc=.*&user=.*&os=\d\.\d&arch=\d*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022338; rev:451;)

# Exploit Toolkit: (SQL Injection Campaign) Nikjju - regex: to_server:GET /?fp=.*&prvtof=.*&cifr=\d& HTTP/1\.0 detector_id: 22339
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Exploit Toolkit: (SQL Injection Campaign) Nikjju"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"fp="; content:"&prvtof="; content:"&cifr="; content:"& HTTP/1.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/?fp=.*&prvtof=.*&cifr=\d& HTTP\/1\.0/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022339; rev:1004;)

# Command&Control: (Dropper) Vorloma - regex: to_server:GET /tool/dtsys\.exe\?.*Host: \d+\.\d+\.\d+\.\d+ detector_id: 22340
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Vorloma"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/tool/dtsys.exe?"; content:"Host|3A| "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/tool\/dtsys\.exe\?.*Host: \d+\.\d+\.\d+\.\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022340; rev:1002;)

# Command&Control: (Trojan) Zbot_1 - regex: to_server:GET /ajax\.jsp\?v=\d.*X-ZCID: .* detector_id: 22341
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zbot_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ajax.jsp?v="; content:"X-ZCID|3A| "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ajax\.jsp\?v=\d.*X-ZCID: .*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022341; rev:1002;)

# Command&Control: (Trojan) Magania - regex: to_server:GET /post\.php\?mac=.*&os=.*&avs=.*&ps=.*&ver=.*&pnum=\d*.*User-Agent: Google page detector_id: 22381
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Magania"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/post.php?mac="; content:"&os="; content:"&avs="; content:"&ps="; content:"&ver="; content:"&pnum="; content:"User-Agent|3A| Google page"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/post\.php\?mac=.*&os=.*&avs=.*&ps=.*&ver=.*&pnum=\d*.*User-Agent: Google page/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022381; rev:721;)

# Command&Control: (Dropper) Umbald - regex: to_server:POST .*/bot\.php HTTP.*User-Agent: umbra.*mode=\d&UID=[A-F0-9]{30} detector_id: 22382
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Umbald"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/bot.php HTTP"; content:"User-Agent|3A| umbra"; content:"mode="; content:"&UID="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/bot\.php HTTP.*User-Agent: umbra.*mode=\d&UID=[A-F0-9]{30}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022382; rev:710;)

# Command&Control: (Trojan) Shiz_1 - regex: to_server:GET /knock\.php\?n=[A-F0-9]{8}&s=seller-\d{2} detector_id: 22383
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Shiz_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/knock.php?n="; content:"&s=seller-"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/knock\.php\?n=[A-F0-9]{8}&s=seller-\d{2}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022383; rev:721;)

# Command&Control: (Trojan) SmartPepi - regex: to_server:GET .*smartmain\.php\?type=main&ver=\[\d*\]\[\d*\]\[\d*\]&time=.*&group=.*&pver=.*&host=.* detector_id: 22384
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) SmartPepi"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"smartmain.php?type=main&ver=|5B|"; content:"|5D||5B|"; content:"|5D||5B|"; content:"|5D|&time="; content:"&group="; content:"&pver="; content:"&host="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*smartmain\.php\?type=main&ver=\[\d*\]\[\d*\]\[\d*\]&time=.*&group=.*&pver=.*&host=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022384; rev:733;)

# Command&Control: (Trojan) Rustock - regex: to_server:POST .*check\.php.*id=.*&bid=.*&getp=.*User-Agent: iexplorer8\.0 detector_id: 22401
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Rustock"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"check.php"; content:"id="; content:"&bid="; content:"&getp="; content:"User-Agent|3A| iexplorer8.0"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*check\.php.*id=.*&bid=.*&getp=.*User-Agent: iexplorer8\.0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022401; rev:722;)

# Command&Control: (Backdoor) Refpron - regex: to_server:GET /perfmonss\.bin detector_id: 22414
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Refpron"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/perfmonss.bin"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/perfmonss\.bin/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022414; rev:721;)

# Command&Control: (Backdoor) Bionet - regex: to_server:POST /scripts/WWPMsg\.dll.*from=.*&fromemail=.*&subject=.*&body=Version.*Computer.*Port.*Pass.*&to=.*&Send=GCi detector_id: 22416
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Bionet"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/scripts/WWPMsg.dll"; content:"from="; content:"&fromemail="; content:"&subject="; content:"&body=Version"; content:"Computer"; content:"Port"; content:"Pass"; content:"&to="; content:"&Send=GCi"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/scripts\/WWPMsg\.dll.*from=.*&fromemail=.*&subject=.*&body=Version.*Computer.*Port.*Pass.*&to=.*&Send=GCi/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022416; rev:721;)

# Command&Control: (Backdoor) Beastdoor - regex: to_server:POST /scripts/WWPMsg\.dll.*from=Beast.*&fromemail=.*&subject=.*Notification.*&body=.*&to=.*&Send= detector_id: 22417
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Beastdoor"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/scripts/WWPMsg.dll"; content:"from=Beast"; content:"&fromemail="; content:"&subject="; content:"Notification"; content:"&body="; content:"&to="; content:"&Send="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/scripts\/WWPMsg\.dll.*from=Beast.*&fromemail=.*&subject=.*Notification.*&body=.*&to=.*&Send=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022417; rev:721;)

# Command&Control: (Dropper) Zdesnado - regex: to_server:GET /xpsystem/report\.php\?user_id=\d{1,3}&status=0&country_id=\d{1,3} detector_id: 22428
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Zdesnado"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/xpsystem/report.php?user_id="; content:"&status=0&country_id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/xpsystem\/report\.php\?user_id=\d{1,3}&status=0&country_id=\d{1,3}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022428; rev:721;)

# Command&Control: (Trojan) ZeroAccess Sirefef - regex: to_server:GET /count\.php\?page=\d{5,7}&style=.*&nbdigits=\d{1,2}.*User-Agent: Opera/1(0|1) detector_id: 22429
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZeroAccess Sirefef"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/count.php?page="; content:"&style="; content:"&nbdigits="; content:"User-Agent|3A| Opera/1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/count\.php\?page=\d{5,7}&style=.*&nbdigits=\d{1,2}.*User-Agent: Opera\/1(0|1)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022429; rev:488;)

# Command&Control: (Banker) GenericBanker_20 - regex: to_server:POST /index\.php.*tipo=.*&XP=.*& detector_id: 22441
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_20"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/index.php"; content:"tipo="; content:"&XP="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php.*tipo=.*&XP=.*&/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022441; rev:721;)

# Command&Control: (Dropper) GenericDropper_100 - regex: to_server:GET /ld\.php\?lv=\d{1,3}.*User-Agent: msctls_progress32 detector_id: 22456
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_100"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ld.php?lv="; content:"User-Agent|3A| msctls_progress32"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ld\.php\?lv=\d{1,3}.*User-Agent: msctls_progress32/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022456; rev:721;)

# Command&Control: (Dropper) Vundo - regex: to_server:GET .*/stget\.php\?sign=.*&key=\d+&id=.*&av=.*&pa=.*&os=.*&vm=.*&digital=.*&rst= detector_id: 22457
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Vundo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/stget.php?sign="; content:"&key="; content:"&id="; content:"&av="; content:"&pa="; content:"&os="; content:"&vm="; content:"&digital="; content:"&rst="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/stget\.php\?sign=.*&key=\d+&id=.*&av=.*&pa=.*&os=.*&vm=.*&digital=.*&rst=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022457; rev:484;)

# Adware: (Toolbar) GenericAdware_13 Cpush - regex: to_server:GET /Install\.php\?cid=\d{6}&all=[0-1]{1}.*User-Agent: My HTTP detector_id: 22459
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) GenericAdware_13 Cpush"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Install.php?cid="; content:"&all="; content:"User-Agent|3A| My HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Install\.php\?cid=\d{6}&all=[0-1]{1}.*User-Agent: My HTTP/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022459; rev:721;)

# Command&Control: (Trojan) Shiz - regex: to_server:POST /(news|home)\.php.*User-Agent: Mozilla/4\.0 \(compatible; MSIE 2\.0; Windows NT 5\.0; detector_id: 22467
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Shiz"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 2.0|3B| Windows NT 5.0|3B|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(news|home)\.php.*User-Agent: Mozilla\/4\.0 \(compatible\; MSIE 2\.0\; Windows NT 5\.0\;/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022467; rev:469;)

# Adware: (Downware) DownloadAdmin - regex: to_server:GET /install\?brand=.*&pid=.*&bc=\d+&country=[A-Z]{2} detector_id: 22485
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) DownloadAdmin"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/install?brand="; content:"&pid="; content:"&bc="; content:"&country="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/install\?brand=.*&pid=.*&bc=\d+&country=[A-Z]{2}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022485; rev:471;)

# Command&Control: (Trojan) Zbot_2 - regex: to_server:POST .*/ads.{3,8}\.php.*User-Agent: z00sAgent/4\.0\(compatible;MSIE7\.0;WindowsNT5\.1;SV1\) detector_id: 22486
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zbot_2"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ads"; content:".php"; content:"User-Agent|3A| z00sAgent/4.0|28|compatible|3B|MSIE7.0|3B|WindowsNT5.1|3B|SV1|29|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/ads.{3,8}\.php.*User-Agent: z00sAgent\/4\.0\(compatible\;MSIE7\.0\;WindowsNT5\.1\;SV1\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022486; rev:470;)

# Adware: (Downware) DownloadAdmin - regex: to_server:GET /install\?s=.*&brand=.*&pid=.*&aid=.*&bc=\d+&country=[A-Z]{2} detector_id: 22488
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) DownloadAdmin"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/install?s="; content:"&brand="; content:"&pid="; content:"&aid="; content:"&bc="; content:"&country="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/install\?s=.*&brand=.*&pid=.*&aid=.*&bc=\d+&country=[A-Z]{2}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022488; rev:471;)

# Command&Control: (Dropper) Leechole - regex: to_server:GET /get\d?\.php\?e=\d+&tc=\d+-[a-f0-9]+&uid=\d+ detector_id: 22489
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Leechole"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get"; content:".php?e="; content:"&tc="; content:"&uid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get\d?\.php\?e=\d+&tc=\d+-[a-f0-9]+&uid=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022489; rev:722;)

# Command&Control: (Trojan) GenericTrojan_11 - regex: to_server:GET /forum/search\.php\?method=.*&flag&mode=.*&v=.*&sox=.*&lport=.*&rsid=.*&slots=.*&spm= detector_id: 22490
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_11"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/forum/search.php?method="; content:"&flag&mode="; content:"&v="; content:"&sox="; content:"&lport="; content:"&rsid="; content:"&slots="; content:"&spm="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/forum\/search\.php\?method=.*&flag&mode=.*&v=.*&sox=.*&lport=.*&rsid=.*&slots=.*&spm=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022490; rev:721;)

# Command&Control: (Trojan) Cycbot - regex: to_server:GET /logo\.png\?tq=g.{3}tz.*&pr=\d+ detector_id: 22491
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Cycbot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/logo.png?tq=g"; content:"tz"; content:"&pr="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/logo\.png\?tq=g.{3}tz.*&pr=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022491; rev:721;)

# Command&Control: (Dropper) Karagany - regex: to_server:GET /[a-z]\.htm\?[a-zA-Z0-9]{15,40} HTTP.*User-Agent: Mozilla/4\.0 \(compatible; MSIE 6\.0; Windows NT 5\.1; SV1\)\r\nHost: \S+\r\nCache-Control: no-cache detector_id: 22492
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Karagany"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".htm?"; content:" HTTP"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 6.0|3B| Windows NT 5.1|3B| SV1|29||0D||0A|Host|3A| "; content:"|0D||0A|Cache-Control|3A| no-cache"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]\.htm\?[a-zA-Z0-9]{15,40} HTTP.*User-Agent: Mozilla\/4\.0 \(compatible\; MSIE 6\.0\; Windows NT 5\.1\; SV1\)\r\nHost: \S+\r\nCache-Control: no-cache/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022492; rev:1004;)

# Command&Control: (Trojan) Refeys - regex: to_server:POST /sys\.php HTTP.*i#\x08\xb8[\xe0-\xef][\x80-\x8f] detector_id: 22501
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Refeys"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/sys.php HTTP"; content:"i|23||08||B8|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/sys\.php HTTP.*i#\x08\xb8[\xe0-\xef][\x80-\x8f]/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022501; rev:477;)

# Command&Control: (Trojan) ZBot - regex: to_server:POST /[a-z]+/config\.php.*bn1=\S+_[A-F0-9]{16}_\d+&sk1=[A-F0-9]{32} detector_id: 22502
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/config.php"; content:"bn1="; content:"&sk1="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]+\/config\.php.*bn1=\S+_[A-F0-9]{16}_\d+&sk1=[A-F0-9]{32}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022502; rev:473;)

# Command&Control: (Trojan) Gamarue - regex: to_server:POST /\d?(l|in|ldr)\.php HTTP.*User-Agent: Mozilla/4\.0\x0d.*upqc detector_id: 22503
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Gamarue"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"User-Agent|3A| Mozilla/4.0|0D|"; content:"upqc"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d?(l|in|ldr)\.php HTTP.*User-Agent: Mozilla\/4\.0\x0d.*upqc/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022503; rev:1018;)

# Command&Control: (Trojan) Quervar - regex: to_server:GET [/a-z0-9]*/way\.php\?[a-zA-Z\d]{8}&pin=[A-F\d]{16} HTTP.*Accept: \*/\*\r\nAccept-Encoding: gzip, deflate detector_id: 22505
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Quervar"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/way.php?"; content:"&pin="; content:" HTTP"; content:"Accept|3A| |2A|/|2A||0D||0A|Accept-Encoding|3A| gzip|2C| deflate"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?[\/a-z0-9]*\/way\.php\?[a-zA-Z\d]{8}&pin=[A-F\d]{16} HTTP.*Accept: \*\/\*\r\nAccept-Encoding: gzip, deflate/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022505; rev:709;)

# Command&Control: (Trojan) GenericTrojan_53 - regex: to_server:POST /[a-z]{1,8}/cmd\.php.*User-Agent: YZF.*headers=UserAgent detector_id: 22506
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_53"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/cmd.php"; content:"User-Agent|3A| YZF"; content:"headers=UserAgent"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{1,8}\/cmd\.php.*User-Agent: YZF.*headers=UserAgent/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022506; rev:473;)

# Command&Control: (Banker) Banload - regex: to_server:POST /[a-z]+\d*/recept\.php HTTP.*User-Agent: HTTP Client.*condicao=.*&arq= detector_id: 22507
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Banload"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/recept.php HTTP"; content:"User-Agent|3A| HTTP Client"; content:"condicao="; content:"&arq="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]+\d*\/recept\.php HTTP.*User-Agent: HTTP Client.*condicao=.*&arq=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022507; rev:494;)

# Command&Control: (Banker) Banbra - regex: to_server:GET /[a-z]+/gate\.php\?username=\S+&country=\S+&OS=\d\.\d HTTP detector_id: 22514
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Banbra"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/gate.php?username="; content:"&country="; content:"&OS="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]+\/gate\.php\?username=\S+&country=\S+&OS=\d\.\d HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022514; rev:473;)

# Command&Control: (Trojan) Carberp - regex: to_server:POST /[a-z]{6,64}\.(db|pl|log|inc|pif|php3|phtml?|rar|7z|rtf) HTTP/1\.1\r\nAccept: \*/\*\r\nUser-Agent.*Host.*Connection: [Cc]lose.*Content-Type: application/x-www-form-urlencoded.*[a-z]{3,6}=[a-zA-Z0-9%]{32,}$ detector_id: 22515
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Carberp"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:" HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|User-Agent"; content:"Host"; content:"Connection|3A| "; content:"lose"; content:"Content-Type|3A| application/x-www-form-urlencoded"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{6,64}\.(db|pl|log|inc|pif|php3|phtml?|rar|7z|rtf) HTTP\/1\.1\r\nAccept: \*\/\*\r\nUser-Agent.*Host.*Connection: [Cc]lose.*Content-Type: application\/x-www-form-urlencoded.*[a-z]{3,6}=[a-zA-Z0-9%]{32,}$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022515; rev:730;)

# Command&Control: (Trojan) ZBot - regex: to_server:POST /~?[a-z/]+/gate\.php HTTP.*Accept: \*/\*.*User-Agent.*Host.*Connection: Keep-Alive.*Cache-Control: no-cache.*[\x00-\x1f\x80-\xff]{4} detector_id: 22516
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/gate.php HTTP"; content:"Accept|3A| |2A|/|2A|"; content:"User-Agent"; content:"Host"; content:"Connection|3A| Keep-Alive"; content:"Cache-Control|3A| no-cache"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/~?[a-z\/]+\/gate\.php HTTP.*Accept: \*\/\*.*User-Agent.*Host.*Connection: Keep-Alive.*Cache-Control: no-cache.*[\x00-\x1f\x80-\xff]{4}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022516; rev:479;)

# Adware: (Adware) WSearch - regex: to_server:GET /route/update\.asp\?VerCliD=.*User-Agent: ProxyDown detector_id: 22517
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) WSearch"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/route/update.asp?VerCliD="; content:"User-Agent|3A| ProxyDown"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/route\/update\.asp\?VerCliD=.*User-Agent: ProxyDown/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022517; rev:721;)

# Adware: (Adware) ZenoSearch - regex: to_server:GET /instreport\d_backup\.asp\?uid=.*User-Agent: \[.*\][A-F0-9]{2} detector_id: 22518
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) ZenoSearch"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/instreport"; content:"_backup.asp?uid="; content:"User-Agent|3A| |5B|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/instreport\d_backup\.asp\?uid=.*User-Agent: \[.*\][A-F0-9]{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022518; rev:721;)

# Command&Control: (Trojan) Ranbyus - regex: to_server:GET .*/index\.php\?id=.*&session=\d+&v=\d+&name=.*&mj=.*&mi=.*&pt=.*&b=\d*&dc=.* detector_id: 22519
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ranbyus"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?id="; content:"&session="; content:"&v="; content:"&name="; content:"&mj="; content:"&mi="; content:"&pt="; content:"&b="; content:"&dc="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/index\.php\?id=.*&session=\d+&v=\d+&name=.*&mj=.*&mi=.*&pt=.*&b=\d*&dc=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022519; rev:721;)

# Command&Control: (Backdoor) Pontoeb - regex: to_server:POST /gate\.php.*User-Agent: N0PE.*mode=.*&hwid=.*&pcname=.*&version=.*&system=.* detector_id: 22520
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Pontoeb"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/gate.php"; content:"User-Agent|3A| N0PE"; content:"mode="; content:"&hwid="; content:"&pcname="; content:"&version="; content:"&system="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/gate\.php.*User-Agent: N0PE.*mode=.*&hwid=.*&pcname=.*&version=.*&system=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022520; rev:721;)

# Command&Control: (Trojan) ZBot - regex: to_server:POST /~?[a-z/]+/file\.php HTTP.*Accept: \*/\*.*User-Agent.*Host.*Connection: Keep-Alive.*Cache-Control: no-cache.*[\x00-\x1f\x80-\xff]{4} detector_id: 22521
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/file.php HTTP"; content:"Accept|3A| |2A|/|2A|"; content:"User-Agent"; content:"Host"; content:"Connection|3A| Keep-Alive"; content:"Cache-Control|3A| no-cache"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/~?[a-z\/]+\/file\.php HTTP.*Accept: \*\/\*.*User-Agent.*Host.*Connection: Keep-Alive.*Cache-Control: no-cache.*[\x00-\x1f\x80-\xff]{4}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022521; rev:479;)

# Command&Control: (Trojan) GenericTrojan_120 - regex: to_server:GET /p/\?d=[A-Z0-9]{3,8}&i=[\d\.]{7,15}&c=\d&ro=\d&ref=unknown&_= detector_id: 22527
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_120"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/p/?d="; content:"&i="; content:"&c="; content:"&ro="; content:"&ref=unknown&_="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/p\/\?d=[A-Z0-9]{3,8}&i=[\d\.]{7,15}&c=\d&ro=\d&ref=unknown&_=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022527; rev:477;)

# Command&Control: (Trojan) Redyms - regex: to_server:POST /([a-z]{5,8})\.php HTTP.*User-Agent.*Host: \1[a-z]*\.net.*Content-Length: 128.*no-cache.*[\x00-\x1f\x80-\xff]{3} detector_id: 22528
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Redyms"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"User-Agent"; content:"Host|3A| "; content:".net"; content:"Content-Length|3A| 128"; content:"no-cache"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/([a-z]{5,8})\.php HTTP.*User-Agent.*Host: \1[a-z]*\.net.*Content-Length: 128.*no-cache.*[\x00-\x1f\x80-\xff]{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022528; rev:477;)

# Command&Control: (Trojan) rBot - regex: to_server:GET /[a-f0-9]{8}\?q=\d{4,} HTTP.*User-Agent: Mozilla/4\.0 \(compatible\)\r\nHost: [0-9\.]{7,15} detector_id: 22529
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) rBot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?q="; content:" HTTP"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|29||0D||0A|Host|3A| "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-f0-9]{8}\?q=\d{4,} HTTP.*User-Agent: Mozilla\/4\.0 \(compatible\)\r\nHost: [0-9\.]{7,15}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022529; rev:1004;)

# Command&Control: (Dropper) GenericDropper_104 - regex: to_server:GET /[a-zA-Z]{1,3}\?[a-e] HTTP.*Host: \d{5}\.([a-z0-9]{1,2}dns|dns[a-z0-9]{1,2})\.(com|net) detector_id: 22530
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_104"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP"; content:"Host|3A| "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-zA-Z]{1,3}\?[a-e] HTTP.*Host: \d{5}\.([a-z0-9]{1,2}dns|dns[a-z0-9]{1,2})\.(com|net)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022530; rev:487;)

# Command&Control: (Trojan) Quervar - regex: to_server:GET /1\.php\?[A-F0-9]{8}&pin=[A-F0-9]{16} HTTP detector_id: 22531
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Quervar"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/1.php?"; content:"&pin="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/1\.php\?[A-F0-9]{8}&pin=[A-F0-9]{16} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022531; rev:487;)

# Command&Control: (Dropper) GenericDropper_104 - regex: to_server:GET /a\?[abe] HTTP.*Host: \d{5}\.([a-z0-9]{1,2}dns|dns[a-z0-9]{1,2})\.pw detector_id: 22532
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_104"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/a?"; content:" HTTP"; content:"Host|3A| "; content:".pw"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/a\?[abe] HTTP.*Host: \d{5}\.([a-z0-9]{1,2}dns|dns[a-z0-9]{1,2})\.pw/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022532; rev:479;)

# Adware: (Toolbar) ZenoSearch - regex: to_server:GET /irdw2_b\.asp\?uid=[0-1]{1} detector_id: 22534
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) ZenoSearch"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/irdw2_b.asp?uid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/irdw2_b\.asp\?uid=[0-1]{1}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022534; rev:721;)

# Command&Control: (Trojan) GenericTrojan_121 - regex: to_server:GET /[a-z/]*gate\.php\?reg=[a-zA-Z]{15} HTTP.*Keep-Alive: 300 detector_id: 22535
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_121"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"gate.php?reg="; content:" HTTP"; content:"Keep-Alive|3A| 300"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z\/]*gate\.php\?reg=[a-zA-Z]{15} HTTP.*Keep-Alive: 300/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022535; rev:479;)

# Command&Control: (Trojan) GenericTrojan_121 - regex: to_server:GET /[a-z/]*gate\.php\?cmd=urls HTTP.*Keep-Alive: 300 detector_id: 22536
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_121"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"gate.php?cmd=urls HTTP"; content:"Keep-Alive|3A| 300"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z\/]*gate\.php\?cmd=urls HTTP.*Keep-Alive: 300/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022536; rev:479;)

# Command&Control: (Trojan) Alinaos - regex: to_server:POST [a-z/]*/push\.php HTTP.*User-Agent: Alina.*UWYQ detector_id: 22537
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Alinaos"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/push.php HTTP"; content:"User-Agent|3A| Alina"; content:"UWYQ"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?[a-z\/]*\/push\.php HTTP.*User-Agent: Alina.*UWYQ/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022537; rev:479;)

# Command&Control: (Trojan) Neurevt - regex: to_server:POST [a-z\-_\d/]*/order\.php HTTP.*ps0=[\dA-F]{16,}&ps1=[\dA-F]{48,}&cs1=[\dA-F]{32,}&cs2=[\dA-F]{32,}&cs3=[\dA-F]{32,} detector_id: 22538
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Neurevt"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/order.php HTTP"; content:"ps0="; content:"&ps1="; content:"&cs1="; content:"&cs2="; content:"&cs3="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?[a-z\-_\d\/]*\/order\.php HTTP.*ps0=[\dA-F]{16,}&ps1=[\dA-F]{48,}&cs1=[\dA-F]{32,}&cs2=[\dA-F]{32,}&cs3=[\dA-F]{32,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022538; rev:699;)

# Command&Control: (Dropper) Tofsee - regex: to_server:GET /tsone/[a-z]+\d+\.dat\?wv=\d+&bt=\d+ HTTP detector_id: 22539
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Tofsee"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/tsone/"; content:".dat?wv="; content:"&bt="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/tsone\/[a-z]+\d+\.dat\?wv=\d+&bt=\d+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022539; rev:479;)

# Command&Control: (Trojan) Mutopy - regex: to_server:POST .*\.php HTTP.*lJtdmf=.*&evtrKd=.*&JQDkr=.*&qgtB=.*&XMpLR= detector_id: 22540
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Mutopy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"lJtdmf="; content:"&evtrKd="; content:"&JQDkr="; content:"&qgtB="; content:"&XMpLR="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php HTTP.*lJtdmf=.*&evtrKd=.*&JQDkr=.*&qgtB=.*&XMpLR=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022540; rev:479;)

# Command&Control: (Trojan) Mutopy - regex: to_server:POST .*\.php HTTP.*lFgaqq=.*&eaMKYX=.*&mQaLuv=.*&dSgdS=.*&cDXH= detector_id: 22542
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Mutopy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"lFgaqq="; content:"&eaMKYX="; content:"&mQaLuv="; content:"&dSgdS="; content:"&cDXH="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php HTTP.*lFgaqq=.*&eaMKYX=.*&mQaLuv=.*&dSgdS=.*&cDXH=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022542; rev:479;)

# Command&Control: (Trojan) Mutopy - regex: to_server:POST .*\.php HTTP.*lXifx=.*&eDmaT=.*&mqXbY=.*&drAadL=.*&FCHNr= detector_id: 22543
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Mutopy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"lXifx="; content:"&eDmaT="; content:"&mqXbY="; content:"&drAadL="; content:"&FCHNr="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php HTTP.*lXifx=.*&eDmaT=.*&mqXbY=.*&drAadL=.*&FCHNr=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022543; rev:479;)

# Command&Control: (Trojan) Mutopy - regex: to_server:POST .*\.php HTTP.*lJtdmf=.*&evtrKd=.*=&dMXEq=.*&grxf=.*=&xIOe=.*&eaMKYX=.*&mQaLuv=.*&dSgdS=.*&cDXH= detector_id: 22544
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Mutopy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"lJtdmf="; content:"&evtrKd="; content:"=&dMXEq="; content:"&grxf="; content:"=&xIOe="; content:"&eaMKYX="; content:"&mQaLuv="; content:"&dSgdS="; content:"&cDXH="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php HTTP.*lJtdmf=.*&evtrKd=.*=&dMXEq=.*&grxf=.*=&xIOe=.*&eaMKYX=.*&mQaLuv=.*&dSgdS=.*&cDXH=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022544; rev:479;)

# Adware: (Adware) LoadMoney - regex: to_server:HEAD /get_download_xml(_\d)?\?id=\d+ HTTP.*User-Agent: tiny-dl/nix detector_id: 22545
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) LoadMoney"; flow:established,to_server; content:"HEAD"; nocase; http_method; content:"HEAD "; content:"/get_download_xml"; content:"?id="; content:" HTTP"; content:"User-Agent|3A| tiny-dl/nix"; pcre:"/HEAD (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get_download_xml(_\d)?\?id=\d+ HTTP.*User-Agent: tiny-dl\/nix/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022545; rev:480;)

# Command&Control: (Dropper) GenericDropper_105 - regex: to_server:GET //[a-z]*tongji[a-z]*\.asp\?unid=\d+&ununid=\d+ HTTP.*User-Agent: Agent\d{5,6} detector_id: 22546
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_105"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"//"; content:"tongji"; content:".asp?unid="; content:"&ununid="; content:" HTTP"; content:"User-Agent|3A| Agent"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\/[a-z]*tongji[a-z]*\.asp\?unid=\d+&ununid=\d+ HTTP.*User-Agent: Agent\d{5,6}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022546; rev:480;)

# Command&Control: (Trojan) GenericTrojan_122 - regex: to_server:GET /log\.php\?comp=.*&logmsg=[A-Za-z0-9\+%]+ HTTP.*User-Agent: [a-f0-9]{10}\.exe detector_id: 22547
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_122"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/log.php?comp="; content:"&logmsg="; content:" HTTP"; content:"User-Agent|3A| "; content:".exe"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/log\.php\?comp=.*&logmsg=[A-Za-z0-9\+%]+ HTTP.*User-Agent: [a-f0-9]{10}\.exe/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022547; rev:481;)

# Command&Control: (Banker) GenericBanker_21 - regex: to_server:GET /cgi-local/admin_local15\.php\?OP=.*&TABELA=.*&CAMPO=.*&ID=\d{1} HTTP detector_id: 22548
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_21"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cgi-local/admin_local15.php?OP="; content:"&TABELA="; content:"&CAMPO="; content:"&ID="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cgi-local\/admin_local15\.php\?OP=.*&TABELA=.*&CAMPO=.*&ID=\d{1} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022548; rev:480;)

# Command&Control: (Backdoor) Morat - regex: to_server:GET /u\.php\?ver=\d&mid=[a-f0-9]{32}&sub=\d HTTP.*User-Agent: Mozilla/3\.0 \(compatible; Indy Library\) detector_id: 22549
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Morat"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/u.php?ver="; content:"&mid="; content:"&sub="; content:" HTTP"; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/u\.php\?ver=\d&mid=[a-f0-9]{32}&sub=\d HTTP.*User-Agent: Mozilla\/3\.0 \(compatible\; Indy Library\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022549; rev:481;)

# Command&Control: (Banker) GenericBanker_22 - regex: to_server:POST .*\.php HTTP.*User-Agent: Mozilla/4\.0 \(compatible; ICS\).*para=.*&subject=.*&dados=.* detector_id: 22550
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_22"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| ICS|29|"; content:"para="; content:"&subject="; content:"&dados="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php HTTP.*User-Agent: Mozilla\/4\.0 \(compatible\; ICS\).*para=.*&subject=.*&dados=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022550; rev:481;)

# Command&Control: (Trojan) Ertfor - regex: to_server:GET /dw/vp\.php\?id=[A-Z0-9]+&ver=.*&v=.*&er=.*User-Agent: Mozilla/4\.0 \(SP3 WINLD\) detector_id: 22551
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ertfor"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/dw/vp.php?id="; content:"&ver="; content:"&v="; content:"&er="; content:"User-Agent|3A| Mozilla/4.0 |28|SP3 WINLD|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/dw\/vp\.php\?id=[A-Z0-9]+&ver=.*&v=.*&er=.*User-Agent: Mozilla\/4\.0 \(SP3 WINLD\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022551; rev:481;)

# Command&Control: (Trojan) Sefnit - regex: to_server:GET /gettasks\d\.php\?protocol=\d&f=\d{6,8}&protoversion=\d&p=.* detector_id: 22552
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sefnit"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/gettasks"; content:".php?protocol="; content:"&f="; content:"&protoversion="; content:"&p="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/gettasks\d\.php\?protocol=\d&f=\d{6,8}&protoversion=\d&p=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022552; rev:481;)

# Command&Control: (Dropper) Kanav - regex: to_server:POST /pro1\.asp.*a1=.*&a2=[a-f0-9]*&a3=.*&a4=.*&a6=.*&a7= detector_id: 22553
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Kanav"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/pro1.asp"; content:"a1="; content:"&a2="; content:"&a3="; content:"&a4="; content:"&a6="; content:"&a7="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/pro1\.asp.*a1=.*&a2=[a-f0-9]*&a3=.*&a4=.*&a6=.*&a7=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022553; rev:483;)

# Command&Control: (Trojan) Xpaj_3 - regex: to_server:POST /\d+/\d+[a-z]{1}/index\.php.*Host: [\d\.]{7,15}.*filename=[a-z]+\.[a-z]{3}&data=.*[\x00-\x1f\x80-\xff]{2} detector_id: 22559
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Xpaj_3"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/index.php"; content:"Host|3A| "; content:"filename="; content:"&data="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d+\/\d+[a-z]{1}\/index\.php.*Host: [\d\.]{7,15}.*filename=[a-z]+\.[a-z]{3}&data=.*[\x00-\x1f\x80-\xff]{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022559; rev:484;)

# Adware: (Toolbar) Addendum Checkin - regex: to_server:GET /request/instinfo\.php\?pid=j[a-z]{1,3}\d{3} HTTP.*User-Agent: NSISDL/\d\.\d detector_id: 22560
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Addendum Checkin"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/request/instinfo.php?pid=j"; content:" HTTP"; content:"User-Agent|3A| NSISDL/"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/request\/instinfo\.php\?pid=j[a-z]{1,3}\d{3} HTTP.*User-Agent: NSISDL\/\d\.\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022560; rev:563;)

# Command&Control: (Dropper) GenericDropper_106 - regex: to_server:GET /get[A-F]{2}\.php\?id=.*&ver=\d&uid=\d+&z=.*&memorySize=\d+&runtime=\d+&CurrentTime=\d+&ComputerName=.*&Username=.*&cpu= detector_id: 22561
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_106"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get"; content:".php?id="; content:"&ver="; content:"&uid="; content:"&z="; content:"&memorySize="; content:"&runtime="; content:"&CurrentTime="; content:"&ComputerName="; content:"&Username="; content:"&cpu="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get[A-F]{2}\.php\?id=.*&ver=\d&uid=\d+&z=.*&memorySize=\d+&runtime=\d+&CurrentTime=\d+&ComputerName=.*&Username=.*&cpu=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022561; rev:485;)

# Command&Control: (Trojan) Mutopy - regex: to_server:POST .*\.php HTTP.*lDfARw=.*&eBivdB=.*&moCmb=.*&dUBSo=.*&MYCD=.*&nPMA= detector_id: 22562
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Mutopy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"lDfARw="; content:"&eBivdB="; content:"&moCmb="; content:"&dUBSo="; content:"&MYCD="; content:"&nPMA="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php HTTP.*lDfARw=.*&eBivdB=.*&moCmb=.*&dUBSo=.*&MYCD=.*&nPMA=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022562; rev:485;)

# Command&Control: (Dropper) Harnig - regex: to_server:GET /yulgbvqk/[a-z]{5,10}\.php\?adv=adv\d+ HTTP.*User-Agent: .*ver\d+ detector_id: 22563
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Harnig"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/yulgbvqk/"; content:".php?adv=adv"; content:" HTTP"; content:"User-Agent|3A| "; content:"ver"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/yulgbvqk\/[a-z]{5,10}\.php\?adv=adv\d+ HTTP.*User-Agent: .*ver\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022563; rev:485;)

# Command&Control: (Worm) Theals - regex: to_server:GET /stat\.php\?os=.*&country=.*.*User-Agent: fuck detector_id: 22565
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Theals"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/stat.php?os="; content:"&country="; content:"User-Agent|3A| fuck"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/stat\.php\?os=.*&country=.*.*User-Agent: fuck/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022565; rev:486;)

# Adware: (Toolbar) Ourxin - regex: to_server:GET /cfs/cfscfg\.7z\?vendor=.*&guid=[A-F0-9]{32} HTTP detector_id: 22566
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Ourxin"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cfs/cfscfg.7z?vendor="; content:"&guid="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cfs\/cfscfg\.7z\?vendor=.*&guid=[A-F0-9]{32} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022566; rev:486;)

# Command&Control: (Backdoor) GenericBackdoor_9 - regex: to_server:POST .*/add\.php HTTP.*Admin=.*&UserName=.*&IsProxy=\d&Info= detector_id: 22567
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) GenericBackdoor_9"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/add.php HTTP"; content:"Admin="; content:"&UserName="; content:"&IsProxy="; content:"&Info="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/add\.php HTTP.*Admin=.*&UserName=.*&IsProxy=\d&Info=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022567; rev:733;)

# Command&Control: (Trojan) Urausy - regex: to_server:GET /555657555[0-9A-F]{30,32}DD0E570A1C1B HTTP detector_id: 22573
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Urausy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/555657555"; content:"DD0E570A1C1B HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/555657555[0-9A-F]{30,32}DD0E570A1C1B HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022573; rev:487;)

# Bitcoin Mining: BitCoinMiner - regex: to_server:POST /(LP|lp) HTTP.*Authorization: Basic.*\{"method": "getwork", "params": \[.*\], "id":\d\} detector_id: 22581
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Bitcoin Mining: BitCoinMiner"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:" HTTP"; content:"Authorization|3A| Basic"; content:"|7B||22|method|22||3A| |22|getwork|22||2C| |22|params|22||3A| |5B|"; content:"|5D||2C| |22|id|22||3A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(LP|lp) HTTP.*Authorization: Basic.*\{"method": "getwork", "params": \[.*\], "id":\d\}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022581; rev:709;)

# Command&Control: (Trojan) Enfal - regex: to_server:GET /oi2c/wlc3/\S+:(-?[A-F0-9]{2}){6}/ij83d HTTP detector_id: 22583
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Enfal"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/oi2c/wlc3/"; content:"/ij83d HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/oi2c\/wlc3\/\S+:(-?[A-F0-9]{2}){6}\/ij83d HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022583; rev:487;)

# Command&Control: (Trojan) Mutopy - regex: to_server:POST .*\.php HTTP.*lJtdmf=.*&evtrKd=.*&miOLST=.*&dMXEq=.*&grxf=.*=&xIOe= detector_id: 22584
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Mutopy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"lJtdmf="; content:"&evtrKd="; content:"&miOLST="; content:"&dMXEq="; content:"&grxf="; content:"=&xIOe="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php HTTP.*lJtdmf=.*&evtrKd=.*&miOLST=.*&dMXEq=.*&grxf=.*=&xIOe=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022584; rev:487;)

# Command&Control: (Backdoor) PcClient - regex: to_server:POST /20110+30+2/\d{6,8}/\d{6}\.(php|jsp) HTTP.*Host: \S+\.3322\.org detector_id: 22585
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) PcClient"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/2011"; content:"2/"; content:" HTTP"; content:"Host|3A| "; content:".3322.org"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/20110+30+2\/\d{6,8}\/\d{6}\.(php|jsp) HTTP.*Host: \S+\.3322\.org/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022585; rev:487;)

# Command&Control: (Trojan) Bebloh - regex: to_server:POST /f44/myse\.php HTTP.*[a-zA-Z0-9\+/=]{160} detector_id: 22586
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bebloh"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/f44/myse.php HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/f44\/myse\.php HTTP.*[a-zA-Z0-9\+\/=]{160}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022586; rev:487;)

# Command&Control: (Trojan) Bebloh - regex: to_server:POST /p8/amid\.php HTTP.*[a-zA-Z0-9\+/=]{160} detector_id: 22587
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bebloh"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/p8/amid.php HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/p8\/amid\.php HTTP.*[a-zA-Z0-9\+\/=]{160}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022587; rev:487;)

# Adware: (Toolbar) Kolweb - regex: to_server:GET .*(config|restore)\.php\?needurl=\d&userid=[A-F0-9]{32}&promocode=.*&ver=\d\.\d{2}&aa=\d+&wv=.*&allver= detector_id: 22598
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Kolweb"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?needurl="; content:"&userid="; content:"&promocode="; content:"&ver="; content:"&aa="; content:"&wv="; content:"&allver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*(config|restore)\.php\?needurl=\d&userid=[A-F0-9]{32}&promocode=.*&ver=\d\.\d{2}&aa=\d+&wv=.*&allver=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022598; rev:491;)

# Adware: (Adware) Eorezo - regex: to_server:GET /cgi-bin/advert/settags\?x_mode=.*&x_format=.*&x_dp_id=\d+&x_pub_id=\d+&tag=.*User-Agent: Mozilla/4\.0 \(compatible; Win32; WinHttp\.WinHttpRequest\.5\) detector_id: 22599
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Eorezo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cgi-bin/advert/settags?x_mode="; content:"&x_format="; content:"&x_dp_id="; content:"&x_pub_id="; content:"&tag="; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| Win32|3B| WinHttp.WinHttpRequest.5|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cgi-bin\/advert\/settags\?x_mode=.*&x_format=.*&x_dp_id=\d+&x_pub_id=\d+&tag=.*User-Agent: Mozilla\/4\.0 \(compatible\; Win32\; WinHttp\.WinHttpRequest\.5\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022599; rev:491;)

# Command&Control: (Trojan) Hrup - regex: to_server:GET /count\.php\?u=YT1[a-zA-Z0-9\+/=]+ HTTP.*User-Agent: Mozilla/4\.0 \(compatible; MSIE 5\.00; Windows 98\) detector_id: 22600
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Hrup"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/count.php?u=YT1"; content:" HTTP"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 5.00|3B| Windows 98|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/count\.php\?u=YT1[a-zA-Z0-9\+\/=]+ HTTP.*User-Agent: Mozilla\/4\.0 \(compatible\; MSIE 5\.00\; Windows 98\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022600; rev:491;)

# Command&Control: (Backdoor) Hanove - regex: to_server:POST /up\.php HTTP.*User-Agent: EMSFRTCBVD.*form-data; name="uploaddir" detector_id: 22728
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Hanove"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/up.php HTTP"; content:"User-Agent|3A| EMSFRTCBVD"; content:"form-data|3B| name=|22|uploaddir|22|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/up\.php HTTP.*User-Agent: EMSFRTCBVD.*form-data\; name="uploaddir"/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022728; rev:491;)

# Command&Control: (Trojan) Virut - regex: to_server:GET /mlist/(changem|createm)\.php\?pcd=\d HTTP.*User-Agent: Mozilla/3\.0 \(compatible; Indy Library\) detector_id: 22830
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Virut"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mlist/"; content:".php?pcd="; content:" HTTP"; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mlist\/(changem|createm)\.php\?pcd=\d HTTP.*User-Agent: Mozilla\/3\.0 \(compatible\; Indy Library\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022830; rev:491;)

# FakeAV: WinWebSec - regex: to_server:POST /i\.php\?affid=\d{5}&v=\d HTTP*data=[A-F0-9]{68,71}&v=\d detector_id: 22831
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: WinWebSec"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/i.php?affid="; content:"&v="; content:" HTT"; content:"data="; content:"&v="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/i\.php\?affid=\d{5}&v=\d HTTP*data=[A-F0-9]{68,71}&v=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022831; rev:491;)

# Command&Control: (Backdoor) GenericBackdoor_10 - regex: to_server:POST /SerInfo\.asp HTTP.*p=.*&ProcessInfo=.*&pcName=.*&MacInfo=.*&AckInfo=.*&userflag=.*&Sn=.*&bIn= detector_id: 22843
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) GenericBackdoor_10"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/SerInfo.asp HTTP"; content:"p="; content:"&ProcessInfo="; content:"&pcName="; content:"&MacInfo="; content:"&AckInfo="; content:"&userflag="; content:"&Sn="; content:"&bIn="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/SerInfo\.asp HTTP.*p=.*&ProcessInfo=.*&pcName=.*&MacInfo=.*&AckInfo=.*&userflag=.*&Sn=.*&bIn=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022843; rev:492;)

# Command&Control: (Banker) Banjori - regex: to_server:POST /welcome\.php HTTP.*&q=.*&action=.*&id=.*&versionf=\d+&versiona=.*&vendor=.*&do=.*&check= detector_id: 22844
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Banjori"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/welcome.php HTTP"; content:"&q="; content:"&action="; content:"&id="; content:"&versionf="; content:"&versiona="; content:"&vendor="; content:"&do="; content:"&check="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/welcome\.php HTTP.*&q=.*&action=.*&id=.*&versionf=\d+&versiona=.*&vendor=.*&do=.*&check=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022844; rev:492;)

# Command&Control: (Trojan) ZBot - regex: to_server:POST /\d+/(video|photo)\.php HTTP.*p1=[A-F0-9]{32}&p2=\S+_[A-F0-9]{16} detector_id: 22845
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"p1="; content:"&p2="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d+\/(video|photo)\.php HTTP.*p1=[A-F0-9]{32}&p2=\S+_[A-F0-9]{16}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022845; rev:492;)

# CommandControl: (Dropper) Karagany - regex: to_server:POST .*/xgate\.php HTTP.*User-Agent: Opera/[0-1]{2}\.\d{2} Presto/2\.2\.30.*id=[0-9_]+&btn=.*&ver=\d\.\d\.\d\.\d&cfgid= detector_id: 22847
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS CommandControl: (Dropper) Karagany"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/xgate.php HTTP"; content:"User-Agent|3A| Opera/"; content:" Presto/2.2.30"; content:"id="; content:"&btn="; content:"&ver="; content:"&cfgid="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/xgate\.php HTTP.*User-Agent: Opera\/[0-1]{2}\.\d{2} Presto\/2\.2\.30.*id=[0-9_]+&btn=.*&ver=\d\.\d\.\d\.\d&cfgid=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022847; rev:493;)

# Command&Control: (Dropper) Tibs - regex: to_server:GET /loaderbb\.php\?l=[A-F0-9]{4}&adv=\d{2} HTTP.*User-Agent: 006 detector_id: 22848
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Tibs"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/loaderbb.php?l="; content:"&adv="; content:" HTTP"; content:"User-Agent|3A| 006"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/loaderbb\.php\?l=[A-F0-9]{4}&adv=\d{2} HTTP.*User-Agent: 006/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022848; rev:493;)

# Command&Control: (Trojan) Usteal - regex: to_server:POST .*\.php HTTP.*filename=".*\.bin".*Content-Type: application/octet-stream.*\r\n\r\nUFR! detector_id: 22849
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Usteal"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"filename=|22|"; content:".bin|22|"; content:"Content-Type|3A| application/octet-stream"; content:"|0D||0A||0D||0A|UFR|21|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php HTTP.*filename=".*\.bin".*Content-Type: application\/octet-stream.*\r\n\r\nUFR!/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022849; rev:570;)

# Command&Control: (Trojan) Bublik - regex: to_server:POST /(cc|mtu)/(gee|gt)\.php HTTP.*[A-Za-z0-9\+/]{25,}={0,2} detector_id: 22850
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bublik"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(cc|mtu)\/(gee|gt)\.php HTTP.*[A-Za-z0-9\+\/]{25,}={0,2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022850; rev:494;)

# Command&Control: (Backdoor) Bafruz - regex: to_server:GET /udp/knock\.php\?sid=\d{11,16}&country=[A-Z]{2} HTTP detector_id: 22854
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Bafruz"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/udp/knock.php?sid="; content:"&country="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/udp\/knock\.php\?sid=\d{11,16}&country=[A-Z]{2} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022854; rev:496;)

# Command&Control: (Dropper) Karagany - regex: to_server:POST /rk`,jopbh/qwq HTTP.*User-Agent: Opera/10\.80 Pesto/2\.2\.30.*id=[0-9\-_]+ detector_id: 22855
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Karagany"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/rk|60||2C|jopbh/qwq HTTP"; content:"User-Agent|3A| Opera/10.80 Pesto/2.2.30"; content:"id="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/rk`,jopbh\/qwq HTTP.*User-Agent: Opera\/10\.80 Pesto\/2\.2\.30.*id=[0-9\-_]+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022855; rev:495;)

# Command&Control: (Dropper) Renos - regex: to_server:GET /download2\.php\?ref=\d{6} HTTP.*User-Agent: Mozilla/4\.0 \(compatible; MSIE 5\.0; Windows 98\) detector_id: 22871
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Renos"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/download2.php?ref="; content:" HTTP"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 5.0|3B| Windows 98|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/download2\.php\?ref=\d{6} HTTP.*User-Agent: Mozilla\/4\.0 \(compatible\; MSIE 5\.0\; Windows 98\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022871; rev:498;)

# Command&Control: (Trojan) GenericTrojan_123 - regex: to_server:POST /ServiceMain HTTP.*Connection: Keep-Alive.*User-Agent.*Connection: Keep-Alive.*[\x00-\x1f\x80-\xff]{3} detector_id: 22872
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_123"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ServiceMain HTTP"; content:"Connection|3A| Keep-Alive"; content:"User-Agent"; content:"Connection|3A| Keep-Alive"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ServiceMain HTTP.*Connection: Keep-Alive.*User-Agent.*Connection: Keep-Alive.*[\x00-\x1f\x80-\xff]{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022872; rev:498;)

# Command&Control: (Keylogger) SniperSpy - regex: to_server:POST /sniperspy75/webapi/.*\.php HTTP.*Content-Disposition: form-data; name="pcusername" detector_id: 22873
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Keylogger) SniperSpy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/sniperspy75/webapi/"; content:".php HTTP"; content:"Content-Disposition|3A| form-data|3B| name=|22|pcusername|22|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/sniperspy75\/webapi\/.*\.php HTTP.*Content-Disposition: form-data\; name="pcusername"/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022873; rev:499;)

# Command&Control: (Banker) GenericBanker_15 - regex: to_server:POST .*/comunic\.php HTTP.*arquivo=.*&tipo= detector_id: 22883
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_15"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/comunic.php HTTP"; content:"arquivo="; content:"&tipo="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/comunic\.php HTTP.*arquivo=.*&tipo=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022883; rev:500;)

# Command&Control: (Trojan) Magania_1 - regex: to_server:GET /count\.aspx\?act=\d&mac=[A-F0-9]{12}&now=[A-F0-9]+ HTTP.*User-Agent: Google page detector_id: 22884
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Magania_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/count.aspx?act="; content:"&mac="; content:"&now="; content:" HTTP"; content:"User-Agent|3A| Google page"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/count\.aspx\?act=\d&mac=[A-F0-9]{12}&now=[A-F0-9]+ HTTP.*User-Agent: Google page/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022884; rev:500;)

# Command&Control: (Dropper) GenericDropper_78 - regex: to_server:GET .*/connect\.php\?hwid=[A-F0-9\-]+&version=\d&pc=.*User-Agent: Mozilla/3\.0 \(compatible; Indy Library\) detector_id: 22885
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_78"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/connect.php?hwid="; content:"&version="; content:"&pc="; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/connect\.php\?hwid=[A-F0-9\-]+&version=\d&pc=.*User-Agent: Mozilla\/3\.0 \(compatible\; Indy Library\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022885; rev:500;)

# Command&Control: (Trojan) GenericTrojan_124 - regex: to_server:POST .*/support_ikv\.asp HTTP.*User-Agent: Mozilla/4\.0 \(compatible;\).*[\x00-\x1f\x80-\xff]{3} detector_id: 22893
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_124"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/support_ikv.asp HTTP"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B||29|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/support_ikv\.asp HTTP.*User-Agent: Mozilla\/4\.0 \(compatible\;\).*[\x00-\x1f\x80-\xff]{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022893; rev:501;)

# Adware: (Adware) LoadMoney - regex: to_server:GET /get_xml\?story=[a-f0-9]{14}&file(_?id)?=\d+ HTTP.*User-Agent: Downloader detector_id: 22894
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) LoadMoney"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get_xml?story="; content:"&file"; content:" HTTP"; content:"User-Agent|3A| Downloader"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get_xml\?story=[a-f0-9]{14}&file(_?id)?=\d+ HTTP.*User-Agent: Downloader/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022894; rev:668;)

# Adware: (Adware) GenericAdware_14 WindowsTab - regex: to_server:GET /app/windowstab/windowstab\.php\?kind=.*&pt=.*&mc=[0-9\-]+&ov=\d\.\d&wv=.*&wb=.*&iv=.*&first=.*&isadm=.*&args= detector_id: 22895
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) GenericAdware_14 WindowsTab"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/app/windowstab/windowstab.php?kind="; content:"&pt="; content:"&mc="; content:"&ov="; content:"&wv="; content:"&wb="; content:"&iv="; content:"&first="; content:"&isadm="; content:"&args="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/app\/windowstab\/windowstab\.php\?kind=.*&pt=.*&mc=[0-9\-]+&ov=\d\.\d&wv=.*&wb=.*&iv=.*&first=.*&isadm=.*&args=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022895; rev:501;)

# Command&Control: (Banker) GenericBanker_23 - regex: to_server:POST .*hardware\.php HTTP.*mac=.*&ip=.*&nome_computador=.*&nome_grupo=.*&dados= detector_id: 23088
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_23"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"hardware.php HTTP"; content:"mac="; content:"&ip="; content:"&nome_computador="; content:"&nome_grupo="; content:"&dados="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*hardware\.php HTTP.*mac=.*&ip=.*&nome_computador=.*&nome_grupo=.*&dados=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023088; rev:507;)

# FakeAV: FakeVimes - regex: to_server:POST /check\.php\?ver=\d&query=[A-F0-9]{32} HTTP.*User-Agent: Mozilla/4\.0 \(compatible; MSIE 6\.0; Windows NT 4\.0; SLCC2\) detector_id: 23089
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeVimes"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/check.php?ver="; content:"&query="; content:" HTTP"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 6.0|3B| Windows NT 4.0|3B| SLCC2|29|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/check\.php\?ver=\d&query=[A-F0-9]{32} HTTP.*User-Agent: Mozilla\/4\.0 \(compatible\; MSIE 6\.0\; Windows NT 4\.0\; SLCC2\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023089; rev:505;)

# Command&Control: (Worm) Psyokym - regex: to_server:GET /extract\.php\?x=.*&ip=[\d\.]+&un=.*User-Agent: VB OpenUrl detector_id: 23090
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Psyokym"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/extract.php?x="; content:"&ip="; content:"&un="; content:"User-Agent|3A| VB OpenUrl"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/extract\.php\?x=.*&ip=[\d\.]+&un=.*User-Agent: VB OpenUrl/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023090; rev:505;)

# Command&Control: (Dropper) GenericDropper_107 - regex: to_server:GET /1\.asp\?mac=[A-F0-9]{12}&compter=.*&flag=.*&run=.*Host:[\d\.]+ detector_id: 23091
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_107"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/1.asp?mac="; content:"&compter="; content:"&flag="; content:"&run="; content:"Host|3A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/1\.asp\?mac=[A-F0-9]{12}&compter=.*&flag=.*&run=.*Host:[\d\.]+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023091; rev:506;)

# Command&Control: (Banker) GenericBanker_24 - regex: to_server:POST /templates/beez5/infect\.php HTTP.*email=.*&from=.*&subject= detector_id: 23092
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_24"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/templates/beez5/infect.php HTTP"; content:"email="; content:"&from="; content:"&subject="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/templates\/beez5\/infect\.php HTTP.*email=.*&from=.*&subject=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023092; rev:506;)

# Command&Control: (Dropper) GenericDropper_50 - regex: to_server:GET /ipk/ip\.asp\?rnd=[A-F0-9]{24} HTTP detector_id: 23093
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_50"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ipk/ip.asp?rnd="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ipk\/ip\.asp\?rnd=[A-F0-9]{24} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023093; rev:506;)

# Command&Control: (Trojan) Magania - regex: to_server:GET /new/get\.asp\?mac=[a-f0-9]{12}&pnum=\d{2,3}&ver=\d{2,3} HTTP detector_id: 23098
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Magania"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/new/get.asp?mac="; content:"&pnum="; content:"&ver="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/new\/get\.asp\?mac=[a-f0-9]{12}&pnum=\d{2,3}&ver=\d{2,3} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023098; rev:507;)

# Command&Control: (Banker) GenericBanker_10 - regex: to_server:GET .*/1nf3ct/x\d/\?chave=.*&url=.*User-Agent: Mozilla/4\.0 \(compatible; Win32; WinHttp\.WinHttpRequest\.5\) detector_id: 23099
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_10"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/1nf3ct/x"; content:"/?chave="; content:"&url="; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| Win32|3B| WinHttp.WinHttpRequest.5|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/1nf3ct\/x\d\/\?chave=.*&url=.*User-Agent: Mozilla\/4\.0 \(compatible\; Win32\; WinHttp\.WinHttpRequest\.5\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023099; rev:507;)

# Command&Control: (Dropper) GenericDropper_68 - regex: to_server:GET /upx/.*\.txt\?k=\d+&t=\d+ HTTP.*User-Agent: fucking detector_id: 23100
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_68"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/upx/"; content:".txt?k="; content:"&t="; content:" HTTP"; content:"User-Agent|3A| fucking"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/upx\/.*\.txt\?k=\d+&t=\d+ HTTP.*User-Agent: fucking/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023100; rev:507;)

# Command&Control: (Trojan) GenericTrojan_98 - regex: to_server:GET /select_keys\.php\?id=[A-F0-9\-]{17,19}\d{12} HTTP.*User-Agent: MSIE9 detector_id: 23105
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_98"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/select_keys.php?id="; content:" HTTP"; content:"User-Agent|3A| MSIE9"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/select_keys\.php\?id=[A-F0-9\-]{17,19}\d{12} HTTP.*User-Agent: MSIE9/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023105; rev:507;)

# Adware: (Hoax) ArchSMS - regex: to_server:POST /program/open_archive HTTP.*archive_id=\d+ detector_id: 23106
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) ArchSMS"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/program/open_archive HTTP"; content:"archive_id="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/program\/open_archive HTTP.*archive_id=\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023106; rev:508;)

# Command&Control: (Trojan) Dusvext - regex: to_server:GET .*/(tasks|ltasks)\.php\?uid=\{[a-z0-9]+\} HTTP.*User-Agent: VERTEXNET detector_id: 23107
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Dusvext"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?uid=|7B|"; content:"|7D| HTTP"; content:"User-Agent|3A| VERTEXNET"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/(tasks|ltasks)\.php\?uid=\{[a-z0-9]+\} HTTP.*User-Agent: VERTEXNET/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023107; rev:514;)

# Command&Control: (Backdoor) GenericBackdoor_11 - regex: to_server:GET /qsb/getip\.asp\?username=.*&serverMac=[a-f0-9\-]{16,18}&edition= detector_id: 23108
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) GenericBackdoor_11"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/qsb/getip.asp?username="; content:"&serverMac="; content:"&edition="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/qsb\/getip\.asp\?username=.*&serverMac=[a-f0-9\-]{16,18}&edition=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023108; rev:508;)

# Command&Control: (TrojanProxy) Mitglieder - regex: to_server:GET .*/script\d{1,2}\.php\?garbage1=\d+&garbage2=[\d\.]+&garbage3=\d+&trafficid=.*&v=\d\.\d HTTP detector_id: 23109
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (TrojanProxy) Mitglieder"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/script"; content:".php?garbage1="; content:"&garbage2="; content:"&garbage3="; content:"&trafficid="; content:"&v="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/script\d{1,2}\.php\?garbage1=\d+&garbage2=[\d\.]+&garbage3=\d+&trafficid=.*&v=\d\.\d HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023109; rev:508;)

# Command&Control: (Trojan) Bublik - regex: to_server:POST /smp/inx\.php HTTP.*Content-Type: application/x-www-form-urlencoded.*[A-Za-z0-9\+/]{20,}={0,2} detector_id: 23129
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bublik"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/smp/inx.php HTTP"; content:"Content-Type|3A| application/x-www-form-urlencoded"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/smp\/inx\.php HTTP.*Content-Type: application\/x-www-form-urlencoded.*[A-Za-z0-9\+\/]{20,}={0,2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023129; rev:513;)

# Command&Control: (Trojan) APT_1 - regex: to_server:GET .*index\.aspx\?i=dv2MoAvP5w detector_id: 23130
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) APT_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"index.aspx?i=dv2MoAvP5w"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*index\.aspx\?i=dv2MoAvP5w/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023130; rev:722;)

# Command&Control: (Trojan) APT_1 - regex: to_server:GET .*index\.aspx\?i=9lgCHo3QxY detector_id: 23131
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) APT_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"index.aspx?i=9lgCHo3QxY"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*index\.aspx\?i=9lgCHo3QxY/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023131; rev:722;)

# Command&Control: (Trojan) APT_1 - regex: to_server:GET .*index\.aspx\?i=6d6nJwgMMU detector_id: 23132
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) APT_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"index.aspx?i=6d6nJwgMMU"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*index\.aspx\?i=6d6nJwgMMU/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023132; rev:722;)

# Command&Control: (Trojan) APT_1 - regex: to_server:GET .*index\.aspx\?i=t9Tzp4i7Zc detector_id: 23133
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) APT_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"index.aspx?i=t9Tzp4i7Zc"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*index\.aspx\?i=t9Tzp4i7Zc/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023133; rev:722;)

# Command&Control: (Trojan) Bublik - regex: to_server:POST /r/t\.ch\?rnd=-\d{9,11} HTTP detector_id: 23134
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bublik"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/r/t.ch?rnd=-"; content:" HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/r\/t\.ch\?rnd=-\d{9,11} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023134; rev:513;)

# Command&Control: (Trojan) Alureon - regex: to_server:GET /loader_log/eye\.php\?id=\d{9,11}-\d{9,11}-\d{9,11}-\d{9,11}&msg=.* detector_id: 23135
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Alureon"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/loader_log/eye.php?id="; content:"&msg="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/loader_log\/eye\.php\?id=\d{9,11}-\d{9,11}-\d{9,11}-\d{9,11}&msg=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023135; rev:733;)

# Command&Control: (Trojan) Carberp - regex: to_server:GET /geter/index_{0,1}\.php\?cmd=.*&uid=.*&step=\d+%5F[A-Za-z0-9]+ HTTP detector_id: 23136
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Carberp"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/geter/index"; content:".php?cmd="; content:"&uid="; content:"&step="; content:"|25|5F"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/geter\/index_{0,1}\.php\?cmd=.*&uid=.*&step=\d+%5F[A-Za-z0-9]+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023136; rev:514;)

# Command&Control: (Dropper) Kolilks Krament, Lamer - regex: to_server:GET /kills\.txt\?\d{6} HTTP detector_id: 23137
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Kolilks Krament, Lamer"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/kills.txt?"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/kills\.txt\?\d{6} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023137; rev:514;)

# Command&Control: (Trojan) Gamarue - regex: to_server:POST /stat/image\.php HTTP.*data=[a-z0-9]{9,} detector_id: 23138
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Gamarue"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/stat/image.php HTTP"; content:"data="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/stat\/image\.php HTTP.*data=[a-z0-9]{9,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023138; rev:514;)

# Command&Control: (Dropper) Dluca - regex: to_server:GET /wk/getclientinfo\.wnk\?id=\{[a-f0-9\-]+\}&srv=.*&ver=\d,\d,\d,\d+&docid=.*&time=\d&cstate=\d detector_id: 23141
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Dluca"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/wk/getclientinfo.wnk?id=|7B|"; content:"|7D|&srv="; content:"&ver="; content:"&docid="; content:"&time="; content:"&cstate="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/wk\/getclientinfo\.wnk\?id=\{[a-f0-9\-]+\}&srv=.*&ver=\d,\d,\d,\d+&docid=.*&time=\d&cstate=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023141; rev:514;)

# Command&Control: (Keylogger) MyKeyloggerOnline - regex: to_server:POST /upload\.php HTTP.*User-Agent: Internet Explorer.*filename=".*\.jpg" detector_id: 23143
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Keylogger) MyKeyloggerOnline"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/upload.php HTTP"; content:"User-Agent|3A| Internet Explorer"; content:"filename=|22|"; content:".jpg|22|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/upload\.php HTTP.*User-Agent: Internet Explorer.*filename=".*\.jpg"/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023143; rev:515;)

# FakeAV: FakeXPA - regex: to_server:GET /get\.php\?step=.*User-Agent: Compatible detector_id: 23144
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeXPA"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get.php?step="; content:"User-Agent|3A| Compatible"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get\.php\?step=.*User-Agent: Compatible/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023144; rev:515;)

# Adware: (Toolbar) AdRotator  - regex: to_server:GET /smb/nsi_install\.php\?aff_id=.*&inst_result=.*&hwid=[a-f0-9]{40} HTTP detector_id: 23145
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) AdRotator "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/smb/nsi_install.php?aff_id="; content:"&inst_result="; content:"&hwid="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/smb\/nsi_install\.php\?aff_id=.*&inst_result=.*&hwid=[a-f0-9]{40} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023145; rev:516;)

# Command&Control: (Trojan) Wombot - regex: to_server:POST /wm\.php\?macros=.*&botstatus=.*User-Agent: Mozilla/4\.0 \(compatible; Synapse\) detector_id: 23146
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Wombot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/wm.php?macros="; content:"&botstatus="; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| Synapse|29|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/wm\.php\?macros=.*&botstatus=.*User-Agent: Mozilla\/4\.0 \(compatible\; Synapse\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023146; rev:516;)

# FakeAV: Cleaner2009Pro - regex: to_server:GET /\?action=\d+&pc_id=\d+&abbr=.*User-Agent: Statistican detector_id: 23153
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: Cleaner2009Pro"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?action="; content:"&pc_id="; content:"&abbr="; content:"User-Agent|3A| Statistican"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?action=\d+&pc_id=\d+&abbr=.*User-Agent: Statistican/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023153; rev:516;)

# Command&Control: (Trojan) Mancsyn - regex: to_server:GET /contact\.php\?p=[A-Za-z0-9]{20,}={0,2} HTTP.*User-Agent: mc_v\d\.\d\.\d detector_id: 23154
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Mancsyn"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/contact.php?p="; content:" HTTP"; content:"User-Agent|3A| mc_v"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/contact\.php\?p=[A-Za-z0-9]{20,}={0,2} HTTP.*User-Agent: mc_v\d\.\d\.\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023154; rev:516;)

# Adware: (Toolbar) EliteBar - regex: to_server:GET /perl/control\.pl\?q=[A-F0-9]{70,100} HTTP detector_id: 23168
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) EliteBar"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/perl/control.pl?q="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/perl\/control\.pl\?q=[A-F0-9]{70,100} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023168; rev:520;)

# Command&Control: (Trojan) Jorik - regex: to_server:GET /wb\.php\?o=\d{2,3}&id=.*_[a-f0-9]{8}&drv=\| detector_id: 23169
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Jorik"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/wb.php?o="; content:"&id="; content:"&drv=|7C|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/wb\.php\?o=\d{2,3}&id=.*_[a-f0-9]{8}&drv=\|/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023169; rev:520;)

# Command&Control: (Dropper) Tofsee - regex: to_server:POST /tsone/ajuno\.php HTTP.*u=.*&p=.*&l=\d detector_id: 23170
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Tofsee"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/tsone/ajuno.php HTTP"; content:"u="; content:"&p="; content:"&l="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/tsone\/ajuno\.php HTTP.*u=.*&p=.*&l=\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023170; rev:520;)

# Command&Control: (Trojan) Cycbot - regex: to_server:GET /images/.*\.jpg\?tq=g.*User-Agent: iamx/3\.11 detector_id: 23569
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Cycbot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/images/"; content:".jpg?tq=g"; content:"User-Agent|3A| iamx/3.11"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/images\/.*\.jpg\?tq=g.*User-Agent: iamx\/3\.11/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023569; rev:727;)

# Command&Control: (Dropper) GenericDropper_21 - regex: to_server:GET /tj\.asp\?mac=[\d\-]{16,18}&ver=\d\.\d&lin=.*&tm=[0-9\.\-]+&t=[A-F0-9]+ HTTP detector_id: 23570
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_21"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/tj.asp?mac="; content:"&ver="; content:"&lin="; content:"&tm="; content:"&t="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/tj\.asp\?mac=[\d\-]{16,18}&ver=\d\.\d&lin=.*&tm=[0-9\.\-]+&t=[A-F0-9]+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023570; rev:521;)

# Command&Control: (Backdoor) PcClient - regex: to_server:GET /pcshare200/ip/ip\.asp\?user=.*&pass=.*&port=\d{1,5}&chk=\d&ver=[A-Z0-9]+ HTTP detector_id: 23571
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) PcClient"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/pcshare200/ip/ip.asp?user="; content:"&pass="; content:"&port="; content:"&chk="; content:"&ver="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/pcshare200\/ip\/ip\.asp\?user=.*&pass=.*&port=\d{1,5}&chk=\d&ver=[A-Z0-9]+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023571; rev:521;)

# Command&Control: (Dropper) Seimon - regex: to_server:GET .*/log/lod\.php\?id=.*&maddr=[a-f0-9]{12} HTTP.*User-Agent: microsoft detector_id: 23572
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Seimon"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/log/lod.php?id="; content:"&maddr="; content:" HTTP"; content:"User-Agent|3A| microsoft"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/log\/lod\.php\?id=.*&maddr=[a-f0-9]{12} HTTP.*User-Agent: microsoft/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023572; rev:522;)

# Command&Control: (Trojan) GenericTrojan_125 - regex: to_server:POST .*/save\.asp\?strHost=.*&strMac=[\d\-]{16,18}&win=.*&time=\d.*date= detector_id: 23573
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_125"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/save.asp?strHost="; content:"&strMac="; content:"&win="; content:"&time="; content:"date="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/save\.asp\?strHost=.*&strMac=[\d\-]{16,18}&win=.*&time=\d.*date=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023573; rev:522;)

# Command&Control: (Backdoor) Hanove - regex: to_server:GET .*/snwd\.php\?tp=\d&tg=.{30}&tv=.*&ts=.*&mt=.*&tr=.*&[A-Z0-9]{5,6} HTTP detector_id: 23574
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Hanove"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/snwd.php?tp="; content:"&tg="; content:"&tv="; content:"&ts="; content:"&mt="; content:"&tr="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/snwd\.php\?tp=\d&tg=.{30}&tv=.*&ts=.*&mt=.*&tr=.*&[A-Z0-9]{5,6} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023574; rev:522;)

# Command&Control: (Dropper) Harnig - regex: to_server:GET /[a-z]{5,10}/[a-z]{5,10}\.php\?id=-{0,1}\d{9,10}&p=1 HTTP.*User-Agent: .*\)ver\d{1,2}.*Host: .*\.com detector_id: 23589
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Harnig"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?id="; content:"&p=1 HTTP"; content:"User-Agent|3A| "; content:"|29|ver"; content:"Host|3A| "; content:".com"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{5,10}\/[a-z]{5,10}\.php\?id=-{0,1}\d{9,10}&p=1 HTTP.*User-Agent: .*\)ver\d{1,2}.*Host: .*\.com/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023589; rev:523;)

# Command&Control: (Dropper) Tamech - regex: to_server:GET /painel/\?add=1&inf=.*User-Agent: AutoIt detector_id: 23590
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Tamech"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/painel/?add=1&inf="; content:"User-Agent|3A| AutoIt"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/painel\/\?add=1&inf=.*User-Agent: AutoIt/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023590; rev:523;)

# Command&Control: (Trojan) GenericTrojan_126 - regex: to_server:POST /mylogs\.php\?to=.*&name=.*&os=.*&username=.*&token=.*&ng HTTP detector_id: 23591
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_126"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/mylogs.php?to="; content:"&name="; content:"&os="; content:"&username="; content:"&token="; content:"&ng HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mylogs\.php\?to=.*&name=.*&os=.*&username=.*&token=.*&ng HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023591; rev:523;)

# Command&Control: (Trojan) Khelios - regex: to_server:GET /[a-z]+\.htm HTTP/1\.1\r\nHost: \d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\r\nContent-Length: \d+\r\n.*\r\n\r\n.*[\x00-\x1f\x80-\xFF]{4}.+ detector_id: 39648
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Khelios"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".htm HTTP/1.1|0D||0A|Host|3A| "; content:"|0D||0A|Content-Length|3A| "; content:"|0D||0A|"; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]+\.htm HTTP\/1\.1\r\nHost: \d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\r\nContent-Length: \d+\r\n.*\r\n\r\n.*[\x00-\x1f\x80-\xFF]{4}.+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1039648; rev:718;)

# Command&Control: (Banker) GenericBanker_8 - regex: to_server:POST .*/(informando|informa)\.php HTTP.*User-Agent: Mozilla/3\.0 \(compatible; Indy Library\).*op=.*&informacao=.*& detector_id: 40178
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_8"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; content:"op="; content:"&informacao="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/(informando|informa)\.php HTTP.*User-Agent: Mozilla\/3\.0 \(compatible\; Indy Library\).*op=.*&informacao=.*&/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040178; rev:537;)

# Command&Control: (Trojan) GenericTrojan_76 - regex: to_server:GET /i\.php\?frevny=.*&bf=.*&qrynl=.*&irefvba=.*&hcqngvzr=\d HTTP detector_id: 40179
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_76"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/i.php?frevny="; content:"&bf="; content:"&qrynl="; content:"&irefvba="; content:"&hcqngvzr="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/i\.php\?frevny=.*&bf=.*&qrynl=.*&irefvba=.*&hcqngvzr=\d HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040179; rev:534;)

# Command&Control: (Trojan) Expiro - regex: to_server:GET /idedrv/\?App=.*&Ver=\d+&Sys=.*&Tag=.*&Host=[A-Z0-9]+&Os=.*&Pc=.*&User= detector_id: 40180
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Expiro"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/idedrv/?App="; content:"&Ver="; content:"&Sys="; content:"&Tag="; content:"&Host="; content:"&Os="; content:"&Pc="; content:"&User="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/idedrv\/\?App=.*&Ver=\d+&Sys=.*&Tag=.*&Host=[A-Z0-9]+&Os=.*&Pc=.*&User=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040180; rev:534;)

# Command&Control: (Banker) Banload - regex: to_server:POST /up\.php HTTP.*User-Agent: Mozilla/3\.0 \(compatible; Indy Library\).*Content-Disposition: form-data; name="step".*Content-Disposition: form-data; name="hash" detector_id: 40181
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Banload"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/up.php HTTP"; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; content:"Content-Disposition|3A| form-data|3B| name=|22|step|22|"; content:"Content-Disposition|3A| form-data|3B| name=|22|hash|22|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/up\.php HTTP.*User-Agent: Mozilla\/3\.0 \(compatible\; Indy Library\).*Content-Disposition: form-data\; name="step".*Content-Disposition: form-data\; name="hash"/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040181; rev:534;)

# Command&Control: (Dropper) Chekafe - regex: to_server:GET /admin/count\.php\?id=\d{1,5}&isInst=1 HTTP.*User-Agent: my_check_data detector_id: 40197
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Chekafe"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/admin/count.php?id="; content:"&isInst=1 HTTP"; content:"User-Agent|3A| my_check_data"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/admin\/count\.php\?id=\d{1,5}&isInst=1 HTTP.*User-Agent: my_check_data/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040197; rev:617;)

# FakeAV: FakeVimes - regex: to_server:GET /\?abbr=.*&pid=\d HTTP.*User-Agent: Mozilla/3\.0 \(compatible; Indy Library\) detector_id: 40198
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeVimes"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?abbr="; content:"&pid="; content:" HTTP"; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?abbr=.*&pid=\d HTTP.*User-Agent: Mozilla\/3\.0 \(compatible\; Indy Library\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040198; rev:535;)

# FakeAV: FakeScanti - regex: to_server:GET /sp\.php\?adv=\d{4}&who=[A-Za-z]{1} HTTP detector_id: 40199
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeScanti"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/sp.php?adv="; content:"&who="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/sp\.php\?adv=\d{4}&who=[A-Za-z]{1} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040199; rev:535;)

# Adware: (Adware) KwSearch - regex: to_server:GET /log-bin/sidebar_load\.php\?maddr=.{12}&ipaddr=[\d\.]+&aff_id=.*&verno= HTTP detector_id: 40200
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) KwSearch"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/log-bin/sidebar_load.php?maddr="; content:"&ipaddr="; content:"&aff_id="; content:"&verno= HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/log-bin\/sidebar_load\.php\?maddr=.{12}&ipaddr=[\d\.]+&aff_id=.*&verno= HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040200; rev:535;)

# Command&Control: (Trojan) Kuluoz - regex: to_server:GET /[A-Z0-9]{152} HTTP/1\.1\r\n.*Host: \d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}(:\d{2,5})?\r\n\r\n detector_id: 40201
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Kuluoz"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP/1.1|0D||0A|"; content:"Host|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[A-Z0-9]{152} HTTP\/1\.1\r\n.*Host: \d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}(:\d{2,5})?\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040201; rev:670;)

# Command&Control: (Trojan) SpyEye - regex: to_server:POST .*/websitechk\.php HTTP.*Content-Disposition: form-data; name="bot_guid".*Content-Disposition: form-data; name="bot_version" detector_id: 40211
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) SpyEye"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/websitechk.php HTTP"; content:"Content-Disposition|3A| form-data|3B| name=|22|bot_guid|22|"; content:"Content-Disposition|3A| form-data|3B| name=|22|bot_version|22|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/websitechk\.php HTTP.*Content-Disposition: form-data\; name="bot_guid".*Content-Disposition: form-data\; name="bot_version"/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040211; rev:536;)

# Command&Control: (Trojan) Jorik - regex: to_server:GET /rp\.php\?omh=[a-z0-9]+&oic=\d+&wxit=\d+&s=\d+&mh=.*&vix=\d{1,2}&ziv=\d+ HTTP detector_id: 40224
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Jorik"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/rp.php?omh="; content:"&oic="; content:"&wxit="; content:"&s="; content:"&mh="; content:"&vix="; content:"&ziv="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/rp\.php\?omh=[a-z0-9]+&oic=\d+&wxit=\d+&s=\d+&mh=.*&vix=\d{1,2}&ziv=\d+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040224; rev:537;)

# Command&Control: (Dropper) GenericDropper_41 - regex: to_server:GET /Count\.asp\?TG=\d+&Mac=.{12}&Ver=[\d\-]+&Jc=.*&Yp=.*&KEY=\d+&CP= detector_id: 40225
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_41"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Count.asp?TG="; content:"&Mac="; content:"&Ver="; content:"&Jc="; content:"&Yp="; content:"&KEY="; content:"&CP="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Count\.asp\?TG=\d+&Mac=.{12}&Ver=[\d\-]+&Jc=.*&Yp=.*&KEY=\d+&CP=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040225; rev:537;)

# FakeAV: Rena Fake Rean - regex: to_server:GET /installed\.php\?id=\d{3} HTTP.*User-Agent: Microsoft BITS/6\.7 detector_id: 40226
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: Rena Fake Rean"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/installed.php?id="; content:" HTTP"; content:"User-Agent|3A| Microsoft BITS/6.7"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/installed\.php\?id=\d{3} HTTP.*User-Agent: Microsoft BITS\/6\.7/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040226; rev:537;)

# Command&Control: (Dropper) GenericDropper_108 - regex: to_server:GET /[a-z]{1}\d{2,3}/agent\.asp\?r=\d+ HTTP.*Host: .*:2004 detector_id: 40227
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_108"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/agent.asp?r="; content:" HTTP"; content:"Host|3A| "; content:"|3A|2004"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{1}\d{2,3}\/agent\.asp\?r=\d+ HTTP.*Host: .*:2004/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040227; rev:583;)

# Command&Control: (Banker) GenericBanker_1 - regex: to_server:POST /GeraDados\.php HTTP.*User-Agent: Mozilla/3\.0 \(compatible; Indy Library\).*praquem=.*&texto=.*&titulo= detector_id: 40230
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_1"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/GeraDados.php HTTP"; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; content:"praquem="; content:"&texto="; content:"&titulo="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/GeraDados\.php HTTP.*User-Agent: Mozilla\/3\.0 \(compatible\; Indy Library\).*praquem=.*&texto=.*&titulo=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040230; rev:538;)

# Command&Control: (Trojan) Alureon - regex: to_server:GET /[a-z0-9]{2,5}\.php\?log=start\|id=[a-z0-9]{8,12}\|os=\d\.\d.*x(32|64)\|error=.{2,3}\|wsaerror=.{2,3}\|version=\d HTTP detector_id: 40231
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Alureon"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?log=start|7C|id="; content:"|7C|os="; content:"|7C|error="; content:"|7C|wsaerror="; content:"|7C|version="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z0-9]{2,5}\.php\?log=start\|id=[a-z0-9]{8,12}\|os=\d\.\d.*x(32|64)\|error=.{2,3}\|wsaerror=.{2,3}\|version=\d HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040231; rev:538;)

# Adware: (Installer) MediaGet - regex: to_server:GET /mediaget-installer-2/binaries/download\.php\?a=mediaget-.{3,6} HTTP detector_id: 40232
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Installer) MediaGet"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mediaget-installer-2/binaries/download.php?a=mediaget-"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mediaget-installer-2\/binaries\/download\.php\?a=mediaget-.{3,6} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040232; rev:538;)

# Command&Control: (Banker) Banload - regex: to_server:POST .*/infects\.php HTTP.*tip=.*&tipo=.*&infects=.*&inf=.*& detector_id: 40233
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Banload"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/infects.php HTTP"; content:"tip="; content:"&tipo="; content:"&infects="; content:"&inf="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/infects\.php HTTP.*tip=.*&tipo=.*&infects=.*&inf=.*&/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040233; rev:538;)

# Adware: (Installer) OpenCandy - regex: to_server:GET /api\.php\?aff=\d+&ver=[\d\.]+&id=.*&os=.*&os_ver=.*&action=.*User-Agent: MERONG detector_id: 40265
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Installer) OpenCandy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/api.php?aff="; content:"&ver="; content:"&id="; content:"&os="; content:"&os_ver="; content:"&action="; content:"User-Agent|3A| MERONG"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\.php\?aff=\d+&ver=[\d\.]+&id=.*&os=.*&os_ver=.*&action=.*User-Agent: MERONG/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040265; rev:541;)

# FakeAV: KoreanFakeAV - regex: to_server:GET /mbk\.php\?v1=[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2} HTTP detector_id: 40266
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: KoreanFakeAV"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mbk.php?v1="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mbk\.php\?v1=[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040266; rev:541;)

# Command&Control: (Trojan) Mutopy - regex: to_server:POST .*\.php HTTP.*lflkwx=.*&eEJvDj=.*&mwTnI=.*&dRaxeQ= detector_id: 40272
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Mutopy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"lflkwx="; content:"&eEJvDj="; content:"&mwTnI="; content:"&dRaxeQ="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php HTTP.*lflkwx=.*&eEJvDj=.*&mwTnI=.*&dRaxeQ=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040272; rev:542;)

# Command&Control: (Trojan) Mutopy - regex: to_server:POST .*\.php HTTP.*lQSWlN=.*&eveKxt=.*&moYkYn=.*&dsmIC=.*&jwIm= detector_id: 40273
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Mutopy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"lQSWlN="; content:"&eveKxt="; content:"&moYkYn="; content:"&dsmIC="; content:"&jwIm="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php HTTP.*lQSWlN=.*&eveKxt=.*&moYkYn=.*&dsmIC=.*&jwIm=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040273; rev:542;)

# Command&Control: (Trojan) Mutopy - regex: to_server:POST .*\.php HTTP.*lbfAeS=.*&esrmTP=.*&mPOuO=.*&dtkROD=.*&YlRE= detector_id: 40274
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Mutopy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"lbfAeS="; content:"&esrmTP="; content:"&mPOuO="; content:"&dtkROD="; content:"&YlRE="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php HTTP.*lbfAeS=.*&esrmTP=.*&mPOuO=.*&dtkROD=.*&YlRE=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040274; rev:542;)

# Command&Control: (Trojan) Mutopy - regex: to_server:POST .*\.php HTTP.*lMmOig=.*&eQpOsj=.*&mXLsg=.*&dkyKh=.*&cKwW= detector_id: 40275
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Mutopy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"lMmOig="; content:"&eQpOsj="; content:"&mXLsg="; content:"&dkyKh="; content:"&cKwW="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php HTTP.*lMmOig=.*&eQpOsj=.*&mXLsg=.*&dkyKh=.*&cKwW=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040275; rev:542;)

# Command&Control: (Trojan) Mutopy - regex: to_server:POST .*\.php HTTP.*lUEkXW=.*&ekjfB=.*&mExNHo=.*&dqxDdv=.*&RUaex=.*&CYUxG= detector_id: 40276
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Mutopy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"lUEkXW="; content:"&ekjfB="; content:"&mExNHo="; content:"&dqxDdv="; content:"&RUaex="; content:"&CYUxG="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php HTTP.*lUEkXW=.*&ekjfB=.*&mExNHo=.*&dqxDdv=.*&RUaex=.*&CYUxG=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040276; rev:542;)

# Command&Control: (Trojan) Mutopy - regex: to_server:POST .*\.php HTTP.*lKOot=.*&eOpusb=.*&mwmnDC=.*&dPDWs= detector_id: 40277
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Mutopy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"lKOot="; content:"&eOpusb="; content:"&mwmnDC="; content:"&dPDWs="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php HTTP.*lKOot=.*&eOpusb=.*&mwmnDC=.*&dPDWs=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040277; rev:542;)

# Command&Control: (Trojan) Mutopy - regex: to_server:POST .*\.php HTTP.*lNivev=.*&etSlFY=.*&mprNv=.*&dbxEB=.*&PlOgl=.*&NDfi= detector_id: 40278
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Mutopy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"lNivev="; content:"&etSlFY="; content:"&mprNv="; content:"&dbxEB="; content:"&PlOgl="; content:"&NDfi="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php HTTP.*lNivev=.*&etSlFY=.*&mprNv=.*&dbxEB=.*&PlOgl=.*&NDfi=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040278; rev:542;)

# FakeAV: KoreanFakeAV - regex: to_server:GET /app_ctr\.php\?strID=.*&strPC=[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2} HTTP detector_id: 40284
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: KoreanFakeAV"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/app_ctr.php?strID="; content:"&strPC="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/app_ctr\.php\?strID=.*&strPC=[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040284; rev:543;)

# FakeAV: WinWebSec - regex: to_server:GET .*/\?ts=[a-z0-9]+&token=.*&affid=\d+&ver=\d+&group=.*User-Agent: .*c:(AMD|INT) detector_id: 40285
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: WinWebSec"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?ts="; content:"&token="; content:"&affid="; content:"&ver="; content:"&group="; content:"User-Agent|3A| "; content:"c|3A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/\?ts=[a-z0-9]+&token=.*&affid=\d+&ver=\d+&group=.*User-Agent: .*c:(AMD|INT)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040285; rev:563;)

# Command&Control: (Banker) Bancodor - regex: to_server:POST .*/atualizaCliente\.php HTTP.*nome=.*&serial=.*&janela= detector_id: 40286
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Bancodor"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/atualizaCliente.php HTTP"; content:"nome="; content:"&serial="; content:"&janela="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/atualizaCliente\.php HTTP.*nome=.*&serial=.*&janela=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040286; rev:543;)

# Command&Control: (Dropper) GenericDropper_109 - regex: to_server:POST .*/upload\.aspx\?filepath=info&filename=.*_[\d\.]+\.jpg HTTP.*User-Agent: MyAgent detector_id: 40304
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_109"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/upload.aspx?filepath=info&filename="; content:".jpg HTTP"; content:"User-Agent|3A| MyAgent"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/upload\.aspx\?filepath=info&filename=.*_[\d\.]+\.jpg HTTP.*User-Agent: MyAgent/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040304; rev:545;)

# Adware: (Adware) WSearch - regex: to_server:GET /pig3/dealip\.asp\?aa=\d{6}&bb=[a-f0-9]{32} HTTP detector_id: 40305
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) WSearch"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/pig3/dealip.asp?aa="; content:"&bb="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/pig3\/dealip\.asp\?aa=\d{6}&bb=[a-f0-9]{32} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040305; rev:545;)

# Command&Control: (Dropper) Leechole - regex: to_server:GET /cnt3\.php\?e=\d+&u=.*&r=\d&sz=\d+&uid=\d+ HTTP detector_id: 40306
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Leechole"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cnt3.php?e="; content:"&u="; content:"&r="; content:"&sz="; content:"&uid="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cnt3\.php\?e=\d+&u=.*&r=\d&sz=\d+&uid=\d+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040306; rev:545;)

# Bitcoin Mining: BitCoinMiner - regex: to_server:POST /.*\.php HTTP.*User-Agent: SBTCM.*pc=.*&cmd=/d detector_id: 40338
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Bitcoin Mining: BitCoinMiner"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"User-Agent|3A| SBTCM"; content:"pc="; content:"&cmd=/d"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\.php HTTP.*User-Agent: SBTCM.*pc=.*&cmd=\/d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040338; rev:709;)

# Command&Control: (Trojan) Dusvext - regex: to_server:POST /[Vv]ertexNet/poster\.php HTTP.*typ=\d&data=[A-F0-9]+ detector_id: 40339
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Dusvext"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"ertexNet/poster.php HTTP"; content:"typ="; content:"&data="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[Vv]ertexNet\/poster\.php HTTP.*typ=\d&data=[A-F0-9]+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040339; rev:549;)

# Command&Control: (Trojan) Enfal - regex: to_server:GET /.*httpdocs/mm/.*:[A-F0-9]{2}-[A-F0-9]{2}-[A-F0-9]{2}-[A-F0-9]{2}-[A-F0-9]{2}-[A-F0-9]{2}/Cmwhite HTTP detector_id: 40340
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Enfal"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"httpdocs/mm/"; content:"/Cmwhite HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*httpdocs\/mm\/.*:[A-F0-9]{2}-[A-F0-9]{2}-[A-F0-9]{2}-[A-F0-9]{2}-[A-F0-9]{2}-[A-F0-9]{2}\/Cmwhite HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040340; rev:549;)

# Command&Control: (Trojan) GenericTrojan_128 - regex: to_server:GET /bot\.php\?ip=[\d\.]+&os=.*&name=.*&id=.*-\d\.\d\.\d HTTP detector_id: 40345
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_128"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bot.php?ip="; content:"&os="; content:"&name="; content:"&id="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bot\.php\?ip=[\d\.]+&os=.*&name=.*&id=.*-\d\.\d\.\d HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040345; rev:551;)

# Command&Control: (Trojan) ZBot - regex: to_server:POST /b/(opt|eve|req)/[A-Fa-f0-9]{24} HTTP.*Accept: \*/\*.*Content-Type.*Connection.*User-Agent detector_id: 40346
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/b/"; content:" HTTP"; content:"Accept|3A| |2A|/|2A|"; content:"Content-Type"; content:"Connection"; content:"User-Agent"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/b\/(opt|eve|req)\/[A-Fa-f0-9]{24} HTTP.*Accept: \*\/\*.*Content-Type.*Connection.*User-Agent/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040346; rev:551;)

# Command&Control: (Dropper) GenericDropper_110 - regex: to_server:GET /radbot/index\.php\?id=\d+&cname=.*&hostname=.*&username=.*&av=. detector_id: 40450
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_110"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/radbot/index.php?id="; content:"&cname="; content:"&hostname="; content:"&username="; content:"&av="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/radbot\/index\.php\?id=\d+&cname=.*&hostname=.*&username=.*&av=./"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040450; rev:552;)

# Command&Control: (Trojan) Dulom - regex: to_server:GET .*/o\.php\?get=ok HTTP.*User-Agent: Mozilla/3\.0 \(compatible; Indy Library\) detector_id: 40474
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Dulom"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/o.php?get=ok HTTP"; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/o\.php\?get=ok HTTP.*User-Agent: Mozilla\/3\.0 \(compatible\; Indy Library\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040474; rev:555;)

# Adware: (Adware) CloverPlus - regex: to_server:GET /inf_(c|d)\.php\?k=\d{1,2} HTTP detector_id: 40475
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) CloverPlus"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/inf_"; content:".php?k="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/inf_(c|d)\.php\?k=\d{1,2} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040475; rev:555;)

# Command&Control: (Banker) Banz - regex: to_server:POST .*/verifica\.php HTTP.*remetente=.*&destinatario=.*&{0,1} detector_id: 40495
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Banz"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/verifica.php HTTP"; content:"remetente="; content:"&destinatario="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/verifica\.php HTTP.*remetente=.*&destinatario=.*&{0,1}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040495; rev:573;)

# Command&Control: (Banker) GenericBanker_25 - regex: to_server:GET .*comphp\.php\?tipo=.*&cliente=.*&mensagem=x(86|64) HTTP detector_id: 40506
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_25"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"comphp.php?tipo="; content:"&cliente="; content:"&mensagem=x"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*comphp\.php\?tipo=.*&cliente=.*&mensagem=x(86|64) HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040506; rev:558;)

# Adware: (Software Bundler) Lollipop - regex: to_server:GET /report/oneinst\.php\?iid=\d{2,4}&nsoft=.*&soft=.*&offer=.*&logtext=.*&action=.*User-Agent: NSISDL/1\.2 \(Mozilla\) detector_id: 40513
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Software Bundler) Lollipop"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/report/oneinst.php?iid="; content:"&nsoft="; content:"&soft="; content:"&offer="; content:"&logtext="; content:"&action="; content:"User-Agent|3A| NSISDL/1.2 |28|Mozilla|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/report\/oneinst\.php\?iid=\d{2,4}&nsoft=.*&soft=.*&offer=.*&logtext=.*&action=.*User-Agent: NSISDL\/1\.2 \(Mozilla\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040513; rev:559;)

# Adware: (Downware) InstallCore - regex: to_server:POST /50OR/\?v=\d\.\d&c=\d{8,10} HTTP detector_id: 40517
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) InstallCore"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/50OR/?v="; content:"&c="; content:" HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/50OR\/\?v=\d\.\d&c=\d{8,10} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040517; rev:559;)

# FakeAV: GenericFakeAV_12 - regex: to_server:POST /1wave\.php HTTP.*data=e/e6r\d detector_id: 40545
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_12"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/1wave.php HTTP"; content:"data=e/e6r"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/1wave\.php HTTP.*data=e\/e6r\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040545; rev:1032;)

# Command&Control: (Trojan) GenericTrojan_129 - regex: to_server:POST /index\.php HTTP.*User-Agent: Mozilla/4\.0 \(compatible; MSIE 5\.01; Windows NT\).*Content-Disposition: form-data; name="UID=" detector_id: 40546
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_129"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/index.php HTTP"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 5.01|3B| Windows NT|29|"; content:"Content-Disposition|3A| form-data|3B| name=|22|UID=|22|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php HTTP.*User-Agent: Mozilla\/4\.0 \(compatible\; MSIE 5\.01\; Windows NT\).*Content-Disposition: form-data\; name="UID="/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040546; rev:562;)

# Command&Control: (Trojan) GenericTrojan_130 - regex: to_server:GET /(plus|version)\.php\?query=.*Wmda.*Host: [\d\.]{7,15}:\d{3,4} detector_id: 40547
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_130"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?query="; content:"Wmda"; content:"Host|3A| "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(plus|version)\.php\?query=.*Wmda.*Host: [\d\.]{7,15}:\d{3,4}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040547; rev:563;)

# Command&Control: (Trojan) GenericTrojan_130 - regex: to_server:GET /do\.asp\?search=.*Wmda.*Host: [\d\.]{7,15}:\d{3,4} detector_id: 40557
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_130"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/do.asp?search="; content:"Wmda"; content:"Host|3A| "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/do\.asp\?search=.*Wmda.*Host: [\d\.]{7,15}:\d{3,4}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040557; rev:563;)

# Command&Control: (Backdoor) Zegost - regex: to_server:POST /open\.php HTTP.*User-Agent: WEBPOST AGENT.*user=.*&mac=.*&os= detector_id: 40558
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Zegost"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/open.php HTTP"; content:"User-Agent|3A| WEBPOST AGENT"; content:"user="; content:"&mac="; content:"&os="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/open\.php HTTP.*User-Agent: WEBPOST AGENT.*user=.*&mac=.*&os=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040558; rev:563;)

# Bitcoin Mining: BitCoinMiner - regex: to_server:POST /ext\.php.*pc=.*&cmd=.* detector_id: 40567
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Bitcoin Mining: BitCoinMiner"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ext.php"; content:"pc="; content:"&cmd="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ext\.php.*pc=.*&cmd=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040567; rev:709;)

# Adware: (Toolbar) Ourxin - regex: to_server:GET /cfs/available/\d+\.txt\?vendor=.*&guid=.*User-Agent: CFS_DOWNLOAD detector_id: 40593
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Ourxin"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cfs/available/"; content:".txt?vendor="; content:"&guid="; content:"User-Agent|3A| CFS_DOWNLOAD"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cfs\/available\/\d+\.txt\?vendor=.*&guid=.*User-Agent: CFS_DOWNLOAD/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040593; rev:565;)

# FakeAV: KoreanFakeAV_1 - regex: to_server:GET /payment\.php\?pid=.*&mc=[A-F0-9]{12} HTTP detector_id: 40594
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: KoreanFakeAV_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/payment.php?pid="; content:"&mc="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/payment\.php\?pid=.*&mc=[A-F0-9]{12} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040594; rev:565;)

# Adware: (Adware) WSearch - regex: to_server:GET /simplesearch/update\.asp\?type=\d&aa=\d+&bb=.*&cc=0{8,12} HTTP detector_id: 40595
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) WSearch"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/simplesearch/update.asp?type="; content:"&aa="; content:"&bb="; content:"&cc="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/simplesearch\/update\.asp\?type=\d&aa=\d+&bb=.*&cc=0{8,12} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040595; rev:565;)

# Adware: (Adware) WSearch - regex: to_server:GET /routeway/dealsetup\.asp\?aa=\d+&bb=.*&cc=\d\.\d\.\d\.\d{1,2}&dd=.*User-Agent: ProxyDown detector_id: 40606
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) WSearch"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/routeway/dealsetup.asp?aa="; content:"&bb="; content:"&cc="; content:"&dd="; content:"User-Agent|3A| ProxyDown"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/routeway\/dealsetup\.asp\?aa=\d+&bb=.*&cc=\d\.\d\.\d\.\d{1,2}&dd=.*User-Agent: ProxyDown/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040606; rev:566;)

# Adware: (Adware) Addendum - regex: to_server:GET /request/app_install\.php\?mac=[A-F0-9]{12}&ver=.*&pid=j[a-z]{2,3}\d{2,3} HTTP detector_id: 40607
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Addendum"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/request/app_install.php?mac="; content:"&ver="; content:"&pid=j"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/request\/app_install\.php\?mac=[A-F0-9]{12}&ver=.*&pid=j[a-z]{2,3}\d{2,3} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040607; rev:566;)

# FakeAV: KoreanFakeAV_1 - regex: to_server:GET .*/Start\.php\?mc=\d{12}&pid= HTTP detector_id: 40608
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: KoreanFakeAV_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Start.php?mc="; content:"&pid= HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/Start\.php\?mc=\d{12}&pid= HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040608; rev:566;)

# Command&Control: (Trojan) GenericTrojan_132 - regex: to_server:POST /.*\.php HTTP.*User-Agent: Uploador.*Content-Disposition: form-data; name="data"; filename=".*\.jpg" detector_id: 40645
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_132"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"User-Agent|3A| Uploador"; content:"Content-Disposition|3A| form-data|3B| name=|22|data|22||3B| filename=|22|"; content:".jpg|22|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\.php HTTP.*User-Agent: Uploador.*Content-Disposition: form-data\; name="data"\; filename=".*\.jpg"/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040645; rev:570;)

# Command&Control: (Backdoor) Protux - regex: to_server:POST .*:\d{3,4}/index\.php HTTP.*User-Agent: Mozilla/4\.8\.20 \(compatible; MSIE 5\.0\.2; Win32\) detector_id: 40646
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Protux"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/index.php HTTP"; content:"User-Agent|3A| Mozilla/4.8.20 |28|compatible|3B| MSIE 5.0.2|3B| Win32|29|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*:\d{3,4}\/index\.php HTTP.*User-Agent: Mozilla\/4\.8\.20 \(compatible\; MSIE 5\.0\.2\; Win32\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040646; rev:570;)

# Adware: (Adware) Zugo - regex: to_server:GET /reg\?c=zugo\..*User-Agent: NSIS_Inetc \(Mozilla\) detector_id: 40679
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Zugo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/reg?c=zugo."; content:"User-Agent|3A| NSIS_Inetc |28|Mozilla|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/reg\?c=zugo\..*User-Agent: NSIS_Inetc \(Mozilla\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040679; rev:571;)

# Command&Control: (Trojan) Sfuzuan - regex: to_server:GET /ux/getip\.aspx\?username=.*&agname=.*&pb=\d HTTP.*User-Agent: IEDLL detector_id: 40711
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sfuzuan"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ux/getip.aspx?username="; content:"&agname="; content:"&pb="; content:" HTTP"; content:"User-Agent|3A| IEDLL"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ux\/getip\.aspx\?username=.*&agname=.*&pb=\d HTTP.*User-Agent: IEDLL/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040711; rev:572;)

# Adware: (Toolbar) GetUpdate - regex: to_server:GET /Install/Init_1\.asp\?N=.*&V=\d+&AID=.*&UID=SN:.*:G:[A-F0-9\-]+&ALX=.*&ASET= detector_id: 40728
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) GetUpdate"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Install/Init_1.asp?N="; content:"&V="; content:"&AID="; content:"&UID=SN|3A|"; content:"|3A|G|3A|"; content:"&ALX="; content:"&ASET="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Install\/Init_1\.asp\?N=.*&V=\d+&AID=.*&UID=SN:.*:G:[A-F0-9\-]+&ALX=.*&ASET=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040728; rev:573;)

# Adware: (Hoax) ArchSMS - regex: to_server:GET .*/lnch\.php\?id_user=.*&subflow=.*&pid=\d{3}&dwnlid=\d{4,5} HTTP detector_id: 40729
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) ArchSMS"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/lnch.php?id_user="; content:"&subflow="; content:"&pid="; content:"&dwnlid="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/lnch\.php\?id_user=.*&subflow=.*&pid=\d{3}&dwnlid=\d{4,5} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040729; rev:606;)

# Command&Control: (Trojan) Trubsil - regex: to_server:POST /cmd\.php HTTP/1\.0.*User-Agent: Mozilla/4\.0 \(compatible; Synapse\).*status=\d detector_id: 40730
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Trubsil"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/cmd.php HTTP/1.0"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| Synapse|29|"; content:"status="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cmd\.php HTTP\/1\.0.*User-Agent: Mozilla\/4\.0 \(compatible\; Synapse\).*status=\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040730; rev:573;)

# Command&Control: (Trojan) Qhosts_1 - regex: to_server:GET /wmiboy/2\.asp\?user=.*&name=.*&username=.*&xt=.*&ip=.*&port=\d+&Submit= detector_id: 40850
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Qhosts_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/wmiboy/2.asp?user="; content:"&name="; content:"&username="; content:"&xt="; content:"&ip="; content:"&port="; content:"&Submit="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/wmiboy\/2\.asp\?user=.*&name=.*&username=.*&xt=.*&ip=.*&port=\d+&Submit=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040850; rev:577;)

# Command&Control: (Trojan) GenericTrojan_133 - regex: to_server:GET /csi\?k=[\d\-]{17}&n=.*&a=\d&i=\d&p=\d&l=\d+&r=\d+&c=\d&t=\d+ HTTP detector_id: 40851
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_133"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/csi?k="; content:"&n="; content:"&a="; content:"&i="; content:"&p="; content:"&l="; content:"&r="; content:"&c="; content:"&t="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/csi\?k=[\d\-]{17}&n=.*&a=\d&i=\d&p=\d&l=\d+&r=\d+&c=\d&t=\d+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040851; rev:577;)

# Command&Control: (Banker) Banz_1 - regex: to_server:POST .*/foi\.php HTTP.*tipo=.*&assunto=.*&Iniciado.*&cli= detector_id: 40852
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Banz_1"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/foi.php HTTP"; content:"tipo="; content:"&assunto="; content:"&Iniciado"; content:"&cli="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/foi\.php HTTP.*tipo=.*&assunto=.*&Iniciado.*&cli=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040852; rev:577;)

# Command&Control: (Trojan) Cossta - regex: to_server:GET /base/get2\.aspx\?str=[a-f0-9]{200,225} HTTP detector_id: 40853
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Cossta"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/base/get2.aspx?str="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/base\/get2\.aspx\?str=[a-f0-9]{200,225} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040853; rev:577;)

# Adware: (Game) ArcadeWeb - regex: to_server:GET /.*/getExternalGamesInfo/ticket=[a-zA-Z0-9]+ HTTP/1\.1\r\nUser-Agent:.*\r\nHost:.*\r\n detector_id: 40854
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Game) ArcadeWeb"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/getExternalGamesInfo/ticket="; content:" HTTP/1.1|0D||0A|User-Agent|3A|"; content:"|0D||0A|Host|3A|"; content:"|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\/getExternalGamesInfo\/ticket=[a-zA-Z0-9]+ HTTP\/1\.1\r\nUser-Agent:.*\r\nHost:.*\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040854; rev:1010;)

# Command&Control: (Banker) GenericBanker_26 - regex: to_server:POST /autogmail\.php HTTP.*pass=.*&maq=.*&tmp=\d{2}\.\d{2}\.\d{4}= detector_id: 40879
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_26"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/autogmail.php HTTP"; content:"pass="; content:"&maq="; content:"&tmp="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/autogmail\.php HTTP.*pass=.*&maq=.*&tmp=\d{2}\.\d{2}\.\d{4}=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040879; rev:578;)

# Command&Control: (Trojan) GenericTrojan_135 - regex: to_server:POST /ssget/hier\.php.*User-Agent: Mozilla/3\.0 \(compatible; Indy Library\).*Content-Disposition: form-data; name=" detector_id: 40880
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_135"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ssget/hier.php"; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; content:"Content-Disposition|3A| form-data|3B| name=|22|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ssget\/hier\.php.*User-Agent: Mozilla\/3\.0 \(compatible\; Indy Library\).*Content-Disposition: form-data\; name="/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040880; rev:587;)

# Command&Control: (Trojan) Magania_1 - regex: to_server:GET /Online\.aspx\?act=\d&id=.*&s=\d HTTP.*User-Agent: Google page detector_id: 40881
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Magania_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Online.aspx?act="; content:"&id="; content:"&s="; content:" HTTP"; content:"User-Agent|3A| Google page"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Online\.aspx\?act=\d&id=.*&s=\d HTTP.*User-Agent: Google page/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040881; rev:578;)

# Command&Control: (Trojan) Fareit - regex: to_server:GET .+\.exe HTTP/1\.0.*Accept-Encoding: identity.*User-Agent: Mozilla.*Windows 98\)\r\n\r\n detector_id: 40882
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fareit"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".exe HTTP/1.0"; content:"Accept-Encoding|3A| identity"; content:"User-Agent|3A| Mozilla"; content:"Windows 98|29||0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.+\.exe HTTP\/1\.0.*Accept-Encoding: identity.*User-Agent: Mozilla.*Windows 98\)\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040882; rev:715;)

# Adware: (Downware) Kraddare - regex: to_server:GET /daemon/SetActiveCount_new\.php.*HTTP/1\.1\r\nUser-Agent:  detector_id: 40883
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Kraddare"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/daemon/SetActiveCount_new.php"; content:"HTTP/1.1|0D||0A|User-Agent|3A| "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/daemon\/SetActiveCount_new\.php.*HTTP\/1\.1\r\nUser-Agent: /s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040883; rev:733;)

# Command&Control: (Backdoor) GenericBackdoor_11 - regex: to_server:GET /[a-z]{3}/getip\.asp\?username=.*User-Agent: Mozilla/4\.0 \(compatible\) detector_id: 40898
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) GenericBackdoor_11"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/getip.asp?username="; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{3}\/getip\.asp\?username=.*User-Agent: Mozilla\/4\.0 \(compatible\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040898; rev:579;)

# Command&Control: (Backdoor) Htbot - regex: to_server:GET /[a-z]{4,}\.php\?command=[a-z\d]+&id=\d+&ip=[\d\.]+&port=\d{1,5} HTTP.*User-Agent: pb detector_id: 40899
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Htbot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?command="; content:"&id="; content:"&ip="; content:"&port="; content:" HTTP"; content:"User-Agent|3A| pb"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{4,}\.php\?command=[a-z\d]+&id=\d+&ip=[\d\.]+&port=\d{1,5} HTTP.*User-Agent: pb/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040899; rev:715;)

# Command&Control: (Trojan) GenericTrojan_130 - regex: to_server:GET .*/classes/s\.php\?query=.*Accept: text/\*.*User-Agent: DMFR detector_id: 40937
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_130"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/classes/s.php?query="; content:"Accept|3A| text/|2A|"; content:"User-Agent|3A| DMFR"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/classes\/s\.php\?query=.*Accept: text\/\*.*User-Agent: DMFR/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040937; rev:587;)

# Command&Control: (Trojan) Opachki - regex: to_server:POST /z\.php\?ch=\d HTTP.*ch=\d&php= detector_id: 40938
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Opachki"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/z.php?ch="; content:" HTTP"; content:"ch="; content:"&php="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/z\.php\?ch=\d HTTP.*ch=\d&php=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040938; rev:580;)

# Command&Control: (Dropper) GenericDropper_111 - regex: to_server:GET /wp/(strip|toot)\.php\?good=\d{9} HTTP.*User-Agent: Mozilla/3\.0 \(compatible; Indy Library\) detector_id: 41055
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_111"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/wp/"; content:".php?good="; content:" HTTP"; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/wp\/(strip|toot)\.php\?good=\d{9} HTTP.*User-Agent: Mozilla\/3\.0 \(compatible\; Indy Library\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041055; rev:583;)

# FakeAV: FakeScanti - regex: to_server:GET /ps\.php\?a=\d+ HTTP.*User-Agent: mozilla/2\.0 detector_id: 41056
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeScanti"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ps.php?a="; content:" HTTP"; content:"User-Agent|3A| mozilla/2.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ps\.php\?a=\d+ HTTP.*User-Agent: mozilla\/2\.0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041056; rev:583;)

# Command&Control: (Trojan) Tarcloin - regex: to_server:GET /in/open\?hwid=[a-f0-9]{7,8}&s=\d{2,3} HTTP detector_id: 41061
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Tarcloin"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/in/open?hwid="; content:"&s="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/in\/open\?hwid=[a-f0-9]{7,8}&s=\d{2,3} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041061; rev:584;)

# Command&Control: (Trojan) Diofopi - regex: to_server:POST /.*\.asp\?imageid=.*&type=\d&resid=\d{6}&nmsg=.*User-Agent: iexplorer detector_id: 41179
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Diofopi"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".asp?imageid="; content:"&type="; content:"&resid="; content:"&nmsg="; content:"User-Agent|3A| iexplorer"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\.asp\?imageid=.*&type=\d&resid=\d{6}&nmsg=.*User-Agent: iexplorer/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041179; rev:585;)

# Command&Control: (Trojan) Ramnit - regex: to_server:GET /mrow\d+/\?id\d{5,} HTTP detector_id: 41186
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ramnit"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mrow"; content:"/?id"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mrow\d+\/\?id\d{5,} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041186; rev:1412;)

# Command&Control: (Banker) Banload - regex: to_server:POST .*/contador\.php HTTP/1\.0.*User-Agent: Mozilla/4\.0 \(compatible; ICS\).*Content-Disposition: form-data; name=" detector_id: 41239
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Banload"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/contador.php HTTP/1.0"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| ICS|29|"; content:"Content-Disposition|3A| form-data|3B| name=|22|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/contador\.php HTTP\/1\.0.*User-Agent: Mozilla\/4\.0 \(compatible\; ICS\).*Content-Disposition: form-data\; name="/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041239; rev:587;)

# Command&Control: (Dropper) GenericDropper_109 - regex: to_server:GET /index\.php\?cmd=\d&u=.*&c=.*&pc=.*&os=.*&rm=\d{2,5} HTTP detector_id: 41300
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_109"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?cmd="; content:"&u="; content:"&c="; content:"&pc="; content:"&os="; content:"&rm="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\?cmd=\d&u=.*&c=.*&pc=.*&os=.*&rm=\d{2,5} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041300; rev:590;)

# Command&Control: (Backdoor) Beksnoc - regex: to_server:POST /[a-z]*/query\.php HTTP.*q=[A-F0-9]{16} detector_id: 41301
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Beksnoc"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/query.php HTTP"; content:"q="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]*\/query\.php HTTP.*q=[A-F0-9]{16}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041301; rev:590;)

# Command&Control: (Trojan) Simda - regex: to_server:GET /chrome/report\.html\?[a-zA-Z0-9]{4,7}=V[a-z]{0,2}%\d.*Host: [\d\.]{7,15} detector_id: 41338
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Simda"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/chrome/report.html?"; content:"=V"; content:"Host|3A| "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/chrome\/report\.html\?[a-zA-Z0-9]{4,7}=V[a-z]{0,2}%\d.*Host: [\d\.]{7,15}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041338; rev:625;)

# Command&Control: (Trojan) BlackEnergy - regex: to_server:POST .*/user\.php HTTP.*id=x.*_[A-F0-9]{8}&build_id=[A-Z0-9]+ detector_id: 41339
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) BlackEnergy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/user.php HTTP"; content:"id=x"; content:"&build_id="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/user\.php HTTP.*id=x.*_[A-F0-9]{8}&build_id=[A-Z0-9]+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041339; rev:591;)

# Command&Control: (Dropper) Witthy - regex: to_server:POST .*/logon\.php HTTP.*User-Agent: Asynchronous WinHTTP/1\.0.*CyoK detector_id: 41340
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Witthy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/logon.php HTTP"; content:"User-Agent|3A| Asynchronous WinHTTP/1.0"; content:"CyoK"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/logon\.php HTTP.*User-Agent: Asynchronous WinHTTP\/1\.0.*CyoK/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041340; rev:591;)

# Command&Control: (Trojan) Sfuzuan - regex: to_server:GET /ux/getip\.aspx\?localip=[\d\.]{7,15}&ip=[\d\.]{7,15}&addr=.*User-Agent: IEDLL detector_id: 41366
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sfuzuan"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ux/getip.aspx?localip="; content:"&ip="; content:"&addr="; content:"User-Agent|3A| IEDLL"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ux\/getip\.aspx\?localip=[\d\.]{7,15}&ip=[\d\.]{7,15}&addr=.*User-Agent: IEDLL/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041366; rev:593;)

# Command&Control: (Backdoor) Bdaejec - regex: to_server:GET /jpg/api\.php\?ID=[a-z]{2,5}\d&fn=.*_[\d\-]{17}&Var=[A-Z0-9]+ HTTP detector_id: 41367
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Bdaejec"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/jpg/api.php?ID="; content:"&fn="; content:"&Var="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/jpg\/api\.php\?ID=[a-z]{2,5}\d&fn=.*_[\d\-]{17}&Var=[A-Z0-9]+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041367; rev:593;)

# Command&Control: (Banker) GenericBanker_27 - regex: to_server:POST /.*User-Agent: Mozilla/3\.0 \(compatible; Indy Library\).*op=.*&nmpc=.*&wind=.*&datacadastro=\d{4}.*&nmplg= detector_id: 41368
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_27"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; content:"op="; content:"&nmpc="; content:"&wind="; content:"&datacadastro="; content:"&nmplg="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*User-Agent: Mozilla\/3\.0 \(compatible\; Indy Library\).*op=.*&nmpc=.*&wind=.*&datacadastro=\d{4}.*&nmplg=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041368; rev:593;)

# Command&Control: (Banker) Banload - regex: to_server:POST .*/infec\.php HTTP.*tipo=.*&tip=.*&cli=.*&inf= detector_id: 41398
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Banload"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/infec.php HTTP"; content:"tipo="; content:"&tip="; content:"&cli="; content:"&inf="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/infec\.php HTTP.*tipo=.*&tip=.*&cli=.*&inf=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041398; rev:597;)

# Command&Control: (Trojan) Kovter - regex: to_server:POST /form\d*\.php HTTP.*Cache-Control: no-cache.*\r\n\r\n(RcpTfd|QUVAAxCL) detector_id: 41399
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Kovter"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/form"; content:".php HTTP"; content:"Cache-Control|3A| no-cache"; content:"|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/form\d*\.php HTTP.*Cache-Control: no-cache.*\r\n\r\n(RcpTfd|QUVAAxCL)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041399; rev:788;)

# Command&Control: (Trojan) GenericTrojan_83 - regex: to_server:GET .*/.*\.asp\?hostid=[A-F0-9]{8}&hostname=.*&hostip=.*&filename=\d{4}\-\d\-\d\-\d{2}\-\d{2}\.dll&filestart=\d{0,1}&filetext=begin:: detector_id: 41401
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_83"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".asp?hostid="; content:"&hostname="; content:"&hostip="; content:"&filename="; content:".dll&filestart="; content:"&filetext=begin|3A||3A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/.*\.asp\?hostid=[A-F0-9]{8}&hostname=.*&hostip=.*&filename=\d{4}\-\d\-\d\-\d{2}\-\d{2}\.dll&filestart=\d{0,1}&filetext=begin::/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041401; rev:733;)

# Command&Control: (Clickbot) Hatigh - regex: to_server:POST /rd/rep\d{0,2}\.php HTTP.*er\[0\]= detector_id: 41408
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Clickbot) Hatigh"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/rd/rep"; content:".php HTTP"; content:"er|5B|0|5D|="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/rd\/rep\d{0,2}\.php HTTP.*er\[0\]=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041408; rev:598;)

# Command&Control: (Backdoor) Dreamy - regex: to_server:GET .*/knock\.php\?win=.*&id=[A-Z0-9]+&lip=[\d\.]{7,15}&s5=\d+ HTTP detector_id: 41409
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Dreamy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/knock.php?win="; content:"&id="; content:"&lip="; content:"&s5="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/knock\.php\?win=.*&id=[A-Z0-9]+&lip=[\d\.]{7,15}&s5=\d+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041409; rev:598;)

# FakeAV: FakeCog - regex: to_server:GET /readdatagateway\.php\?type=stats&affid=\d+&subid=\d+&adwareok detector_id: 41547
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: FakeCog"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/readdatagateway.php?type=stats&affid="; content:"&subid="; content:"&adwareok"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/readdatagateway\.php\?type=stats&affid=\d+&subid=\d+&adwareok/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041547; rev:604;)

# Command&Control: (Trojan) GenericTrojan_136 - regex: to_server:GET /chkld32\.asp\?ci=[A-Z0-9]{16} HTTP.*User-Agent: VBUsers detector_id: 41548
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_136"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/chkld32.asp?ci="; content:" HTTP"; content:"User-Agent|3A| VBUsers"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/chkld32\.asp\?ci=[A-Z0-9]{16} HTTP.*User-Agent: VBUsers/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041548; rev:604;)

# Adware: (Adware) Kraddare Werpingad - regex: to_server:GET /partner/c\.php\?m=.*&mac=[A-F0-9]{12}&f=.*\.exe HTTP detector_id: 41588
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Kraddare Werpingad"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/partner/c.php?m="; content:"&mac="; content:"&f="; content:".exe HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/partner\/c\.php\?m=.*&mac=[A-F0-9]{12}&f=.*\.exe HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041588; rev:606;)

# Command&Control: (Dropper) Obitel - regex: to_server:GET .*/gate\.php\?id=[a-f0-9]{8} HTTP.*User-Agent: ie detector_id: 41589
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Obitel"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/gate.php?id="; content:" HTTP"; content:"User-Agent|3A| ie"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/gate\.php\?id=[a-f0-9]{8} HTTP.*User-Agent: ie/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041589; rev:606;)

# Command&Control: (Dropper) Nuwar - regex: to_server:GET .*/ab\.php\?name=.*_.*_.*&\d{4} HTTP detector_id: 41664
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Nuwar"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ab.php?name="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/ab\.php\?name=.*_.*_.*&\d{4} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041664; rev:612;)

# Command&Control: (Trojan) Rhubot - regex: to_server:GET /index\.php\?bot=[a-z]{15}&botkey=.*&os=.*&ram=\d+&user=.*&cpu=\d detector_id: 41669
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Rhubot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?bot="; content:"&botkey="; content:"&os="; content:"&ram="; content:"&user="; content:"&cpu="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\?bot=[a-z]{15}&botkey=.*&os=.*&ram=\d+&user=.*&cpu=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041669; rev:612;)

# Command&Control: (Backdoor) Htbot - regex: to_server:GET /[a-z]{4,}\.php\?command=(getip|getid|getbackconnect) HTTP.*User-Agent: pb detector_id: 41670
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Htbot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?command="; content:" HTTP"; content:"User-Agent|3A| pb"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{4,}\.php\?command=(getip|getid|getbackconnect) HTTP.*User-Agent: pb/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041670; rev:718;)

# Command&Control: (Trojan) Qadars - regex: to_server:GET /(infor|info)\.php\?uid=.*&process=.*&pid=\d+&level=\d&error=\d&status=\d+&time=\d+&message=\d+&counter=[\d\.]+&left=\d&data= detector_id: 41676
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Qadars"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?uid="; content:"&process="; content:"&pid="; content:"&level="; content:"&error="; content:"&status="; content:"&time="; content:"&message="; content:"&counter="; content:"&left="; content:"&data="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(infor|info)\.php\?uid=.*&process=.*&pid=\d+&level=\d&error=\d&status=\d+&time=\d+&message=\d+&counter=[\d\.]+&left=\d&data=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041676; rev:641;)

# Command&Control: (Trojan) Hider - regex: to_server:GET /1001/main\.php\?id=[a-z0-9]+ HTTP.*User-Agent: PRIVATE detector_id: 41678
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Hider"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/1001/main.php?id="; content:" HTTP"; content:"User-Agent|3A| PRIVATE"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/1001\/main\.php\?id=[a-z0-9]+ HTTP.*User-Agent: PRIVATE/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041678; rev:613;)

# Command&Control: (Trojan) Comfoo - regex: to_server:GET /[a-zA-Z0-9]{9,13}/[a-zA-Z0-9]+[0-9]{3,5}/[0-9]{2,6}/[a-zA-Z0-9]{10,14}/[0-9A-Za-z]{15,19}/ HTTP/1\.1 detector_id: 41696
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Comfoo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ HTTP/1.1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-zA-Z0-9]{9,13}\/[a-zA-Z0-9]+[0-9]{3,5}\/[0-9]{2,6}\/[a-zA-Z0-9]{10,14}\/[0-9A-Za-z]{15,19}\/ HTTP\/1\.1/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041696; rev:733;)

# Command&Control: (Trojan) GenericTrojan_137 - regex: to_server:POST .*/connectff\.php.*User-Agent: Mozila/1\.0.*mode=\d&user= detector_id: 41697
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_137"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/connectff.php"; content:"User-Agent|3A| Mozila/1.0"; content:"mode="; content:"&user="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/connectff\.php.*User-Agent: Mozila\/1\.0.*mode=\d&user=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041697; rev:614;)

# Command&Control: (Trojan) Qhosts_1 - regex: to_server:GET .*/gLoad\.php\?act=.*&pref=.*User-Agent: Mozilla/3\.0 \(compatible; Indy Library\) detector_id: 41698
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Qhosts_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/gLoad.php?act="; content:"&pref="; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/gLoad\.php\?act=.*&pref=.*User-Agent: Mozilla\/3\.0 \(compatible\; Indy Library\)/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041698; rev:614;)

# Command&Control: (Trojan) Cryptolocker - regex: to_server:POST /home/ HTTP/1\.1.*[\x80-\xff]{5} detector_id: 41768
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Cryptolocker"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/home/ HTTP/1.1"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/home\/ HTTP\/1\.1.*[\x80-\xff]{5}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041768; rev:1010;)

# Command&Control: (Banker) Banbra_1 - regex: to_server:GET .*/index\.php\?nomepc=.*&osName=.*&polimo= detector_id: 41769
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Banbra_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?nomepc="; content:"&osName="; content:"&polimo="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/index\.php\?nomepc=.*&osName=.*&polimo=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041769; rev:618;)

# Adware: (Software Bundler) Lollipop - regex: to_server:POST /(bin|com)/(check|user)\.php\?cv=1 HTTP detector_id: 41770
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Software Bundler) Lollipop"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php?cv=1 HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(bin|com)\/(check|user)\.php\?cv=1 HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041770; rev:618;)

# Command&Control: (Trojan) GenericTrojan_138 - regex: to_server:GET /log\.php\?log=&win=-{1,4}[A-Z]{1} detector_id: 41853
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_138"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/log.php?log=&win="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/log\.php\?log=&win=-{1,4}[A-Z]{1}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041853; rev:619;)

# Command&Control: (Dropper) Asune - regex: to_server:GET .*/get\.php\?\d{7}&M=0 detector_id: 41854
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Asune"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get.php?"; content:"&M=0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/get\.php\?\d{7}&M=0/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041854; rev:619;)

# Command&Control: (Trojan) Mirage - regex: to_server:POST http:\/\/.*result(\?|%3F)hl(=|%3D)[a-z]{2}(&|%26)meta(=|%3D)[a-z]+.*HTTP.*Mjtdkj detector_id: 41962
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Mirage"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"http|3A|//"; content:"result"; content:"hl"; content:"meta"; content:"HTTP"; content:"Mjtdkj"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?http:\/\/.*result(\?|%3F)hl(=|%3D)[a-z]{2}(&|%26)meta(=|%3D)[a-z]+.*HTTP.*Mjtdkj/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041962; rev:873;)

# Command&Control: (Trojan) GenericTrojan_139 - regex: to_server:POST /stone\.php HTTP.*User-Agent: Mozilla/981\.0 \(compatible; Arachmo\) detector_id: 41963
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_139"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/stone.php HTTP"; content:"User-Agent|3A| Mozilla/981.0 |28|compatible|3B| Arachmo|29|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/stone\.php HTTP.*User-Agent: Mozilla\/981\.0 \(compatible\; Arachmo\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041963; rev:623;)

# Adware: (Adware) GenericAdware_13 Cpush - regex: to_server:GET /cpush/version\.txt\?version=\d.*&uid=[A-F0-9\-]{36} detector_id: 41992
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) GenericAdware_13 Cpush"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cpush/version.txt?version="; content:"&uid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cpush\/version\.txt\?version=\d.*&uid=[A-F0-9\-]{36}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041992; rev:625;)

# FakeAV: WinFixer - regex: to_server:GET /captcha/index\.php\?d=.*&pg=.*User-Agent: WinSoftware NetInstaller detector_id: 42019
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: WinFixer"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/captcha/index.php?d="; content:"&pg="; content:"User-Agent|3A| WinSoftware NetInstaller"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/captcha\/index\.php\?d=.*&pg=.*User-Agent: WinSoftware NetInstaller/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042019; rev:627;)

# Command&Control: (Trojan) Whirep  - regex: to_server:GET /rep\.php\?uid=\d{10}&aid=[a-f0-9]{32} HTTP.*User-Agent: wget 3\.0 detector_id: 42046
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Whirep "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/rep.php?uid="; content:"&aid="; content:" HTTP"; content:"User-Agent|3A| wget 3.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/rep\.php\?uid=\d{10}&aid=[a-f0-9]{32} HTTP.*User-Agent: wget 3\.0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042046; rev:629;)

# Command&Control: (Trojan) GenericTrojan_140 - regex: to_server:GET /test/gate\.php\?mode=\d&UID=\{[A-F0-9\-]{35,37}\} detector_id: 42059
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_140"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/test/gate.php?mode="; content:"&UID=|7B|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/test\/gate\.php\?mode=\d&UID=\{[A-F0-9\-]{35,37}\}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042059; rev:633;)

# Command&Control: (Trojan) Qadars - regex: to_server:GET /informs\.php\?ver=\d\.\d\.\d\.\d\.[A-Z0-9]{2}&uid=.*&process=.*&pid=\d+&level=\d detector_id: 42060
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Qadars"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/informs.php?ver="; content:"&uid="; content:"&process="; content:"&pid="; content:"&level="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/informs\.php\?ver=\d\.\d\.\d\.\d\.[A-Z0-9]{2}&uid=.*&process=.*&pid=\d+&level=\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042060; rev:633;)

# Adware: (Adware) Kraddare - regex: to_server:GET /log\.webe\?type=.&mac=[A-F0-9]{12}&dist=\d+&ov=.*&adn=\d+&ver=\d{4} detector_id: 42065
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Kraddare"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/log.webe?type="; content:"&mac="; content:"&dist="; content:"&ov="; content:"&adn="; content:"&ver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/log\.webe\?type=.&mac=[A-F0-9]{12}&dist=\d+&ov=.*&adn=\d+&ver=\d{4}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042065; rev:634;)

# Command&Control: (Trojan) GenericTrojan_141 - regex: to_server:GET .*/dog\.php\?zbc=\d&host=.*&os=\d\.\d&v=\d\.\d HTTP detector_id: 42072
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_141"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/dog.php?zbc="; content:"&host="; content:"&os="; content:"&v="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/dog\.php\?zbc=\d&host=.*&os=\d\.\d&v=\d\.\d HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042072; rev:634;)

# FakeAV: KoreanFakeAV - regex: to_server:GET /maqa\.php\?alks1=.*&iew2=[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2} detector_id: 42085
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: KoreanFakeAV"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/maqa.php?alks1="; content:"&iew2="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/maqa\.php\?alks1=.*&iew2=[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042085; rev:635;)

# FakeAV: KoreanFakeAV - regex: to_server:GET /vqer\.php\?dsfID=.*&lkrPC=.*&sdriMode=setup&sdrqSite=.*&strOs= detector_id: 42086
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: KoreanFakeAV"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/vqer.php?dsfID="; content:"&lkrPC="; content:"&sdriMode=setup&sdrqSite="; content:"&strOs="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/vqer\.php\?dsfID=.*&lkrPC=.*&sdriMode=setup&sdrqSite=.*&strOs=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042086; rev:635;)

# Command&Control: (Trojan) GenericTrojan_79 - regex: to_server:POST .*/si\.php\?(get&slist&comp=|comp=).*User-Agent: odin detector_id: 42123
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_79"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/si.php?"; content:"User-Agent|3A| odin"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/si\.php\?(get&slist&comp=|comp=).*User-Agent: odin/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042123; rev:643;)

# Command&Control: (Trojan) GenericTrojan_142 - regex: to_server:GET .*/register\.php\?mode=\d&ver=.&comname=.*&ip=[\d\.]*&os=.*&fault=\d HTTP detector_id: 42138
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_142"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/register.php?mode="; content:"&ver="; content:"&comname="; content:"&ip="; content:"&os="; content:"&fault="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/register\.php\?mode=\d&ver=.&comname=.*&ip=[\d\.]*&os=.*&fault=\d HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042138; rev:641;)

# FakeAV: KoreanFakeAV - regex: to_server:GET /mdjs\.php\?qw1=.*&rioue2=[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2} detector_id: 42139
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: KoreanFakeAV"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mdjs.php?qw1="; content:"&rioue2="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mdjs\.php\?qw1=.*&rioue2=[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}:[A-F0-9]{2}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042139; rev:641;)

# Command&Control: (Trojan) GenericTrojan_143 - regex: to_server:POST /[a-z]{3,8}\.php HTTP.*tit=[A-Z]{4}&cont=.*&val=.*&typ=\d detector_id: 42154
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_143"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"tit="; content:"&cont="; content:"&val="; content:"&typ="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{3,8}\.php HTTP.*tit=[A-Z]{4}&cont=.*&val=.*&typ=\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042154; rev:641;)

# FakeAV: KoreanFakeAV - regex: to_server:GET /vajsd\.php\?sdfID=.*&eoiruPC=.*&sdlzMode=.*&qeiorSite= detector_id: 42165
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: KoreanFakeAV"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/vajsd.php?sdfID="; content:"&eoiruPC="; content:"&sdlzMode="; content:"&qeiorSite="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/vajsd\.php\?sdfID=.*&eoiruPC=.*&sdlzMode=.*&qeiorSite=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042165; rev:642;)

# Command&Control: (Dropper) CWS - regex: to_server:GET /affiliate/interface\.php\?userid=\d{4,6}&program=\d&variable=try detector_id: 42187
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) CWS"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/affiliate/interface.php?userid="; content:"&program="; content:"&variable=try"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/affiliate\/interface\.php\?userid=\d{4,6}&program=\d&variable=try/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042187; rev:644;)

# OpenBDS test: OpenBDS sensor rule test - regex: to_server:GET /test_OpenBDS_ids HTTP/.\.. detector_id: 42559
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS OpenBDS test: OpenBDS sensor rule test"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/test_OpenBDS_ids HTTP/"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/test_OpenBDS_ids HTTP\/.\../"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042559; rev:648;)

# Command&Control: (Trojan) GenericTrojan_11 - regex: to_server:GET /forum/search\.php\?email=.*&method=post HTTP detector_id: 42583
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_11"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/forum/search.php?email="; content:"&method=post HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/forum\/search\.php\?email=.*&method=post HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042583; rev:650;)

# Adware: (Downware) InstallMate - regex: to_server:GET /\?step_id=.*&installer_id=.*&publisher_id=.*&source_id=\d+&page_id=\d+&affiliate_id=\d+&country_code=.*&locale= detector_id: 42587
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) InstallMate"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?step_id="; content:"&installer_id="; content:"&publisher_id="; content:"&source_id="; content:"&page_id="; content:"&affiliate_id="; content:"&country_code="; content:"&locale="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?step_id=.*&installer_id=.*&publisher_id=.*&source_id=\d+&page_id=\d+&affiliate_id=\d+&country_code=.*&locale=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042587; rev:650;)

# Adware: (Adware) DomaIQ - regex: to_server:GET /debug/Version/\d+(_\d+)*/Nsis/[A-Za-z]+ HTTP detector_id: 42588
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) DomaIQ"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/debug/Version/"; content:"/Nsis/"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/debug\/Version\/\d+(_\d+)*\/Nsis\/[A-Za-z]+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042588; rev:650;)

# Adware: (Downware) Solimba - regex: to_server:GET /installer/[a-f0-9]{8}(-[a-f0-9]{4}){3}-[a-f0-9]{12}/\d+/config HTTP detector_id: 42608
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Solimba"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/installer/"; content:"/config HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/installer\/[a-f0-9]{8}(-[a-f0-9]{4}){3}-[a-f0-9]{12}\/\d+\/config HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042608; rev:709;)

# Command&Control: (Trojan) Vundo - regex: to_server:GET /\d{2,4}/\d{2,4}\.html HTTP.*From: \d{10,}\x0d\x0aVia: [a-z]{5} detector_id: 42613
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Vundo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".html HTTP"; content:"From|3A| "; content:"|0D||0A|Via|3A| "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d{2,4}\/\d{2,4}\.html HTTP.*From: \d{10,}\x0d\x0aVia: [a-z]{5}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042613; rev:653;)

# Adware: (Adware) LoadMoney - regex: to_server:GET /get_xml\?file_id=\d+&did=\d+(&hsig=[a-f0-9]+)? HTTP.*User-Agent: tiny-dl/nix detector_id: 42637
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) LoadMoney"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get_xml?file_id="; content:"&did="; content:" HTTP"; content:"User-Agent|3A| tiny-dl/nix"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get_xml\?file_id=\d+&did=\d+(&hsig=[a-f0-9]+)? HTTP.*User-Agent: tiny-dl\/nix/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042637; rev:668;)

# Command&Control: (Trojan) GenericBanker_28 - regex: to_server:POST .*/b\.php HTTP.*tt=.*&ct=.*&tp=.*& detector_id: 43451
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericBanker_28"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/b.php HTTP"; content:"tt="; content:"&ct="; content:"&tp="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/b\.php HTTP.*tt=.*&ct=.*&tp=.*&/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043451; rev:658;)

# FakeAV: KoreanFakeAV - regex: to_server:GET /vsdre\.php\?lkjID=.*&riePC=.*&qwaMode=.*&lzxSite=.*&strOs= detector_id: 43452
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: KoreanFakeAV"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/vsdre.php?lkjID="; content:"&riePC="; content:"&qwaMode="; content:"&lzxSite="; content:"&strOs="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/vsdre\.php\?lkjID=.*&riePC=.*&qwaMode=.*&lzxSite=.*&strOs=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043452; rev:658;)

# FakeAV: KoreanFakeAV - regex: to_server:GET /mancsd\.php\?xcv1=.*&erkl2=\d{2}: detector_id: 43469
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: KoreanFakeAV"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mancsd.php?xcv1="; content:"&erkl2="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mancsd\.php\?xcv1=.*&erkl2=\d{2}:/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043469; rev:659;)

# Adware: (Adware) LoadMoney - regex: to_server:GET /get_download_xml(_\d)\?id=\d+&did=\d+(&hsig=[a-f0-9]+)? HTTP.*User-Agent: tiny-dl/nix detector_id: 43639
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) LoadMoney"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get_download_xml"; content:"?id="; content:"&did="; content:" HTTP"; content:"User-Agent|3A| tiny-dl/nix"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get_download_xml(_\d)\?id=\d+&did=\d+(&hsig=[a-f0-9]+)? HTTP.*User-Agent: tiny-dl\/nix/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043639; rev:668;)

# Command&Control: (Trojan) GenericTrojan_79 - regex: to_server:POST /[a-z]+/si\.php\?reg&ver=[\d\.]+&comp=\S+&addinfo=.*User-Agent: odin detector_id: 43641
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_79"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/si.php?reg&ver="; content:"&comp="; content:"&addinfo="; content:"User-Agent|3A| odin"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]+\/si\.php\?reg&ver=[\d\.]+&comp=\S+&addinfo=.*User-Agent: odin/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043641; rev:668;)

# Command&Control: (Trojan) GenericTrojan_79 - regex: to_server:POST /[a-z]+/si\.php\?get&(download|version)&comp=\S+ HTTP.*User-Agent: odin detector_id: 43642
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_79"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/si.php?get&"; content:"&comp="; content:" HTTP"; content:"User-Agent|3A| odin"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]+\/si\.php\?get&(download|version)&comp=\S+ HTTP.*User-Agent: odin/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043642; rev:668;)

# Command&Control: (Trojan) GenericTrojan_79 - regex: to_server:GET /[a-z]+/si\.php\?get&news_slist&comp=\S+ HTTP.*User-Agent: odin detector_id: 43643
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_79"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/si.php?get&news_slist&comp="; content:" HTTP"; content:"User-Agent|3A| odin"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]+\/si\.php\?get&news_slist&comp=\S+ HTTP.*User-Agent: odin/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043643; rev:668;)

# Adware: (Adware) DuDu - regex: to_server:GET ///ddd/oembtrun\.html\?oemid=[a-f0-9\-]{36}&start_extract=1 HTTP detector_id: 43645
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) DuDu"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"///ddd/oembtrun.html?oemid="; content:"&start_extract=1 HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\/\/ddd\/oembtrun\.html\?oemid=[a-f0-9\-]{36}&start_extract=1 HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043645; rev:668;)

# Adware: (Adware) DuDu - regex: to_server:GET /ddd/oembtrun\.html\?&vendor=badfile&ddd_ret_code=\d+&bt_ret_code=\d+&end_extract=1 HTTP detector_id: 43646
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) DuDu"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ddd/oembtrun.html?&vendor=badfile&ddd_ret_code="; content:"&bt_ret_code="; content:"&end_extract=1 HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ddd\/oembtrun\.html\?&vendor=badfile&ddd_ret_code=\d+&bt_ret_code=\d+&end_extract=1 HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043646; rev:668;)

# Command&Control: (Backdoor) Mokes - regex: to_server:POST /bot/index\.php HTTP.*User-Agent: Mozilla/4\.0\x0d\x0a.*[a-zA-Z\d]{3}AAA[A-C][a-zA-Z\d/\+]{10,}={0,2}\x0d\x0a detector_id: 43647
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Mokes"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/bot/index.php HTTP"; content:"User-Agent|3A| Mozilla/4.0|0D||0A|"; content:"AAA"; content:"|0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bot\/index\.php HTTP.*User-Agent: Mozilla\/4\.0\x0d\x0a.*[a-zA-Z\d]{3}AAA[A-C][a-zA-Z\d\/\+]{10,}={0,2}\x0d\x0a/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043647; rev:681;)

# Command&Control: (Trojan) GenericTrojan_79 - regex: to_server:POST /[a-z]+/si\.php\?cstorage=(ddos|search|shell)&comp=\S+ HTTP.*User-Agent: odin detector_id: 43648
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_79"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/si.php?cstorage="; content:"&comp="; content:" HTTP"; content:"User-Agent|3A| odin"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]+\/si\.php\?cstorage=(ddos|search|shell)&comp=\S+ HTTP.*User-Agent: odin/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043648; rev:668;)

# Command&Control: (Trojan) GenericTrojan_144 - regex: to_server:GET /get\.php\?name=[a-f\d]{8}&os=XP&xxx=x(32|64)&res2=\w* HTTP detector_id: 43649
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_144"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get.php?name="; content:"&os=XP&xxx=x"; content:"&res2="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get\.php\?name=[a-f\d]{8}&os=XP&xxx=x(32|64)&res2=\w* HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043649; rev:668;)

# Command&Control: (Trojan) ZBot - regex: to_server:POST /[a-z/]*config/index\.php HTTP.*on\x99.*[\x00-\x1f\x80-\xff]{3} detector_id: 43650
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"config/index.php HTTP"; content:"on|99|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z\/]*config\/index\.php HTTP.*on\x99.*[\x00-\x1f\x80-\xff]{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043650; rev:668;)

# Adware: (Adware) LoadMoney - regex: to_server:GET /get_xml\?stb=\d+&did=\d+&file_id=\d+ HTTP.*User-Agent: tiny-dl/nix detector_id: 43651
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) LoadMoney"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get_xml?stb="; content:"&did="; content:"&file_id="; content:" HTTP"; content:"User-Agent|3A| tiny-dl/nix"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get_xml\?stb=\d+&did=\d+&file_id=\d+ HTTP.*User-Agent: tiny-dl\/nix/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043651; rev:668;)

# Adware: (Adware) LoadMoney - regex: to_server:GET /get_xml\?did=\d+&file_id=\d+(&hsig=[a-f0-9]+)? HTTP.*User-Agent: Downloader detector_id: 43652
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) LoadMoney"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get_xml?did="; content:"&file_id="; content:" HTTP"; content:"User-Agent|3A| Downloader"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get_xml\?did=\d+&file_id=\d+(&hsig=[a-f0-9]+)? HTTP.*User-Agent: Downloader/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043652; rev:668;)

# Command&Control: (Trojan) GenericTrojan_145 - regex: to_server:POST [a-z\d/]+\.php HTTP.*m=CA==&h=[a-zA-Z\d]+={0,2}&p=[a-zA-Z\d]+={0,2}&v=[a-zA-Z\d]+={0,2}&s=[a-zA-Z\d]+={0,2} detector_id: 43653
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_145"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"m=CA==&h="; content:"&p="; content:"&v="; content:"&s="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?[a-z\d\/]+\.php HTTP.*m=CA==&h=[a-zA-Z\d]+={0,2}&p=[a-zA-Z\d]+={0,2}&v=[a-zA-Z\d]+={0,2}&s=[a-zA-Z\d]+={0,2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043653; rev:668;)

# Command&Control: (Dropper) GenericDropper_112 - regex: to_server:GET /ie[a-z]\d{4,}\.exe\?&t=\d{10,} HTTP.*Accept: image detector_id: 43654
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_112"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ie"; content:".exe?&t="; content:" HTTP"; content:"Accept|3A| image"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ie[a-z]\d{4,}\.exe\?&t=\d{10,} HTTP.*Accept: image/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043654; rev:668;)

# Command&Control: (Dropper) GenericDropper_112 - regex: to_server:GET /VV94\.exe\?&t=\d{10,} HTTP.*Accept: image detector_id: 43655
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_112"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/VV94.exe?&t="; content:" HTTP"; content:"Accept|3A| image"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/VV94\.exe\?&t=\d{10,} HTTP.*Accept: image/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043655; rev:668;)

# Command&Control: (Dropper) GenericDropper_112 - regex: to_server:GET /IEP_\d{6,}\.exe\?&t=\d{10,} HTTP.*Accept: image detector_id: 43656
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_112"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/IEP_"; content:".exe?&t="; content:" HTTP"; content:"Accept|3A| image"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/IEP_\d{6,}\.exe\?&t=\d{10,} HTTP.*Accept: image/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043656; rev:668;)

# Command&Control: (Banker) GenericBanker_29 - regex: to_server:POST /[a-z/]*ubm\.php HTTP.*User-Agent: Mozilla/3\.0 \(compatible; Indy Library\).*tipe=2&sobre=entrou detector_id: 43657
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_29"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"ubm.php HTTP"; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; content:"tipe=2&sobre=entrou"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z\/]*ubm\.php HTTP.*User-Agent: Mozilla\/3\.0 \(compatible\; Indy Library\).*tipe=2&sobre=entrou/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043657; rev:668;)

# Command&Control: (Worm) Autorun - regex: to_server:GET /priv\d/bots\.php\?name=\w*&so=[\d\.]+ HTTP.*User-Agent: vb wininet detector_id: 43658
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Autorun"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/priv"; content:"/bots.php?name="; content:"&so="; content:" HTTP"; content:"User-Agent|3A| vb wininet"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/priv\d\/bots\.php\?name=\w*&so=[\d\.]+ HTTP.*User-Agent: vb wininet/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043658; rev:668;)

# Command&Control: (Trojan) Sharik - regex: to_server:GET /gate\.php\?client_id=[a-f\d]{8}&connected=\d&server_port=\d+&debug=\d HTTP detector_id: 43659
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sharik"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/gate.php?client_id="; content:"&connected="; content:"&server_port="; content:"&debug="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/gate\.php\?client_id=[a-f\d]{8}&connected=\d&server_port=\d+&debug=\d HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043659; rev:668;)

# Command&Control: (Trojan) GenericTrojan_145 - regex: to_server:POST [a-z\d/]+\.php HTTP.*m=CQ==&h=[a-zA-Z\d]+={0,2} detector_id: 43660
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_145"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"m=CQ==&h="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?[a-z\d\/]+\.php HTTP.*m=CQ==&h=[a-zA-Z\d]+={0,2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043660; rev:668;)

# Command&Control: (Trojan) Sality - regex: to_server:GET /sobakavolos\.gif\?[a-f\d]{4,6}=\d{6,} HTTP detector_id: 43661
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sality"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/sobakavolos.gif?"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/sobakavolos\.gif\?[a-f\d]{4,6}=\d{6,} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043661; rev:718;)

# Command&Control: (Keylogger) SniperSpy - regex: to_server:POST /webapi/uploadxml\.php HTTP.*form-data;.*userid.*username.*computername.*pcusername.*macaddress.*pcserverid detector_id: 43721
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Keylogger) SniperSpy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/webapi/uploadxml.php HTTP"; content:"form-data|3B|"; content:"userid"; content:"username"; content:"computername"; content:"pcusername"; content:"macaddress"; content:"pcserverid"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/webapi\/uploadxml\.php HTTP.*form-data\;.*userid.*username.*computername.*pcusername.*macaddress.*pcserverid/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043721; rev:670;)

# Command&Control: (Trojan) GenericTrojan_146 - regex: to_server:POST /[a-z/]*count\.asp HTTP.*User-Agent: MyApp.*Mac=[a-fA-F\w\-]{17}&Os=\S+&Ver= detector_id: 43722
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_146"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"count.asp HTTP"; content:"User-Agent|3A| MyApp"; content:"Mac="; content:"&Os="; content:"&Ver="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z\/]*count\.asp HTTP.*User-Agent: MyApp.*Mac=[a-fA-F\w\-]{17}&Os=\S+&Ver=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043722; rev:670;)

# Command&Control: (Trojan) Kuluoz - regex: to_server:POST /[A-F\d]{42} HTTP.*form-data;.*filename=.key\.bin.*filename=.data\.bin detector_id: 43723
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Kuluoz"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:" HTTP"; content:"form-data|3B|"; content:"filename="; content:"key.bin"; content:"filename="; content:"data.bin"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[A-F\d]{42} HTTP.*form-data\;.*filename=.key\.bin.*filename=.data\.bin/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043723; rev:670;)

# Adware: (Adware) LoadMoney - regex: to_server:GET /get_download_xml(_\d)\?id=\d+ HTTP.*User-Agent: tiny-dl/nix detector_id: 43724
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) LoadMoney"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get_download_xml"; content:"?id="; content:" HTTP"; content:"User-Agent|3A| tiny-dl/nix"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get_download_xml(_\d)\?id=\d+ HTTP.*User-Agent: tiny-dl\/nix/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043724; rev:671;)

# FakeAV: GenericFakeAV_13 - regex: to_server:GET /\?0=\d+&1=\d+&2=\d+&3=i&4=\d+&5=\d+&6=\d+&7=[a-z]{8,10} HTTP.*Host: \d+\.\d+\.\d+\.\d+ detector_id: 43775
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: GenericFakeAV_13"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?0="; content:"&1="; content:"&2="; content:"&3=i&4="; content:"&5="; content:"&6="; content:"&7="; content:" HTTP"; content:"Host|3A| "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?0=\d+&1=\d+&2=\d+&3=i&4=\d+&5=\d+&6=\d+&7=[a-z]{8,10} HTTP.*Host: \d+\.\d+\.\d+\.\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043775; rev:672;)

# Adware: (Adware) LoadMoney - regex: to_server:GET \S+\.php\?id=[0-9]+ HTTP/1\.1\r\nAccept: \*/\*\r\nUser-Agent: tiny-dl/nix\r\nHost: \S+\r\n\r\n detector_id: 43796
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) LoadMoney"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?id="; content:" HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|User-Agent|3A| tiny-dl/nix|0D||0A|Host|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\S+\.php\?id=[0-9]+ HTTP\/1\.1\r\nAccept: \*\/\*\r\nUser-Agent: tiny-dl\/nix\r\nHost: \S+\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043796; rev:680;)

# Command&Control: (Trojan) HackedFirefox - regex: to_server:POST /a123o/Post\.aspx HTTP/1\.1\r\nHost: .+\r\nAccept: .+\r\nContent-Length: \d+\r\nContent-Type: .+\r\n\r\ns1=.*s2= detector_id: 43902
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) HackedFirefox"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/a123o/Post.aspx HTTP/1.1|0D||0A|Host|3A| "; content:"|0D||0A|Accept|3A| "; content:"|0D||0A|Content-Length|3A| "; content:"|0D||0A|Content-Type|3A| "; content:"|0D||0A||0D||0A|s1="; content:"s2="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/a123o\/Post\.aspx HTTP\/1\.1\r\nHost: .+\r\nAccept: .+\r\nContent-Length: \d+\r\nContent-Type: .+\r\n\r\ns1=.*s2=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043902; rev:1010;)

# Command&Control: (Backdoor) Androm - regex: to_server:POST /[a-z_\d/]*gr?ate\.php HTTP.*User-Agent: Mozilla/4\.0\x0d\x0a.*[a-zA-Z\d/\+]{10,}={0,2}\n detector_id: 43962
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Androm"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"ate.php HTTP"; content:"User-Agent|3A| Mozilla/4.0|0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z_\d\/]*gr?ate\.php HTTP.*User-Agent: Mozilla\/4\.0\x0d\x0a.*[a-zA-Z\d\/\+]{10,}={0,2}\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043962; rev:718;)

# Command&Control: (Trojan) ZBot - regex: to_server:POST /[a-z\d/]*false\.php HTTP.*bn1=[A-Z]{4}_[\dA-F]{16}_\d{3}&sk1=[\dA-F]{16} detector_id: 43963
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"false.php HTTP"; content:"bn1="; content:"&sk1="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z\d\/]*false\.php HTTP.*bn1=[A-Z]{4}_[\dA-F]{16}_\d{3}&sk1=[\dA-F]{16}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043963; rev:681;)

# Command&Control: (Trojan) HackedFirefox - regex: to_server:GET /a123o/Get\.aspx\?s=.+-.+-.+-.+ HTTP detector_id: 43986
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) HackedFirefox"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/a123o/Get.aspx?s="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/a123o\/Get\.aspx\?s=.+-.+-.+-.+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043986; rev:683;)

# Command&Control: (Worm) Bobax - regex: to_server:GET /reg\?u=[\dA-F]{8}&v=\d+&s=\d+(&su=\d+)?&p=\d+(&e=\d)?(&o=\d)? HTTP detector_id: 44185
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Bobax"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/reg?u="; content:"&v="; content:"&s="; content:"&p="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/reg\?u=[\dA-F]{8}&v=\d+&s=\d+(&su=\d+)?&p=\d+(&e=\d)?(&o=\d)? HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044185; rev:695;)

# Command&Control: (Trojan) Xorpix - regex: to_server:GET /work\.php\?method=reg HTTP.*User-Agent:.*Windows 98 detector_id: 44186
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Xorpix"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/work.php?method=reg HTTP"; content:"User-Agent|3A|"; content:"Windows 98"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/work\.php\?method=reg HTTP.*User-Agent:.*Windows 98/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044186; rev:711;)

# Command&Control: (PasswordStealer) GenericPasswordStealer_1 - regex: to_server:GET [a-zA-z/]*index\.php\?action=add&username=.*&password=.*&app=.*&pcname=.*&sitename=.* HTTP.*User-Agent: HardCore Software detector_id: 44216
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (PasswordStealer) GenericPasswordStealer_1"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"index.php?action=add&username="; content:"&password="; content:"&app="; content:"&pcname="; content:"&sitename="; content:" HTTP"; content:"User-Agent|3A| HardCore Software"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?[a-zA-z\/]*index\.php\?action=add&username=.*&password=.*&app=.*&pcname=.*&sitename=.* HTTP.*User-Agent: HardCore Software/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044216; rev:1002;)

# Command&Control: (Backdoor) Prorat - regex: to_server:GET /friendship/email_thank_you/\?failed_url=.*friendship.*send_by_email.*&folder_id=\d+&Extra_Params_Counte=\d&nick_name=ProRat\+Server detector_id: 44217
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Prorat"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/friendship/email_thank_you/?failed_url="; content:"friendship"; content:"send_by_email"; content:"&folder_id="; content:"&Extra_Params_Counte="; content:"&nick_name=ProRat|2B|Server"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/friendship\/email_thank_you\/\?failed_url=.*friendship.*send_by_email.*&folder_id=\d+&Extra_Params_Counte=\d&nick_name=ProRat\+Server/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044217; rev:699;)

# Command&Control: (Trojan) Neurevt - regex: to_server:POST [a-z\-_\d/]*/order\.php HTTP.*ps0=[\dA-F]{16,}&ps1=[\dA-F]{48,}&slc=[\dA-F]{8,}&sl_0=[\dA-F]{16,} detector_id: 44218
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Neurevt"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/order.php HTTP"; content:"ps0="; content:"&ps1="; content:"&slc="; content:"&sl_0="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?[a-z\-_\d\/]*\/order\.php HTTP.*ps0=[\dA-F]{16,}&ps1=[\dA-F]{48,}&slc=[\dA-F]{8,}&sl_0=[\dA-F]{16,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044218; rev:699;)

# Command&Control: (Trojan) Sality - regex: to_server:GET [a-z/]*(/logos|/images|/img/|)/[a-zA-Z0-9]+\.(jpg|gif)\?[a-f0-9]{5}=[0-9]{7} HTTP/1\.1\r\nUser-Agent: [^\r]+\r\nHost: [^\r]+\r\nCache-Control: no-cache\r\n(Cookie: [^\r]+\r\n)?\r\n detector_id: 44219
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sality"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP/1.1|0D||0A|User-Agent|3A| "; content:"|0D||0A|Host|3A| "; content:"|0D||0A|Cache-Control|3A| no-cache|0D||0A|"; content:"|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?[a-z\/]*(\/logos|\/images|\/img\/|)\/[a-zA-Z0-9]+\.(jpg|gif)\?[a-f0-9]{5}=[0-9]{7} HTTP\/1\.1\r\nUser-Agent: [^\r]+\r\nHost: [^\r]+\r\nCache-Control: no-cache\r\n(Cookie: [^\r]+\r\n)?\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044219; rev:813;)

# Command&Control: (Trojan) GenericTrojan_79 - regex: to_server:POST /[a-z]+/si\.php\?enc&comp=\S+&ext=\S+ HTTP.*User-Agent: odin detector_id: 44310
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_79"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/si.php?enc&comp="; content:"&ext="; content:" HTTP"; content:"User-Agent|3A| odin"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]+\/si\.php\?enc&comp=\S+&ext=\S+ HTTP.*User-Agent: odin/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044310; rev:708;)

# Command&Control: (Trojan) GenericTrojan_147 - regex: to_server:GET /TJ\.asp\?A=whileInject-[a-z\d\.]+ HTTP detector_id: 44329
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_147"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/TJ.asp?A=whileInject-"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/TJ\.asp\?A=whileInject-[a-z\d\.]+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044329; rev:708;)

# Command&Control: (Backdoor) DarkHole - regex: to_server:GET .*index\.php\?uid=\d{5,8}&ver=[A-Za-z0-9]{5} HTTP.*User-Agent: darkness detector_id: 44332
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) DarkHole"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"index.php?uid="; content:"&ver="; content:" HTTP"; content:"User-Agent|3A| darkness"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*index\.php\?uid=\d{5,8}&ver=[A-Za-z0-9]{5} HTTP.*User-Agent: darkness/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044332; rev:708;)

# Command&Control: (Trojan) Sality - regex: to_server:GET [a-z/]*/logos?[a-z]?\.gif\?[\da-f]{5}=\d{5,} HTTP/1\.1\r\nUser-Agent: [^\r]+\r\nHost: [\w\d\.-]+\r\nCache-Control: no-cache\r\nCookie: btst=[a-f\d]{32}\|[\d\.]+\|[\d\|]+; snkz=[\d\.]+\r\n\r\n detector_id: 44333
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sality"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/logo"; content:".gif?"; content:" HTTP/1.1|0D||0A|User-Agent|3A| "; content:"|0D||0A|Host|3A| "; content:"|0D||0A|Cache-Control|3A| no-cache|0D||0A|Cookie|3A| btst="; content:"|3B| snkz="; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?[a-z\/]*\/logos?[a-z]?\.gif\?[\da-f]{5}=\d{5,} HTTP\/1\.1\r\nUser-Agent: [^\r]+\r\nHost: [\w\d\.-]+\r\nCache-Control: no-cache\r\nCookie: btst=[a-f\d]{32}\|[\d\.]+\|[\d\|]+\; snkz=[\d\.]+\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044333; rev:709;)

# Adware: (Downware) InstallMate - regex: to_server:POST /\?report_version=\d+& HTTP.*User-Agent: TixDll detector_id: 44334
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) InstallMate"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/?report_version="; content:"& HTTP"; content:"User-Agent|3A| TixDll"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?report_version=\d+& HTTP.*User-Agent: TixDll/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044334; rev:709;)

# Bitcoin Mining: BitCoinMiner - regex: to_server:GET /postback/\?cid=[CG]PU&eid=[a-z]+&key=\d,[A-Z]{2},\d{2}(:\d{2}){5} detector_id: 44335
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Bitcoin Mining: BitCoinMiner"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/postback/?cid="; content:"PU&eid="; content:"&key="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/postback\/\?cid=[CG]PU&eid=[a-z]+&key=\d,[A-Z]{2},\d{2}(:\d{2}){5}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044335; rev:709;)

# Adware: (Downware) Solimba - regex: to_server:GET /installer/[a-f0-9]{8}(-[a-f0-9]{4}){3}-[a-f0-9]{12}/\d+/open\?ie=[\d\.]+&net=[\d\.]+F&sp=\d+ HTTP detector_id: 44336
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Solimba"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/installer/"; content:"/open?ie="; content:"&net="; content:"F&sp="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/installer\/[a-f0-9]{8}(-[a-f0-9]{4}){3}-[a-f0-9]{12}\/\d+\/open\?ie=[\d\.]+&net=[\d\.]+F&sp=\d+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044336; rev:709;)

# Command&Control: (Virus) Alman - regex: to_server:GET /lol/lmo/lol_info\.php\?uid=&chk=[\dA-F]{32} HTTP.*User-Agent: [\da-f]{10} detector_id: 44337
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Virus) Alman"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/lol/lmo/lol_info.php?uid=&chk="; content:" HTTP"; content:"User-Agent|3A| "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/lol\/lmo\/lol_info\.php\?uid=&chk=[\dA-F]{32} HTTP.*User-Agent: [\da-f]{10}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044337; rev:711;)

# Command&Control: (Trojan) Quervar - regex: to_server:GET [/a-z0-9]*/update\.apx\?[a-zA-Z\d]{8}&pin=[A-F0-9]{16} HTTP.*Accept: \*/\*\r\nAccept-Encoding: gzip, deflate detector_id: 44338
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Quervar"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/update.apx?"; content:"&pin="; content:" HTTP"; content:"Accept|3A| |2A|/|2A||0D||0A|Accept-Encoding|3A| gzip|2C| deflate"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?[\/a-z0-9]*\/update\.apx\?[a-zA-Z\d]{8}&pin=[A-F0-9]{16} HTTP.*Accept: \*\/\*\r\nAccept-Encoding: gzip, deflate/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044338; rev:709;)

# Command&Control: (Trojan) Kuluoz - regex: to_server:POST /[A-F\d]{42} HTTP.*Accept: \*/\*\r\nContent-Type: application/x-www-form-urlencoded\r\nUser-Agent: .*\r\nHost: [\d\.]+:(443|8080)\r\nContent-Length: \d+\r\nCache-Control: no-cache.*[\x00-\x1f\x80-\xff]{3} detector_id: 44339
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Kuluoz"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:" HTTP"; content:"Accept|3A| |2A|/|2A||0D||0A|Content-Type|3A| application/x-www-form-urlencoded|0D||0A|User-Agent|3A| "; content:"|0D||0A|Host|3A| "; content:"|0D||0A|Content-Length|3A| "; content:"|0D||0A|Cache-Control|3A| no-cache"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[A-F\d]{42} HTTP.*Accept: \*\/\*\r\nContent-Type: application\/x-www-form-urlencoded\r\nUser-Agent: .*\r\nHost: [\d\.]+:(443|8080)\r\nContent-Length: \d+\r\nCache-Control: no-cache.*[\x00-\x1f\x80-\xff]{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044339; rev:709;)

# Command&Control: (Trojan) Necurs - regex: to_server:POST /forum/db\.php HTTP.*Content-Type: application/octet-stream.*Connection: Keep-Alive.*Pragma: no-cache.*[\x00-\x1f\x80-\xff]{3} detector_id: 44344
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Necurs"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/forum/db.php HTTP"; content:"Content-Type|3A| application/octet-stream"; content:"Connection|3A| Keep-Alive"; content:"Pragma|3A| no-cache"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/forum\/db\.php HTTP.*Content-Type: application\/octet-stream.*Connection: Keep-Alive.*Pragma: no-cache.*[\x00-\x1f\x80-\xff]{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044344; rev:709;)

# Command&Control: (Trojan) GenericTrojan_148 - regex: to_server:POST [a-z/]*/index\.php HTTP.*\d{250} detector_id: 44345
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_148"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/index.php HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?[a-z\/]*\/index\.php HTTP.*\d{250}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044345; rev:711;)

# Command&Control: (Trojan) Sality - regex: to_server:GET [a-z/]*/main[a-z]?\.gif\?[\da-f]{5}=\d{5,} HTTP/1\.1\r\nUser-Agent: Opera/\d\.\d\d \(Windows NT 6\.0; U; en\)\r\nHost: .*Cache-Control: no-cache detector_id: 44346
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sality"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/main"; content:".gif?"; content:" HTTP/1.1|0D||0A|User-Agent|3A| Opera/"; content:" |28|Windows NT 6.0|3B| U|3B| en|29||0D||0A|Host|3A| "; content:"Cache-Control|3A| no-cache"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?[a-z\/]*\/main[a-z]?\.gif\?[\da-f]{5}=\d{5,} HTTP\/1\.1\r\nUser-Agent: Opera\/\d\.\d\d \(Windows NT 6\.0\; U\; en\)\r\nHost: .*Cache-Control: no-cache/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044346; rev:1010;)

# Command&Control: (Trojan) Gamarue - regex: to_server:GET /[a-c]\?=([a-z]{5})\1{5}[a-z]{2} HTTP.*Accept: \*/\*.*Accept-Encoding: gzip, deflate.*User-Agent:.*Host:.*Connection: Keep-Alive detector_id: 44347
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Gamarue"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?="; content:" HTTP"; content:"Accept|3A| |2A|/|2A|"; content:"Accept-Encoding|3A| gzip|2C| deflate"; content:"User-Agent|3A|"; content:"Host|3A|"; content:"Connection|3A| Keep-Alive"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-c]\?=([a-z]{5})\1{5}[a-z]{2} HTTP.*Accept: \*\/\*.*Accept-Encoding: gzip, deflate.*User-Agent:.*Host:.*Connection: Keep-Alive/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044347; rev:709;)

# Command&Control: (Trojan) GenericTrojan_149 - regex: to_server:POST [a-z\d/]*/image\.php HTTP.*User-Agent: Mozilla/4\.0\r\n.*fHGAT[\da-zA-Z+/]*={0,2}$ detector_id: 44348
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_149"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/image.php HTTP"; content:"User-Agent|3A| Mozilla/4.0|0D||0A|"; content:"fHGAT"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?[a-z\d\/]*\/image\.php HTTP.*User-Agent: Mozilla\/4\.0\r\n.*fHGAT[\da-zA-Z+\/]*={0,2}$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044348; rev:721;)

# Command&Control: (Trojan) Fareit - regex: to_server:POST /(?=.{0,8}\d)(?=.{0,8}[A-Z])[a-zA-Z\d]{8,}/(?=.{0,14}\d)(?=.{0,14}[A-Z])[a-zA-Z\d]{12,}\.php HTTP/1\.0\r\nHost:.*Accept: \*/\*.*Accept-Encoding: identity.*Content-Type: application/octet-stream.*Connection: close.*Content-Encoding: binary.*User-Agent:.*[\x00-\x1f\x80-\xff]{3} detector_id: 44349
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fareit"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP/1.0|0D||0A|Host|3A|"; content:"Accept|3A| |2A|/|2A|"; content:"Accept-Encoding|3A| identity"; content:"Content-Type|3A| application/octet-stream"; content:"Connection|3A| close"; content:"Content-Encoding|3A| binary"; content:"User-Agent|3A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(?=.{0,8}\d)(?=.{0,8}[A-Z])[a-zA-Z\d]{8,}\/(?=.{0,14}\d)(?=.{0,14}[A-Z])[a-zA-Z\d]{12,}\.php HTTP\/1\.0\r\nHost:.*Accept: \*\/\*.*Accept-Encoding: identity.*Content-Type: application\/octet-stream.*Connection: close.*Content-Encoding: binary.*User-Agent:.*[\x00-\x1f\x80-\xff]{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044349; rev:715;)

# Command&Control: (Trojan) Sality - regex: to_server:GET /banner\.gif\?[\da-f]{5}=\d{5,} HTTP/1\.1\r\nUser-Agent: [^\r]+\r\nHost: [\w\d\.-]+\r\nCache-Control: no-cache detector_id: 44350
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sality"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/banner.gif?"; content:" HTTP/1.1|0D||0A|User-Agent|3A| "; content:"|0D||0A|Host|3A| "; content:"|0D||0A|Cache-Control|3A| no-cache"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/banner\.gif\?[\da-f]{5}=\d{5,} HTTP\/1\.1\r\nUser-Agent: [^\r]+\r\nHost: [\w\d\.-]+\r\nCache-Control: no-cache/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044350; rev:709;)

# Command&Control: (Trojan) Sality - regex: to_server:GET /home\.gif\?[\da-f]{5}=\d{5,} HTTP.*Host: kukutrustnet\d+\.info detector_id: 44351
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sality"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/home.gif?"; content:" HTTP"; content:"Host|3A| kukutrustnet"; content:".info"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/home\.gif\?[\da-f]{5}=\d{5,} HTTP.*Host: kukutrustnet\d+\.info/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044351; rev:709;)

# Command&Control: (Trojan) Sality - regex: to_server:GET /(img|images)/button\.gif\?[\da-f]{5}=\d{5,} HTTP/1\.1\r\nUser-Agent: [^\r]+\r\nHost: [\w\d\.-]+\r\nCache-Control: no-cache\r\n\r\n detector_id: 44352
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sality"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/button.gif?"; content:" HTTP/1.1|0D||0A|User-Agent|3A| "; content:"|0D||0A|Host|3A| "; content:"|0D||0A|Cache-Control|3A| no-cache|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(img|images)\/button\.gif\?[\da-f]{5}=\d{5,} HTTP\/1\.1\r\nUser-Agent: [^\r]+\r\nHost: [\w\d\.-]+\r\nCache-Control: no-cache\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044352; rev:709;)

# Adware: (Downware) Amonetize - regex: to_server:POST /index\.php HTTP.*Net1\.1=&Net2=[\d\.]+&Net4=[\d\.]+&OSversion=.*&Slv=&Sysid=[\dA-F]+&Sysid1=[\dA-F]+&X64=[YN]&admin=[YN]&browser=.*&chver=.*&exe=.*&ffver= detector_id: 44354
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Amonetize"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/index.php HTTP"; content:"Net1.1=&Net2="; content:"&Net4="; content:"&OSversion="; content:"&Slv=&Sysid="; content:"&Sysid1="; content:"&X64="; content:"&admin="; content:"&browser="; content:"&chver="; content:"&exe="; content:"&ffver="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php HTTP.*Net1\.1=&Net2=[\d\.]+&Net4=[\d\.]+&OSversion=.*&Slv=&Sysid=[\dA-F]+&Sysid1=[\dA-F]+&X64=[YN]&admin=[YN]&browser=.*&chver=.*&exe=.*&ffver=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044354; rev:1010;)

# Command&Control: (Backdoor) DarkHole - regex: to_server:POST /upload\.php HTTP.*User-Agent: Uploador.*Content-Disposition: form-data; name="data"; filename="\S+\.dark" detector_id: 44356
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) DarkHole"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/upload.php HTTP"; content:"User-Agent|3A| Uploador"; content:"Content-Disposition|3A| form-data|3B| name=|22|data|22||3B| filename=|22|"; content:".dark|22|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/upload\.php HTTP.*User-Agent: Uploador.*Content-Disposition: form-data\; name="data"\; filename="\S+\.dark"/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044356; rev:711;)

# Adware: (Adware) Verti - regex: to_server:POST /evt/\?phxcb=[\da-f]{8}(-[\da-f]{4}){3}-[\da-f]{12} HTTP.*a=[\dA-F]{200,}&b= detector_id: 44357
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Verti"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/evt/?phxcb="; content:" HTTP"; content:"a="; content:"&b="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/evt\/\?phxcb=[\da-f]{8}(-[\da-f]{4}){3}-[\da-f]{12} HTTP.*a=[\dA-F]{200,}&b=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044357; rev:710;)

# Adware: (Downware) InstallMonster - regex: to_server:POST /api/index HTTP.*Connection: keep-alive.*Content-Length:.*Host:.*Accept: text/html,application/xhtml\+xml,application/xml.*Accept-Encoding: identity.*User-Agent: Mozilla/3\.0 \(compatible; Indy Library\) detector_id: 44364
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) InstallMonster"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/api/index HTTP"; content:"Connection|3A| keep-alive"; content:"Content-Length|3A|"; content:"Host|3A|"; content:"Accept|3A| text/html|2C|application/xhtml|2B|xml|2C|application/xml"; content:"Accept-Encoding|3A| identity"; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/index HTTP.*Connection: keep-alive.*Content-Length:.*Host:.*Accept: text\/html,application\/xhtml\+xml,application\/xml.*Accept-Encoding: identity.*User-Agent: Mozilla\/3\.0 \(compatible\; Indy Library\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044364; rev:710;)

# Command&Control: (Trojan) Sality - regex: to_server:GET [a-z/]*/index\.php\?bot=[a-z\d]+&botkey=[a-z\d]+&os=\S+&ram=\S+&user=\S+&cpu=\S+ HTTP detector_id: 44370
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sality"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?bot="; content:"&botkey="; content:"&os="; content:"&ram="; content:"&user="; content:"&cpu="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?[a-z\/]*\/index\.php\?bot=[a-z\d]+&botkey=[a-z\d]+&os=\S+&ram=\S+&user=\S+&cpu=\S+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044370; rev:711;)

# Command&Control: (Banker) GenericBanker_30 - regex: to_server:POST /imagens/inff\.php HTTP.*op=info&informacao=.*& detector_id: 44408
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_30"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/imagens/inff.php HTTP"; content:"op=info&informacao="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/imagens\/inff\.php HTTP.*op=info&informacao=.*&/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044408; rev:715;)

# Command&Control: (Backdoor) Htbot - regex: to_server:GET /[a-z]{4,}\.php\?command=ghl&id=\d+ HTTP.*User-Agent: pb detector_id: 44409
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Htbot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?command=ghl&id="; content:" HTTP"; content:"User-Agent|3A| pb"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{4,}\.php\?command=ghl&id=\d+ HTTP.*User-Agent: pb/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044409; rev:715;)

#  Adware: (Downware) Solimba - regex: to_server:GET /installer/[a-f0-9]{8}(-[a-f0-9]{4}){3}-[a-f0-9]{12}/\d+/open\?i=f&n=f&v=[\d\.]+ HTTP detector_id: 44410
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS  Adware: (Downware) Solimba"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/installer/"; content:"/open?i=f&n=f&v="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/installer\/[a-f0-9]{8}(-[a-f0-9]{4}){3}-[a-f0-9]{12}\/\d+\/open\?i=f&n=f&v=[\d\.]+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044410; rev:715;)

# Command&Control: (Trojan) GenericTrojan_79 - regex: to_server:POST /[a-z]+/si\.php\?news_stream&comp=\S+ HTTP.*User-Agent: odin detector_id: 44411
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_79"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/si.php?news_stream&comp="; content:" HTTP"; content:"User-Agent|3A| odin"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]+\/si\.php\?news_stream&comp=\S+ HTTP.*User-Agent: odin/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044411; rev:715;)

# Adware: (Toolbar) iBryte - regex: to_server:GET /(launch|start)(_v\d)?\.php\?p=[a-z]+&pid=\d+&tid=\d+&sid=\d+ HTTP detector_id: 44412
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) iBryte"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?p="; content:"&pid="; content:"&tid="; content:"&sid="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(launch|start)(_v\d)?\.php\?p=[a-z]+&pid=\d+&tid=\d+&sid=\d+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044412; rev:715;)

# Adware: (Downware) GenericDownware_4 - regex: to_server:GET [a-z/]*/(open|360|s)\.ini\?name=[A-Za-z\d\.]+\.exe&ini=[a-z]+\.ini(&t=\d+)? HTTP.*User-Agent: NSISDL detector_id: 44413
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) GenericDownware_4"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".ini?name="; content:".exe&ini="; content:".ini"; content:" HTTP"; content:"User-Agent|3A| NSISDL"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?[a-z\/]*\/(open|360|s)\.ini\?name=[A-Za-z\d\.]+\.exe&ini=[a-z]+\.ini(&t=\d+)? HTTP.*User-Agent: NSISDL/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044413; rev:743;)

# Adware: (Adware) LoadMoney - regex: to_server:GET /info\?story=[a-f\d]{14}&file=\d+ HTTP.*User-Agent: Downloader detector_id: 44414
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) LoadMoney"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/info?story="; content:"&file="; content:" HTTP"; content:"User-Agent|3A| Downloader"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/info\?story=[a-f\d]{14}&file=\d+ HTTP.*User-Agent: Downloader/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044414; rev:715;)

# Adware: (Adware) GenericAdware_15 - regex: to_server:POST /ii\?v=\d HTTP.*Content-Length: 192.*Content-Type: multipart/encrypted.*Host:.*Connection: Keep-Alive.*[\x00-\x1f\x80-\xff]{3} detector_id: 44415
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) GenericAdware_15"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ii?v="; content:" HTTP"; content:"Content-Length|3A| 192"; content:"Content-Type|3A| multipart/encrypted"; content:"Host|3A|"; content:"Connection|3A| Keep-Alive"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ii\?v=\d HTTP.*Content-Length: 192.*Content-Type: multipart\/encrypted.*Host:.*Connection: Keep-Alive.*[\x00-\x1f\x80-\xff]{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044415; rev:715;)

#  Command&Control: (PasswordStealer) Tepfer - regex: to_server:POST /idx\.php HTTP.*Host:.*Accept: \*/\*.*Accept-Encoding: identity.*Content-Length: \d{4,}.*Content-Type: application/octet-stream.*Connection: close.*Content-Encoding: binary.*User-Agent:.*[\x00-\x1f\x80-\xff]{3} detector_id: 44416
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS  Command&Control: (PasswordStealer) Tepfer"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/idx.php HTTP"; content:"Host|3A|"; content:"Accept|3A| |2A|/|2A|"; content:"Accept-Encoding|3A| identity"; content:"Content-Length|3A| "; content:"Content-Type|3A| application/octet-stream"; content:"Connection|3A| close"; content:"Content-Encoding|3A| binary"; content:"User-Agent|3A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/idx\.php HTTP.*Host:.*Accept: \*\/\*.*Accept-Encoding: identity.*Content-Length: \d{4,}.*Content-Type: application\/octet-stream.*Connection: close.*Content-Encoding: binary.*User-Agent:.*[\x00-\x1f\x80-\xff]{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044416; rev:715;)

#  Command&Control: (Trojan) Redyms - regex: to_server:POST / HTTP/1\.1\r\nHost: \S+\r\nContent-Length: 128\r\nCache-Control: no-cache.*[\x00-\x1f\x80-\xff]{3} detector_id: 44417
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS  Command&Control: (Trojan) Redyms"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ HTTP/1.1|0D||0A|Host|3A| "; content:"|0D||0A|Content-Length|3A| 128|0D||0A|Cache-Control|3A| no-cache"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ HTTP\/1\.1\r\nHost: \S+\r\nContent-Length: 128\r\nCache-Control: no-cache.*[\x00-\x1f\x80-\xff]{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044417; rev:715;)

# Adware: (Game) GameVance - regex: to_server:GET /aj/ireport\.php\?p=u7G3.*User-Agent: zz_tah detector_id: 44449
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Game) GameVance"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/aj/ireport.php?p=u7G3"; content:"User-Agent|3A| zz_tah"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/aj\/ireport\.php\?p=u7G3.*User-Agent: zz_tah/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044449; rev:1010;)

# Command&Control: (Trojan) Contuedo - regex: to_server:POST /upload\.php HTTP.*conteudo=.*&myFile=Aut_\S+\.log detector_id: 44450
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Contuedo"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/upload.php HTTP"; content:"conteudo="; content:"&myFile=Aut_"; content:".log"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/upload\.php HTTP.*conteudo=.*&myFile=Aut_\S+\.log/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044450; rev:717;)

# Adware: (Adware) Adpeak - regex: to_server:POST /[a-z]\.json\?g=[A-F\d]{8}(-[A-F\d]{4}){3}-[A-F\d]{12}.*connection: close, TE.*content-length: 1.*user-agent: LuaSocket detector_id: 44451
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Adpeak"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".json?g="; content:"connection|3A| close|2C| TE"; content:"content-length|3A| 1"; content:"user-agent|3A| LuaSocket"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]\.json\?g=[A-F\d]{8}(-[A-F\d]{4}){3}-[A-F\d]{12}.*connection: close, TE.*content-length: 1.*user-agent: LuaSocket/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044451; rev:717;)

# Adware: (Downware) Freepds - regex: to_server:GET /freepds/fileinfo\.php\?kind=download&ind=\d*&pid=partner\d*&uniq=&prog_uniq=freepdscom.*User-Agent: FreePDSG detector_id: 44457
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Freepds"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/freepds/fileinfo.php?kind=download&ind="; content:"&pid=partner"; content:"&uniq=&prog_uniq=freepdscom"; content:"User-Agent|3A| FreePDSG"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/freepds\/fileinfo\.php\?kind=download&ind=\d*&pid=partner\d*&uniq=&prog_uniq=freepdscom.*User-Agent: FreePDSG/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044457; rev:718;)

# Command&Control: (Trojan) Shiz - regex: to_server:GET /login\.php HTTP.*Referer: http://www\.google\.com\r\nUser-Agent: Mozilla/4\.0 \(compatible; MSIE 2\.0; Windows NT 5\.0;.*\)\r\nHost detector_id: 44464
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Shiz"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/login.php HTTP"; content:"Referer|3A| http|3A|//www.google.com|0D||0A|User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 2.0|3B| Windows NT 5.0|3B|"; content:"|29||0D||0A|Host"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/login\.php HTTP.*Referer: http:\/\/www\.google\.com\r\nUser-Agent: Mozilla\/4\.0 \(compatible\; MSIE 2\.0\; Windows NT 5\.0\;.*\)\r\nHost/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044464; rev:1010;)

# Command&Control: (Banker) GenericBanker_31 - regex: to_server:POST / HTTP.*mailmyform_username=omestresupremo&Infectado=.*&Computador=.*&Usuario=.*&Windows= detector_id: 44515
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_31"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ HTTP"; content:"mailmyform_username=omestresupremo&Infectado="; content:"&Computador="; content:"&Usuario="; content:"&Windows="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ HTTP.*mailmyform_username=omestresupremo&Infectado=.*&Computador=.*&Usuario=.*&Windows=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044515; rev:721;)

# Adware: (Downware) Outbrowse - regex: to_server:GET /Installer/Flow\?pubid=.*&distid=.*&productid=.*&subpubid=.*&campaignid=.*&networkid=.*&dfb=.*&os=.*&iev=.*&ffv=.*&chromev=.*&macaddress=.*&netv=.*&hb=.*&systembit=.*&version= detector_id: 44516
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Outbrowse"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Installer/Flow?pubid="; content:"&distid="; content:"&productid="; content:"&subpubid="; content:"&campaignid="; content:"&networkid="; content:"&dfb="; content:"&os="; content:"&iev="; content:"&ffv="; content:"&chromev="; content:"&macaddress="; content:"&netv="; content:"&hb="; content:"&systembit="; content:"&version="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Installer\/Flow\?pubid=.*&distid=.*&productid=.*&subpubid=.*&campaignid=.*&networkid=.*&dfb=.*&os=.*&iev=.*&ffv=.*&chromev=.*&macaddress=.*&netv=.*&hb=.*&systembit=.*&version=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044516; rev:721;)

# Adware: (Adware) Linkular - regex: to_server:GET /api/success/\?s=\d+&c=\d+&cv=.*(&b=.*)?(&bv=.*)?(&os=win&osv=.*)?(&context=.*)?.*HTTP.*User-Agent: NSIS_Inetc detector_id: 44517
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Linkular"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/api/success/?s="; content:"&c="; content:"&cv="; content:"HTTP"; content:"User-Agent|3A| NSIS_Inetc"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/success\/\?s=\d+&c=\d+&cv=.*(&b=.*)?(&bv=.*)?(&os=win&osv=.*)?(&context=.*)?.*HTTP.*User-Agent: NSIS_Inetc/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044517; rev:844;)

# Adware: (Adware) LoadMoney - regex: to_server:GET /dwnld/url\?u=.*&f=.*torrent&key=a0b2c437.*User-Agent: tiny-dl detector_id: 44558
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) LoadMoney"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/dwnld/url?u="; content:"&f="; content:"torrent&key=a0b2c437"; content:"User-Agent|3A| tiny-dl"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/dwnld\/url\?u=.*&f=.*torrent&key=a0b2c437.*User-Agent: tiny-dl/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044558; rev:722;)

# Adware: (Adware) LoadMoney - regex: to_server:GET /dwnld/url\?u=.*User-Agent: tiny-dl detector_id: 44559
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) LoadMoney"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/dwnld/url?u="; content:"User-Agent|3A| tiny-dl"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/dwnld\/url\?u=.*User-Agent: tiny-dl/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044559; rev:801;)

# Command&Control: (Dropper) Dofoil - regex: to_server:POST [a-z/]*/index\.php HTTP/1\.0\r\nUser-Agent: Mozilla/4\.0\r\nHost.*Content-Type: application/x-www-form-urlencoded\r\nConnection: close\r\nContent-Length.*[A-Za-z\d]{3}AAA[A-Za-z\d/+]+={0,2}\r\n detector_id: 44560
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Dofoil"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/index.php HTTP/1.0|0D||0A|User-Agent|3A| Mozilla/4.0|0D||0A|Host"; content:"Content-Type|3A| application/x-www-form-urlencoded|0D||0A|Connection|3A| close|0D||0A|Content-Length"; content:"AAA"; content:"|0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?[a-z\/]*\/index\.php HTTP\/1\.0\r\nUser-Agent: Mozilla\/4\.0\r\nHost.*Content-Type: application\/x-www-form-urlencoded\r\nConnection: close\r\nContent-Length.*[A-Za-z\d]{3}AAA[A-Za-z\d\/+]+={0,2}\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044560; rev:1002;)

# Command&Control: (Banker) GenericBanker_32 - regex: to_server:POST /~?[a-zA-Z/]*index\.php\?maquina= HTTP.*User-Agent: Mozilla/3\.0 \(compatible; Indy Library\).*Key_ID=.*&NomePC=.*&GetOS=.*&GetAVInfo=.*&GbExists=.*&GetBrowser= detector_id: 44561
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) GenericBanker_32"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"index.php?maquina= HTTP"; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; content:"Key_ID="; content:"&NomePC="; content:"&GetOS="; content:"&GetAVInfo="; content:"&GbExists="; content:"&GetBrowser="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/~?[a-zA-Z\/]*index\.php\?maquina= HTTP.*User-Agent: Mozilla\/3\.0 \(compatible\; Indy Library\).*Key_ID=.*&NomePC=.*&GetOS=.*&GetAVInfo=.*&GbExists=.*&GetBrowser=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044561; rev:722;)

# Command&Control: (Trojan) ZBot - regex: to_server:POST /~[a-z]{5,8}\d*/[a-z_\-]+\d*/file\.php HTTP/1\.1\r\nAccept: \*/\*\r\nUser-Agent.*Host: \d+\.\d+\.\d+\.\d+\r\nContent-Length: 12[28]\r\nConnection: Keep-Alive\r\nCache-Control: no-cache.*[\x00-\x1f\x80-\xFF]{3} detector_id: 44562
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/|7E|"; content:"/file.php HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|User-Agent"; content:"Host|3A| "; content:"|0D||0A|Content-Length|3A| 12"; content:"|0D||0A|Connection|3A| Keep-Alive|0D||0A|Cache-Control|3A| no-cache"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/~[a-z]{5,8}\d*\/[a-z_\-]+\d*\/file\.php HTTP\/1\.1\r\nAccept: \*\/\*\r\nUser-Agent.*Host: \d+\.\d+\.\d+\.\d+\r\nContent-Length: 12[28]\r\nConnection: Keep-Alive\r\nCache-Control: no-cache.*[\x00-\x1f\x80-\xFF]{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044562; rev:723;)

# Command&Control: (Trojan) ZBot - regex: to_server:POST /[a-z0-9]{10,13}/file\.php HTTP.*Content-Length: (122|128|131).*[\x00-\x1f\x80-\xFF]{3} detector_id: 44563
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/file.php HTTP"; content:"Content-Length|3A| "; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z0-9]{10,13}\/file\.php HTTP.*Content-Length: (122|128|131).*[\x00-\x1f\x80-\xFF]{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044563; rev:1032;)

# Command&Control: (Backdoor) GenericBackdoor_13 - regex: to_server:GET /log\.php\?key=S-[A-Z\d]{6}-[A-Z\d]{4}-[A-Z\d]{6} HTTP.*User-Agent: DMFR detector_id: 44680
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) GenericBackdoor_13"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/log.php?key=S-"; content:" HTTP"; content:"User-Agent|3A| DMFR"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/log\.php\?key=S-[A-Z\d]{6}-[A-Z\d]{4}-[A-Z\d]{6} HTTP.*User-Agent: DMFR/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044680; rev:730;)

# Command&Control: (Trojan) Shiotob - regex: to_server:POST /was/vas\.php HTTP.*[A-Za-z\d\+/]{40,}=={0,2}$ detector_id: 44681
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Shiotob"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/was/vas.php HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/was\/vas\.php HTTP.*[A-Za-z\d\+\/]{40,}=={0,2}$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044681; rev:1002;)

# Adware: (Downware) GenericDownware_5 - regex: to_server:GET /downtor\.php\?id=\d+ HTTP.*User-Agent: MediaLabsSiteInstaller detector_id: 44682
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) GenericDownware_5"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/downtor.php?id="; content:" HTTP"; content:"User-Agent|3A| MediaLabsSiteInstaller"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/downtor\.php\?id=\d+ HTTP.*User-Agent: MediaLabsSiteInstaller/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044682; rev:730;)

# Command&Control: (Trojan) Gamarue - regex: to_server:POST /beta\.php HTTP.*User-Agent: Mozilla/4\.0\r.*b0lsBZp detector_id: 44683
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Gamarue"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/beta.php HTTP"; content:"User-Agent|3A| Mozilla/4.0|0D|"; content:"b0lsBZp"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/beta\.php HTTP.*User-Agent: Mozilla\/4\.0\r.*b0lsBZp/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044683; rev:730;)

# Command&Control: (Trojan) Gamarue - regex: to_server:POST /punta/gae\.php HTTP.*User-Agent: Mozilla/4\.0\r.*KZkoi detector_id: 44684
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Gamarue"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/punta/gae.php HTTP"; content:"User-Agent|3A| Mozilla/4.0|0D|"; content:"KZkoi"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/punta\/gae\.php HTTP.*User-Agent: Mozilla\/4\.0\r.*KZkoi/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044684; rev:731;)

# Command&Control: (Trojan) ZBot - regex: to_server:POST /paris\.php HTTP.*bn1=[A-Z]{4}_[A-F\d]{16}_\d+&sk1=[A-F\d]{32} detector_id: 44685
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/paris.php HTTP"; content:"bn1="; content:"&sk1="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/paris\.php HTTP.*bn1=[A-Z]{4}_[A-F\d]{16}_\d+&sk1=[A-F\d]{32}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044685; rev:730;)

# Command&Control: (Trojan) ZBot - regex: to_server:POST /file-[a-f\d]{6}\.php HTTP/1\.1\r\nAccept: \*/\*\r\nUser-Agent:.*Host.*Content-Length: 128\r\nConnection: Keep-Alive\r\nCache-Control: no-cache.*[\x00-\x1f\x80-\xff]{3} detector_id: 44692
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/file-"; content:".php HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|User-Agent|3A|"; content:"Host"; content:"Content-Length|3A| 128|0D||0A|Connection|3A| Keep-Alive|0D||0A|Cache-Control|3A| no-cache"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/file-[a-f\d]{6}\.php HTTP\/1\.1\r\nAccept: \*\/\*\r\nUser-Agent:.*Host.*Content-Length: 128\r\nConnection: Keep-Alive\r\nCache-Control: no-cache.*[\x00-\x1f\x80-\xff]{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044692; rev:731;)

# Command&Control: (C&CTool) DirtJumper - regex: to_server:POST /[a-z\d]+\.php HTTP/1\.1\r\nHost:.*Keep-Alive: 300\r\nConnection: keep-alive\r\nUser-Agent: Mozilla/5\.0 \(Windows; U; Windows NT 5\.1; en-US\)\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: \d+\r\n\r\nk=(?=.{0,14}\d)(?=.{0,14}[a-z])[a-z0-9]{15,32} detector_id: 44693
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (C&CTool) DirtJumper"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP/1.1|0D||0A|Host|3A|"; content:"Keep-Alive|3A| 300|0D||0A|Connection|3A| keep-alive|0D||0A|User-Agent|3A| Mozilla/5.0 |28|Windows|3B| U|3B| Windows NT 5.1|3B| en-US|29||0D||0A|Content-Type|3A| application/x-www-form-urlencoded|0D||0A|Content-Length|3A| "; content:"|0D||0A||0D||0A|k="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z\d]+\.php HTTP\/1\.1\r\nHost:.*Keep-Alive: 300\r\nConnection: keep-alive\r\nUser-Agent: Mozilla\/5\.0 \(Windows\; U\; Windows NT 5\.1\; en-US\)\r\nContent-Type: application\/x-www-form-urlencoded\r\nContent-Length: \d+\r\n\r\nk=(?=.{0,14}\d)(?=.{0,14}[a-z])[a-z0-9]{15,32}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044693; rev:1010;)

# Command&Control: (Password Stealer) OnLineGames - regex: to_server:GET /t1081/tyhop\.asp\?up=x1x2x3&pp=y1y2y3 HTTP.*User-Agent: Mozilla/5\.0 \(compatible\) detector_id: 44694
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Password Stealer) OnLineGames"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/t1081/tyhop.asp?up=x1x2x3&pp=y1y2y3 HTTP"; content:"User-Agent|3A| Mozilla/5.0 |28|compatible|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/t1081\/tyhop\.asp\?up=x1x2x3&pp=y1y2y3 HTTP.*User-Agent: Mozilla\/5\.0 \(compatible\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044694; rev:731;)

# Command&Control: (Password Stealer) OnLineGames - regex: to_server:GET /t1081/yhset\.asp\?up=[A-F\d]{32}&gameuser=.*HTTP.*User-Agent: Mozilla/5\.0 \(compatible\) detector_id: 44695
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Password Stealer) OnLineGames"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/t1081/yhset.asp?up="; content:"&gameuser="; content:"HTTP"; content:"User-Agent|3A| Mozilla/5.0 |28|compatible|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/t1081\/yhset\.asp\?up=[A-F\d]{32}&gameuser=.*HTTP.*User-Agent: Mozilla\/5\.0 \(compatible\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044695; rev:731;)

# Command&Control: (Trojan) GenericTrojan_150 - regex: to_server:POST /common/man\.php HTTP.*User-Agent: Mozilla/5\.0.*Firefox.*n%\)\*,>k% detector_id: 44696
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_150"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/common/man.php HTTP"; content:"User-Agent|3A| Mozilla/5.0"; content:"Firefox"; content:"n|25||29||2A||2C|>k|25|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/common\/man\.php HTTP.*User-Agent: Mozilla\/5\.0.*Firefox.*n%\)\*,>k%/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044696; rev:731;)

# Drive-by: (ExploitKit) Bleeding Life EK - regex: to_server:GET /EK/BleedingLife_2/ detector_id: 45527
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: (ExploitKit) Bleeding Life EK"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/EK/BleedingLife_2/"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/EK\/BleedingLife_2\//"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045527; rev:778;)

# Drive-by: (ExploitKit) FirePack EK - regex: to_server:GET /EK/FirePack_0\.18/ HTTP/1\.1\r\n detector_id: 45528
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: (ExploitKit) FirePack EK"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/EK/FirePack_0.18/ HTTP/1.1|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/EK\/FirePack_0\.18\/ HTTP\/1\.1\r\n/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045528; rev:1010;)

# Adware: (Downware) OptimumInstaller - regex: to_server:GET .*\?mode=dl&browser=.*&useragent=.*&sf=.*&&callback detector_id: 45529
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) OptimumInstaller"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?mode=dl&browser="; content:"&useragent="; content:"&sf="; content:"&&callback"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\?mode=dl&browser=.*&useragent=.*&sf=.*&&callback/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045529; rev:778;)

# Command&Control: (Backdoor) Elirks - regex: to_server:GET /form/[a-z]{1}/.{12}/\?zy=[0-9]{1}&fa=.{12} detector_id: 45548
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Elirks"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/form/"; content:"/?zy="; content:"&fa="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/form\/[a-z]{1}\/.{12}\/\?zy=[0-9]{1}&fa=.{12}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045548; rev:771;)

# Adware: (Toolbar) iBryte - regex: to_server:GET /impression\.do/.*\?event=.*&spsource=.*&user_id=.*&implementation_id=.*&subid2=.*&traffic_source=.*&subid=.*&referrer=.* detector_id: 45591
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) iBryte"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/impression.do/"; content:"?event="; content:"&spsource="; content:"&user_id="; content:"&implementation_id="; content:"&subid2="; content:"&traffic_source="; content:"&subid="; content:"&referrer="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/impression\.do\/.*\?event=.*&spsource=.*&user_id=.*&implementation_id=.*&subid2=.*&traffic_source=.*&subid=.*&referrer=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045591; rev:1010;)

# Command&Control: (Trojan) Alureon - regex: to_server:POST /k\.php HTTP.*SIY1YY_\(\^\[ detector_id: 45637
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Alureon"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/k.php HTTP"; content:"SIY1YY_|28||5E||5B|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/k\.php HTTP.*SIY1YY_\(\^\[/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045637; rev:777;)

# Adware: (Downware) LoadMoney - regex: to_server:GET /get_xml\?stb=\d+&did=\d+&file_id=\d+ HTTP.*User-Agent: Downloader detector_id: 45646
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) LoadMoney"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get_xml?stb="; content:"&did="; content:"&file_id="; content:" HTTP"; content:"User-Agent|3A| Downloader"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get_xml\?stb=\d+&did=\d+&file_id=\d+ HTTP.*User-Agent: Downloader/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045646; rev:778;)

# Command&Control: (Trojan) Boroda - regex: to_server:GET /load/\d+/\?p=\d&t=\d&e=\d HTTP.*User-Agent: IE detector_id: 45662
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Boroda"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/load/"; content:"/?p="; content:"&t="; content:"&e="; content:" HTTP"; content:"User-Agent|3A| IE"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/load\/\d+\/\?p=\d&t=\d&e=\d HTTP.*User-Agent: IE/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045662; rev:780;)

# Command&Control: (Trojan) Napolar - regex: to_server:POST / HTTP.*v=[0-9\.]+&u=.*&c=.*&s=\{[0-9a-z\-]+\}&w=[0-9\.]+&b=\d+ detector_id: 45668
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Napolar"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ HTTP"; content:"v="; content:"&u="; content:"&c="; content:"&s=|7B|"; content:"|7D|&w="; content:"&b="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ HTTP.*v=[0-9\.]+&u=.*&c=.*&s=\{[0-9a-z\-]+\}&w=[0-9\.]+&b=\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045668; rev:781;)

# Adware: (Downware) Vittalia - regex: to_server:GET /cmd/api\.php\?mk=[0-9]+&action=[a-z]+.*User-Agent: NSIS\_ToolkitOffers detector_id: 45669
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Vittalia"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cmd/api.php?mk="; content:"&action="; content:"User-Agent|3A| NSIS_ToolkitOffers"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cmd\/api\.php\?mk=[0-9]+&action=[a-z]+.*User-Agent: NSIS\_ToolkitOffers/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045669; rev:784;)

# Command&Control: (Trojan) Uniemv - regex: to_server:GET /gate\.php\?user=[\da-f]{32}&id=\d+&type=\d+(&key=[\da-f]{8}|&hashrate=|) HTTP detector_id: 45686
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Uniemv"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/gate.php?user="; content:"&id="; content:"&type="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/gate\.php\?user=[\da-f]{32}&id=\d+&type=\d+(&key=[\da-f]{8}|&hashrate=|) HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045686; rev:784;)

# Adware: (Adware) BetterInternet - regex: to_server:GET /adserver/static/js/inimage_i\.js\?pid=\d+&ext_domain=\d+&cb=\d+&ox_subId=\d+ detector_id: 45747
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) BetterInternet"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/adserver/static/js/inimage_i.js?pid="; content:"&ext_domain="; content:"&cb="; content:"&ox_subId="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/adserver\/static\/js\/inimage_i\.js\?pid=\d+&ext_domain=\d+&cb=\d+&ox_subId=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045747; rev:787;)

# Command&Control: (Dropper) Umbald - regex: to_server:POST .*/bot\.php HTTP.*User-Agent: umbra.*mode=\d+&UID=\{[A-F0-9\-]{36}\} detector_id: 45774
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Umbald"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/bot.php HTTP"; content:"User-Agent|3A| umbra"; content:"mode="; content:"&UID=|7B|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/bot\.php HTTP.*User-Agent: umbra.*mode=\d+&UID=\{[A-F0-9\-]{36}\}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045774; rev:788;)

# Command&Control: (Trojan) GenericTrojan_151 - regex: to_server:POST .*/gate\.php\?hwid=[\d\.]*&localip=[\d\.]*&pc=.*&winver=.*&wuser=.*&wagent= detector_id: 45775
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_151"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/gate.php?hwid="; content:"&localip="; content:"&pc="; content:"&winver="; content:"&wuser="; content:"&wagent="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/gate\.php\?hwid=[\d\.]*&localip=[\d\.]*&pc=.*&winver=.*&wuser=.*&wagent=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045775; rev:1002;)

# Command&Control: (Trojan) Dishigy - regex: to_server:POST /beta/index\.php HTTP/1\.0.*Host: [a-z\d]+\.co\.cc.*User-Agent: Mozilla/5\.0 \(Windows; U; Windows NT 5\.1; en-US\).*k=\d{14} detector_id: 45776
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Dishigy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/beta/index.php HTTP/1.0"; content:"Host|3A| "; content:".co.cc"; content:"User-Agent|3A| Mozilla/5.0 |28|Windows|3B| U|3B| Windows NT 5.1|3B| en-US|29|"; content:"k="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/beta\/index\.php HTTP\/1\.0.*Host: [a-z\d]+\.co\.cc.*User-Agent: Mozilla\/5\.0 \(Windows\; U\; Windows NT 5\.1\; en-US\).*k=\d{14}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045776; rev:788;)

# Command&Control: (Trojan) GenericTrojan_152 - regex: to_server:GET /[a-z]{2,}\d{2,}/rjb_hqgg\.php\?bh=\d{4}&k1=[a-f\d]{32}&k2=[a-f\d]{32}&k3=[a-f\d]{32} HTTP detector_id: 45777
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_152"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/rjb_hqgg.php?bh="; content:"&k1="; content:"&k2="; content:"&k3="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{2,}\d{2,}\/rjb_hqgg\.php\?bh=\d{4}&k1=[a-f\d]{32}&k2=[a-f\d]{32}&k3=[a-f\d]{32} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045777; rev:1002;)

# Command&Control: (Trojan) GenericTrojan_153 - regex: to_server:POST /zimmerman\d\.php HTTP.*User-Agent: Opera.*Windows NT.*Edition.*Local.*\d+=\d+&ver=\d+&req=\d+ detector_id: 45778
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_153"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/zimmerman"; content:".php HTTP"; content:"User-Agent|3A| Opera"; content:"Windows NT"; content:"Edition"; content:"Local"; content:"&ver="; content:"&req="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/zimmerman\d\.php HTTP.*User-Agent: Opera.*Windows NT.*Edition.*Local.*\d+=\d+&ver=\d+&req=\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045778; rev:788;)

# Command&Control: (Trojan) GenericTrojan_154 - regex: to_server:POST /ojp HTTP.*Accept: text/html, application/xhtml\+xml, \*/\*.*[\x00-\x1f\x80-\xFF]{2} detector_id: 45779
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_154"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ojp HTTP"; content:"Accept|3A| text/html|2C| application/xhtml|2B|xml|2C| |2A|/|2A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ojp HTTP.*Accept: text\/html, application\/xhtml\+xml, \*\/\*.*[\x00-\x1f\x80-\xFF]{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045779; rev:788;)

# Command&Control: (Trojan) Sality - regex: to_server:GET [a-z/]*/xs\d?\.jpg\?[\da-f]{5}=\d{5,} HTTP/1\.1\r\nUser-Agent: [^\r]+\r\nHost: [\w\d\.-]+\r\nCache-Control: no-cache\r\nCookie: btst=[a-f\d]{32}\|[\d\.]+\|[\d\|]+; snkz=[\d\.]+\r\n\r\n detector_id: 45780
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sality"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/xs"; content:".jpg?"; content:" HTTP/1.1|0D||0A|User-Agent|3A| "; content:"|0D||0A|Host|3A| "; content:"|0D||0A|Cache-Control|3A| no-cache|0D||0A|Cookie|3A| btst="; content:"|3B| snkz="; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?[a-z\/]*\/xs\d?\.jpg\?[\da-f]{5}=\d{5,} HTTP\/1\.1\r\nUser-Agent: [^\r]+\r\nHost: [\w\d\.-]+\r\nCache-Control: no-cache\r\nCookie: btst=[a-f\d]{32}\|[\d\.]+\|[\d\|]+\; snkz=[\d\.]+\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045780; rev:788;)

# Command&Control: (Trojan) Kuluoz - regex: to_server:POST /[A-F\d]{42} HTTP.*Accept: \*/\*\r\nContent-Type: application/x-www-form-urlencoded\r\nUser-Agent: .*\r\nHost: [\d\.]+\r\nContent-Length: 312\r\nCache-Control: no-cache.*[\x00-\x1f\x80-\xff]{3} detector_id: 45798
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Kuluoz"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:" HTTP"; content:"Accept|3A| |2A|/|2A||0D||0A|Content-Type|3A| application/x-www-form-urlencoded|0D||0A|User-Agent|3A| "; content:"|0D||0A|Host|3A| "; content:"|0D||0A|Content-Length|3A| 312|0D||0A|Cache-Control|3A| no-cache"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[A-F\d]{42} HTTP.*Accept: \*\/\*\r\nContent-Type: application\/x-www-form-urlencoded\r\nUser-Agent: .*\r\nHost: [\d\.]+\r\nContent-Length: 312\r\nCache-Control: no-cache.*[\x00-\x1f\x80-\xff]{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045798; rev:791;)

# Command&Control: (Trojan) Taidoor - regex: to_server:GET /parse\.jsp\?[a-z]{2}=[a-z]{6}(?=[A-F]{0,11}\d)[\dA-F]{12} HTTP detector_id: 45799
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Taidoor"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/parse.jsp?"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/parse\.jsp\?[a-z]{2}=[a-z]{6}(?=[A-F]{0,11}\d)[\dA-F]{12} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045799; rev:791;)

# Command&Control: (Trojan) Taidoor - regex: to_server:GET /user\.jsp\?[a-z]{2}=[a-z]{6}(?=[A-F]{0,11}\d)[\dA-F]{12} HTTP detector_id: 45800
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Taidoor"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/user.jsp?"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/user\.jsp\?[a-z]{2}=[a-z]{6}(?=[A-F]{0,11}\d)[\dA-F]{12} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045800; rev:791;)

# Command&Control: (Trojan) GenericTrojan_155 - regex: to_server:POST / HTTP.*0=[\d\.]+&1=[A-F\d]{26}&2=[A-F\d]{6}&3=(?=[A-F]{0,75}\d)[A-F\d]{76}&4=[\d\.]+&5=\d+&6=[A-F\d]{8} detector_id: 45801
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_155"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ HTTP"; content:"0="; content:"&1="; content:"&2="; content:"&3="; content:"&4="; content:"&5="; content:"&6="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ HTTP.*0=[\d\.]+&1=[A-F\d]{26}&2=[A-F\d]{6}&3=(?=[A-F]{0,75}\d)[A-F\d]{76}&4=[\d\.]+&5=\d+&6=[A-F\d]{8}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045801; rev:791;)

# Command&Control: (Dropper) Zlob - regex: to_server:GET /this/is/stereo/music\.php\?param=\d+;\d+;\d+ HTTP.*User-Agent: internetsecurity detector_id: 45826
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Zlob"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/this/is/stereo/music.php?param="; content:" HTTP"; content:"User-Agent|3A| internetsecurity"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/this\/is\/stereo\/music\.php\?param=\d+\;\d+\;\d+ HTTP.*User-Agent: internetsecurity/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045826; rev:792;)

# Command&Control: (Trojan) Taidoor - regex: to_server:GET /login\.jsp\?[a-z]{2}=[a-z]{6}(?=[A-F]{0,11}\d)[\dA-F]{12} HTTP  detector_id: 45827
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Taidoor"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/login.jsp?"; content:" HTTP "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/login\.jsp\?[a-z]{2}=[a-z]{6}(?=[A-F]{0,11}\d)[\dA-F]{12} HTTP /"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045827; rev:792;)

# Command&Control: (Virus) Alman - regex: to_server:GET /[a-z]+\.asp\?action=post&HD=[\dA-F]{32}&OT=\d&IV=[\d\.]+&AV=\d HTTP detector_id: 45835
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Virus) Alman"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".asp?action=post&HD="; content:"&OT="; content:"&IV="; content:"&AV="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]+\.asp\?action=post&HD=[\dA-F]{32}&OT=\d&IV=[\d\.]+&AV=\d HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045835; rev:794;)

# Adware: (Downware) Artemis - regex: to_server:GET /m1/.*\?mainver=[\d\.]+&popver=[\d\.]+&xmlver=\d+.*User-Agent: hello crazyk detector_id: 45844
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Artemis"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/m1/"; content:"?mainver="; content:"&popver="; content:"&xmlver="; content:"User-Agent|3A| hello crazyk"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/m1\/.*\?mainver=[\d\.]+&popver=[\d\.]+&xmlver=\d+.*User-Agent: hello crazyk/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045844; rev:794;)

# Adware: (Toolbar) MultiPlug - regex: to_server:GET /sync/.*\?q=.*&rmbs=1&jsoncallback=getjson HTTP detector_id: 45845
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) MultiPlug"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/sync/"; content:"?q="; content:"&rmbs=1&jsoncallback=getjson HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/sync\/.*\?q=.*&rmbs=1&jsoncallback=getjson HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045845; rev:794;)

# Adware: (Downware) Outbrowse - regex: to_server:GET //offers/DynamicOfferScreen\?offerid=\d+&productid=\d+&distid=\d+&leadp=\d+&dfb=\d&hb=\d&external=\d& HTTP detector_id: 45846
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Outbrowse"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"//offers/DynamicOfferScreen?offerid="; content:"&productid="; content:"&distid="; content:"&leadp="; content:"&dfb="; content:"&hb="; content:"&external="; content:"& HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\/offers\/DynamicOfferScreen\?offerid=\d+&productid=\d+&distid=\d+&leadp=\d+&dfb=\d&hb=\d&external=\d& HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045846; rev:798;)

# Adware: (Adware) AirInstaller - regex: to_server:GET /get/launch/.*\?c=[a-f0-9]{8}-[a-f0-9]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}&m=\d+&l=\d+&b=.*&sid=.*&os=.*HTTP.*User-Agent: (Air)?Installer Detection RulesXML detector_id: 45861
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) AirInstaller"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get/launch/"; content:"?c="; content:"&m="; content:"&l="; content:"&b="; content:"&sid="; content:"&os="; content:"HTTP"; content:"User-Agent|3A| "; content:"Installer Detection RulesXML"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get\/launch\/.*\?c=[a-f0-9]{8}-[a-f0-9]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}&m=\d+&l=\d+&b=.*&sid=.*&os=.*HTTP.*User-Agent: (Air)?Installer Detection RulesXML/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045861; rev:984;)

# Adware: (Downware) Bundlore - regex: to_server:GET /offers/get(Installer|Initial)Settings\.php\?installerName=.*HTTP detector_id: 45878
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Bundlore"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/offers/get"; content:"Settings.php?installerName="; content:"HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/offers\/get(Installer|Initial)Settings\.php\?installerName=.*HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045878; rev:853;)

# Command&Control: (Dropper) Nurech - regex: to_server:GET /c\.php\?l=[A-Z]+&d=[A-Z0-9]+&ver=[0-9\.]+.* HTTP/1\.1.*User-Agent: upnp detector_id: 45879
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Nurech"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/c.php?l="; content:"&d="; content:"&ver="; content:" HTTP/1.1"; content:"User-Agent|3A| upnp"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/c\.php\?l=[A-Z]+&d=[A-Z0-9]+&ver=[0-9\.]+.* HTTP\/1\.1.*User-Agent: upnp/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045879; rev:1010;)

# Adware: (Toolbar) Conduit - regex: to_server:GET /DMResolver/ResolveByBundleID/[a-z0-9\-]+\?smallStubVersion=[0-9\.]+&sessionID=[a-z0-9\-]+&retryNumber=\d+&TrackingID=.*HTTP.*User-Agent: COMMLAYER detector_id: 45880
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Conduit"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/DMResolver/ResolveByBundleID/"; content:"?smallStubVersion="; content:"&sessionID="; content:"&retryNumber="; content:"&TrackingID="; content:"HTTP"; content:"User-Agent|3A| COMMLAYER"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/DMResolver\/ResolveByBundleID\/[a-z0-9\-]+\?smallStubVersion=[0-9\.]+&sessionID=[a-z0-9\-]+&retryNumber=\d+&TrackingID=.*HTTP.*User-Agent: COMMLAYER/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045880; rev:798;)

# Adware: (Downware) VideoDownloader  - regex: to_server:GET /GP1q\?transaction_id=[a-z0-9]+\? HTTP.*User-Agent: WebForm 1 detector_id: 45881
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) VideoDownloader "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/GP1q?transaction_id="; content:"? HTTP"; content:"User-Agent|3A| WebForm 1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/GP1q\?transaction_id=[a-z0-9]+\? HTTP.*User-Agent: WebForm 1/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045881; rev:798;)

# Adware: (Downware) Somoto - regex: to_server:GET /init/.*/[a-z0-9]+\?v=[0-9\.]+&uid=[a-z0-9]+&muid=[A-Z0-9]+&v1=.* detector_id: 45898
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Somoto"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/init/"; content:"?v="; content:"&uid="; content:"&muid="; content:"&v1="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/init\/.*\/[a-z0-9]+\?v=[0-9\.]+&uid=[a-z0-9]+&muid=[A-Z0-9]+&v1=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045898; rev:799;)

# Command&Control: (Virus) Alman - regex: to_server:GET /info\.asp\?action=update&version=\d+ detector_id: 45912
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Virus) Alman"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/info.asp?action=update&version="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/info\.asp\?action=update&version=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045912; rev:800;)

# Command&Control: (Clickbot) Clikug - regex: to_server:POST /instlog/ver/\d+/sid/\d+ HTTP.*message= detector_id: 45913
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Clickbot) Clikug"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/instlog/ver/"; content:"/sid/"; content:" HTTP"; content:"message="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/instlog\/ver\/\d+\/sid\/\d+ HTTP.*message=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045913; rev:800;)

# Command&Control: (Clickbot) Clikug - regex: to_server:GET /precheck/\?supp=\d+ HTTP detector_id: 45914
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Clickbot) Clikug"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/precheck/?supp="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/precheck\/\?supp=\d+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045914; rev:800;)

# Adware: (Downware) Zyczu - regex: to_server:GET /get\.php\?id=[a-zA-Z0-9]+&bit=\d+.*HTTP.*User-Agent: ZDM/1\.0 detector_id: 45973
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Zyczu"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get.php?id="; content:"&bit="; content:"HTTP"; content:"User-Agent|3A| ZDM/1.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get\.php\?id=[a-zA-Z0-9]+&bit=\d+.*HTTP.*User-Agent: ZDM\/1\.0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045973; rev:807;)

# Command&Control: (Trojan) GenericTrojan_156 - regex: to_server:GET /bts/e/.*?(t=\d+|id=\d+) HTTP detector_id: 45974
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_156"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bts/e/"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bts\/e\/.*?(t=\d+|id=\d+) HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045974; rev:807;)

# Adware: (Downware) Somoto - regex: to_server:GET /.*/.*/.*\?v=2\.1&uid=[0-9a-f]+&muid=[0-9A-F]+ HTTP detector_id: 45975
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Somoto"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?v=2.1&uid="; content:"&muid="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\/.*\/.*\?v=2\.1&uid=[0-9a-f]+&muid=[0-9A-F]+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045975; rev:807;)

# Command&Control: (Trojan) Carberp - regex: to_server:GET /stat\?uid=\d+&downlink=\d+&uplink=\d+&id=.*&statpass=.*&version=\d+&features=\d+&guid=.*&comment=.*&p=\d+&s= HTTP detector_id: 45976
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Carberp"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/stat?uid="; content:"&downlink="; content:"&uplink="; content:"&id="; content:"&statpass="; content:"&version="; content:"&features="; content:"&guid="; content:"&comment="; content:"&p="; content:"&s= HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/stat\?uid=\d+&downlink=\d+&uplink=\d+&id=.*&statpass=.*&version=\d+&features=\d+&guid=.*&comment=.*&p=\d+&s= HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1045976; rev:808;)

# Command&Control: (Virus) Jadtre - regex: to_server:GET /announce\?info_hash=.*&peer_id=.*&port=\d+&uploaded=\d+&downloaded=\d+&left=\d+(&event=[a-z]+)?&compact=\d+&numwant=\d+&no_peer_id=\d+ HTTP.*User-Agent: dolit detector_id: 46200
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Virus) Jadtre"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/announce?info_hash="; content:"&peer_id="; content:"&port="; content:"&uploaded="; content:"&downloaded="; content:"&left="; content:"&compact="; content:"&numwant="; content:"&no_peer_id="; content:" HTTP"; content:"User-Agent|3A| dolit"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/announce\?info_hash=.*&peer_id=.*&port=\d+&uploaded=\d+&downloaded=\d+&left=\d+(&event=[a-z]+)?&compact=\d+&numwant=\d+&no_peer_id=\d+ HTTP.*User-Agent: dolit/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1046200; rev:873;)

# Adware: (Downware) hicrazyk - regex: to_server:GET /setup/\?name=[a-z0-9]+\.exe(&mac=[A-Z\-0-9]+)?(&md5=[a-z0-9]+)?&ini=[a-z0-9]+\.ini&v=[0-9\.]+.*HTTP.*User-Agent: NSISDL/1\.2 \(Mozilla\) detector_id: 46283
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) hicrazyk"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/setup/?name="; content:".exe"; content:"&ini="; content:".ini&v="; content:"HTTP"; content:"User-Agent|3A| NSISDL/1.2 |28|Mozilla|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/setup\/\?name=[a-z0-9]+\.exe(&mac=[A-Z\-0-9]+)?(&md5=[a-z0-9]+)?&ini=[a-z0-9]+\.ini&v=[0-9\.]+.*HTTP.*User-Agent: NSISDL\/1\.2 \(Mozilla\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1046283; rev:842;)

# Adware: (Downware) AdMonetizer InstallMonetizer - regex: to_server:POST /FCL_Co_remote(_v\d)?\.php.*HTTP.*User-Agent: NSIS_Inetc \(Mozilla\).*from=.*&type=.*&pubid=\d+&CbId=\d+&mgu=.*&BundleVersionID=.* detector_id: 46295
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) AdMonetizer InstallMonetizer"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/FCL_Co_remote"; content:".php"; content:"HTTP"; content:"User-Agent|3A| NSIS_Inetc |28|Mozilla|29|"; content:"from="; content:"&type="; content:"&pubid="; content:"&CbId="; content:"&mgu="; content:"&BundleVersionID="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/FCL_Co_remote(_v\d)?\.php.*HTTP.*User-Agent: NSIS_Inetc \(Mozilla\).*from=.*&type=.*&pubid=\d+&CbId=\d+&mgu=.*&BundleVersionID=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1046295; rev:1012;)

#  - regex: to_server:GET /entrance\?s1=[a-z\dA-Z]{320,360}.* detector_id: 46412
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/entrance?s1="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/entrance\?s1=[a-z\dA-Z]{320,360}.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1046412; rev:853;)

# Adware: (Adware) InstallBrain - regex: to_server:POST /service/stats\.php\?sv=\d+.*\x0d\x0a\x0d\x0a\xe3\x5a detector_id: 46420
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) InstallBrain"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/service/stats.php?sv="; content:"|0D||0A||0D||0A||E3|Z"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/service\/stats\.php\?sv=\d+.*\x0d\x0a\x0d\x0a\xe3\x5a/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1046420; rev:854;)

# Adware: (Downware) GenericDownware_6 - regex: to_server:GET /start_v2\.php\?p=[a-z]+&pid=\d*&tid=\d*&sid=\d* HTTP.*User-Agent: NSISDL/1\.2 \(Mozilla\) detector_id: 46480
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) GenericDownware_6"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/start_v2.php?p="; content:"&pid="; content:"&tid="; content:"&sid="; content:" HTTP"; content:"User-Agent|3A| NSISDL/1.2 |28|Mozilla|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/start_v2\.php\?p=[a-z]+&pid=\d*&tid=\d*&sid=\d* HTTP.*User-Agent: NSISDL\/1\.2 \(Mozilla\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1046480; rev:873;)

# Adware: (Downware) AnyProtect - regex: to_server:GET \/r\?_=\d+(&|&amp;)pid=[\d-]+(&|&amp;)evt=[A-Za-z0-9:_]+(&|&amp;)v=[\d-]+ HTTP detector_id: 46481
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) AnyProtect"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/r?_="; content:"pid="; content:"evt="; content:"v="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/r\?_=\d+(&|&amp\;)pid=[\d-]+(&|&amp\;)evt=[A-Za-z0-9:_]+(&|&amp\;)v=[\d-]+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1046481; rev:873;)

# Adware: (Downware) Widoman - regex: to_server:GET /installer/get/\?language=[a-z]{2}&os=.*&admin=1&av=[a-zA-Z0-9\-]&v=\d+&ref=[a-zA-Z0-9\.]&source=[a-z0-9]+ HTTP detector_id: 46482
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Widoman"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/installer/get/?language="; content:"&os="; content:"&admin=1&av="; content:"&v="; content:"&ref="; content:"&source="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/installer\/get\/\?language=[a-z]{2}&os=.*&admin=1&av=[a-zA-Z0-9\-]&v=\d+&ref=[a-zA-Z0-9\.]&source=[a-z0-9]+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1046482; rev:873;)

# Fake-AV: WinWebSec - regex: to_server:GET /api/stats/debug/\d+/\?ts=[a-f0-9]+&token=.*&group=.*&nid=[A-F0-9]+&lid=\d+&ver=\d+&affid=\d+ HTTP detector_id: 46483
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Fake-AV: WinWebSec"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/api/stats/debug/"; content:"/?ts="; content:"&token="; content:"&group="; content:"&nid="; content:"&lid="; content:"&ver="; content:"&affid="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/stats\/debug\/\d+\/\?ts=[a-f0-9]+&token=.*&group=.*&nid=[A-F0-9]+&lid=\d+&ver=\d+&affid=\d+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1046483; rev:873;)

# Adware: (Toolbar) Fralimbo - regex: to_server:GET /fp\?alpha=.{100,} HTTP.*User-Agent: NSIS_Inetc \(Mozilla\) detector_id: 46520
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Fralimbo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/fp?alpha="; content:" HTTP"; content:"User-Agent|3A| NSIS_Inetc |28|Mozilla|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/fp\?alpha=.{100,} HTTP.*User-Agent: NSIS_Inetc \(Mozilla\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1046520; rev:884;)

# Adware: (Downware) Zona - regex: to_server:GET /getActiveCampaigns\?userId=[A-Z0-9-]+&pid=\d+&appId=\d+ HTTP.*User-Agent: httpget detector_id: 46559
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Zona"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/getActiveCampaigns?userId="; content:"&pid="; content:"&appId="; content:" HTTP"; content:"User-Agent|3A| httpget"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/getActiveCampaigns\?userId=[A-Z0-9-]+&pid=\d+&appId=\d+ HTTP.*User-Agent: httpget/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1046559; rev:896;)

# Command&Control: (Trojan) Bladabindi - regex: to_server:GET /[A-Za-z\d]+\.(txt|exe)\?gu=[A-Za-z\d-]+&e=\d+&n=[a-f\d]+ HTTP/1\.1\r\nHost: [a-z0-9]+\.gulfup\.com\r\nConnection: Keep-Alive\r\n\r\n detector_id: 46560
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bladabindi"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?gu="; content:"&e="; content:"&n="; content:" HTTP/1.1|0D||0A|Host|3A| "; content:".gulfup.com|0D||0A|Connection|3A| Keep-Alive|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[A-Za-z\d]+\.(txt|exe)\?gu=[A-Za-z\d-]+&e=\d+&n=[a-f\d]+ HTTP\/1\.1\r\nHost: [a-z0-9]+\.gulfup\.com\r\nConnection: Keep-Alive\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1046560; rev:1010;)

# Command&Control: (Android) Boxer - regex: to_server:POST /newlog\.php HTTP.*User-Agent: Apache-HttpClient/UNAVAILABLE \(java 1\.4\).*name=[a-f0-9]{100} detector_id: 46577
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Android) Boxer"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/newlog.php HTTP"; content:"User-Agent|3A| Apache-HttpClient/UNAVAILABLE |28|java 1.4|29|"; content:"name="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/newlog\.php HTTP.*User-Agent: Apache-HttpClient\/UNAVAILABLE \(java 1\.4\).*name=[a-f0-9]{100}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1046577; rev:900;)

# Command&Control: (Trojan) Msposer - regex: to_server:GET /web/PopWinParam\.asp\?d=\d+&mainver=[0-9\.]+&popver=[0-9\.]+&xmlver=\d+ detector_id: 46578
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Msposer"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/web/PopWinParam.asp?d="; content:"&mainver="; content:"&popver="; content:"&xmlver="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/web\/PopWinParam\.asp\?d=\d+&mainver=[0-9\.]+&popver=[0-9\.]+&xmlver=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1046578; rev:900;)

# Adware: (Toolbar) iBryte - regex: to_server:GET /o/[a-zA-Z0-9]+/.*\.exe\?mode=[a-z]+&sf=\d+&filedescription=.*subid=.*user_id=[0-9a-z\-]+.*thankYouUrl=.*HTTP.*User-Agent: d detector_id: 46579
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) iBryte"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/o/"; content:".exe?mode="; content:"&sf="; content:"&filedescription="; content:"subid="; content:"user_id="; content:"thankYouUrl="; content:"HTTP"; content:"User-Agent|3A| d"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/o\/[a-zA-Z0-9]+\/.*\.exe\?mode=[a-z]+&sf=\d+&filedescription=.*subid=.*user_id=[0-9a-z\-]+.*thankYouUrl=.*HTTP.*User-Agent: d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1046579; rev:1010;)

# Command&Control: (Trojan) Msposer - regex: to_server:GET /stat/\?(v=.)?&ac=.*&name=.*&mac=[0-9A-Fa-f\-]{17}&md5=[0-9a-f]{32} detector_id: 46580
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Msposer"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/stat/?"; content:"&ac="; content:"&name="; content:"&mac="; content:"&md5="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/stat\/\?(v=.)?&ac=.*&name=.*&mac=[0-9A-Fa-f\-]{17}&md5=[0-9a-f]{32}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1046580; rev:900;)

# Command&Control: (Trojan) Androm - regex: to_server:POST .*\.php HTTP\/1\.1\x0d\x0aCache-Control: no-cache\x0d\x0aConnection: close\x0d\x0aPragma: no-cache\x0d\x0aContent-Type: application/x-www-form-urlencoded\x0d\x0aUser-Agent: Mozilla\/4\.0\x0d\x0aContent-Length: \d+\x0d\x0aHost: .*\x0d\x0a\x0d\x0a[a-zA-Z\d\+\/]+[=]{0,2} detector_id: 46617
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Androm"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP/1.1|0D||0A|Cache-Control|3A| no-cache|0D||0A|Connection|3A| close|0D||0A|Pragma|3A| no-cache|0D||0A|Content-Type|3A| application/x-www-form-urlencoded|0D||0A|User-Agent|3A| Mozilla/4.0|0D||0A|Content-Length|3A| "; content:"|0D||0A|Host|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php HTTP\/1\.1\x0d\x0aCache-Control: no-cache\x0d\x0aConnection: close\x0d\x0aPragma: no-cache\x0d\x0aContent-Type: application\/x-www-form-urlencoded\x0d\x0aUser-Agent: Mozilla\/4\.0\x0d\x0aContent-Length: \d+\x0d\x0aHost: .*\x0d\x0a\x0d\x0a[a-zA-Z\d\+\/]+[=]{0,2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1046617; rev:914;)

# Command&Control: (Trojan) Androm - regex: to_server:POST .*\.php HTTP\/1\.1\x0d\x0aContent-Type: application/x-www-form-urlencoded\x0d\x0aConnection: close\x0d\x0aUser-Agent: Mozilla\/4\.0\x0d\x0aHost: .*\x0d\x0aContent-Length: \d+\x0d\x0aCache-Control: no-cache\x0d\x0aPragma: no-cache\x0d\x0a\x0d\x0a[a-zA-Z\d\+\/]+[=]{0,2} detector_id: 46618
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Androm"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP/1.1|0D||0A|Content-Type|3A| application/x-www-form-urlencoded|0D||0A|Connection|3A| close|0D||0A|User-Agent|3A| Mozilla/4.0|0D||0A|Host|3A| "; content:"|0D||0A|Content-Length|3A| "; content:"|0D||0A|Cache-Control|3A| no-cache|0D||0A|Pragma|3A| no-cache|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php HTTP\/1\.1\x0d\x0aContent-Type: application\/x-www-form-urlencoded\x0d\x0aConnection: close\x0d\x0aUser-Agent: Mozilla\/4\.0\x0d\x0aHost: .*\x0d\x0aContent-Length: \d+\x0d\x0aCache-Control: no-cache\x0d\x0aPragma: no-cache\x0d\x0a\x0d\x0a[a-zA-Z\d\+\/]+[=]{0,2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1046618; rev:914;)

# Adware: (Downloader) CostMin - regex: to_server:GET /\?e=[a-z0-9]+&clsb=\d+(&sfx=\d+)?&(prv=.*&publisher=\d+|publisher=\d+&prv=.*)&hid=\d+&cht=\d+&dcu=\d+&cpatch=\d+&dcs=\d+&pf=\d+(&dd=\+)? detector_id: 50173
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downloader) CostMin"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?e="; content:"&clsb="; content:"&hid="; content:"&cht="; content:"&dcu="; content:"&cpatch="; content:"&dcs="; content:"&pf="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?e=[a-z0-9]+&clsb=\d+(&sfx=\d+)?&(prv=.*&publisher=\d+|publisher=\d+&prv=.*)&hid=\d+&cht=\d+&dcu=\d+&cpatch=\d+&dcs=\d+&pf=\d+(&dd=\+)?/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050173; rev:1014;)

# Command&Control: (Trojan) Potukorp - regex: to_server:POST /count\.asp HTTP.*os=[a-zA-Z0-9\-]+&userid=.*&mac=[a-zA-Z0-9\-_]+&ver=\d+&ip=[0-9\.]{7,15} detector_id: 50174
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Potukorp"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/count.asp HTTP"; content:"os="; content:"&userid="; content:"&mac="; content:"&ver="; content:"&ip="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/count\.asp HTTP.*os=[a-zA-Z0-9\-]+&userid=.*&mac=[a-zA-Z0-9\-_]+&ver=\d+&ip=[0-9\.]{7,15}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050174; rev:960;)

# Command&Control: (Banker) Bancos - regex: to_server:GET /[a-z]{5}\.asp\?action=[a-z]+&username=.*&ip=[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+ HTTP.*User-Agent: vb   wininet detector_id: 50335
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Bancos"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".asp?action="; content:"&username="; content:"&ip="; content:" HTTP"; content:"User-Agent|3A| vb   wininet"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{5}\.asp\?action=[a-z]+&username=.*&ip=[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+ HTTP.*User-Agent: vb   wininet/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050335; rev:982;)

# Adware: (Downware) AirInstaller - regex: to_server:GET /get/event/\?name=started_with_admin&data\[click_id\]=.*HTTP.*User-Agent: AirInstaller Event detector_id: 50344
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) AirInstaller"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get/event/?name=started_with_admin&data|5B|click_id|5D|="; content:"HTTP"; content:"User-Agent|3A| AirInstaller Event"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get\/event\/\?name=started_with_admin&data\[click_id\]=.*HTTP.*User-Agent: AirInstaller Event/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050344; rev:984;)

# Command&Control: (Trojan) SquareNet - regex: to_server:GET /entry/exe/runinfo\?ref=\d+&site_id=\d+&mac=[A-Z0-9]+&step=dblclick&crc=.*HTTP.*User-Agent: wget detector_id: 50345
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) SquareNet"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/entry/exe/runinfo?ref="; content:"&site_id="; content:"&mac="; content:"&step=dblclick&crc="; content:"HTTP"; content:"User-Agent|3A| wget"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/entry\/exe\/runinfo\?ref=\d+&site_id=\d+&mac=[A-Z0-9]+&step=dblclick&crc=.*HTTP.*User-Agent: wget/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050345; rev:984;)

# Command&Control: (Trojan) KillAV - regex: to_server:GET /iplookup/iplookup\.php\?format=json HTTP.*User-Agent: NSIS_Inetc \(Mozilla\) detector_id: 50346
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) KillAV"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/iplookup/iplookup.php?format=json HTTP"; content:"User-Agent|3A| NSIS_Inetc |28|Mozilla|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/iplookup\/iplookup\.php\?format=json HTTP.*User-Agent: NSIS_Inetc \(Mozilla\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050346; rev:1002;)

# Adware: (Downware) OneInstaller - regex: to_server:POST /installer/\?dl=\d HTTP.*User-Agent: NSIS_Inetc \(Mozilla\).*geturl=\d&name=.*&img=.*&url=.*&version=.*&id=.*& detector_id: 50347
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) OneInstaller"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/installer/?dl="; content:" HTTP"; content:"User-Agent|3A| NSIS_Inetc |28|Mozilla|29|"; content:"geturl="; content:"&name="; content:"&img="; content:"&url="; content:"&version="; content:"&id="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/installer\/\?dl=\d HTTP.*User-Agent: NSIS_Inetc \(Mozilla\).*geturl=\d&name=.*&img=.*&url=.*&version=.*&id=.*&/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050347; rev:984;)

# Command&Control: (Trojan) Emogen - regex: to_server:GET /i/ini\?date=\d+&cid=\d+&id=\d+ HTTP.*User-Agent: NSIS_Inetc \(Mozilla\) detector_id: 50348
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Emogen"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/i/ini?date="; content:"&cid="; content:"&id="; content:" HTTP"; content:"User-Agent|3A| NSIS_Inetc |28|Mozilla|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/i\/ini\?date=\d+&cid=\d+&id=\d+ HTTP.*User-Agent: NSIS_Inetc \(Mozilla\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050348; rev:984;)

# Adware: (Downware) InstallCore - regex: to_server:GET /cmd/report\.php\?vid=[a-z]+&iv=v[0-9]+&PartnerId=[A-Z]+&action=ourStarted&program=.*&origen=.*&ua=[a-z]+&pmd5=.*&installer=\d.*HTTP.*User-Agent: NSIS_ToolkitOffers \(Mozilla\) detector_id: 50349
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) InstallCore"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cmd/report.php?vid="; content:"&iv=v"; content:"&PartnerId="; content:"&action=ourStarted&program="; content:"&origen="; content:"&ua="; content:"&pmd5="; content:"&installer="; content:"HTTP"; content:"User-Agent|3A| NSIS_ToolkitOffers |28|Mozilla|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cmd\/report\.php\?vid=[a-z]+&iv=v[0-9]+&PartnerId=[A-Z]+&action=ourStarted&program=.*&origen=.*&ua=[a-z]+&pmd5=.*&installer=\d.*HTTP.*User-Agent: NSIS_ToolkitOffers \(Mozilla\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050349; rev:984;)

# Adware: (Downware) Adload - regex: to_server:GET /launch_v4\.php\?p=[a-z]+&pid=\d+&tid=\d+&b_typ=.*HTTP/1\.0.*User-Agent: NSISDL/1\.2 \(Mozilla\) detector_id: 50350
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Adload"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/launch_v4.php?p="; content:"&pid="; content:"&tid="; content:"&b_typ="; content:"HTTP/1.0"; content:"User-Agent|3A| NSISDL/1.2 |28|Mozilla|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/launch_v4\.php\?p=[a-z]+&pid=\d+&tid=\d+&b_typ=.*HTTP\/1\.0.*User-Agent: NSISDL\/1\.2 \(Mozilla\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050350; rev:984;)

# Command&Control: (Pwd Stealer) Zeus GameOver - regex: to_server:POST /update HTTP/1\.1\r\nHost: [a-z0-9\.]+\r\nAccept-Encoding:\r\nConnection: (keep alive|close)\r\nContent-Length: detector_id: 50386
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Pwd Stealer) Zeus GameOver"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/update HTTP/1.1|0D||0A|Host|3A| "; content:"|0D||0A|Accept-Encoding|3A||0D||0A|Connection|3A| "; content:"|0D||0A|Content-Length|3A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/update HTTP\/1\.1\r\nHost: [a-z0-9\.]+\r\nAccept-Encoding:\r\nConnection: (keep alive|close)\r\nContent-Length:/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050386; rev:988;)

# Adware: (Downware) 4Shared Downloader - regex: to_server:GET /at\?subId=[a-zA-Z0-9]+[%\|][a-z0-9]+ detector_id: 50409
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) 4Shared Downloader"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/at?subId="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/at\?subId=[a-zA-Z0-9]+[%\|][a-z0-9]+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050409; rev:1256;)

# Adware: (Downware) VOPackage - regex: to_server:GET /vuupc/dl\.php\?rr=[a-zA-Z0-9]+&sct=[A-Z]+&data=[a-z0-9]+&r=.*&prm=.*HTTP.*User-Agent: NSIS_Inetc \(Mozilla\) detector_id: 50410
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) VOPackage"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/vuupc/dl.php?rr="; content:"&sct="; content:"&data="; content:"&r="; content:"&prm="; content:"HTTP"; content:"User-Agent|3A| NSIS_Inetc |28|Mozilla|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/vuupc\/dl\.php\?rr=[a-zA-Z0-9]+&sct=[A-Z]+&data=[a-z0-9]+&r=.*&prm=.*HTTP.*User-Agent: NSIS_Inetc \(Mozilla\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050410; rev:994;)

# Adware: (Downloader) CostMin - regex: to_server:GET /\?e=cost\d?&clsb=\d&publisher=\d+&prv=[a-zA-Z]+&sfx=\d&hid=.* detector_id: 50411
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downloader) CostMin"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?e=cost"; content:"&clsb="; content:"&publisher="; content:"&prv="; content:"&sfx="; content:"&hid="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?e=cost\d?&clsb=\d&publisher=\d+&prv=[a-zA-Z]+&sfx=\d&hid=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050411; rev:1014;)

# Command&Control: (Trojan) Carbanak - regex: to_server:POST .*Content-Disposition: form-data; name="upload"; filename="outlook\.cab" detector_id: 50412
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Carbanak"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"Content-Disposition|3A| form-data|3B| name=|22|upload|22||3B| filename=|22|outlook.cab|22|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*Content-Disposition: form-data\; name="upload"\; filename="outlook\.cab"/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050412; rev:2138;)

# Adware: (Downware) SwiftBrowse - regex: to_server:POST /rs HTTP.*User-Agent: NSIS_Inetc \(Mozilla\).*alpha=.+ detector_id: 50413
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) SwiftBrowse"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/rs HTTP"; content:"User-Agent|3A| NSIS_Inetc |28|Mozilla|29|"; content:"alpha="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/rs HTTP.*User-Agent: NSIS_Inetc \(Mozilla\).*alpha=.+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050413; rev:994;)

# Adware: (Toolbar) iBryte - regex: to_server:GET /o/Browser_safeguard/Setup\.exe\?mode=dl(test)?&sf=\d.*&callback&browser=.*&useragent=.*HTTP detector_id: 50429
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) iBryte"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/o/Browser_safeguard/Setup.exe?mode=dl"; content:"&sf="; content:"&callback&browser="; content:"&useragent="; content:"HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/o\/Browser_safeguard\/Setup\.exe\?mode=dl(test)?&sf=\d.*&callback&browser=.*&useragent=.*HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050429; rev:996;)

# Adware: (Downware) Vittalia - regex: to_server:GET /installers/cpp_installers/get/main_out\.php\?p=.*HTTP.*User-Agent: NSIS_ToolkitOffers \(Mozilla\) detector_id: 50430
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Vittalia"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/installers/cpp_installers/get/main_out.php?p="; content:"HTTP"; content:"User-Agent|3A| NSIS_ToolkitOffers |28|Mozilla|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/installers\/cpp_installers\/get\/main_out\.php\?p=.*HTTP.*User-Agent: NSIS_ToolkitOffers \(Mozilla\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050430; rev:996;)

# Adware: (Downware) OpenCandy - regex: to_server:GET /get_file\.php\?p=.*\.exe&u={[A-F0-9\-]+}(&r=\d)? HTTP.*User-Agent: NSISDL/1\.2 \(Mozilla\) detector_id: 50457
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) OpenCandy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get_file.php?p="; content:".exe&u=|7B|"; content:" HTTP"; content:"User-Agent|3A| NSISDL/1.2 |28|Mozilla|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get_file\.php\?p=.*\.exe&u={[A-F0-9\-]+}(&r=\d)? HTTP.*User-Agent: NSISDL\/1\.2 \(Mozilla\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050457; rev:1002;)

# Adware: (Downware) MultiInstaller - regex: to_server:GET /start\?s1=[a-z0-9]{300,} HTTP.*User-Agent: Heisenberg detector_id: 50458
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) MultiInstaller"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/start?s1="; content:" HTTP"; content:"User-Agent|3A| Heisenberg"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/start\?s1=[a-z0-9]{300,} HTTP.*User-Agent: Heisenberg/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050458; rev:1002;)

# Command&Control: (Trojan) Small - regex: to_server:GET /download\?((name|size|nonce|expires|sig|hash|ip|content_type)=.*){8} detector_id: 50459
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Small"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/download?"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/download\?((name|size|nonce|expires|sig|hash|ip|content_type)=.*){8}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050459; rev:1002;)

# Command&Control: (Trojan) Upatre - regex: to_server:GET .*HTTP\/1\.1\r\nAccept: text\/\*\, application\/\*\r\nUser-Agent: Updates downloader\r\n.*Cache-Control: no-cache detector_id: 50460
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Upatre"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"HTTP/1.1|0D||0A|Accept|3A| text/|2A||2C| application/|2A||0D||0A|User-Agent|3A| Updates downloader|0D||0A|"; content:"Cache-Control|3A| no-cache"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*HTTP\/1\.1\r\nAccept: text\/\*\, application\/\*\r\nUser-Agent: Updates downloader\r\n.*Cache-Control: no-cache/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050460; rev:1004;)

# Command&Control: (Trojan) Upatre - regex: to_server:GET /tasks\?version=\d{3}&group=[a-z0-9]{5}&client=[a-z0-9]{32}&computer=.*&os=\d\.\d&latency=\d\.\d.*HTTP.*User-Agent: Microsoft-CryptoAPI/6\.1 detector_id: 50461
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Upatre"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/tasks?version="; content:"&group="; content:"&client="; content:"&computer="; content:"&os="; content:"&latency="; content:"HTTP"; content:"User-Agent|3A| Microsoft-CryptoAPI/6.1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/tasks\?version=\d{3}&group=[a-z0-9]{5}&client=[a-z0-9]{32}&computer=.*&os=\d\.\d&latency=\d\.\d.*HTTP.*User-Agent: Microsoft-CryptoAPI\/6\.1/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050461; rev:1002;)

# Adware: (Downware) Zona - regex: to_server:GET /installer\.html\?param=[a-f0-9]{50,} HTTP.*User-Agent: httpget detector_id: 50478
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Zona"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/installer.html?param="; content:" HTTP"; content:"User-Agent|3A| httpget"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/installer\.html\?param=[a-f0-9]{50,} HTTP.*User-Agent: httpget/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050478; rev:1004;)

# Adware: (Downware) SoftonicInstaller - regex: to_server:GET /\d+/universaldownloader-prefetch(\?WL=\d+)? HTTP detector_id: 50479
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) SoftonicInstaller"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/universaldownloader-prefetch"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d+\/universaldownloader-prefetch(\?WL=\d+)? HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050479; rev:1026;)

# Adware: (Installer) OpenCandy - regex: to_server:GET /fas/stat\.php\?sid=.*&tt=.*&iid=.*&pid=.*&tid=.*&st=.* detector_id: 50480
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Installer) OpenCandy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/fas/stat.php?sid="; content:"&tt="; content:"&iid="; content:"&pid="; content:"&tid="; content:"&st="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/fas\/stat\.php\?sid=.*&tt=.*&iid=.*&pid=.*&tid=.*&st=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050480; rev:1004;)

# Command&Control: (Worm) AutoRun - regex: to_server:GET .*/count\.asp\?mac=[0-9\-]+&ver=\d+&user=\d+&pc=.*&md5=[a-f0-9]+ HTTP.*User-Agent: Mozilla/4\.0 detector_id: 50481
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) AutoRun"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/count.asp?mac="; content:"&ver="; content:"&user="; content:"&pc="; content:"&md5="; content:" HTTP"; content:"User-Agent|3A| Mozilla/4.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/count\.asp\?mac=[0-9\-]+&ver=\d+&user=\d+&pc=.*&md5=[a-f0-9]+ HTTP.*User-Agent: Mozilla\/4\.0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050481; rev:1004;)

# Command&Control: (Trojan) NgrBot - regex: to_server:POST /root/image\.php.*HTTP.*User-Agent: Mozilla/4\.0\r\nContent-Type: application/x-www-form-urlencoded detector_id: 50482
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) NgrBot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/root/image.php"; content:"HTTP"; content:"User-Agent|3A| Mozilla/4.0|0D||0A|Content-Type|3A| application/x-www-form-urlencoded"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/root\/image\.php.*HTTP.*User-Agent: Mozilla\/4\.0\r\nContent-Type: application\/x-www-form-urlencoded/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050482; rev:1004;)

# Adware: (Downware) Bandoo - regex: to_server:GET /www/delivery/so/init_offer\.php\?brand_name=.* detector_id: 50483
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Bandoo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/www/delivery/so/init_offer.php?brand_name="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/www\/delivery\/so\/init_offer\.php\?brand_name=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050483; rev:1004;)

# Adware: (Downware) Vittalia - regex: to_server:GET /cmd/(api|geo|log|report)\.php.*HTTP.*User-Agent: NSIS_ToolkitOffers \(Mozilla\) detector_id: 50484
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Vittalia"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cmd/"; content:".php"; content:"HTTP"; content:"User-Agent|3A| NSIS_ToolkitOffers |28|Mozilla|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cmd\/(api|geo|log|report)\.php.*HTTP.*User-Agent: NSIS_ToolkitOffers \(Mozilla\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050484; rev:1004;)

# Adware: (Downware) TinyDownloadManager - regex: to_server:GET /rating/\?action=get&url=.*User-Agent: TinyDownloadManager* detector_id: 50536
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) TinyDownloadManager"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/rating/?action=get&url="; content:"User-Agent|3A| TinyDownloadManage"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/rating\/\?action=get&url=.*User-Agent: TinyDownloadManager*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050536; rev:1012;)

# Adware: (Toolbar) Conduit - regex: to_server:GET /MainOffer/\d+/\?CurrentStep=\d&TotalSteps=\d&DMVersion=[0-9\.]+&IsSmartCustomFrame=[a-z]+&Language= detector_id: 50537
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Conduit"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/MainOffer/"; content:"/?CurrentStep="; content:"&TotalSteps="; content:"&DMVersion="; content:"&IsSmartCustomFrame="; content:"&Language="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/MainOffer\/\d+\/\?CurrentStep=\d&TotalSteps=\d&DMVersion=[0-9\.]+&IsSmartCustomFrame=[a-z]+&Language=/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050537; rev:1012;)

# Adware: (Downware) 4shared Download Manager - regex: to_server:GET /trackcnt/[A-Za-z0-9]+/\?data=[A-Z0-9]+ HTTP detector_id: 50538
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) 4shared Download Manager"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/trackcnt/"; content:"/?data="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/trackcnt\/[A-Za-z0-9]+\/\?data=[A-Z0-9]+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050538; rev:1012;)

# Adware: (Downware) AdMonetizer InstallMonetizer - regex: to_server:POST /FCL_Co_v\d\.php HTTP.*User-Agent: NSIS_Inetc \(Mozilla\).*from=.*&type=.*&BundleVersionID=.* detector_id: 50539
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) AdMonetizer InstallMonetizer"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/FCL_Co_v"; content:".php HTTP"; content:"User-Agent|3A| NSIS_Inetc |28|Mozilla|29|"; content:"from="; content:"&type="; content:"&BundleVersionID="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/FCL_Co_v\d\.php HTTP.*User-Agent: NSIS_Inetc \(Mozilla\).*from=.*&type=.*&BundleVersionID=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050539; rev:1012;)

# Command&Control: (Pwd Stealer) Zeus Gameover - regex: to_server:POST /write HTTP/1\.1\r\nHost: default\r\nAccept-Encoding:\r\nConnection: [^\r]+\r\nContent-Length: \d{2,}\r\n(X-ID: \d+)? detector_id: 50540
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Pwd Stealer) Zeus Gameover"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/write HTTP/1.1|0D||0A|Host|3A| default|0D||0A|Accept-Encoding|3A||0D||0A|Connection|3A| "; content:"|0D||0A|Content-Length|3A| "; content:"|0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/write HTTP\/1\.1\r\nHost: default\r\nAccept-Encoding:\r\nConnection: [^\r]+\r\nContent-Length: \d{2,}\r\n(X-ID: \d+)?/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050540; rev:1180;)

# Adware: (Toolbar) Wajam - regex: to_server:GET /install/valid?v=\d&unique_id=[A-Z0-9]{32} detector_id: 50541
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Wajam"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/install/vali"; content:"v="; content:"&unique_id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/install\/valid?v=\d&unique_id=[A-Z0-9]{32}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050541; rev:1012;)

# Command&Control: (Trojan) Symmi - regex: to_server:GET /index\.php\?email=.*&method=post HTTP/1\.0 detector_id: 50542
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Symmi"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?email="; content:"&method=post HTTP/1.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\?email=.*&method=post HTTP\/1\.0/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050542; rev:1012;)

# Command&Control: (Trojan) Scar - regex: to_server:GET /config2\.asp\?id=[A-Z0-9]{8} HTTP/1\.1\r\nUser-Agent: Mozilla/4\.0.*Connection: close\r\nHost: detector_id: 50564
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Scar"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/config2.asp?id="; content:" HTTP/1.1|0D||0A|User-Agent|3A| Mozilla/4.0"; content:"Connection|3A| close|0D||0A|Host|3A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/config2\.asp\?id=[A-Z0-9]{8} HTTP\/1\.1\r\nUser-Agent: Mozilla\/4\.0.*Connection: close\r\nHost:/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050564; rev:1016;)

# Command&Control: (Trojan) Fareit - regex: to_server:POST /skysteal/skygate\.php HTTP/1\.0 detector_id: 50565
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fareit"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/skysteal/skygate.php HTTP/1.0"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/skysteal\/skygate\.php HTTP\/1\.0/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050565; rev:1016;)

# Command&Control: (Trojan) Quervar - regex: to_server:GET .*\?[a-zA-Z\d]{8}&pin=[A-F\d]{16} HTTP.*Accept: \*/\*\r\nAccept-Encoding: gzip, deflate\r\nUser-Agent: Mozilla/4\.0 detector_id: 50566
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Quervar"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"&pin="; content:" HTTP"; content:"Accept|3A| |2A|/|2A||0D||0A|Accept-Encoding|3A| gzip|2C| deflate|0D||0A|User-Agent|3A| Mozilla/4.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\?[a-zA-Z\d]{8}&pin=[A-F\d]{16} HTTP.*Accept: \*\/\*\r\nAccept-Encoding: gzip, deflate\r\nUser-Agent: Mozilla\/4\.0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050566; rev:1016;)

# Command&Control: (Trojan) Buzus - regex: to_server:GET /config2\.asp\?id=[A-F0-9]{8} HTTP.*User-Agent: Mozilla/4\.0 .* detector_id: 50574
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Buzus"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/config2.asp?id="; content:" HTTP"; content:"User-Agent|3A| Mozilla/4.0 "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/config2\.asp\?id=[A-F0-9]{8} HTTP.*User-Agent: Mozilla\/4\.0 .*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050574; rev:1018;)

# Command&Control: (Trojan) Android.FakeInstaller - regex: to_server:POST /[a-z]+/index\.php HTTP.*User-Agent: Apache-HttpClient/UNAVAILABLE.*0=[a-z]+(&\d=.*){9}&.* detector_id: 50575
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Android.FakeInstaller"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/index.php HTTP"; content:"User-Agent|3A| Apache-HttpClient/UNAVAILABLE"; content:"0="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]+\/index\.php HTTP.*User-Agent: Apache-HttpClient\/UNAVAILABLE.*0=[a-z]+(&\d=.*){9}&.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050575; rev:1018;)

# Command&Control: (Trojan) SecretSpy - regex: to_server:POST /monitor/app/serverside/android_api.php\?mName=[a-zA-Z]+Information&format=json HTTP detector_id: 50576
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) SecretSpy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/monitor/app/serverside/android_api"; content:"php?mName="; content:"Information&format=json HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/monitor\/app\/serverside\/android_api.php\?mName=[a-zA-Z]+Information&format=json HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050576; rev:1018;)

# Command&Control: (Trojan) ZBot - regex: to_server:POST /x0rz/edit\.php HTTP detector_id: 50577
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/x0rz/edit.php HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/x0rz\/edit\.php HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050577; rev:1018;)

# Command&Control: (Trojan) Ice IX - regex: to_server:POST /.+\.php HTTP.*bn1=[A-Z0-9_\-]+&sk1=[A-Z0-9]{32} detector_id: 50647
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ice IX"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"bn1="; content:"&sk1="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.+\.php HTTP.*bn1=[A-Z0-9_\-]+&sk1=[A-Z0-9]{32}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050647; rev:1030;)

# Command&Control: (Trojan) Zusy - regex: to_server:GET /default2.aspx\?guid=[a-z0-9\-]{36}&gate=\d&good=\-?\d&bad=\-?\d&unlucky=\-?\d&ip=.*&fn=.* detector_id: 50648
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zusy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/default2"; content:"aspx?guid="; content:"&gate="; content:"&good="; content:"&bad="; content:"&unlucky="; content:"&ip="; content:"&fn="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/default2.aspx\?guid=[a-z0-9\-]{36}&gate=\d&good=\-?\d&bad=\-?\d&unlucky=\-?\d&ip=.*&fn=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050648; rev:1030;)

# Command&Control: (Android Trojan) Android.CardServ - regex: to_server:POST /shua/index\.php\?s=.*&wifi=\d HTTP.*softid=.*&post=.*&header=.* detector_id: 50672
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Android Trojan) Android.CardServ"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/shua/index.php?s="; content:"&wifi="; content:" HTTP"; content:"softid="; content:"&post="; content:"&header="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/shua\/index\.php\?s=.*&wifi=\d HTTP.*softid=.*&post=.*&header=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050672; rev:1038;)

# Command&Control: (Android Trojan) SpyBanker - regex: to_server:POST /[a-z]/\d+ HTTP.*Content-Length: 1844.*content=[a-zA-Z0-9]{300,} detector_id: 50673
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Android Trojan) SpyBanker"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:" HTTP"; content:"Content-Length|3A| 1844"; content:"content="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]\/\d+ HTTP.*Content-Length: 1844.*content=[a-zA-Z0-9]{300,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050673; rev:1038;)

# Command&Control: (Trojan) Android.SMSSend - regex: to_server:POST /.*\.php\?info=([a-zA-Z0-9]+)=?=? HTTP.*info=\1 detector_id: 50803
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Android.SMSSend"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php?info="; content:" HTTP"; content:"info="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\.php\?info=([a-zA-Z0-9]+)=?=? HTTP.*info=\1/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050803; rev:1054;)

# Adware: (Downware) Verti - regex: to_server:POST /.*\?nexcb=[a-z\d]{8}-[a-z\d]{4}-[a-z\d]{4}-[a-z\d]{4}-[a-z\d]{12} detector_id: 50804
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Verti"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"?nexcb="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\?nexcb=[a-z\d]{8}-[a-z\d]{4}-[a-z\d]{4}-[a-z\d]{4}-[a-z\d]{12}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050804; rev:1054;)

# Adware: (Adware) Android.Utchi - regex: to_server:GET /zt/zt\.jsp\?k=\d+&c=\d+&sdk=\d+&sv=\d+&n=\d+&m=i-\d+& detector_id: 50805
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Android.Utchi"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/zt/zt.jsp?k="; content:"&c="; content:"&sdk="; content:"&sv="; content:"&n="; content:"&m=i-"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/zt\/zt\.jsp\?k=\d+&c=\d+&sdk=\d+&sv=\d+&n=\d+&m=i-\d+&/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050805; rev:1054;)

# Adware: (Downware) InstallMonster - regex: to_server:POST /api/index HTTP/1\.0.*User-Agent: Mozilla/3\.0 \(compatible; Indy Library\) detector_id: 50806
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) InstallMonster"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/api/index HTTP/1.0"; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/index HTTP\/1\.0.*User-Agent: Mozilla\/3\.0 \(compatible\; Indy Library\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050806; rev:1054;)

# Adware: (Riskware) MediaMagnet - regex: to_server:GET /download/vk/\?cs=.*&u=.*&audio=.*&song=.* detector_id: 50996
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Riskware) MediaMagnet"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/download/vk/?cs="; content:"&u="; content:"&audio="; content:"&song="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/download\/vk\/\?cs=.*&u=.*&audio=.*&song=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050996; rev:1072;)

# Adware: (Downware) Graftor - regex: to_server:GET /download/altBlankNet2\.dat(\?version=[0-9\.]+)+ HTTP detector_id: 50997
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Graftor"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/download/altBlankNet2.dat"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/download\/altBlankNet2\.dat(\?version=[0-9\.]+)+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050997; rev:1072;)

# Command&Control: (Dropper) GenericDropper_113 - regex: to_server:GET /333 HTTP.*UA-CPU: detector_id: 51047
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_113"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/333 HTTP"; content:"UA-CPU|3A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/333 HTTP.*UA-CPU:/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051047; rev:1082;)

# Adware: (Downware) MediaMagnet - regex: to_server:POST /api/v\d\.\d\.\d/target/get_rules HTTP.*filterProfile=.*&place_id=.*&values=.* detector_id: 51060
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) MediaMagnet"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/api/v"; content:"/target/get_rules HTTP"; content:"filterProfile="; content:"&place_id="; content:"&values="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/v\d\.\d\.\d\/target\/get_rules HTTP.*filterProfile=.*&place_id=.*&values=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051060; rev:1084;)

# Adware: (Downware) SwiftBrowse - regex: to_server:GET /bed\?bet=\d+ HTTP.*User-Agent: NSIS_Inetc \(Mozilla\) detector_id: 51062
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) SwiftBrowse"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bed?bet="; content:" HTTP"; content:"User-Agent|3A| NSIS_Inetc |28|Mozilla|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bed\?bet=\d+ HTTP.*User-Agent: NSIS_Inetc \(Mozilla\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051062; rev:1084;)

# Command&Control: (Trojan) Dridex - regex: to_server:POST [a-zA-Z0-9\/]{40,} HTTP/1\.1\r\nContent-Length: 59\r\nHost: \d+\.\d+\.\d+\.\d+\r\n\r\n detector_id: 51081
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Dridex"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:" HTTP/1.1|0D||0A|Content-Length|3A| 59|0D||0A|Host|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?[a-zA-Z0-9\/]{40,} HTTP\/1\.1\r\nContent-Length: 59\r\nHost: \d+\.\d+\.\d+\.\d+\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051081; rev:1086;)

# Command&Control: (Downloader) Banload - regex: to_server:POST /triton/coisa\.php HTTP/1.0.*User-Agent: Mozilla/4\.0 \(compatible; Synapse\).*00 detector_id: 51151
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Downloader) Banload"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/triton/coisa.php HTTP/1"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| Synapse|29|"; content:"00"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/triton\/coisa\.php HTTP\/1.0.*User-Agent: Mozilla\/4\.0 \(compatible\; Synapse\).*00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051151; rev:1100;)

# Command&Control: (Dropper) Upatre - regex: to_server:GET /.*\.tar HTTP.*User-Agent: [A-Za-z0-9]+\r\n detector_id: 51179
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Upatre"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".tar HTTP"; content:"User-Agent|3A| "; content:"|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\.tar HTTP.*User-Agent: [A-Za-z0-9]+\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051179; rev:1104;)

# Command&Control: (Dropper) Generic - regex: to_server:POST /sabata/sabata1/file\.php HTTP/1\.1 detector_id: 51206
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Generic"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/sabata/sabata1/file.php HTTP/1.1"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/sabata\/sabata1\/file\.php HTTP\/1\.1/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051206; rev:1110;)

# Command&Control: (Trojan) Virut_2 - regex: to_server:GET /cgi-bin/[a-z0-9]+\.cgi(\?action=[a-z]+&qq=[a-z]+)? HTTP.*User-Agent: linkrunner detector_id: 51207
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Virut_2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cgi-bin/"; content:".cgi"; content:" HTTP"; content:"User-Agent|3A| linkrunner"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cgi-bin\/[a-z0-9]+\.cgi(\?action=[a-z]+&qq=[a-z]+)? HTTP.*User-Agent: linkrunner/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051207; rev:1110;)

# Command&Control: (Dropper) AutoIt - regex: to_server:POST /includes/Archive/vensu/secure\.php HTTP/1\.1 detector_id: 51208
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) AutoIt"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/includes/Archive/vensu/secure.php HTTP/1.1"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/includes\/Archive\/vensu\/secure\.php HTTP\/1\.1/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051208; rev:1110;)

# Command&Control: (Trojan) Vawtrak - regex: to_server:POST /handlers/[0-9a-f]+/data/[0-9a-f]+/[0-9a-f]{8}\?id=[0-9a-f]+ detector_id: 51230
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Vawtrak"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/handlers/"; content:"/data/"; content:"?id="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/handlers\/[0-9a-f]+\/data\/[0-9a-f]+\/[0-9a-f]{8}\?id=[0-9a-f]+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051230; rev:1112;)

# Command&Control: (Trojan) Bicololo - regex: to_server:GET /zayats/podoxdfdf/\d{2,3} HTTP/1.1 detector_id: 51253
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bicololo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/zayats/podoxdfdf/"; content:" HTTP/1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/zayats\/podoxdfdf\/\d{2,3} HTTP\/1.1/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051253; rev:1114;)

# Adware: (Flooder) VTFlooder - regex: to_server:POST /md5\.php HTTP/1\.1\r\nUser-Agent: Mozilla/5\.0\r\nHost: vtboss\.yolox\.net\r\nContent-Length: 32 detector_id: 51266
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Flooder) VTFlooder"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/md5.php HTTP/1.1|0D||0A|User-Agent|3A| Mozilla/5.0|0D||0A|Host|3A| vtboss.yolox.net|0D||0A|Content-Length|3A| 32"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/md5\.php HTTP\/1\.1\r\nUser-Agent: Mozilla\/5\.0\r\nHost: vtboss\.yolox\.net\r\nContent-Length: 32/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051266; rev:1118;)

# Command&Control: (Android) PremiumText - regex: to_server:GET /api/ads2\?d=.*&imei=[a-z0-9]+&imsi=[a-z0-9]+&lat=\d+\.\d+&lng=\d+\.\d+ HTTP detector_id: 51268
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Android) PremiumText"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/api/ads2?d="; content:"&imei="; content:"&imsi="; content:"&lat="; content:"&lng="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/ads2\?d=.*&imei=[a-z0-9]+&imsi=[a-z0-9]+&lat=\d+\.\d+&lng=\d+\.\d+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051268; rev:1118;)

# Adware: (Installer) InstallBrain - regex: to_server:POST /events HTTP/1\.1\r\nX-Token: [0-9a-f]{32}\r\nX-Hash: [0-9a-f]{40}\r\n.*\r\n\r\n{"timestamp":".*","action": detector_id: 51305
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Installer) InstallBrain"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/events HTTP/1.1|0D||0A|X-Token|3A| "; content:"|0D||0A|X-Hash|3A| "; content:"|0D||0A|"; content:"|0D||0A||0D||0A||7B||22|timestamp|22||3A||22|"; content:"|22||2C||22|action|22||3A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/events HTTP\/1\.1\r\nX-Token: [0-9a-f]{32}\r\nX-Hash: [0-9a-f]{40}\r\n.*\r\n\r\n{"timestamp":".*","action":/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051305; rev:1124;)

# Command&Control: (Android) Opfake - regex: to_server:POST /rq\.php HTTP.*User-Agent: Apache-HttpClient/UNAVAILABLE \(java 1\.4\).*\r\n\r\nname=.* detector_id: 51306
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Android) Opfake"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/rq.php HTTP"; content:"User-Agent|3A| Apache-HttpClient/UNAVAILABLE |28|java 1.4|29|"; content:"|0D||0A||0D||0A|name="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/rq\.php HTTP.*User-Agent: Apache-HttpClient\/UNAVAILABLE \(java 1\.4\).*\r\n\r\nname=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051306; rev:1124;)

# Test for Giancarlo - regex: to_server:GET /shamalaia\.html HTTP detector_id: 51589
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Test for Giancarlo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/shamalaia.html HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/shamalaia\.html HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051589; rev:1141;)

# Command&Control: (Trojan) XSLCmd - regex: to_server:POST compose\.aspx\?s\=[A-Z0-9]{47} HTTP.*Referer: http://(?P<myhost>[^/]+)/.*Host: (?P=myhost) detector_id: 51590
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) XSLCmd"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"compose.aspx?s="; content:" HTTP"; content:"Referer|3A| http|3A|//"; content:"Host|3A| "; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?compose\.aspx\?s\=[A-Z0-9]{47} HTTP.*Referer: http:\/\/(?P<myhost>[^\/]+)\/.*Host: (?P=myhost)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051590; rev:1137;)

# Adware: (Adware) SunriseBrowse - regex: to_server:GET /idz\?crc=[a-z0-9]{8} HTTP/1\.1 detector_id: 51648
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) SunriseBrowse"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/idz?crc="; content:" HTTP/1.1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/idz\?crc=[a-z0-9]{8} HTTP\/1\.1/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051648; rev:1304;)

# Command&Control: (Trojan) Rovnix - regex: to_server:GET /usdeclar\.txt.*Host: constitution\.org detector_id: 51649
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Rovnix"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/usdeclar.txt"; content:"Host|3A| constitution.org"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/usdeclar\.txt.*Host: constitution\.org/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051649; rev:1153;)

# Command&Control: (Trojan) Rovnix - regex: to_server:POST /(t|d|c)[a-z]{6,9}\.php\?[a-z]{4,9}=[a-zA-Z0-9\+/]{100,}={0,2} HTTP detector_id: 51651
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Rovnix"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php?"; content:" HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(t|d|c)[a-z]{6,9}\.php\?[a-z]{4,9}=[a-zA-Z0-9\+\/]{100,}={0,2} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051651; rev:1153;)

# Command&Control: (Trojan) Rovnix - regex: to_server:POST /task\.php\?version=[0-9]+&user=.*&server=[0-9]+&id=[0-9]+&crc=[a-z0-9]+ detector_id: 51653
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Rovnix"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/task.php?version="; content:"&user="; content:"&server="; content:"&id="; content:"&crc="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/task\.php\?version=[0-9]+&user=.*&server=[0-9]+&id=[0-9]+&crc=[a-z0-9]+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051653; rev:1153;)

# Command&Control: (Trojan) Chepro - regex: to_server:GET .*conta\.php\?chave=[A-Za-z0-9]+&url=.*HTTP.*User-Agent: Mozilla/3\.0 \(compatible; Indy Library\) detector_id: 51654
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Chepro"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"conta.php?chave="; content:"&url="; content:"HTTP"; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*conta\.php\?chave=[A-Za-z0-9]+&url=.*HTTP.*User-Agent: Mozilla\/3\.0 \(compatible\; Indy Library\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051654; rev:1153;)

# Command&Control: (Trojan) Sinowal - regex: to_server:GET .*/ld/.*\.php\?id=.*&n=.*&try=.* HTTP detector_id: 51655
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sinowal"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ld/"; content:".php?id="; content:"&n="; content:"&try="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/ld\/.*\.php\?id=.*&n=.*&try=.* HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051655; rev:1153;)

# Command&Control: (Dropper) Zusy - regex: to_server:GET /a\?id=h1&v=201\d{12}&a=.*&b=.* HTTP detector_id: 51661
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Zusy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/a?id=h1&v=201"; content:"&a="; content:"&b="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/a\?id=h1&v=201\d{12}&a=.*&b=.* HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051661; rev:1155;)

# Adware: (Downloader) NSIS - regex: to_server:GET /gt3\?srcid=.*&srcname=.*&bao=\d+ HTTP detector_id: 51662
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downloader) NSIS"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/gt3?srcid="; content:"&srcname="; content:"&bao="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/gt3\?srcid=.*&srcname=.*&bao=\d+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051662; rev:1155;)

# Command&Control: (Trojan) Zeus Gameover - regex: to_server:POST /updatec HTTP/1\.1\r\nHost: [^\n]+\r\nAccept-Encoding:\r\nConnection: (close|keep-alive)\r\nContent-Length: \d{2,}\r\n\r\n detector_id: 51663
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zeus Gameover"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/updatec HTTP/1.1|0D||0A|Host|3A| "; content:"|0D||0A|Accept-Encoding|3A||0D||0A|Connection|3A| "; content:"|0D||0A|Content-Length|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/updatec HTTP\/1\.1\r\nHost: [^\n]+\r\nAccept-Encoding:\r\nConnection: (close|keep-alive)\r\nContent-Length: \d{2,}\r\n\r\n/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051663; rev:1259;)

# Command&Control: (Trojan) Drolnx - regex: to_server:GET /code\.php\?mode=[a-z]+&usr=[a-z0-9A-Z=]+&cb=[a-z0-9A-Z=]{100,} HTTP detector_id: 51664
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Drolnx"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/code.php?mode="; content:"&usr="; content:"&cb="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/code\.php\?mode=[a-z]+&usr=[a-z0-9A-Z=]+&cb=[a-z0-9A-Z=]{100,} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051664; rev:1155;)

# Command&Control: (Trojan) BlackEnergy - regex: to_server:POST /(YXJyYWtpczAy|aG91c2VhdHJlaWRlczk0|QmFzaGFyb2Z0aGVTYXJkYXVrYXJz|U2FsdXNhU2VjdW5kdXMy|ZXBzaWxvbmVyaWRhbmkw)/.*HTTP detector_id: 51681
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) BlackEnergy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(YXJyYWtpczAy|aG91c2VhdHJlaWRlczk0|QmFzaGFyb2Z0aGVTYXJkYXVrYXJz|U2FsdXNhU2VjdW5kdXMy|ZXBzaWxvbmVyaWRhbmkw)\/.*HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051681; rev:1157;)

# Command&Control: (Backdoor) Houdini - regex: to_server:POST .*User-Agent: [0-9A-F]{8}\<\|\>.{1,63}\<\|\>.{1,63}\<\|\>.{1,63}\<\|\>.{0,63}\<\|\>.{1,63}\<\|\>(false|true) -  detector_id: 51689
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Houdini"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"User-Agent|3A| "; content:"<|7C|>"; content:"<|7C|>"; content:"<|7C|>"; content:"<|7C|>"; content:"<|7C|>"; content:"<|7C|>"; content:" - "; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*User-Agent: [0-9A-F]{8}\<\|\>.{1,63}\<\|\>.{1,63}\<\|\>.{1,63}\<\|\>.{0,63}\<\|\>.{1,63}\<\|\>(false|true) - /s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051689; rev:1157;)

# Command&Control: (Dropper) Generic Dropper - regex: to_server:GET /down/\d{4}/.*\.exe HTTP detector_id: 51877
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Generic Dropper"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/down/"; content:".exe HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/down\/\d{4}\/.*\.exe HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051877; rev:1164;)

# Adware: (Downware) AdMonetizer InstallMonetizer - regex: to_server:POST /FCL_Co.*\.php HTTP.*User-Agent: NSIS_Inetc.*from=.*&type=.*&pubid=.*&CbId= detector_id: 51879
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) AdMonetizer InstallMonetizer"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/FCL_Co"; content:".php HTTP"; content:"User-Agent|3A| NSIS_Inetc"; content:"from="; content:"&type="; content:"&pubid="; content:"&CbId="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/FCL_Co.*\.php HTTP.*User-Agent: NSIS_Inetc.*from=.*&type=.*&pubid=.*&CbId=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051879; rev:1164;)

# Command&Control: (Trojan) Zusy - regex: to_server:POST /[a-z0-9]{13}/ HTTP/1\.0\r\nHost: [a-z]{12}\.ru\r\nContent-Length: \d{3}\r\n\r\n detector_id: 51881
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zusy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ HTTP/1.0|0D||0A|Host|3A| "; content:".ru|0D||0A|Content-Length|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z0-9]{13}\/ HTTP\/1\.0\r\nHost: [a-z]{12}\.ru\r\nContent-Length: \d{3}\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051881; rev:1164;)

# Command&Control: (Trojan) Asprox - regex: to_server:POST /(index\.php|[a-zA-Z0-9]+) HTTP/1\.1\r\nAccept: \*/\*\r\nContent-Type: application/x-www-form-urlencoded\r\nUser-Agent: Mozilla/5\.0 \(Windows NT 6\.1; WOW64; rv:28\.0\) Gecko/20100101 Firefox/28\.0\r\nHost: .*\r\nContent-Length: \d+\r\nCache-Control: no-cache\r\n\r\n\x80\x00\x00\x00 detector_id: 51916
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Asprox"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:" HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|Content-Type|3A| application/x-www-form-urlencoded|0D||0A|User-Agent|3A| Mozilla/5.0 |28|Windows NT 6.1|3B| WOW64|3B| rv|3A|28.0|29| Gecko/20100101 Firefox/28.0|0D||0A|Host|3A| "; content:"|0D||0A|Content-Length|3A| "; content:"|0D||0A|Cache-Control|3A| no-cache|0D||0A||0D||0A||80||00||00||00|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(index\.php|[a-zA-Z0-9]+) HTTP\/1\.1\r\nAccept: \*\/\*\r\nContent-Type: application\/x-www-form-urlencoded\r\nUser-Agent: Mozilla\/5\.0 \(Windows NT 6\.1\; WOW64\; rv:28\.0\) Gecko\/20100101 Firefox\/28\.0\r\nHost: .*\r\nContent-Length: \d+\r\nCache-Control: no-cache\r\n\r\n\x80\x00\x00\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051916; rev:1178;)

# Command&Control: (Trojan) Sofacy - regex: to_server:POST /(webhp|watch|search|find|results|open|search|close)/?\?.*ai=[a-zA-Z0-9\-_=]{25,}.* HTTP detector_id: 51917
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sofacy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"ai="; content:" HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(webhp|watch|search|find|results|open|search|close)\/?\?.*ai=[a-zA-Z0-9\-_=]{25,}.* HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051917; rev:1166;)

# Command&Control: (PwdStealer) ZeuS Gameover - regex: to_server:GET / HTTP/1\.1\r\nAccept: \*/\*\r\nAccept-Language: (en-US|en-us)\r\nUser-Agent: Mozilla/4\.0 \(compatible; MSIE[^\r]+\r\nHost: [a-z]{18,30}\.[a-z]{3,4}\r\nConnection: Close\r\n\r\n detector_id: 51918
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (PwdStealer) ZeuS Gameover"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|Accept-Language|3A| "; content:"|0D||0A|User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE"; content:"|0D||0A|Host|3A| "; content:"|0D||0A|Connection|3A| Close|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ HTTP\/1\.1\r\nAccept: \*\/\*\r\nAccept-Language: (en-US|en-us)\r\nUser-Agent: Mozilla\/4\.0 \(compatible\; MSIE[^\r]+\r\nHost: [a-z]{18,30}\.[a-z]{3,4}\r\nConnection: Close\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051918; rev:1166;)

# Command&Control: (Trojan) Android.FakeInstaller - regex: to_server:POST /comlog\.php\?command=.*&phone=\d{11,15} HTTP.*alldata=.* detector_id: 52085
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Android.FakeInstaller"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/comlog.php?command="; content:"&phone="; content:" HTTP"; content:"alldata="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/comlog\.php\?command=.*&phone=\d{11,15} HTTP.*alldata=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052085; rev:1170;)

# Command&Control: (PwdStealer) Citadel - regex: to_server:POST /[a-zA-Z0-9]+/file\.php HTTP.*Accept: \*/\*.*User-Agent: Mozilla/4\.0 \(compatible; MSIE.*Content-Length: 128\r\n detector_id: 52086
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (PwdStealer) Citadel"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/file.php HTTP"; content:"Accept|3A| |2A|/|2A|"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE"; content:"Content-Length|3A| 128|0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-zA-Z0-9]+\/file\.php HTTP.*Accept: \*\/\*.*User-Agent: Mozilla\/4\.0 \(compatible\; MSIE.*Content-Length: 128\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052086; rev:1170;)

# Command&Control: (Trojan) Asprox - regex: to_server:POST /[A-F0-9]{42} HTTP/1\.1\r\nAccept: \*/\*\r\nContent-Type: multipart/form-data; boundary=[^\r]+\r\nContent-Length: \d+\r\nUser-Agent: Mozilla/5\.0[^\r]+\r\nHost: [0-9\.]+:\d+\r\nCache-Control: no-cache\r\n\r\n detector_id: 52179
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Asprox"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:" HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|Content-Type|3A| multipart/form-data|3B| boundary="; content:"|0D||0A|Content-Length|3A| "; content:"|0D||0A|User-Agent|3A| Mozilla/5.0"; content:"|0D||0A|Host|3A| "; content:"|0D||0A|Cache-Control|3A| no-cache|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[A-F0-9]{42} HTTP\/1\.1\r\nAccept: \*\/\*\r\nContent-Type: multipart\/form-data\; boundary=[^\r]+\r\nContent-Length: \d+\r\nUser-Agent: Mozilla\/5\.0[^\r]+\r\nHost: [0-9\.]+:\d+\r\nCache-Control: no-cache\r\n\r\n/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052179; rev:1178;)

# Adware: (Downware) Amonetize - regex: to_server:POST /tdownload\.php HTTP.*version=.*&s1=[a-z0-9]{40}&t1=\d{10}&prefix=amisetup\d{4} detector_id: 52180
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Amonetize"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/tdownload.php HTTP"; content:"version="; content:"&s1="; content:"&t1="; content:"&prefix=amisetup"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/tdownload\.php HTTP.*version=.*&s1=[a-z0-9]{40}&t1=\d{10}&prefix=amisetup\d{4}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052180; rev:1178;)

# Command&Control: (Trojan) Android.SMSStealer - regex: to_server:GET /api/aq\?q=[a-zA-Z0-9_\-]{192} HTTP/1\.1 detector_id: 52181
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Android.SMSStealer"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/api/aq?q="; content:" HTTP/1.1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/aq\?q=[a-zA-Z0-9_\-]{192} HTTP\/1\.1/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052181; rev:1178;)

# Command&Control: (Trojan) Symmi - regex: to_server:GET /index\.php\?email=.*&method=post&len HTTP/1\.0\r\nAccept[^\r]+\r\nConnection: close\r\nHost detector_id: 52182
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Symmi"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?email="; content:"&method=post&len HTTP/1.0|0D||0A|Accept"; content:"|0D||0A|Connection|3A| close|0D||0A|Host"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\?email=.*&method=post&len HTTP\/1\.0\r\nAccept[^\r]+\r\nConnection: close\r\nHost/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052182; rev:1178;)

# Command&Control: (Trojan) Zbot - regex: to_server:POST .*\.php HTTP/1.\d\r\nAccept: \*/\*\r\nUser-Agent: Mozilla[^\r]+\r\nHost: [^\r]+\r\nContent-Length: \d{3,}\r\nConnection: [^\r]+\r\nCache-Control: no-cache\r\n\r\n detector_id: 52317
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zbot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP/1"; content:"|0D||0A|Accept|3A| |2A|/|2A||0D||0A|User-Agent|3A| Mozilla"; content:"|0D||0A|Host|3A| "; content:"|0D||0A|Content-Length|3A| "; content:"|0D||0A|Connection|3A| "; content:"|0D||0A|Cache-Control|3A| no-cache|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php HTTP\/1.\d\r\nAccept: \*\/\*\r\nUser-Agent: Mozilla[^\r]+\r\nHost: [^\r]+\r\nContent-Length: \d{3,}\r\nConnection: [^\r]+\r\nCache-Control: no-cache\r\n\r\n/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052317; rev:1180;)

# Command&Control: (Downloader) OxyPumper - regex: to_server:GET /api/(firewalloff|virprotectoff|keywordexecute)/[a-z0-9]{32}/\d{7}/ detector_id: 52339
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Downloader) OxyPumper"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/api/"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/(firewalloff|virprotectoff|keywordexecute)\/[a-z0-9]{32}\/\d{7}\//"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052339; rev:1182;)

# Command&Control: (Trojan) Sofacy - regex: to_server:GET /(webhp|watch|search|find|results|open|search|close)/?\?.*&ai=[a-zA-Z0-9\-_=]{25,}(&| ).*HTTP detector_id: 52360
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sofacy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"&ai="; content:"HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(webhp|watch|search|find|results|open|search|close)\/?\?.*&ai=[a-zA-Z0-9\-_=]{25,}(&| ).*HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052360; rev:1184;)

# Adware: (Adware) CloverPlus - regex: to_server:GET /ssi/[a-z]{3}\.php\?pid=defapp&cid=\d{12} HTTP detector_id: 52362
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) CloverPlus"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ssi/"; content:".php?pid=defapp&cid="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ssi\/[a-z]{3}\.php\?pid=defapp&cid=\d{12} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052362; rev:1184;)

# Adware: (Downware) MiniDownloader - regex: to_server:GET /fc/downer/v\d\.\d/FCPacker\.exe\?time=\d{10} HTTP/1\.1 detector_id: 52719
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) MiniDownloader"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/fc/downer/v"; content:"/FCPacker.exe?time="; content:" HTTP/1.1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/fc\/downer\/v\d\.\d\/FCPacker\.exe\?time=\d{10} HTTP\/1\.1/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052719; rev:1192;)

# Adware: (Adware) DomaIQ - regex: to_server:GET /www/delivery/ajs\.php\?zoneid=\d+&cb=\d+&charset=.*&loc=.* detector_id: 52720
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) DomaIQ"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/www/delivery/ajs.php?zoneid="; content:"&cb="; content:"&charset="; content:"&loc="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/www\/delivery\/ajs\.php\?zoneid=\d+&cb=\d+&charset=.*&loc=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052720; rev:1192;)

# Command&Control: (Trojan) Dridex - regex: to_server:POST [^ ]{40,} HTTP/1\.1\r\nHost\x3a\x20\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}(:\d{1,5})?\r\nConnection: Close\r\nUser-Agent: Mozilla/5\.0[^\r]+\r\nContent-Type: octet/binary\r\nAccept: \*\/\*\r\nAccept-Language: [^\r]+\r\n(Content-Encoding: gzip\r\n)?Content-Length: \d+\r\n\r\n detector_id: 52721
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Dridex"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:" HTTP/1.1|0D||0A|Host|3A| "; content:"|0D||0A|Connection|3A| Close|0D||0A|User-Agent|3A| Mozilla/5.0"; content:"|0D||0A|Content-Type|3A| octet/binary|0D||0A|Accept|3A| |2A|/|2A||0D||0A|Accept-Language|3A| "; content:"|0D||0A|"; content:"Content-Length|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?[^ ]{40,} HTTP\/1\.1\r\nHost\x3a\x20\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}(:\d{1,5})?\r\nConnection: Close\r\nUser-Agent: Mozilla\/5\.0[^\r]+\r\nContent-Type: octet\/binary\r\nAccept: \*\/\*\r\nAccept-Language: [^\r]+\r\n(Content-Encoding: gzip\r\n)?Content-Length: \d+\r\n\r\n/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052721; rev:1192;)

# Command&Control: (Dropper) Further Reminder - regex: to_server:GET /doc/\d.exe HTTP.*Host: \d+\.\d+\.\d+\.\d+:8080.* detector_id: 52724
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Further Reminder"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/doc/"; content:"exe HTTP"; content:"Host|3A| "; content:"|3A|8080"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/doc\/\d.exe HTTP.*Host: \d+\.\d+\.\d+\.\d+:8080.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052724; rev:1192;)

# Command&Control: (Trojan) Fareit - regex: to_server:POST /.*\.php HTTP/1\.0(?:(\r\nConnection: close|\r\nContent-Type: application/octet-stream|\r\nContent-Encoding: binary)){3} detector_id: 52725
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fareit"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP/1.0"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\.php HTTP\/1\.0(?:(\r\nConnection: close|\r\nContent-Type: application\/octet-stream|\r\nContent-Encoding: binary)){3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052725; rev:1192;)

# Adware: (Downware) SoftPulse - regex: to_server:POST /[a-z0-9]{112} HTTP/1\.1\r\nUser-Agent: dBrowser \d CallGetResponse:\d detector_id: 52727
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) SoftPulse"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:" HTTP/1.1|0D||0A|User-Agent|3A| dBrowser "; content:" CallGetResponse|3A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z0-9]{112} HTTP\/1\.1\r\nUser-Agent: dBrowser \d CallGetResponse:\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052727; rev:1236;)

#  Adware: (Downware) Solimba - regex: to_server:GET /s/app\.min\.css\?\d{10} HTTP detector_id: 52848
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS  Adware: (Downware) Solimba"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/s/app.min.css?"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/s\/app\.min\.css\?\d{10} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052848; rev:1210;)

# Adware: (Downware) DownloadGuide - regex: to_server:POST /1/dg/3 HTTP/1\.1.*{"BuildId":.*"Client".*"DlgVersion".*"Culture".*"LocalTime".*} detector_id: 52849
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) DownloadGuide"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/1/dg/3 HTTP/1.1"; content:"|7B||22|BuildId|22||3A|"; content:"|22|Client|22|"; content:"|22|DlgVersion|22|"; content:"|22|Culture|22|"; content:"|22|LocalTime|22|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/1\/dg\/3 HTTP\/1\.1.*{"BuildId":.*"Client".*"DlgVersion".*"Culture".*"LocalTime".*}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052849; rev:1210;)

# Command&Control: (Trojan) Karba - regex: to_server:GET /bin/read_i\.php\?a1=step2.*&a2=.*&a3=.*&a4=.* HTTP detector_id: 52857
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Karba"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bin/read_i.php?a1=step2"; content:"&a2="; content:"&a3="; content:"&a4="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bin\/read_i\.php\?a1=step2.*&a2=.*&a3=.*&a4=.* HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052857; rev:1222;)

# Command&Control: (Trojan) WireLurker - regex: to_server:GET /mac_log/\?appid=[A-Z0-9]{12}.*HTTP/1\.1 detector_id: 52943
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) WireLurker"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mac_log/?appid="; content:"HTTP/1.1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mac_log\/\?appid=[A-Z0-9]{12}.*HTTP\/1\.1/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052943; rev:1222;)

# Command&Control: (Trojan) WireLurker - regex: to_server:GET /mac/get(version|soft)\.php\?sn=[A-Z0-9]{12} HTTP/1\.1 detector_id: 52944
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) WireLurker"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mac/get"; content:".php?sn="; content:" HTTP/1.1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mac\/get(version|soft)\.php\?sn=[A-Z0-9]{12} HTTP\/1\.1/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052944; rev:1222;)

# Command&Control: (Trojan) Rovnix - regex: to_server:GET /(t|d|c)(?!ownload)(?!ounterdb)[a-z]{6,9}\.php\?[a-z]{4,9}=[a-zA-Z0-9\+/]{100,}={0,2} HTTP detector_id: 52961
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Rovnix"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(t|d|c)(?!ownload)(?!ounterdb)[a-z]{6,9}\.php\?[a-z]{4,9}=[a-zA-Z0-9\+\/]{100,}={0,2} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052961; rev:1224;)

# Adware: (Adware) PopAd - regex: to_server:GET /c_log\.php\?dis_idx=\d{1,2}&type=[A-Z]{2}&kind=[A-Z]&mac=(\d{2}-){5}\d{2} HTTP detector_id: 52962
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) PopAd"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/c_log.php?dis_idx="; content:"&type="; content:"&kind="; content:"&mac="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/c_log\.php\?dis_idx=\d{1,2}&type=[A-Z]{2}&kind=[A-Z]&mac=(\d{2}-){5}\d{2} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052962; rev:1232;)

# Command&Control: (Trojan) Injector - regex: to_server:POST /login\.php\?([a-z]{2,4}=.*){1,3} HTTP.*[a-z]{1,2}=.{3}AA[a-zA-Z0-9/+]{300,} detector_id: 52963
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Injector"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/login.php?"; content:" HTTP"; content:"AA"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/login\.php\?([a-z]{2,4}=.*){1,3} HTTP.*[a-z]{1,2}=.{3}AA[a-zA-Z0-9\/+]{300,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052963; rev:1232;)

# Adware: (Adware) SmartInstaller - regex: to_server:POST /index\.php/api/updater-status HTTP.*uuid=[a-z0-9]{8}-([a-z0-9]{4}-){3}[a-z0-9]{12}&status=\d&version=\d{2} detector_id: 53099
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) SmartInstaller"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/index.php/api/updater-status HTTP"; content:"uuid="; content:"&status="; content:"&version="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\/api\/updater-status HTTP.*uuid=[a-z0-9]{8}-([a-z0-9]{4}-){3}[a-z0-9]{12}&status=\d&version=\d{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053099; rev:1232;)

# Adware: (Riskware) OptimizerPro - regex: to_server:GET .*\?sid=.*&dt=.*&gid=.*&tz=.*&ln=1&lc=0&bis=0&bief=0&biefx=0&bif=0&os=.*&f=.*HTTP.*User-Agent: Mozilla/3\.0 \(compatible; Indy Library\) detector_id: 52988
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Riskware) OptimizerPro"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?sid="; content:"&dt="; content:"&gid="; content:"&tz="; content:"&ln=1&lc=0&bis=0&bief=0&biefx=0&bif=0&os="; content:"&f="; content:"HTTP"; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\?sid=.*&dt=.*&gid=.*&tz=.*&ln=1&lc=0&bis=0&bief=0&biefx=0&bif=0&os=.*&f=.*HTTP.*User-Agent: Mozilla\/3\.0 \(compatible\; Indy Library\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052988; rev:1232;)

# Command&Control: (Trojan) Cycler - regex: to_server:GET /googleCallback\?rid=[a-z0-9]{8}-([a-z0-9]{4}-){3}[a-z0-9]{12}&isAfd=1.*Referer:.*supernetforme\.com/search\.php detector_id: 52989
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Cycler"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/googleCallback?rid="; content:"&isAfd=1"; content:"Referer|3A|"; content:"supernetforme.com/search.php"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/googleCallback\?rid=[a-z0-9]{8}-([a-z0-9]{4}-){3}[a-z0-9]{12}&isAfd=1.*Referer:.*supernetforme\.com\/search\.php/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052989; rev:1232;)

# Adware: (Downware) MiniDownloader - regex: to_server:GET /gamedownloader/\d{6}/dlpacker_ver\.txt\?time=\d{10} detector_id: 52990
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) MiniDownloader"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/gamedownloader/"; content:"/dlpacker_ver.txt?time="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/gamedownloader\/\d{6}\/dlpacker_ver\.txt\?time=\d{10}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1052990; rev:1232;)

# Command&Control: (Trojan) Sinowal - regex: to_server:GET /ld/[a-z0-9]{4}/ld\.php\?id=[A-Z0-9]{32}&n=[a-z0-9]{3}&try=\d HTTP/1\.0 detector_id: 53103
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sinowal"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ld/"; content:"/ld.php?id="; content:"&n="; content:"&try="; content:" HTTP/1.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ld\/[a-z0-9]{4}\/ld\.php\?id=[A-Z0-9]{32}&n=[a-z0-9]{3}&try=\d HTTP\/1\.0/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053103; rev:1232;)

# Command&Control: (Trojan) Vawtrak - regex: to_server:POST /forumdisplay\.php\?fid=\d{10} HTTP/1\.1.*id=[A-Z0-9]{36}&iv=\d{8}&info=[A-Z0-9]{24}&proxy= detector_id: 53104
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Vawtrak"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/forumdisplay.php?fid="; content:" HTTP/1.1"; content:"id="; content:"&iv="; content:"&info="; content:"&proxy="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/forumdisplay\.php\?fid=\d{10} HTTP\/1\.1.*id=[A-Z0-9]{36}&iv=\d{8}&info=[A-Z0-9]{24}&proxy=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053104; rev:1232;)

# Command&Control: (Trojan) Wuji - regex: to_server:GET /cpa[a-z]{1,10}\.ashx\?id=\d&r=[a-z0-9]{8}-([a-z0-9]{4}-){3}[a-z0-9]{12} detector_id: 53105
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Wuji"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cpa"; content:".ashx?id="; content:"&r="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cpa[a-z]{1,10}\.ashx\?id=\d&r=[a-z0-9]{8}-([a-z0-9]{4}-){3}[a-z0-9]{12}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053105; rev:1232;)

# Command&Control: (Trojan-Downloader) Genome - regex: to_server:GET .*\?rec_id=.*&c_id=.*&s_id=.*&update=\d HTTP.*User-Agent: DIN Synchronizer detector_id: 53106
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan-Downloader) Genome"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?rec_id="; content:"&c_id="; content:"&s_id="; content:"&update="; content:" HTTP"; content:"User-Agent|3A| DIN Synchronizer"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\?rec_id=.*&c_id=.*&s_id=.*&update=\d HTTP.*User-Agent: DIN Synchronizer/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053106; rev:1232;)

# Command&Control: (Trojan) StartPage - regex: to_server:GET /tongji\?sfid=\d+ HTTP detector_id: 53107
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) StartPage"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/tongji?sfid="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/tongji\?sfid=\d+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053107; rev:1232;)

# Adware: (Adware) SmartInstaller - regex: to_server:POST /api/(get-config|updater-status|install-status) HTTP/1\.1.*Host: (api|metrics)\.wiseinstaller\.net.*Expect: 100-continue\r\nConnection: Close detector_id: 53153
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) SmartInstaller"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/api/"; content:" HTTP/1.1"; content:"Host|3A| "; content:".wiseinstaller.net"; content:"Expect|3A| 100-continue|0D||0A|Connection|3A| Close"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/(get-config|updater-status|install-status) HTTP\/1\.1.*Host: (api|metrics)\.wiseinstaller\.net.*Expect: 100-continue\r\nConnection: Close/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053153; rev:1236;)

# Adware: (Adware) InstallMonster - regex: to_server:GET /common/gate/installer_gate_client\.php\?download_id=\d+&mode=prechecking HTTP/1\.1\r\nUser-Agent: \d+\r\nHost: installmetrix\.com detector_id: 53154
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) InstallMonster"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/common/gate/installer_gate_client.php?download_id="; content:"&mode=prechecking HTTP/1.1|0D||0A|User-Agent|3A| "; content:"|0D||0A|Host|3A| installmetrix.com"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/common\/gate\/installer_gate_client\.php\?download_id=\d+&mode=prechecking HTTP\/1\.1\r\nUser-Agent: \d+\r\nHost: installmetrix\.com/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053154; rev:1236;)

# Command&Control: (Trojan) Medfos - regex: to_server:GET /.*\?n=\d&r=[a-zA-Z0-9_]{150,} HTTP/1\.1 detector_id: 53246
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Medfos"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?n="; content:"&r="; content:" HTTP/1.1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\?n=\d&r=[a-zA-Z0-9_]{150,} HTTP\/1\.1/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053246; rev:1242;)

# Command&Control: (Trojan) Android.SMSStealer - regex: to_server:GET /api/ads\d\?d=[a-z0-9]{6}(&imei=[a-z0-9]{10}&imsi=[a-z0-9]{10}&lat=\d\.\d&lng=\d\.\d&c=\d&l=\d&cmcmn=[a-z0-9]{4})? HTTP/1\.1 detector_id: 53247
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Android.SMSStealer"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/api/ads"; content:"?d="; content:" HTTP/1.1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/ads\d\?d=[a-z0-9]{6}(&imei=[a-z0-9]{10}&imsi=[a-z0-9]{10}&lat=\d\.\d&lng=\d\.\d&c=\d&l=\d&cmcmn=[a-z0-9]{4})? HTTP\/1\.1/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053247; rev:1242;)

# Command&Control: (Backdoor) AHTBot - regex: to_server:GET /besim/botnet/kontrol\.php\?pcadi=.*&(ddos|pcadi|cmd|args|ss|indir|kaydet)=.* HTTP/1\.1 detector_id: 53248
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) AHTBot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/besim/botnet/kontrol.php?pcadi="; content:" HTTP/1.1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/besim\/botnet\/kontrol\.php\?pcadi=.*&(ddos|pcadi|cmd|args|ss|indir|kaydet)=.* HTTP\/1\.1/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053248; rev:1242;)

# Command&Control: (Trojan) Kazy - regex: to_server:GET /get_json\?stb=\d&did=\d{10}&ext_partner_id=.*&file_id=\d{9} HTTP/1\.1\r\nUser-Agent: Downloader \d\.\d detector_id: 53270
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Kazy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get_json?stb="; content:"&did="; content:"&ext_partner_id="; content:"&file_id="; content:" HTTP/1.1|0D||0A|User-Agent|3A| Downloader "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get_json\?stb=\d&did=\d{10}&ext_partner_id=.*&file_id=\d{9} HTTP\/1\.1\r\nUser-Agent: Downloader \d\.\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053270; rev:1242;)

# Command&Control: (Trojan) StartPage - regex: to_server:GET /dl/shmehao\.ini HTTP/1\.1\r\nUser-Agent: NSIS_Inetc \(Mozilla\) detector_id: 53271
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) StartPage"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/dl/shmehao.ini HTTP/1.1|0D||0A|User-Agent|3A| NSIS_Inetc |28|Mozilla|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/dl\/shmehao\.ini HTTP\/1\.1\r\nUser-Agent: NSIS_Inetc \(Mozilla\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053271; rev:1242;)

# Adware: (Adware) DomaIQ - regex: to_server:GET /[a-zA-Z0-9]{8}/[a-z]{3}\d{2}/\?site_code=[a-z]{3}&section_code=\d{3} HTTP/1\.1 detector_id: 53272
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) DomaIQ"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?site_code="; content:"&section_code="; content:" HTTP/1.1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-zA-Z0-9]{8}\/[a-z]{3}\d{2}\/\?site_code=[a-z]{3}&section_code=\d{3} HTTP\/1\.1/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053272; rev:1242;)

# Command&Control: (RAT) PlugX - regex: to_server:POST /[A-F0-9]{24} HTTP/1\.1\r\nAccept: \*/\*\r\n([A-Z0-9]+)\d: 0\r\n\1\d: 0\r\n\1\d: 61456\r\n\1\d: 1 detector_id: 53279
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (RAT) PlugX"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:" HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|"; content:"|3A| 0|0D||0A|"; content:"|3A| 0|0D||0A|"; content:"|3A| 61456|0D||0A|"; content:"|3A| 1"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[A-F0-9]{24} HTTP\/1\.1\r\nAccept: \*\/\*\r\n([A-Z0-9]+)\d: 0\r\n\1\d: 0\r\n\1\d: 61456\r\n\1\d: 1/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053279; rev:1242;)

# Command&Control: (Trojan) Emotet - regex: to_server:POST /[a-f0-9]{8}/[a-f0-9]{8}/ HTTP/1\.1.*User-Agent: Mozilla\/4\.0 \(compatible;MSIE 7\.0;Windows NT 6\.0\)\r\nHost: ([a-z]{16}\.[a-z]{2,4}|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}:8080).*Content-Length: (199|200|201) detector_id: 53280
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Emotet"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ HTTP/1.1"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B|MSIE 7.0|3B|Windows NT 6.0|29||0D||0A|Host|3A| "; content:"Content-Length|3A| "; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-f0-9]{8}\/[a-f0-9]{8}\/ HTTP\/1\.1.*User-Agent: Mozilla\/4\.0 \(compatible\;MSIE 7\.0\;Windows NT 6\.0\)\r\nHost: ([a-z]{16}\.[a-z]{2,4}|\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}:8080).*Content-Length: (199|200|201)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053280; rev:1242;)

# Command&Control: (Backdoor) Dridex - regex: to_server:POST / HTTP/1.1\r\nHost: \d+\.\d+\.\d+\.\d+\r\nConnection: Close\r\nUser-Agent: Mozilla/5.0 [^\r]+\r\nContent-Type: octet/binary\r\nAccept: \*/\*\r\nAccept-Language: q=0.8,en-US\;q=0.6,en\;q=0.4\r\nContent-Length: \d{4}\r\n\r\n detector_id: 53299
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Dridex"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ HTTP/1"; content:"1|0D||0A|Host|3A| "; content:"|0D||0A|Connection|3A| Close|0D||0A|User-Agent|3A| Mozilla/5"; content:"0 "; content:"|0D||0A|Content-Type|3A| octet/binary|0D||0A|Accept|3A| |2A|/|2A||0D||0A|Accept-Language|3A| q=0"; content:"8|2C|en-US|3B|q=0"; content:"6|2C|en|3B|q=0"; content:"4|0D||0A|Content-Length|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ HTTP\/1.1\r\nHost: \d+\.\d+\.\d+\.\d+\r\nConnection: Close\r\nUser-Agent: Mozilla\/5.0 [^\r]+\r\nContent-Type: octet\/binary\r\nAccept: \*\/\*\r\nAccept-Language: q=0.8,en-US\;q=0.6,en\;q=0.4\r\nContent-Length: \d{4}\r\n\r\n/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053299; rev:1246;)

# Command&Control: (Trojan) Spindest - regex: to_server:GET /\d{6}n\.txt HTTP/1\.1 detector_id: 53305
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Spindest"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"n.txt HTTP/1.1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d{6}n\.txt HTTP\/1\.1/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053305; rev:1248;)

# Command&Control: (Trojan) Spindest - regex: to_server:POST /\d{6}\.asp HTTP/1\.1 detector_id: 53306
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Spindest"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".asp HTTP/1.1"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d{6}\.asp HTTP\/1\.1/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053306; rev:1248;)

# Command&Control: (Dropper) Dapato - regex: to_server:GET /tongji\.asp\?sn=[a-zA-Z0-9]{20,}\.exe&tmac=\d{12}&action=.*&ver=\d\.\d HTTP/1\.1\r\nUser-Agent: LETITGO detector_id: 53307
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Dapato"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/tongji.asp?sn="; content:".exe&tmac="; content:"&action="; content:"&ver="; content:" HTTP/1.1|0D||0A|User-Agent|3A| LETITGO"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/tongji\.asp\?sn=[a-zA-Z0-9]{20,}\.exe&tmac=\d{12}&action=.*&ver=\d\.\d HTTP\/1\.1\r\nUser-Agent: LETITGO/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053307; rev:1248;)

# Adware: (Riskware) GetNow - regex: to_server:GET /setup\?lcid=\d+&publisherid=\d+&compliancy=\d HTTP detector_id: 53308
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Riskware) GetNow"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/setup?lcid="; content:"&publisherid="; content:"&compliancy="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/setup\?lcid=\d+&publisherid=\d+&compliancy=\d HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053308; rev:1248;)

# Adware: (Downware) SoftPulse - regex: to_server:GET /[A-F0-9]{96}\?[a-z_]+=[a-z\-\.]+ HTTP/1\.1 detector_id: 53310
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) SoftPulse"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP/1.1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[A-F0-9]{96}\?[a-z_]+=[a-z\-\.]+ HTTP\/1\.1/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053310; rev:1248;)

# Command&Control: (Trojan) Cycler - regex: to_server:GET /js/(standard|google_caf)\.js\?rte=\d&tm=\d&dn=.*&tid=\d{4} HTTP/1\.1 detector_id: 53311
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Cycler"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/js/"; content:".js?rte="; content:"&tm="; content:"&dn="; content:"&tid="; content:" HTTP/1.1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/js\/(standard|google_caf)\.js\?rte=\d&tm=\d&dn=.*&tid=\d{4} HTTP\/1\.1/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053311; rev:1248;)

# Command&Control: (Trojan-Downloader) Genome - regex: to_server:GET /armtoolbars/GetInstallParameters\.php\?c=\d{2}&p=\d{2} HTTP.*User-Agent: MM 1\.0 detector_id: 53312
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan-Downloader) Genome"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/armtoolbars/GetInstallParameters.php?c="; content:"&p="; content:" HTTP"; content:"User-Agent|3A| MM 1.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/armtoolbars\/GetInstallParameters\.php\?c=\d{2}&p=\d{2} HTTP.*User-Agent: MM 1\.0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053312; rev:1248;)

# Command&Control: (Trojan) Dynamer - regex: to_server:GET /files/others/log\.php\?w=.* HTTP detector_id: 53327
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Dynamer"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/files/others/log.php?w="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/files\/others\/log\.php\?w=.* HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053327; rev:1254;)

# Command&Control: (PwdStealer) Golroted - regex: to_server:GET \/WebPanel\/log\.php\?username=.*&name=.*&data=.* HTTP detector_id: 53328
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (PwdStealer) Golroted"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/WebPanel/log.php?username="; content:"&name="; content:"&data="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/WebPanel\/log\.php\?username=.*&name=.*&data=.* HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053328; rev:1254;)

# Adware: (Downware) Oxypumper - regex: to_server:GET /download/altBlankNet2\.dat\?version=[0-9\.]+&dr=[a-f0-9]+(\?version=.*&dr=.*)? HTTP detector_id: 53329
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Oxypumper"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/download/altBlankNet2.dat?version="; content:"&dr="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/download\/altBlankNet2\.dat\?version=[0-9\.]+&dr=[a-f0-9]+(\?version=.*&dr=.*)? HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053329; rev:1254;)

# Command&Control: (Trojan) Dridex - regex: to_server:GET /333 HTTP/1\.1\r\nAccept: \*/\*\r\nAccept-Encoding: gzip, deflate\r\nUser-Agent.*\r\nHost.*\r\nConnection: Keep-Alive detector_id: 53331
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Dridex"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/333 HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|Accept-Encoding|3A| gzip|2C| deflate|0D||0A|User-Agent"; content:"|0D||0A|Host"; content:"|0D||0A|Connection|3A| Keep-Alive"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/333 HTTP\/1\.1\r\nAccept: \*\/\*\r\nAccept-Encoding: gzip, deflate\r\nUser-Agent.*\r\nHost.*\r\nConnection: Keep-Alive/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053331; rev:1254;)

# Command&Control: (Trojan) Ramnit - regex: to_server:GET /stat/report\.php\?no_policy=\d&source=uninstaller&stage=\d&ver=[\d\.]+&wvr=\d+&mntrId=[a-z0-9]{32} HTTP/1\.1\r\nUser-Agent: Babylon detector_id: 53332
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ramnit"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/stat/report.php?no_policy="; content:"&source=uninstaller&stage="; content:"&ver="; content:"&wvr="; content:"&mntrId="; content:" HTTP/1.1|0D||0A|User-Agent|3A| Babylon"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/stat\/report\.php\?no_policy=\d&source=uninstaller&stage=\d&ver=[\d\.]+&wvr=\d+&mntrId=[a-z0-9]{32} HTTP\/1\.1\r\nUser-Agent: Babylon/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053332; rev:1254;)

# Adware: (Downware) Somoto - regex: to_server:GET /pinger\?event_type=.*installer_source=.*muid=.*client_uid=.*uniqid=.*affiliate_id=.*software_id=.*HTTP detector_id: 53333
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Somoto"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/pinger?event_type="; content:"installer_source="; content:"muid="; content:"client_uid="; content:"uniqid="; content:"affiliate_id="; content:"software_id="; content:"HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/pinger\?event_type=.*installer_source=.*muid=.*client_uid=.*uniqid=.*affiliate_id=.*software_id=.*HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053333; rev:1254;)

# Command&Control: (Trojan) Sdbot - regex: to_server:POST \/ HTTP.*User-Agent: ALIZER.*klidqtobqup=.* detector_id: 53334
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sdbot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ HTTP"; content:"User-Agent|3A| ALIZER"; content:"klidqtobqup="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ HTTP.*User-Agent: ALIZER.*klidqtobqup=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053334; rev:1254;)

# Adware: (Downloader) InstallMate - regex: to_server:POST \/ HTTP.*User-Agent: Mozilla\/5\.0\ \(Windows\ NT\ 6\.2\;\ WOW64\)\ AppleWebKit\/535\.7\ \(KHTML\,\ like\ Gecko\)\ Chrome\/16\.0\.912\.75\ Safari\/535\.7.*data=.*&report=.* detector_id: 53335
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downloader) InstallMate"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ HTTP"; content:"User-Agent|3A| Mozilla/5.0 |28|Windows NT 6.2|3B| WOW64|29| AppleWebKit/535.7 |28|KHTML|2C| like Gecko|29| Chrome/16.0.912.75 Safari/535.7"; content:"data="; content:"&report="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ HTTP.*User-Agent: Mozilla\/5\.0\ \(Windows\ NT\ 6\.2\;\ WOW64\)\ AppleWebKit\/535\.7\ \(KHTML\,\ like\ Gecko\)\ Chrome\/16\.0\.912\.75\ Safari\/535\.7.*data=.*&report=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053335; rev:1254;)

# Adware: (Downloader) Loadmoney - regex: to_server:GET /get_json\?stb=\d+&did=\d+&ext_partner_id=.*&file_id=.*&rnd=[a-f0-9]+ HTTP.*User-Agent: Downloader.* detector_id: 53336
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downloader) Loadmoney"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get_json?stb="; content:"&did="; content:"&ext_partner_id="; content:"&file_id="; content:"&rnd="; content:" HTTP"; content:"User-Agent|3A| Downloader"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get_json\?stb=\d+&did=\d+&ext_partner_id=.*&file_id=.*&rnd=[a-f0-9]+ HTTP.*User-Agent: Downloader.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053336; rev:1254;)

# Command&Control: (Trojan) Qakbot - regex: to_server:POST \/f650XXQhUQe\.php HTTP.*\r\n\r\nn=\d+&m=.*&v=\d+&g=.* detector_id: 53337
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Qakbot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/f650XXQhUQe.php HTTP"; content:"|0D||0A||0D||0A|n="; content:"&m="; content:"&v="; content:"&g="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/f650XXQhUQe\.php HTTP.*\r\n\r\nn=\d+&m=.*&v=\d+&g=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053337; rev:1254;)

# Command&Control: (Trojan) Pasta.IK - regex: to_server:GET .*\.txt HTTP/1\.1\r\nUser-Agent: Mozilla/4\.0 \(compatible; MSIE 6\.0; Windows NT 5\.0\)\r\nAccept: \*/\*\r\nHost: [^\r]+\r\nCache-Control: no-cache\r\n\r\n detector_id: 53338
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Pasta.IK"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".txt HTTP/1.1|0D||0A|User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 6.0|3B| Windows NT 5.0|29||0D||0A|Accept|3A| |2A|/|2A||0D||0A|Host|3A| "; content:"|0D||0A|Cache-Control|3A| no-cache|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.txt HTTP\/1\.1\r\nUser-Agent: Mozilla\/4\.0 \(compatible\; MSIE 6\.0\; Windows NT 5\.0\)\r\nAccept: \*\/\*\r\nHost: [^\r]+\r\nCache-Control: no-cache\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053338; rev:1254;)

# Adware: (Adware) Adpeak - regex: to_server:POST /[a-z]\.php HTTP.*User-Agent: NSIS_Inetc \(Mozilla\).*u=[A-F0-9]{8}-([A-F0-9]{4}-){3}[A-F0-9]{12}&s=[A-F0-9]{8}-([A-F0-9]{4}-){3}[A-F0-9]{12}&a=(32|64)&o=.*&q=\d{2} detector_id: 53357
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Adpeak"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"User-Agent|3A| NSIS_Inetc |28|Mozilla|29|"; content:"u="; content:"&s="; content:"&a="; content:"&o="; content:"&q="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]\.php HTTP.*User-Agent: NSIS_Inetc \(Mozilla\).*u=[A-F0-9]{8}-([A-F0-9]{4}-){3}[A-F0-9]{12}&s=[A-F0-9]{8}-([A-F0-9]{4}-){3}[A-F0-9]{12}&a=(32|64)&o=.*&q=\d{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053357; rev:1255;)

# Adware: (Adware) LoadMoney - regex: to_server:GET /launch_error\?text=.* HTTP/1\.1\r\nUser-Agent: Downloader \d\.\d\r\n detector_id: 53358
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) LoadMoney"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/launch_error?text="; content:" HTTP/1.1|0D||0A|User-Agent|3A| Downloader "; content:"|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/launch_error\?text=.* HTTP\/1\.1\r\nUser-Agent: Downloader \d\.\d\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053358; rev:1255;)

# Adware: (Installer) Malavida - regex: to_server:POST \/Malavida\/\?v=[0-9\.]+&c=\d+ HTTP.*User-Agent: ICAS.*[a-zA-Z0-9]{20,} detector_id: 53359
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Installer) Malavida"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/Malavida/?v="; content:"&c="; content:" HTTP"; content:"User-Agent|3A| ICAS"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Malavida\/\?v=[0-9\.]+&c=\d+ HTTP.*User-Agent: ICAS.*[a-zA-Z0-9]{20,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053359; rev:1255;)

# Command&Control: (Trojan) Generic Dropper - regex: to_server:GET /streams/[a-zA-Z0-9]+/.*\.exe\?sig=.*&type=download HTTP detector_id: 53360
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Generic Dropper"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/streams/"; content:".exe?sig="; content:"&type=download HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/streams\/[a-zA-Z0-9]+\/.*\.exe\?sig=.*&type=download HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053360; rev:1255;)

# Adware: (Downware) Softpulse - regex: to_server:POST /__dmp__/ HTTP/1\.1\r\nUser-Agent: session detector_id: 53361
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Softpulse"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/__dmp__/ HTTP/1.1|0D||0A|User-Agent|3A| session"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/__dmp__\/ HTTP\/1\.1\r\nUser-Agent: session/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053361; rev:1255;)

# Command&Control: (PwdStealer) Kazy - regex: to_server:GET \/Locus\/data\.php\?fname=Predator_Pain.*&data=.* HTTP detector_id: 53362
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (PwdStealer) Kazy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Locus/data.php?fname=Predator_Pain"; content:"&data="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Locus\/data\.php\?fname=Predator_Pain.*&data=.* HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053362; rev:1255;)

# Adware: (Downloader) Flowsurf - regex: to_server:GET \/set\.php\?ID=[a-f0-9\-]+&Action=\d HTTP detector_id: 53363
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downloader) Flowsurf"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/set.php?ID="; content:"&Action="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/set\.php\?ID=[a-f0-9\-]+&Action=\d HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053363; rev:1256;)

# Adware: (Downloader) Downloadadmin - regex: to_server:POST \/external\-install\?bc=\d+&pid=.*&brand=.*&secure=(true|false) HTTP.*X-WebInstallCode:.*User-Agent: Tightrope.*delta=.* detector_id: 53364
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downloader) Downloadadmin"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/external-install?bc="; content:"&pid="; content:"&brand="; content:"&secure="; content:" HTTP"; content:"X-WebInstallCode|3A|"; content:"User-Agent|3A| Tightrope"; content:"delta="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/external\-install\?bc=\d+&pid=.*&brand=.*&secure=(true|false) HTTP.*X-WebInstallCode:.*User-Agent: Tightrope.*delta=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053364; rev:1256;)

# Command&Control: (Dropper) Zemot - regex: to_server:GET /catalog/\d{3,} HTTP.*User-Agent: Mozilla/4\.0 \(compatible\; MSIE 8\.0\; Windows NT 5\.1\; Trident/4\.0\; \.NET CLR 2\.0\.50727\; \.NET CLR 3\.0\.04506\.30\; \.NET CLR 3\.0\.4506\.2152\; \.NET CLR 3\.5\.30729\; \.NET CLR 4\.0\.3219\) detector_id: 53365
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Zemot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/catalog/"; content:" HTTP"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 8.0|3B| Windows NT 5.1|3B| Trident/4.0|3B| .NET CLR 2.0.50727|3B| .NET CLR 3.0.04506.30|3B| .NET CLR 3.0.4506.2152|3B| .NET CLR 3.5.30729|3B| .NET CLR 4.0.3219|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/catalog\/\d{3,} HTTP.*User-Agent: Mozilla\/4\.0 \(compatible\; MSIE 8\.0\; Windows NT 5\.1\; Trident\/4\.0\; \.NET CLR 2\.0\.50727\; \.NET CLR 3\.0\.04506\.30\; \.NET CLR 3\.0\.4506\.2152\; \.NET CLR 3\.5\.30729\; \.NET CLR 4\.0\.3219\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053365; rev:1256;)

# Command&Control: (Trojan) Badur.igh - regex: to_server:POST .*/tasks\.php HTTP/1\.0.*getcmd=\d&uid=[A-F0-9]+&os=.*&nat=(yes|no)&version=[0-9\.]+&serial=[A-Z0-9\-]+&quality=\d+ detector_id: 53366
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Badur.igh"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/tasks.php HTTP/1.0"; content:"getcmd="; content:"&uid="; content:"&os="; content:"&nat="; content:"&version="; content:"&serial="; content:"&quality="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/tasks\.php HTTP\/1\.0.*getcmd=\d&uid=[A-F0-9]+&os=.*&nat=(yes|no)&version=[0-9\.]+&serial=[A-Z0-9\-]+&quality=\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053366; rev:1256;)

# Command&Control: (Trojan) Badur.igh - regex: to_server:POST .*/tasks\.php HTTP/1\.0.*\r\n\r\nping=1\n detector_id: 53367
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Badur.igh"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/tasks.php HTTP/1.0"; content:"|0D||0A||0D||0A|ping=1|0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/tasks\.php HTTP\/1\.0.*\r\n\r\nping=1\n/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053367; rev:1256;)

# Command&Control: (Dropper) Sisron - regex: to_server:POST \/blog\/index\.php HTTP.*User-Agent: Mozilla\/4\.0\ \(compatible\;\ MSIE\ 6\.0\;\ Windows\ NT\ 5\.1\;\ SV1\;\ \.NET\ CLR\ 1\.0\.4344\).*\r\n\r\npc=.*&type=\d\r\n detector_id: 53379
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Sisron"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/blog/index.php HTTP"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 6.0|3B| Windows NT 5.1|3B| SV1|3B| .NET CLR 1.0.4344|29|"; content:"|0D||0A||0D||0A|pc="; content:"&type="; content:"|0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/blog\/index\.php HTTP.*User-Agent: Mozilla\/4\.0\ \(compatible\;\ MSIE\ 6\.0\;\ Windows\ NT\ 5\.1\;\ SV1\;\ \.NET\ CLR\ 1\.0\.4344\).*\r\n\r\npc=.*&type=\d\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053379; rev:1258;)

# Command&Control: (Trojan) Emotet - regex: to_server:POST /[a-f0-9]{8}/[a-f0-9]{8}/ HTTP.*User-Agent: Mozilla/4\.0 \(compatible\;MSIE 7\.0\;Windows NT 6\.0\)\r\n detector_id: 53380
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Emotet"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ HTTP"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B|MSIE 7.0|3B|Windows NT 6.0|29||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-f0-9]{8}\/[a-f0-9]{8}\/ HTTP.*User-Agent: Mozilla\/4\.0 \(compatible\;MSIE 7\.0\;Windows NT 6\.0\)\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053380; rev:1258;)

# Command&Control: (Trojan) Wuji - regex: to_server:GET \/[a-z]{3,}\.ashx\?v=[0-9\.]+&t=\d+ HTTP/1\.1\r\nHost: [^\r]+\r\nCache-Control: no-cache\r\n\r\n detector_id: 53415
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Wuji"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".ashx?v="; content:"&t="; content:" HTTP/1.1|0D||0A|Host|3A| "; content:"|0D||0A|Cache-Control|3A| no-cache|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{3,}\.ashx\?v=[0-9\.]+&t=\d+ HTTP\/1\.1\r\nHost: [^\r]+\r\nCache-Control: no-cache\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053415; rev:1267;)

# Command&Control: (Backdoor) Emdivi - regex: to_server:HEAD .*\/index.php HTTP.*Cookie: .*;date=.*\x2540\.4(.|\x25[A-F0-9][A-F0-9]){8}\x251D detector_id: 53417
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Emdivi"; flow:established,to_server; content:"HEAD"; nocase; http_method; content:"HEAD "; content:"/index"; content:"php HTTP"; content:"Cookie|3A| "; content:"|3B|date="; content:"|25|40.4"; content:"|25|1D"; pcre:"/HEAD (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/index.php HTTP.*Cookie: .*\;date=.*\x2540\.4(.|\x25[A-F0-9][A-F0-9]){8}\x251D/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053417; rev:1268;)

# Command&Control: (Backdoor) Emdivi - regex: to_server:POST .*/index.php HTTP.*Cookie: "ret=[a-f0-9]{32}\/ok" detector_id: 53418
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Emdivi"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/index"; content:"php HTTP"; content:"Cookie|3A| |22|ret="; content:"/ok|22|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/index.php HTTP.*Cookie: "ret=[a-f0-9]{32}\/ok"/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053418; rev:1268;)

# Adware: (Toolbar) iBryte - regex: to_server:GET \/impression\.do\/\?event=.*&implementation\_id=.*&user\_id=.*&adprovider=.*&source=.*&page=.*&referrer=.* HTTP.*User-Agent: download\ manager detector_id: 53419
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) iBryte"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/impression.do/?event="; content:"&implementation_id="; content:"&user_id="; content:"&adprovider="; content:"&source="; content:"&page="; content:"&referrer="; content:" HTTP"; content:"User-Agent|3A| download manager"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/impression\.do\/\?event=.*&implementation\_id=.*&user\_id=.*&adprovider=.*&source=.*&page=.*&referrer=.* HTTP.*User-Agent: download\ manager/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053419; rev:1268;)

# Adware: (Adware) Yontoo - regex: to_server:GET /rs\.php\?p=[a-z]+ HTTP/1\.0.*User-Agent: NSISDL/\d\.\d \(Mozilla\) detector_id: 53420
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Yontoo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/rs.php?p="; content:" HTTP/1.0"; content:"User-Agent|3A| NSISDL/"; content:" |28|Mozilla|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/rs\.php\?p=[a-z]+ HTTP\/1\.0.*User-Agent: NSISDL\/\d\.\d \(Mozilla\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053420; rev:1268;)

# Adware: (Adware) InstallIQ - regex: to_server:GET .*/(api/engine|eng/mundo)\?accountid=\d{5}&shortname=.*&defaultbrowser=.*&campaignName=.*&productsessionid=.*&browsermappingid=\d{4}&associatetrackingid=\d{9}&secondchancemappingid=.*&rewritevalueid=\d{6}&betalinkid=.* HTTP/1\.1 detector_id: 53421
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) InstallIQ"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?accountid="; content:"&shortname="; content:"&defaultbrowser="; content:"&campaignName="; content:"&productsessionid="; content:"&browsermappingid="; content:"&associatetrackingid="; content:"&secondchancemappingid="; content:"&rewritevalueid="; content:"&betalinkid="; content:" HTTP/1.1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/(api\/engine|eng\/mundo)\?accountid=\d{5}&shortname=.*&defaultbrowser=.*&campaignName=.*&productsessionid=.*&browsermappingid=\d{4}&associatetrackingid=\d{9}&secondchancemappingid=.*&rewritevalueid=\d{6}&betalinkid=.* HTTP\/1\.1/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053421; rev:1268;)

# Adware: (Downware) DownloadAdmin - regex: to_server:POST /install\?bc=\d{6}&pid=.*&brand=.*&country=[A-Z]{2}(&osName=.*&osVersion=\d&browserName=.*&browserVersion=\d+)?&secure=(true|false) HTTP/1\.1\r\nX-WebInstallCode: .*service\.downloadadmin\.com.*X-WebInstallUrl:.*service\.downloadadmin\.com detector_id: 53422
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) DownloadAdmin"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/install?bc="; content:"&pid="; content:"&brand="; content:"&country="; content:"&secure="; content:" HTTP/1.1|0D||0A|X-WebInstallCode|3A| "; content:"service.downloadadmin.com"; content:"X-WebInstallUrl|3A|"; content:"service.downloadadmin.com"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/install\?bc=\d{6}&pid=.*&brand=.*&country=[A-Z]{2}(&osName=.*&osVersion=\d&browserName=.*&browserVersion=\d+)?&secure=(true|false) HTTP\/1\.1\r\nX-WebInstallCode: .*service\.downloadadmin\.com.*X-WebInstallUrl:.*service\.downloadadmin\.com/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053422; rev:1268;)

# Adware: (Downware) Amonetize - regex: to_server:POST \/finalize\.php HTTP.*\r\n\r\n\_hdn=\d+&\_ver=[0-9\.]+&\_p=\d+&\_s=.*&\_cc=.*&\_cid=.*&\_psb=\d+&\_cnt=.*&\_instid=.*&\_brw=.*&\_fc=\d+&\_appname=.*&\_appimageurl=.*&\_netfs=.*&\_vert=\d+ detector_id: 53471
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Amonetize"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/finalize.php HTTP"; content:"|0D||0A||0D||0A|_hdn="; content:"&_ver="; content:"&_p="; content:"&_s="; content:"&_cc="; content:"&_cid="; content:"&_psb="; content:"&_cnt="; content:"&_instid="; content:"&_brw="; content:"&_fc="; content:"&_appname="; content:"&_appimageurl="; content:"&_netfs="; content:"&_vert="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/finalize\.php HTTP.*\r\n\r\n\_hdn=\d+&\_ver=[0-9\.]+&\_p=\d+&\_s=.*&\_cc=.*&\_cid=.*&\_psb=\d+&\_cnt=.*&\_instid=.*&\_brw=.*&\_fc=\d+&\_appname=.*&\_appimageurl=.*&\_netfs=.*&\_vert=\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053471; rev:1269;)

# Adware: (Adware) AirInstaller - regex: to_server:GET \/get\/log\/\?b=.*&c=[a-z0-9\-]+&d=[0-9\.]+&o=.*&r=.*&s=[0-9a-f]+&t=\d+ HTTP detector_id: 53472
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) AirInstaller"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get/log/?b="; content:"&c="; content:"&d="; content:"&o="; content:"&r="; content:"&s="; content:"&t="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get\/log\/\?b=.*&c=[a-z0-9\-]+&d=[0-9\.]+&o=.*&r=.*&s=[0-9a-f]+&t=\d+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053472; rev:1269;)

# Adware: (Downloader) InstallCore - regex: to_server:POST \/\?pcrc=\d+&v=\d\.\d HTTP.*User-Agent: Mozilla\/4\.0\ \(compatible\;\ MSIE\ 6\.0\;\ Windows\ NT\ 5\.1\;\ SV1\) detector_id: 53473
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downloader) InstallCore"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/?pcrc="; content:"&v="; content:" HTTP"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 6.0|3B| Windows NT 5.1|3B| SV1|29|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?pcrc=\d+&v=\d\.\d HTTP.*User-Agent: Mozilla\/4\.0\ \(compatible\;\ MSIE\ 6\.0\;\ Windows\ NT\ 5\.1\;\ SV1\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053473; rev:1269;)

#  - regex: to_server:GET .*\.exe(\?[a-zA-Z0-9]+=[a-zA-Z0-9]+)?&h=\d+ HTTP detector_id: 53511
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".exe"; content:"&h="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.exe(\?[a-zA-Z0-9]+=[a-zA-Z0-9]+)?&h=\d+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053511; rev:1272;)

# Command&Control: (Pentesting) Shinobot - regex: to_server:POST \/sync\.php HTTP.*hid=\d+&password=[A-F0-9]+&jrid=\d+&loot=.* detector_id: 53560
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Pentesting) Shinobot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/sync.php HTTP"; content:"hid="; content:"&password="; content:"&jrid="; content:"&loot="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/sync\.php HTTP.*hid=\d+&password=[A-F0-9]+&jrid=\d+&loot=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053560; rev:1296;)

# Command&Control: (Pentesting) Shinobot - regex: to_server:POST \/gen\.php HTTP.*computername=.*&username=.*&domainname=.*&ipaddr=\d+\.\d+\.\d+\.\d+&timezone=.*&ver=\d\.\d\.\d\.\d&password=.* detector_id: 53561
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Pentesting) Shinobot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/gen.php HTTP"; content:"computername="; content:"&username="; content:"&domainname="; content:"&ipaddr="; content:"&timezone="; content:"&ver="; content:"&password="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/gen\.php HTTP.*computername=.*&username=.*&domainname=.*&ipaddr=\d+\.\d+\.\d+\.\d+&timezone=.*&ver=\d\.\d\.\d\.\d&password=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053561; rev:1296;)

# Command&Control: (Trojan) Dynamer - regex: to_server:GET \/getver\.asp\?qq=\d+ HTTP/1\.1\r\nUser-Agent: Mozilla\/4\.0\r\nHost: [^\r]+\r\nCache-Control: no-cache\r\n\r\n detector_id: 53562
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Dynamer"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/getver.asp?qq="; content:" HTTP/1.1|0D||0A|User-Agent|3A| Mozilla/4.0|0D||0A|Host|3A| "; content:"|0D||0A|Cache-Control|3A| no-cache|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/getver\.asp\?qq=\d+ HTTP\/1\.1\r\nUser-Agent: Mozilla\/4\.0\r\nHost: [^\r]+\r\nCache-Control: no-cache\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053562; rev:1296;)

# Command&Control: (Trojan) Dynamer - regex: to_server:GET \/TongJi\.asp\?Act=[a-zA-Z0-9\=]{20,} HTTP/1\.1\r\nUser-Agent: Mozilla\/4\.0\r\nHost: [^\r]+\r\nCache-Control: no-cache\r\nCookie: ASPSESSION.* detector_id: 53563
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Dynamer"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/TongJi.asp?Act="; content:" HTTP/1.1|0D||0A|User-Agent|3A| Mozilla/4.0|0D||0A|Host|3A| "; content:"|0D||0A|Cache-Control|3A| no-cache|0D||0A|Cookie|3A| ASPSESSION"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/TongJi\.asp\?Act=[a-zA-Z0-9\=]{20,} HTTP\/1\.1\r\nUser-Agent: Mozilla\/4\.0\r\nHost: [^\r]+\r\nCache-Control: no-cache\r\nCookie: ASPSESSION.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053563; rev:1296;)

# Command&Control: (Dropper) Kylim - regex: to_server:GET /ext/dow.exe HTTP.*User-Agent: AutoIt detector_id: 53596
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Kylim"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ext/dow"; content:"exe HTTP"; content:"User-Agent|3A| AutoIt"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ext\/dow.exe HTTP.*User-Agent: AutoIt/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053596; rev:1301;)

# Command&Control: (Dropper) Kylim - regex: to_server:GET \/ext\/log\.php\?mylord HTTP detector_id: 53597
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Kylim"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ext/log.php?mylord HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ext\/log\.php\?mylord HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053597; rev:1301;)

# Adware: (Riskware) Chindo - regex: to_server:GET /\d\.ico\?\d{6} HTTP detector_id: 53598
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Riskware) Chindo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".ico?"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d\.ico\?\d{6} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053598; rev:1301;)

# Command&Control: (Trojan) Neurevt - regex: to_server:POST [a-z\-_\d/]*/[a-z]+\.php HTTP.*ps0=[\dA-F]{16,}&ps1=[\dA-F]{48,} detector_id: 53611
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Neurevt"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"ps0="; content:"&ps1="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?[a-z\-_\d\/]*\/[a-z]+\.php HTTP.*ps0=[\dA-F]{16,}&ps1=[\dA-F]{48,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053611; rev:1303;)

# Command&Control: (Trojan) Qbot - regex: to_server:POST /[a-zA-Z0-9]{20}\.php HTTP.*n=\d+&m=.*&v=\d+&g=\d+ detector_id: 53621
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Qbot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"n="; content:"&m="; content:"&v="; content:"&g="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-zA-Z0-9]{20}\.php HTTP.*n=\d+&m=.*&v=\d+&g=\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053621; rev:1309;)

# Command&Control: (Rootkit) GenericRootkit - regex: to_server:GET /wb/bsf/\?mac=\d{2}\-\d{2}\-\d{2}\-\d{2}\-\d{2}\-\d{2} HTTP.*User-Agent: TrikIE\/1\.0 detector_id: 53646
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Rootkit) GenericRootkit"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/wb/bsf/?mac="; content:" HTTP"; content:"User-Agent|3A| TrikIE/1.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/wb\/bsf\/\?mac=\d{2}\-\d{2}\-\d{2}\-\d{2}\-\d{2}\-\d{2} HTTP.*User-Agent: TrikIE\/1\.0/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053646; rev:1311;)

# Adware: (BHO) FirstFloor - regex: to_server:GET /process/GetOfferPageV2\.ashx\?appid=(\d+)?&si=(\d+)?&lang=.*&oid=.*&browser=.*&dbrowser=.*&ai=.*&paa=.* HTTP/1.1\r\nHost: [^\r]+\r\nConnection: Keep-Alive\r\n\r\n detector_id: 53648
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (BHO) FirstFloor"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/process/GetOfferPageV2.ashx?appid="; content:"&si="; content:"&lang="; content:"&oid="; content:"&browser="; content:"&dbrowser="; content:"&ai="; content:"&paa="; content:" HTTP/1"; content:"1|0D||0A|Host|3A| "; content:"|0D||0A|Connection|3A| Keep-Alive|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/process\/GetOfferPageV2\.ashx\?appid=(\d+)?&si=(\d+)?&lang=.*&oid=.*&browser=.*&dbrowser=.*&ai=.*&paa=.* HTTP\/1.1\r\nHost: [^\r]+\r\nConnection: Keep-Alive\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053648; rev:1312;)

# Command&Control: (Trojan) Dynamer - regex: to_server:GET .*\.asp\?Name1=.*&Info1=.* HTTP/1\.1\r\nConnection: Keep-Alive\r\nAccept: \*/\*\r\nUser-Agent: [^\r]+Win32\; WinHttp.WinHttpRequest.5\)\r\nHost: [^\r]+\r\n\r\n detector_id: 53649
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Dynamer"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".asp?Name1="; content:"&Info1="; content:" HTTP/1.1|0D||0A|Connection|3A| Keep-Alive|0D||0A|Accept|3A| |2A|/|2A||0D||0A|User-Agent|3A| "; content:"Win32|3B| WinHttp"; content:"WinHttpRequest"; content:"5|29||0D||0A|Host|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.asp\?Name1=.*&Info1=.* HTTP\/1\.1\r\nConnection: Keep-Alive\r\nAccept: \*\/\*\r\nUser-Agent: [^\r]+Win32\; WinHttp.WinHttpRequest.5\)\r\nHost: [^\r]+\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053649; rev:1312;)

# Adware: (Downloader) OneClick - regex: to_server:GET \/download\/ccode\.php\?co=[a-z]{2} HTTP.*User-Agent: NSISDL\/1\.2\ \(Mozilla\) detector_id: 53650
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downloader) OneClick"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/download/ccode.php?co="; content:" HTTP"; content:"User-Agent|3A| NSISDL/1.2 |28|Mozilla|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/download\/ccode\.php\?co=[a-z]{2} HTTP.*User-Agent: NSISDL\/1\.2\ \(Mozilla\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053650; rev:1312;)

# Adware: (Riskware) Chindo - regex: to_server:POST \/query\?cmd=(validurl|fid2finfo) HTTP\/1\.1\x0d\x0aContent-Length: \d+\x0d\x0aConnection: Keep-Alive\x0d\x0a\x0d\x0a detector_id: 53653
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Riskware) Chindo"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/query?cmd="; content:" HTTP/1.1|0D||0A|Content-Length|3A| "; content:"|0D||0A|Connection|3A| Keep-Alive|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/query\?cmd=(validurl|fid2finfo) HTTP\/1\.1\x0d\x0aContent-Length: \d+\x0d\x0aConnection: Keep-Alive\x0d\x0a\x0d\x0a/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053653; rev:1314;)

# Adware: (Toolbar) Conduit - regex: to_server:POST \/iis2ebs\.asp HTTP.*\x0d\x0aRequestString= detector_id: 53654
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Conduit"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/iis2ebs.asp HTTP"; content:"|0D||0A|RequestString="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/iis2ebs\.asp HTTP.*\x0d\x0aRequestString=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053654; rev:1314;)

# Adware: (Riskware) Chindo - regex: to_server:GET \/go\/full\/\d+\/\d+ HTTP\/1\.1\r\nUser-Agent: NSIS_Inetc \(Mozilla\) detector_id: 53655
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Riskware) Chindo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/go/full/"; content:" HTTP/1.1|0D||0A|User-Agent|3A| NSIS_Inetc |28|Mozilla|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/go\/full\/\d+\/\d+ HTTP\/1\.1\r\nUser-Agent: NSIS_Inetc \(Mozilla\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053655; rev:1314;)

# Adware: (Downware) SoftPulse - regex: to_server:GET \/[a-f0-9]{144} HTTP\/1\.\d\r\nAccept: \*\/\*\r\nProxy\-Authorization: Basic detector_id: 53656
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) SoftPulse"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP/1."; content:"|0D||0A|Accept|3A| |2A|/|2A||0D||0A|Proxy-Authorization|3A| Basic"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-f0-9]{144} HTTP\/1\.\d\r\nAccept: \*\/\*\r\nProxy\-Authorization: Basic/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053656; rev:1314;)

# Command&Control: (Dropper) BindEx - regex: to_server:POST \/post\/ HTTP\/1\.\d.*mac=([A-Fa-f0-9][A-Fa-f0-9]\-){5}[A-Fa-f0-9][A-Fa-f0-9]&ver=\d\.\d\.\d\.\d+&soft_id=\d+&tuiguang_id=.*&yanzheng=[a-f0-9]{32} detector_id: 53663
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) BindEx"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/post/ HTTP/1."; content:"mac="; content:"&ver="; content:"&soft_id="; content:"&tuiguang_id="; content:"&yanzheng="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/post\/ HTTP\/1\.\d.*mac=([A-Fa-f0-9][A-Fa-f0-9]\-){5}[A-Fa-f0-9][A-Fa-f0-9]&ver=\d\.\d\.\d\.\d+&soft_id=\d+&tuiguang_id=.*&yanzheng=[a-f0-9]{32}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053663; rev:1316;)

# Command&Control: (Stealer) Win32.Prast - regex: to_server:GET .*\/Ser.erList\.txt HTTP.*(User-Agent: Mozilla\/3\.0 \(compatible: Indy Library\)\x0d\x0a|Accept-Encoding: identity\x0d\x0a){2} detector_id: 53675
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Stealer) Win32.Prast"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Ser"; content:"erList.txt HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/Ser.erList\.txt HTTP.*(User-Agent: Mozilla\/3\.0 \(compatible: Indy Library\)\x0d\x0a|Accept-Encoding: identity\x0d\x0a){2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053675; rev:1317;)

# Adware: (Downware) 4Shared Downloader - regex: to_server:POST /smart-download/+.*User-Agent: Preloader.*preloader=\d detector_id: 53691
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) 4Shared Downloader"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/smart-download"; content:"User-Agent|3A| Preloader"; content:"preloader="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/smart-download\/+.*User-Agent: Preloader.*preloader=\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053691; rev:1323;)

# Command&Control: (Trojan) AgentByPass - regex: to_server:GET \/binary\/whitelist\.dat\?ver=[0-9\.]+&uid=.*&lip=\d+\.\d+\.\d+\.\d+&mac=\d+&p=\d+&b=\d+\.\d+\.\d+\.\d+\.\d+&md5=[a-fA-F0-9]+ HTTP detector_id: 53693
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) AgentByPass"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/binary/whitelist.dat?ver="; content:"&uid="; content:"&lip="; content:"&mac="; content:"&p="; content:"&b="; content:"&md5="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/binary\/whitelist\.dat\?ver=[0-9\.]+&uid=.*&lip=\d+\.\d+\.\d+\.\d+&mac=\d+&p=\d+&b=\d+\.\d+\.\d+\.\d+\.\d+&md5=[a-fA-F0-9]+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053693; rev:1324;)

# Command&Control: (Trojan) FlyStudio - regex: to_server:GET \/.*\.php\?ip=[0-9\.]+&mac=([A-F0-9]{2}\-){5}[A-F0-9]{2}&sd=.*&id=&uid=&sid=[A-F0-9]{32} HTTP detector_id: 53694
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) FlyStudio"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?ip="; content:"&mac="; content:"&sd="; content:"&id=&uid=&sid="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\.php\?ip=[0-9\.]+&mac=([A-F0-9]{2}\-){5}[A-F0-9]{2}&sd=.*&id=&uid=&sid=[A-F0-9]{32} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053694; rev:1324;)

# Command&Control: (Dropper) Kidsoper - regex: to_server:GET .*\.exe\?download\_token=[a-f0-9]{64} HTTP detector_id: 53695
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Kidsoper"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".exe?download_token="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.exe\?download\_token=[a-f0-9]{64} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053695; rev:1324;)

# Adware: (Toolbar) iBryte - regex: to_server:GET \/impression\.do\/\?event=.*&implementation\_id=.* HTTP.*User-Agent: download\ manager detector_id: 53709
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) iBryte"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/impression.do/?event="; content:"&implementation_id="; content:" HTTP"; content:"User-Agent|3A| download manager"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/impression\.do\/\?event=.*&implementation\_id=.* HTTP.*User-Agent: download\ manager/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053709; rev:1326;)

# Command&Control: (Trojan) Yakes - regex: to_server:GET /report\_.*HTTP/1\.1\r\nUser-Agent: Mozilla/4\.0 \(compatible\; MSIE 8\.0\; Windows NT 5\.1\; Trident/4\.0\)\r\nHost: \d+\.\d+\.\d+\.\d+\r\nCache-Control: no-cache\r\n\r\n detector_id: 53710
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Yakes"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/report_"; content:"HTTP/1.1|0D||0A|User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 8.0|3B| Windows NT 5.1|3B| Trident/4.0|29||0D||0A|Host|3A| "; content:"|0D||0A|Cache-Control|3A| no-cache|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/report\_.*HTTP\/1\.1\r\nUser-Agent: Mozilla\/4\.0 \(compatible\; MSIE 8\.0\; Windows NT 5\.1\; Trident\/4\.0\)\r\nHost: \d+\.\d+\.\d+\.\d+\r\nCache-Control: no-cache\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053710; rev:1326;)

# Command&Control: (Trojan) Zemot - regex: to_server:GET /[a-z0-9A-Z]+/mod_[a-z0-9]+/ HTTP.*User-Agent: Mozilla/4\.0 \(compatible\; MSIE 8\.0\; Windows NT 5\.1\; Trident/4\.0\; \.NET CLR 2\.0\.50727\; \.NET CLR 3\.0\.04506\.30\; \.NET CLR 3\.0\.4506\.2152\; \.NET CLR 3\.5\.30729\; \.NET CLR 4\.0\.3219\) detector_id: 53719
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zemot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mod_"; content:"/ HTTP"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 8.0|3B| Windows NT 5.1|3B| Trident/4.0|3B| .NET CLR 2.0.50727|3B| .NET CLR 3.0.04506.30|3B| .NET CLR 3.0.4506.2152|3B| .NET CLR 3.5.30729|3B| .NET CLR 4.0.3219|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z0-9A-Z]+\/mod_[a-z0-9]+\/ HTTP.*User-Agent: Mozilla\/4\.0 \(compatible\; MSIE 8\.0\; Windows NT 5\.1\; Trident\/4\.0\; \.NET CLR 2\.0\.50727\; \.NET CLR 3\.0\.04506\.30\; \.NET CLR 3\.0\.4506\.2152\; \.NET CLR 3\.5\.30729\; \.NET CLR 4\.0\.3219\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053719; rev:1328;)

# Adware: (Downloader) GenericDownware - regex: to_server:GET .*/read\.php\?t=.*&d=\d+&c=.* HTTP.*User-Agent: Mozilla/5\.0 \(compatible\; MSIE 10\.0\; Windows NT 6\.1\; Trident/6\.0\; KngStr_IAM\) detector_id: 53794
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downloader) GenericDownware"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/read.php?t="; content:"&d="; content:"&c="; content:" HTTP"; content:"User-Agent|3A| Mozilla/5.0 |28|compatible|3B| MSIE 10.0|3B| Windows NT 6.1|3B| Trident/6.0|3B| KngStr_IAM|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/read\.php\?t=.*&d=\d+&c=.* HTTP.*User-Agent: Mozilla\/5\.0 \(compatible\; MSIE 10\.0\; Windows NT 6\.1\; Trident\/6\.0\; KngStr_IAM\)/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053794; rev:1332;)

# Command&Control: (Dropper) Hosts2 - regex: to_server:GET /test/(down|shua)\.txt HTTP.*User-Agent: config detector_id: 53810
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Hosts2"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/test/"; content:".txt HTTP"; content:"User-Agent|3A| config"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/test\/(down|shua)\.txt HTTP.*User-Agent: config/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053810; rev:1337;)

# Adware: (BHO) Crossrider - regex: to_server:GET \/utility\.gif\?error=start&report=.*&ver=\d+&action=.*&ms\_vr=\d+&clock=\d+&rnd=\d+ HTTP detector_id: 53811
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (BHO) Crossrider"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/utility.gif?error=start&report="; content:"&ver="; content:"&action="; content:"&ms_vr="; content:"&clock="; content:"&rnd="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/utility\.gif\?error=start&report=.*&ver=\d+&action=.*&ms\_vr=\d+&clock=\d+&rnd=\d+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053811; rev:1337;)

# Adware: (BHO) Crossrider - regex: to_server:GET /\d+/[a-z]+/[a-z]+/[a-z]{2}/setup\.exe_[a-f]+ HTTP detector_id: 53812
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (BHO) Crossrider"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/setup.exe_"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d+\/[a-z]+\/[a-z]+\/[a-z]{2}\/setup\.exe_[a-f]+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053812; rev:1337;)

# Command&Control: (Keylogger) Spy.Keylogger - regex: to_server:POST /[a-z0-9A-Z]+\.php HTTP.*\r\n\r\npcname=.*&note=.*&country=.*&user=.*&log=.* detector_id: 53829
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Keylogger) Spy.Keylogger"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"|0D||0A||0D||0A|pcname="; content:"&note="; content:"&country="; content:"&user="; content:"&log="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z0-9A-Z]+\.php HTTP.*\r\n\r\npcname=.*&note=.*&country=.*&user=.*&log=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053829; rev:1340;)

# Command&Control: (Keylogger) Spy.Keylogger - regex: to_server:GET /include/newage\.txt HTTP/1.1\r\nAccept: (.*\,){11} \*/\*\r\n detector_id: 53837
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Keylogger) Spy.Keylogger"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/include/newage.txt HTTP/1"; content:"1|0D||0A|Accept|3A| "; content:" |2A|/|2A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/include\/newage\.txt HTTP\/1.1\r\nAccept: (.*\,){11} \*\/\*\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053837; rev:1340;)

# Command&Control: (Trojan) Zeus Gameover - regex: to_server:POST /updatec HTTP/1\.1\r\nHost: [^\n]+\r\nAccept-Encoding:\r\nConnection: (close|keep-alive)\r\nContent-Length: \d{2,}\r\n(session-id: [a-zA-Z0-9]+\r\n)?\r\n detector_id: 53842
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zeus Gameover"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/updatec HTTP/1.1|0D||0A|Host|3A| "; content:"|0D||0A|Accept-Encoding|3A||0D||0A|Connection|3A| "; content:"|0D||0A|Content-Length|3A| "; content:"|0D||0A|"; content:"|0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/updatec HTTP\/1\.1\r\nHost: [^\n]+\r\nAccept-Encoding:\r\nConnection: (close|keep-alive)\r\nContent-Length: \d{2,}\r\n(session-id: [a-zA-Z0-9]+\r\n)?\r\n/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053842; rev:1341;)

# Command&Control: (Trojan) CryptoLocker - regex: to_server:GET /blog/.* HTTP/1\.1\r\nUser-Agent: Mozilla/4\.0 \(compatible\; MSIE 7\.0\; Windows NT 5\.1\; Trident/4\.0\; \.NET4\.0C\; \.NET4\.0E\; \.NET CLR 2\.0\.50727\; \.NET CLR 3\.0\.4506\.2152\; \.NET CLR 3\.5\.30729; \.NET CLR 1\.1\.4322\)\r\nHost: [^\r]+\r\nCache-Control: no-cache\r\n\r\n detector_id: 53844
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) CryptoLocker"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/blog/"; content:" HTTP/1.1|0D||0A|User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 7.0|3B| Windows NT 5.1|3B| Trident/4.0|3B| .NET4.0C|3B| .NET4.0E|3B| .NET CLR 2.0.50727|3B| .NET CLR 3.0.4506.2152|3B| .NET CLR 3.5.30729|3B| .NET CLR 1.1.4322|29||0D||0A|Host|3A| "; content:"|0D||0A|Cache-Control|3A| no-cache|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/blog\/.* HTTP\/1\.1\r\nUser-Agent: Mozilla\/4\.0 \(compatible\; MSIE 7\.0\; Windows NT 5\.1\; Trident\/4\.0\; \.NET4\.0C\; \.NET4\.0E\; \.NET CLR 2\.0\.50727\; \.NET CLR 3\.0\.4506\.2152\; \.NET CLR 3\.5\.30729\; \.NET CLR 1\.1\.4322\)\r\nHost: [^\r]+\r\nCache-Control: no-cache\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053844; rev:1342;)

# Command&Control: (Trojan) Dursg - regex: to_server:GET /tools/parser\.php\?user[^ =]+id=\d&pcid=[A-Z0-9]+ HTTP/1\.0.*User-Agent: Mozilla\/4\.0 \(compatible\; Synapse\) detector_id: 53845
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Dursg"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/tools/parser.php?user"; content:"id="; content:"&pcid="; content:" HTTP/1.0"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| Synapse|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/tools\/parser\.php\?user[^ =]+id=\d&pcid=[A-Z0-9]+ HTTP\/1\.0.*User-Agent: Mozilla\/4\.0 \(compatible\; Synapse\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053845; rev:1342;)

# Command&Control: (Trojan) Simda - regex: to_server:POST / HTTP.*User-Agent: Mozilla/4\.0 \(compatible\; MSIE 8\.0\; Trident/4\.0\; \.NET CLR 2\.0\.50727\; \.NET CLR 1\.1\.4322\; \.NET CLR 3\.0\.04506\.590\; \.NET CLR 3\.0\.04506\.648\; \.NET CLR 3\.5\.21022\; \.NET CLR 3\.0\.4506\.2152\; \.NET CLR 3\.5\.30729\).*\r\n\r\nQGMY=.* detector_id: 53846
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Simda"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ HTTP"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 8.0|3B| Trident/4.0|3B| .NET CLR 2.0.50727|3B| .NET CLR 1.1.4322|3B| .NET CLR 3.0.04506.590|3B| .NET CLR 3.0.04506.648|3B| .NET CLR 3.5.21022|3B| .NET CLR 3.0.4506.2152|3B| .NET CLR 3.5.30729|29|"; content:"|0D||0A||0D||0A|QGMY="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ HTTP.*User-Agent: Mozilla\/4\.0 \(compatible\; MSIE 8\.0\; Trident\/4\.0\; \.NET CLR 2\.0\.50727\; \.NET CLR 1\.1\.4322\; \.NET CLR 3\.0\.04506\.590\; \.NET CLR 3\.0\.04506\.648\; \.NET CLR 3\.5\.21022\; \.NET CLR 3\.0\.4506\.2152\; \.NET CLR 3\.5\.30729\).*\r\n\r\nQGMY=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053846; rev:1342;)

#  - regex: to_server:GET \/\??[a-f0-9]{60,}\x3b1\d{5}\x3b\d{1,3} HTTP.*x-flash-version: \d+,\d+,\d+,\d+ detector_id: 53847
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS "; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"|3B|1"; content:" HTTP"; content:"x-flash-version|3A| "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\??[a-f0-9]{60,}\x3b1\d{5}\x3b\d{1,3} HTTP.*x-flash-version: \d+,\d+,\d+,\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053847; rev:1342;)

# Adware: (Downware) Admonetizer - regex: to_server:POST \/binno\/xml\?uid=[A-F0-9]+&v=\d\.\d\.\d&affid=.*&sid=.*&s=\d+ HTTP.*User-Agent: Mozilla\/4\.0\ \(compatible\;\ Win32\;\ WinHttp\.WinHttpRequest\.5\).*\r\n\r\ninstaller\_data=.* detector_id: 53883
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Admonetizer"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/binno/xml?uid="; content:"&v="; content:"&affid="; content:"&sid="; content:"&s="; content:" HTTP"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| Win32|3B| WinHttp.WinHttpRequest.5|29|"; content:"|0D||0A||0D||0A|installer_data="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/binno\/xml\?uid=[A-F0-9]+&v=\d\.\d\.\d&affid=.*&sid=.*&s=\d+ HTTP.*User-Agent: Mozilla\/4\.0\ \(compatible\;\ Win32\;\ WinHttp\.WinHttpRequest\.5\).*\r\n\r\ninstaller\_data=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053883; rev:1346;)

# Command&Control: (Spyware) iSpy.pw - regex: to_server:POST \/logpanel\/insert HTTP.*key=.*&type=\d&pcname=.*&log=.* detector_id: 53884
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Spyware) iSpy.pw"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/logpanel/insert HTTP"; content:"key="; content:"&type="; content:"&pcname="; content:"&log="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/logpanel\/insert HTTP.*key=.*&type=\d&pcname=.*&log=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053884; rev:1346;)

# Command&Control: (Spyware) iSpy.pw - regex: to_server:GET /logpanel/downloads/PWS\.bin HTTP detector_id: 53885
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Spyware) iSpy.pw"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/logpanel/downloads/PWS.bin HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/logpanel\/downloads\/PWS\.bin HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053885; rev:1346;)

# Drive-by: (Payload) Incognito EK - regex: to_server:GET .*/load\.php\?.* HTTP.*User-Agent: [^\r]*Java/1 detector_id: 53921
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: (Payload) Incognito EK"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/load.php?"; content:" HTTP"; content:"User-Agent|3A| "; content:"Java/1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/load\.php\?.* HTTP.*User-Agent: [^\r]*Java\/1/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053921; rev:1355;)

# Adware: (Adware) Somoto - regex: to_server:POST /installer/ajax HTTP.*\r\n\r\ncountry=[A-Z]{2}&uid_orig=[a-f0-9]+&uid=[a-f0-9]+&affid=.*&sid=.*&cli_id=.*&softwareName=.*&installerVersion=\d\.\d detector_id: 53922
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Somoto"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/installer/ajax HTTP"; content:"|0D||0A||0D||0A|country="; content:"&uid_orig="; content:"&uid="; content:"&affid="; content:"&sid="; content:"&cli_id="; content:"&softwareName="; content:"&installerVersion="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/installer\/ajax HTTP.*\r\n\r\ncountry=[A-Z]{2}&uid_orig=[a-f0-9]+&uid=[a-f0-9]+&affid=.*&sid=.*&cli_id=.*&softwareName=.*&installerVersion=\d\.\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053922; rev:1356;)

# Command&Control: (Trojan) Banload - regex: to_server:POST .*/InsertCliente\.php HTTP.*User-Agent: Mozilla/3\.0 \(compatible\; Indy Library\).*\r\n\r\nA1=.*(&A\d=.*){7} detector_id: 53923
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Banload"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/InsertCliente.php HTTP"; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; content:"|0D||0A||0D||0A|A1="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/InsertCliente\.php HTTP.*User-Agent: Mozilla\/3\.0 \(compatible\; Indy Library\).*\r\n\r\nA1=.*(&A\d=.*){7}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053923; rev:1356;)

# Command&Control: (Downloader) Genome - regex: to_server:GET .*\/cgi\-bin/.*\.cgi\?.*User-Agent: MSIE\ \d\.0 detector_id: 53925
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Downloader) Genome"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cgi-bin/"; content:".cgi?"; content:"User-Agent|3A| MSIE "; content:".0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/cgi\-bin\/.*\.cgi\?.*User-Agent: MSIE\ \d\.0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053925; rev:1356;)

# Command&Control: (PPI) Yakes - regex: to_server:GET \/notificate\.php\?did=.*&ccode=\d HTTP.*User-Agent: Mozilla\/3\.0\ \(compatible\;\ Indy\ Library\) detector_id: 53926
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (PPI) Yakes"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/notificate.php?did="; content:"&ccode="; content:" HTTP"; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/notificate\.php\?did=.*&ccode=\d HTTP.*User-Agent: Mozilla\/3\.0\ \(compatible\;\ Indy\ Library\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053926; rev:1440;)

# Command&Control: (Ransomware) Crowti - regex: to_server:POST .*/img\d\.php\?[a-z]=[a-z0-9]{10,} HTTP.*w=[a-f0-9]{20,} detector_id: 53954
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) Crowti"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/img"; content:".php?"; content:" HTTP"; content:"w="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/img\d\.php\?[a-z]=[a-z0-9]{10,} HTTP.*w=[a-f0-9]{20,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053954; rev:1360;)

# Command&Control: (Dropper) Agent.ksja - regex: to_server:GET .*\.jpg\?\d+ HTTP/1\.1\r\nUser-Agent: Mozilla\/4\.0 \(Compatible\; MSIE 6\.0\;\)\r\nHost: [^\r]+\r\n\r\n detector_id: 53955
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Agent.ksja"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".jpg?"; content:" HTTP/1.1|0D||0A|User-Agent|3A| Mozilla/4.0 |28|Compatible|3B| MSIE 6.0|3B||29||0D||0A|Host|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.jpg\?\d+ HTTP\/1\.1\r\nUser-Agent: Mozilla\/4\.0 \(Compatible\; MSIE 6\.0\;\)\r\nHost: [^\r]+\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053955; rev:1360;)

# Command&Control: (Dropper) Agent.ksja - regex: to_server:GET .*\.php\?m=\d+&os=.*&ie=[\d\.]+ HTTP/1\.1\r\nUser-Agent: Mozilla\/4\.0 \(Compatible\; MSIE 6\.0\;\)\r\nHost: [^\r]+\r\n\r\n detector_id: 53956
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Agent.ksja"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?m="; content:"&os="; content:"&ie="; content:" HTTP/1.1|0D||0A|User-Agent|3A| Mozilla/4.0 |28|Compatible|3B| MSIE 6.0|3B||29||0D||0A|Host|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php\?m=\d+&os=.*&ie=[\d\.]+ HTTP\/1\.1\r\nUser-Agent: Mozilla\/4\.0 \(Compatible\; MSIE 6\.0\;\)\r\nHost: [^\r]+\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053956; rev:1360;)

# Command&Control: (Trojan) Startpage - regex: to_server:GET \/Nts\/usup\?ptid=.*&sid=.*&ln=[a-z\_]+&ver=[0-9\.]+&uid=.*&upv=.* HTTP.*User-Agent: Mozilla\/4\.0 \(compatible\; MSIE\ 8\.0\; Windows NT 5\.1\; Trident\/4\.0\; \) detector_id: 53957
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Startpage"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Nts/usup?ptid="; content:"&sid="; content:"&ln="; content:"&ver="; content:"&uid="; content:"&upv="; content:" HTTP"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 8.0|3B| Windows NT 5.1|3B| Trident/4.0|3B| |29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Nts\/usup\?ptid=.*&sid=.*&ln=[a-z\_]+&ver=[0-9\.]+&uid=.*&upv=.* HTTP.*User-Agent: Mozilla\/4\.0 \(compatible\; MSIE\ 8\.0\; Windows NT 5\.1\; Trident\/4\.0\; \)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053957; rev:1360;)

# Command&Control: (Dropper) Bicololo - regex: to_server:GET .*/\d+/\?mwa=[a-f0-9]{6} HTTP.*Host: \d+\.\d+\.\d+\.\d+ detector_id: 53958
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Bicololo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?mwa="; content:" HTTP"; content:"Host|3A| "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/\d+\/\?mwa=[a-f0-9]{6} HTTP.*Host: \d+\.\d+\.\d+\.\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053958; rev:1360;)

# Drive-by: (JAR download) Blackhole - regex: to_server:GET /[a-z\_-]+/[a-z0-9\_-]+\.php\?[a-zA-Z0-9]+=[a-zA-Z0-9]+&[a-zA-Z0-9]+=[a-zA-Z0-9]+ HTTP.*User-Agent: .*Java/1 detector_id: 53959
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: (JAR download) Blackhole"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?"; content:" HTTP"; content:"User-Agent|3A| "; content:"Java/1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z\_-]+\/[a-z0-9\_-]+\.php\?[a-zA-Z0-9]+=[a-zA-Z0-9]+&[a-zA-Z0-9]+=[a-zA-Z0-9]+ HTTP.*User-Agent: .*Java\/1/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053959; rev:1360;)

# Adware: (Downware) Amonetize - regex: to_server:POST \/name\.php HTTP.*i=.*&prefix=.*&version=[0-9\.]+ detector_id: 53970
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Amonetize"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/name.php HTTP"; content:"i="; content:"&prefix="; content:"&version="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/name\.php HTTP.*i=.*&prefix=.*&version=[0-9\.]+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053970; rev:1366;)

# Adware: (Toolbar) BrowseFox - regex: to_server:POST \/[a-z]{2}( HTTP.*|\?)alpha=[A-Za-z0-9\+\/]+\={0,2} detector_id: 53971
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) BrowseFox"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"alpha="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{2}( HTTP.*|\?)alpha=[A-Za-z0-9\+\/]+\={0,2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053971; rev:1366;)

# Command&Control: (Trojan) SpyEyes.atjw - regex: to_server:POST /[a-zA-Z0-9]+\.php HTTP.*\r\n\r\nn=\d+&m=.*&v=\d+&g=\d+ detector_id: 54003
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) SpyEyes.atjw"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"|0D||0A||0D||0A|n="; content:"&m="; content:"&v="; content:"&g="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-zA-Z0-9]+\.php HTTP.*\r\n\r\nn=\d+&m=.*&v=\d+&g=\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054003; rev:1370;)

# Adware: (Adware) Gamevance - regex: to_server:GET .*\.php\?.* HTTP/1\.1\r\nUser-Agent: zz\_gv \d+\r\nHost: [^\r]+\r\nCache-Control: no-cache(\r\nCookie: [^\r]+)?\r\n\r\n detector_id: 54004
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Gamevance"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?"; content:" HTTP/1.1|0D||0A|User-Agent|3A| zz_gv "; content:"|0D||0A|Host|3A| "; content:"|0D||0A|Cache-Control|3A| no-cache"; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php\?.* HTTP\/1\.1\r\nUser-Agent: zz\_gv \d+\r\nHost: [^\r]+\r\nCache-Control: no-cache(\r\nCookie: [^\r]+)?\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054004; rev:1370;)

# Command&Control: (Backdoor) Mhtserv - regex: to_server:GET .*\/fun\.php\?ID=.*&ip=\d+\.\d+\.\d+\.\d+(\:\d+)? HTTP.*User-Agent: test detector_id: 54005
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Mhtserv"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/fun.php?ID="; content:"&ip="; content:" HTTP"; content:"User-Agent|3A| test"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/fun\.php\?ID=.*&ip=\d+\.\d+\.\d+\.\d+(\:\d+)? HTTP.*User-Agent: test/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054005; rev:1370;)

# Command&Control: (Trojan) Zusy - regex: to_server:GET /[a-z]/ext/\?f HTTP detector_id: 54006
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zusy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ext/?f HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]\/ext\/\?f HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054006; rev:1370;)

# Command&Control: (Trojan) Zusy - regex: to_server:GET /[a-z]/infects/r\?a=.*&b=.*&c=.*&d=.* HTTP detector_id: 54007
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zusy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/infects/r?a="; content:"&b="; content:"&c="; content:"&d="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]\/infects\/r\?a=.*&b=.*&c=.*&d=.* HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054007; rev:1370;)

# Drive-by: (JAR Download) Nuclear EK - regex: to_server:GET (\/[0-9])*\/14\d{8}\.jar HTTP.*User-Agent: [^\r]*Java\/1\. detector_id: 54030
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: (JAR Download) Nuclear EK"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/14"; content:".jar HTTP"; content:"User-Agent|3A| "; content:"Java/1."; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(\/[0-9])*\/14\d{8}\.jar HTTP.*User-Agent: [^\r]*Java\/1\./s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054030; rev:1374;)

# Command&Control: (Trojan) Banload - regex: to_server:GET .*\/[a-zA-Z0-9]+\.jmp HTTP\/1\.1.*Content\-Type\: application\/x\-www\-form\-urlencoded.*Accept\: text\/html, \*\/\*.*Accept\-Encoding\: identity detector_id: 54033
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Banload"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".jmp HTTP/1.1"; content:"Content-Type|3A| application/x-www-form-urlencoded"; content:"Accept|3A| text/html|2C| |2A|/|2A|"; content:"Accept-Encoding|3A| identity"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/[a-zA-Z0-9]+\.jmp HTTP\/1\.1.*Content\-Type\: application\/x\-www\-form\-urlencoded.*Accept\: text\/html, \*\/\*.*Accept\-Encoding\: identity/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054033; rev:1374;)

# Command&Control: (Trojan) Zbot - regex: to_server:POST .*\.php HTTP\/1\.\d\r\nAccept: \*\/\*\r\nCache\-Control: no\-cache\r\nUser\-Agent: [^\r\n]+\r\nHost: [^\r\n]+\r\nContent\-Length: [^\r\n]+\r\nConnection: [^\r\n]+\r\n(?:\r\n)? detector_id: 54040
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zbot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP/1."; content:"|0D||0A|Accept|3A| |2A|/|2A||0D||0A|Cache-Control|3A| no-cache|0D||0A|User-Agent|3A| "; content:"|0D||0A|Host|3A| "; content:"|0D||0A|Content-Length|3A| "; content:"|0D||0A|Connection|3A| "; content:"|0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php HTTP\/1\.\d\r\nAccept: \*\/\*\r\nCache\-Control: no\-cache\r\nUser\-Agent: [^\r\n]+\r\nHost: [^\r\n]+\r\nContent\-Length: [^\r\n]+\r\nConnection: [^\r\n]+\r\n(?:\r\n)?/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054040; rev:1380;)

# OpenBDS blocking test - regex: to_server:GET /test_OpenBDS_blocking HTTP detector_id: 54084
reject http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS (msg:"OpenBDS OpenBDS blocking test"; flow:established,to_server; content:"GET"; nocase; http_method; content:"/test_OpenBDS_blocking HTTP"; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054084; rev:1;)

# Command&Control: (Trojan) Critroni - regex: to_server:GET .* HTTP/1\.1\r\nReferer: [^\r]+\r\nAccept: \*/\*\r\nCookie: disclaimer\_accepted\=true\r\nUser-Agent: Mozilla/5\.0 [^\r]+\r\nHost: [^\r]+\r\nCache-Control: [^\r]+\r\n\r\n detector_id: 54091
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Critroni"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP/1.1|0D||0A|Referer|3A| "; content:"|0D||0A|Accept|3A| |2A|/|2A||0D||0A|Cookie|3A| disclaimer_accepted=true|0D||0A|User-Agent|3A| Mozilla/5.0 "; content:"|0D||0A|Host|3A| "; content:"|0D||0A|Cache-Control|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.* HTTP\/1\.1\r\nReferer: [^\r]+\r\nAccept: \*\/\*\r\nCookie: disclaimer\_accepted\=true\r\nUser-Agent: Mozilla\/5\.0 [^\r]+\r\nHost: [^\r]+\r\nCache-Control: [^\r]+\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054091; rev:1383;)

# Command&Control: (Trojan) Neurevt - regex: to_server:POST /.*\.php(\?(p?id|page)=\d+)? HTTP/1\.1\r\nContent-Type: application/x-www-form-urlencoded\r\nUser-Agent: Mozilla/4\.0 \(compatible\;[^\r]+\r\nHost: [^\r]+\r\nContent-Length: \d{3,}\r\nCache-Control: no-cache\r\n\r\n[a-z]{4,10}=[a-fA-F0-9]+&[a-z]{4,10}=[a-fA-F0-9]+&[a-z]{4,10}=[a-fA-F0-9]+ detector_id: 54092
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Neurevt"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php"; content:" HTTP/1.1|0D||0A|Content-Type|3A| application/x-www-form-urlencoded|0D||0A|User-Agent|3A| Mozilla/4.0 |28|compatible|3B|"; content:"|0D||0A|Host|3A| "; content:"|0D||0A|Content-Length|3A| "; content:"|0D||0A|Cache-Control|3A| no-cache|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\.php(\?(p?id|page)=\d+)? HTTP\/1\.1\r\nContent-Type: application\/x-www-form-urlencoded\r\nUser-Agent: Mozilla\/4\.0 \(compatible\;[^\r]+\r\nHost: [^\r]+\r\nContent-Length: \d{3,}\r\nCache-Control: no-cache\r\n\r\n[a-z]{4,10}=[a-fA-F0-9]+&[a-z]{4,10}=[a-fA-F0-9]+&[a-z]{4,10}=[a-fA-F0-9]+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054092; rev:1383;)

# OpenBDS test signature - regex: to_server:GET /download_exec/[a-zA-Z0-9\_\-\.]+ HTTP detector_id: 54094
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS OpenBDS test signature"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/download_exec/"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/download_exec\/[a-zA-Z0-9\_\-\.]+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054094; rev:1384;)

# Adware: (Adware) Qjwmonkey - regex: to_server:GET /inst\.exe HTTP.*User-Agent: Mozilla/5\.0 \(compatible\; MSIE 9\.0\; Windows NT 6\.1\; WOW64\; Trident/5.0\) detector_id: 54119
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Qjwmonkey"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/inst.exe HTTP"; content:"User-Agent|3A| Mozilla/5.0 |28|compatible|3B| MSIE 9.0|3B| Windows NT 6.1|3B| WOW64|3B| Trident/5"; content:"0|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/inst\.exe HTTP.*User-Agent: Mozilla\/5\.0 \(compatible\; MSIE 9\.0\; Windows NT 6\.1\; WOW64\; Trident\/5.0\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054119; rev:1385;)

# Command&Control: (Trojan) Gamarue - regex: to_server:POST .*\/image\.php HTTP\/1\.1.*User\-Agent: Mozilla\/\d\.0\r\nContent\-Type: application\/x\-www\-form\-urlencoded\r\nContent\-Length: \d{2,3}\r\nConnection: close\r\n\r\n[A-Za-z0-9+\/]+={0,2} detector_id: 54123
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Gamarue"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/image.php HTTP/1.1"; content:"User-Agent|3A| Mozilla/"; content:".0|0D||0A|Content-Type|3A| application/x-www-form-urlencoded|0D||0A|Content-Length|3A| "; content:"|0D||0A|Connection|3A| close|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/image\.php HTTP\/1\.1.*User\-Agent: Mozilla\/\d\.0\r\nContent\-Type: application\/x\-www\-form\-urlencoded\r\nContent\-Length: \d{2,3}\r\nConnection: close\r\n\r\n[A-Za-z0-9+\/]+={0,2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054123; rev:1386;)

# Command&Control: (Callback) Metasploit meterpreter - regex: to_server:POST /[a-zA-Z0-9]+\_[a-zA-Z0-9]+/ HTTP.*\x00\x01\x00\x01core_channel_ detector_id: 54162
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Callback) Metasploit meterpreter"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ HTTP"; content:"|00||01||00||01|core_channel_"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-zA-Z0-9]+\_[a-zA-Z0-9]+\/ HTTP.*\x00\x01\x00\x01core_channel_/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054162; rev:1390;)

# Command&Control: (Callback) Metasploit Meterpreter - regex: to_server:POST /[a-zA-Z0-9]+\_[a-zA-Z0-9]+/ HTTP.*\x00\x01\x00\x01stdapi_ detector_id: 54163
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Callback) Metasploit Meterpreter"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ HTTP"; content:"|00||01||00||01|stdapi_"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-zA-Z0-9]+\_[a-zA-Z0-9]+\/ HTTP.*\x00\x01\x00\x01stdapi_/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054163; rev:1390;)

# GET to 3322 subdomain - regex: to_server:GET .*Host: [^\r]+\.f?3322\.(org|net) detector_id: 54165
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS GET to 3322 subdomain"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"Host|3A| "; content:"3322."; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*Host: [^\r]+\.f?3322\.(org|net)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054165; rev:1391;)

# POST to 3322 subdomain - regex: to_server:POST .*Host: [^\r]+\.f?3322\.(org|net) detector_id: 54166
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS POST to 3322 subdomain"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"Host|3A| "; content:"3322."; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*Host: [^\r]+\.f?3322\.(org|net)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054166; rev:1391;)

# Command&Control: (Dropper) Onlinegames - regex: to_server:GET .*\.bin HTTP\/1\.\d\r\nUser\-Agent: HTTPTEST\r\n detector_id: 54175
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Onlinegames"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".bin HTTP/1."; content:"|0D||0A|User-Agent|3A| HTTPTEST|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.bin HTTP\/1\.\d\r\nUser\-Agent: HTTPTEST\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054175; rev:1398;)

# Command&Control: (Trojan) Redosdru - regex: to_server:GET /\d\.jpg HTTP/1\.1\r\nUser-Agent: Mozilla/4\.0 \(compatible\)\r\nHost: \d+\.\d+\.\d+\.\d+(\:\d+)?\r\nCache-Control: no-cache\r\n\r\n detector_id: 54200
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Redosdru"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".jpg HTTP/1.1|0D||0A|User-Agent|3A| Mozilla/4.0 |28|compatible|29||0D||0A|Host|3A| "; content:"|0D||0A|Cache-Control|3A| no-cache|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d\.jpg HTTP\/1\.1\r\nUser-Agent: Mozilla\/4\.0 \(compatible\)\r\nHost: \d+\.\d+\.\d+\.\d+(\:\d+)?\r\nCache-Control: no-cache\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054200; rev:1401;)

# Command&Control: (Dropper) Generic dropper - regex: to_server:GET .*/image\.php\?id=\d+&act=\d+ HTTP.*User-Agent: Mozilla/4\.0 \(compatible\; MSIE 7\.0\; Windows NT 5\.1\; Trident/4\.0\; \.NET4\.0C\; \.NET4\.0E\; \.NET CLR 2\.0\.50727\; \.NET CLR 3\.0\.4506\.2152\; \.NET CLR 3\.5\.30729\; \.NET CLR 1\.1\.4322\) detector_id: 54201
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Generic dropper"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/image.php?id="; content:"&act="; content:" HTTP"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 7.0|3B| Windows NT 5.1|3B| Trident/4.0|3B| .NET4.0C|3B| .NET4.0E|3B| .NET CLR 2.0.50727|3B| .NET CLR 3.0.4506.2152|3B| .NET CLR 3.5.30729|3B| .NET CLR 1.1.4322|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/image\.php\?id=\d+&act=\d+ HTTP.*User-Agent: Mozilla\/4\.0 \(compatible\; MSIE 7\.0\; Windows NT 5\.1\; Trident\/4\.0\; \.NET4\.0C\; \.NET4\.0E\; \.NET CLR 2\.0\.50727\; \.NET CLR 3\.0\.4506\.2152\; \.NET CLR 3\.5\.30729\; \.NET CLR 1\.1\.4322\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054201; rev:1403;)

# Command&Control: (Trojan) Mewsei - regex: to_server:POST /si\.php\?xd=\{.*\} HTTP.*User-Agent: MSIE detector_id: 54202
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Mewsei"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/si.php?xd=|7B|"; content:"|7D| HTTP"; content:"User-Agent|3A| MSIE"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/si\.php\?xd=\{.*\} HTTP.*User-Agent: MSIE/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054202; rev:1401;)

# Command&Control: (Dropper) Satray - regex: to_server:GET /Counter/NewCounter\.asp\?Param=[\%a-f0-9]{6,} HTTP.*User-Agent: NUT\r\n detector_id: 54203
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Satray"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Counter/NewCounter.asp?Param="; content:" HTTP"; content:"User-Agent|3A| NUT|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Counter\/NewCounter\.asp\?Param=[\%a-f0-9]{6,} HTTP.*User-Agent: NUT\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054203; rev:1401;)

# Adware: (Riskware) Zoomylib - regex: to_server:POST .* HTTP/1\.1\r\nContent-Type: application/x-www-form-urlencoded\r\nHost: [^\r]+\r\nContent-Length: \d+\r\nCache-Control: no-cache\r\n\r\nkey=.*&x=\d+ detector_id: 54204
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Riskware) Zoomylib"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:" HTTP/1.1|0D||0A|Content-Type|3A| application/x-www-form-urlencoded|0D||0A|Host|3A| "; content:"|0D||0A|Content-Length|3A| "; content:"|0D||0A|Cache-Control|3A| no-cache|0D||0A||0D||0A|key="; content:"&x="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.* HTTP\/1\.1\r\nContent-Type: application\/x-www-form-urlencoded\r\nHost: [^\r]+\r\nContent-Length: \d+\r\nCache-Control: no-cache\r\n\r\nkey=.*&x=\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054204; rev:1401;)

# Adware: (Adware) InstallIQ - regex: to_server:POST \/ruxitbeacon HTTP.*User-Agent: Mozilla\/4\.0 \(compatible\; MSIE 8\.0\; Windows NT 5\.1\; Trident/4\.0\; \.NET4\.0C\; \.NET4\.0E\; \.NET CLR 2\.0\.50727\; \.NET CLR 3\.0\.4506\.2152\; \.NET CLR 3\.5\.30729\; \.NET CLR 1\.1\.4322\).*\$a=.* detector_id: 54205
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) InstallIQ"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ruxitbeacon HTTP"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 8.0|3B| Windows NT 5.1|3B| Trident/4.0|3B| .NET4.0C|3B| .NET4.0E|3B| .NET CLR 2.0.50727|3B| .NET CLR 3.0.4506.2152|3B| .NET CLR 3.5.30729|3B| .NET CLR 1.1.4322|29|"; content:"|24|a="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ruxitbeacon HTTP.*User-Agent: Mozilla\/4\.0 \(compatible\; MSIE 8\.0\; Windows NT 5\.1\; Trident\/4\.0\; \.NET4\.0C\; \.NET4\.0E\; \.NET CLR 2\.0\.50727\; \.NET CLR 3\.0\.4506\.2152\; \.NET CLR 3\.5\.30729\; \.NET CLR 1\.1\.4322\).*\$a=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054205; rev:1401;)

# Command&Control: (Trojan Downloader) FakeIE - regex: to_server:GET \/index\.php\?tn=\d{8}\_pg HTTP detector_id: 54206
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan Downloader) FakeIE"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?tn="; content:"_pg HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\?tn=\d{8}\_pg HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054206; rev:1402;)

# Adware: (Bundler) Bundlore - regex: to_server:POST \/TapAction\.aspx\?campaign\_id=.*&tpi=.*&action\_id=\d HTTP.*User-Agent: InnoTools\_Downloader.*RK\ web\ call detector_id: 54208
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Bundler) Bundlore"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/TapAction.aspx?campaign_id="; content:"&tpi="; content:"&action_id="; content:" HTTP"; content:"User-Agent|3A| InnoTools_Downloader"; content:"RK web call"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/TapAction\.aspx\?campaign\_id=.*&tpi=.*&action\_id=\d HTTP.*User-Agent: InnoTools\_Downloader.*RK\ web\ call/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054208; rev:1402;)

# Command&Control: (Trojan) Staser - regex: to_server:GET \/vuupc\/dl\.php\?fn=\_suf\d HTTP.*User\-Agent: NSIS\_Inetc\ \(Mozilla\) detector_id: 54209
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Staser"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/vuupc/dl.php?fn=_suf"; content:" HTTP"; content:"User-Agent|3A| NSIS_Inetc |28|Mozilla|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/vuupc\/dl\.php\?fn=\_suf\d HTTP.*User\-Agent: NSIS\_Inetc\ \(Mozilla\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054209; rev:1402;)

# Command&Contro: (Trojan) Pincav - regex: to_server:GET \/services\/(rules|stores|update).*(\?|\&)dummy=\d{3} HTTP detector_id: 54210
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Contro: (Trojan) Pincav"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/services/"; content:"dummy="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/services\/(rules|stores|update).*(\?|\&)dummy=\d{3} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054210; rev:1402;)

# BrowserEnhancer: (BHO) Firstfloor - regex: to_server:GET \/process\/GetOfferPageV3\.ashx\?appid=-?\d*&si=\d*&lang=[a-z]{2}&oid=\d*&browser=[^&]+&ai=&paa=&uus=[A-F0-9\-]{24,}&mac=(?:[A-F0-9]{2}\:){5}[A-F0-9]{2}&vm=\d HTTP detector_id: 54211
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS BrowserEnhancer: (BHO) Firstfloor"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/process/GetOfferPageV3.ashx?appid="; content:"&si="; content:"&lang="; content:"&oid="; content:"&browser="; content:"&ai=&paa=&uus="; content:"&mac="; content:"&vm="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/process\/GetOfferPageV3\.ashx\?appid=-?\d*&si=\d*&lang=[a-z]{2}&oid=\d*&browser=[^&]+&ai=&paa=&uus=[A-F0-9\-]{24,}&mac=(?:[A-F0-9]{2}\:){5}[A-F0-9]{2}&vm=\d HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054211; rev:1402;)

# Command&Control: (Trojan) SystemHijack - regex: to_server:GET .*(\/ll\/.*\/login.asp)\?m=[\%A-F0-9]{48}&v=(?:\%[A-F0-9]{2})+&d=[\%A-F0-9]{96}&u=(?:\%[A-F0-9]{2})+&C=(?:\%[A-F0-9]{2})+&o=(?:\%[A-F0-9]{2})+&k=[\%A-F0-9]{96}&E=[\d\.]+&G= HTTP\/1\.1\r\nUser\-Agent: http:\/\/[^\r]*\1 detector_id: 54223
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) SystemHijack"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?m="; content:"&v="; content:"&d="; content:"&u="; content:"&C="; content:"&o="; content:"&k="; content:"&E="; content:"&G= HTTP/1.1|0D||0A|User-Agent|3A| http|3A|//"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*(\/ll\/.*\/login.asp)\?m=[\%A-F0-9]{48}&v=(?:\%[A-F0-9]{2})+&d=[\%A-F0-9]{96}&u=(?:\%[A-F0-9]{2})+&C=(?:\%[A-F0-9]{2})+&o=(?:\%[A-F0-9]{2})+&k=[\%A-F0-9]{96}&E=[\d\.]+&G= HTTP\/1\.1\r\nUser\-Agent: http:\/\/[^\r]*\1/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054223; rev:1404;)

# Adware: (Riskware) Kraddare - regex: to_server:POST /a/v\d/.*\.php HTTP.*User-Agent: plusmat.*m=\d+&a=.* detector_id: 54224
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Riskware) Kraddare"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/a/v"; content:".php HTTP"; content:"User-Agent|3A| plusmat"; content:"m="; content:"&a="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/a\/v\d\/.*\.php HTTP.*User-Agent: plusmat.*m=\d+&a=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054224; rev:1404;)

# Adware: (Downware) Torntv - regex: to_server:GET \/cdi\.asp\?st=[a-zA-Z0-9]+ HTTP.*User-Agent: NSIS\_Inetc\ \(Mozilla\) detector_id: 54230
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Torntv"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cdi.asp?st="; content:" HTTP"; content:"User-Agent|3A| NSIS_Inetc |28|Mozilla|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cdi\.asp\?st=[a-zA-Z0-9]+ HTTP.*User-Agent: NSIS\_Inetc\ \(Mozilla\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054230; rev:1404;)

# Adware: (PUA) PornTool - regex: to_server:GET \/DownloadInsertinfo\.aspx\?Browser=.*&Resolution=\d+\x2a\d+&OS=.*&KEY=.*&Mac=[A-Fa-f0-9\-]{17}&HardDrive=.*&CPU=.*&Graphics=.*&Safe=.*&QQ=.*&Sougou=.*&Lmarkid=\d+&Wmarkid=\d+&Mtype=\d+&tick=\d+&flag=[a-f0-9]{32}&status=\d+&qqnumber=.*&downloadtime=\d+&setuptime=\d+&downloadflag=\d+&v=V\d\.\d HTTP\/1\.1\r\nUser-Agent: DownloadInstall detector_id: 54231
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUA) PornTool"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/DownloadInsertinfo.aspx?Browser="; content:"&Resolution="; content:"&OS="; content:"&KEY="; content:"&Mac="; content:"&HardDrive="; content:"&CPU="; content:"&Graphics="; content:"&Safe="; content:"&QQ="; content:"&Sougou="; content:"&Lmarkid="; content:"&Wmarkid="; content:"&Mtype="; content:"&tick="; content:"&flag="; content:"&status="; content:"&qqnumber="; content:"&downloadtime="; content:"&setuptime="; content:"&downloadflag="; content:"&v=V"; content:" HTTP/1.1|0D||0A|User-Agent|3A| DownloadInstall"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/DownloadInsertinfo\.aspx\?Browser=.*&Resolution=\d+\x2a\d+&OS=.*&KEY=.*&Mac=[A-Fa-f0-9\-]{17}&HardDrive=.*&CPU=.*&Graphics=.*&Safe=.*&QQ=.*&Sougou=.*&Lmarkid=\d+&Wmarkid=\d+&Mtype=\d+&tick=\d+&flag=[a-f0-9]{32}&status=\d+&qqnumber=.*&downloadtime=\d+&setuptime=\d+&downloadflag=\d+&v=V\d\.\d HTTP\/1\.1\r\nUser-Agent: DownloadInstall/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054231; rev:1404;)

# Command&Control: (DDoS) Dirtjumper - regex: to_server:POST .* HTTP/1\.0\r\nHost: [^\r]+\r\nKeep-Alive: \d+\r\nConnection: keep-alive\r\nUser-Agent: Mozilla/5\.0 \(Windows\; U\; Windows NT 5\.1\; en-US\)\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: \d+\r\n\r\nk=[a-z0-9]{32}||to_server:POST .* HTTP/1\.0\r\nHost: [^\r]+\r\nKeep-Alive: \d+\r\nConnection: [^\r]+\r\nUser-Agent: Mozilla/5\.0 \(Windows\; U\; Windows NT 5\.1\; en-US\)\r\nContent-Type: [^\r]+\r\nContent-Length: \d+\r\n\r\nk=[a-z0-9]{32} detector_id: 54243
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (DDoS) Dirtjumper (0) (no alert)"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:" HTTP/1.0|0D||0A|Host|3A| "; content:"|0D||0A|Keep-Alive|3A| "; content:"|0D||0A|Connection|3A| keep-alive|0D||0A|User-Agent|3A| Mozilla/5.0 |28|Windows|3B| U|3B| Windows NT 5.1|3B| en-US|29||0D||0A|Content-Type|3A| application/x-www-form-urlencoded|0D||0A|Content-Length|3A| "; content:"|0D||0A||0D||0A|k="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.* HTTP\/1\.0\r\nHost: [^\r]+\r\nKeep-Alive: \d+\r\nConnection: keep-alive\r\nUser-Agent: Mozilla\/5\.0 \(Windows\; U\; Windows NT 5\.1\; en-US\)\r\nContent-Type: application\/x-www-form-urlencoded\r\nContent-Length: \d+\r\n\r\nk=[a-z0-9]{32}/s"; flowbits:set,LL.54243_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105424300; rev:1405;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (DDoS) Dirtjumper (1)"; flowbits:isset,LL.54243_0; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:" HTTP/1.0|0D||0A|Host|3A| "; content:"|0D||0A|Keep-Alive|3A| "; content:"|0D||0A|Connection|3A| "; content:"|0D||0A|User-Agent|3A| Mozilla/5.0 |28|Windows|3B| U|3B| Windows NT 5.1|3B| en-US|29||0D||0A|Content-Type|3A| "; content:"|0D||0A|Content-Length|3A| "; content:"|0D||0A||0D||0A|k="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.* HTTP\/1\.0\r\nHost: [^\r]+\r\nKeep-Alive: \d+\r\nConnection: [^\r]+\r\nUser-Agent: Mozilla\/5\.0 \(Windows\; U\; Windows NT 5\.1\; en-US\)\r\nContent-Type: [^\r]+\r\nContent-Length: \d+\r\n\r\nk=[a-z0-9]{32}/s"; flowbits:unset,LL.54243_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105424301; rev:1405;)

# Command&Control: (Trojan) Zusy - regex: to_server:POST \/fsi\.php\?(comp=[^\ ]+|[a-z]+&[a-z]+) HTTP.*User-Agent: fortis\r\n.*Content-Length: 0\r\n detector_id: 54248
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zusy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/fsi.php?"; content:" HTTP"; content:"User-Agent|3A| fortis|0D||0A|"; content:"Content-Length|3A| 0|0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/fsi\.php\?(comp=[^\ ]+|[a-z]+&[a-z]+) HTTP.*User-Agent: fortis\r\n.*Content-Length: 0\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054248; rev:1410;)

# Command&Control: (Dropper) MSIL.TrojanDownloader - regex: to_server:GET \/\d{8} HTTP\/1\.\d\r\nHost: [^\r]+\r\n\r\n detector_id: 54249
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) MSIL.TrojanDownloader"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP/1."; content:"|0D||0A|Host|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d{8} HTTP\/1\.\d\r\nHost: [^\r]+\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054249; rev:1410;)

# Command&Control: (Trojan) Beaugrit - regex: to_server:GET \/403\/? HTTP\/1\.1\r\nUser\-Agent: Mozilla\/6\.0 \(compatible\)\r\nHost: detector_id: 54251
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Beaugrit"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/403"; content:" HTTP/1.1|0D||0A|User-Agent|3A| Mozilla/6.0 |28|compatible|29||0D||0A|Host|3A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/403\/? HTTP\/1\.1\r\nUser\-Agent: Mozilla\/6\.0 \(compatible\)\r\nHost:/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054251; rev:1410;)

# Adware: (Downware) 4thRequest - regex: to_server:GET \/(\d{6})d\/\1\_[a-zA-Z0-9]{2}\.exe\?([a-zA-Z0-9]{20,30})=\2 HTTP.*User-Agent: NSIS\_Inetc \(Mozilla\)||to_server:GET \/\d{6}d\/\d{6}\_[a-z0-9A-Z\_]+\.exe\?aleaTokenID=[a-zA-Z0-9]{10,} HTTP detector_id: 54352
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) 4thRequest (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"d/"; content:".exe?"; content:" HTTP"; content:"User-Agent|3A| NSIS_Inetc |28|Mozilla|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(\d{6})d\/\1\_[a-zA-Z0-9]{2}\.exe\?([a-zA-Z0-9]{20,30})=\2 HTTP.*User-Agent: NSIS\_Inetc \(Mozilla\)/s"; flowbits:set,LL.54352_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105435200; rev:1411;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) 4thRequest (1)"; flowbits:isset,LL.54352_0; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"d/"; content:".exe?aleaTokenID="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d{6}d\/\d{6}\_[a-z0-9A-Z\_]+\.exe\?aleaTokenID=[a-zA-Z0-9]{10,} HTTP/"; flowbits:unset,LL.54352_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105435201; rev:1411;)

# Command&Control: (Trojan) Ramnit - regex: to_server:GET \/\?id\d{5,} HTTP detector_id: 54262
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ramnit"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?id"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?id\d{5,} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054262; rev:1412;)

# Adware: (Riskware) Ammyy Admin - regex: to_server:POST / HTTP.*v=\d\.\d&d=[A-Za-z0-9]{10,} detector_id: 54264
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Riskware) Ammyy Admin"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ HTTP"; content:"v="; content:"&d="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ HTTP.*v=\d\.\d&d=[A-Za-z0-9]{10,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054264; rev:1412;)

# Spyware: (Installer) Y73Client - regex: to_server:POST /i\.php\?ID=\d+&fn=\d+\_\d+-\d+-\d+-\d+-\d+-\d+&Var=\d+ HTTP.*User-Agent: Y73Client detector_id: 54265
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Spyware: (Installer) Y73Client"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/i.php?ID="; content:"&fn="; content:"&Var="; content:" HTTP"; content:"User-Agent|3A| Y73Client"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/i\.php\?ID=\d+&fn=\d+\_\d+-\d+-\d+-\d+-\d+-\d+&Var=\d+ HTTP.*User-Agent: Y73Client/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054265; rev:1412;)

# Command&Control: (Hacktool) Doser - regex: to_server:GET .*\/add\.php\?uid=[A-Z0-9]{32}&os=.*&ip=\d+\.\d+\.\d+\.\d+&name=.* HTTP detector_id: 54266
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Hacktool) Doser"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/add.php?uid="; content:"&os="; content:"&ip="; content:"&name="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/add\.php\?uid=[A-Z0-9]{32}&os=.*&ip=\d+\.\d+\.\d+\.\d+&name=.* HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054266; rev:1412;)

# Fake-AV: (Rogue) Trapwot - regex: to_server:POST .*/rp\?v=\d+&a=\d+&u=[a-z0-9]{32}&d=\d+&f=\d+&c=\d+ HTTP.*Host: \d+\.\d+\.\d+\.\d+ detector_id: 54267
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Fake-AV: (Rogue) Trapwot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/rp?v="; content:"&a="; content:"&u="; content:"&d="; content:"&f="; content:"&c="; content:" HTTP"; content:"Host|3A| "; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/rp\?v=\d+&a=\d+&u=[a-z0-9]{32}&d=\d+&f=\d+&c=\d+ HTTP.*Host: \d+\.\d+\.\d+\.\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054267; rev:1412;)

# Command&Control: (Payload) Zemot - regex: to_server:GET /mod_[a-z0-9]+/[a-z0-9A-Z]+/ HTTP.*User-Agent: Mozilla/4\.0 \(compatible\; MSIE 8\.0\; Windows NT 5\.1\; Trident/4\.0\; \.NET CLR 2\.0\.50727\; \.NET CLR 3\.0\.04506\.30\; \.NET CLR 3\.0\.4506\.2152\; \.NET CLR 3\.5\.30729\; \.NET CLR 4\.0\.3219\) detector_id: 54291
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Payload) Zemot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mod_"; content:"/ HTTP"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 8.0|3B| Windows NT 5.1|3B| Trident/4.0|3B| .NET CLR 2.0.50727|3B| .NET CLR 3.0.04506.30|3B| .NET CLR 3.0.4506.2152|3B| .NET CLR 3.5.30729|3B| .NET CLR 4.0.3219|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mod_[a-z0-9]+\/[a-z0-9A-Z]+\/ HTTP.*User-Agent: Mozilla\/4\.0 \(compatible\; MSIE 8\.0\; Windows NT 5\.1\; Trident\/4\.0\; \.NET CLR 2\.0\.50727\; \.NET CLR 3\.0\.04506\.30\; \.NET CLR 3\.0\.4506\.2152\; \.NET CLR 3\.5\.30729\; \.NET CLR 4\.0\.3219\)/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054291; rev:1414;)

# Command&Control: (Trojan) TrojanClicker - regex: to_server:GET .*\/rm\.php\?v=\d&version=\d+ HTTP.*User-Agent: Mozilla\/4\.0 detector_id: 54292
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) TrojanClicker"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/rm.php?v="; content:"&version="; content:" HTTP"; content:"User-Agent|3A| Mozilla/4.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/rm\.php\?v=\d&version=\d+ HTTP.*User-Agent: Mozilla\/4\.0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054292; rev:1414;)

# Command&Control: (Trojan) Rukometa - regex: to_server:HEAD \/\?prod=[a-z\_]+(&version=[0-9\.]+)?&action=[a-z\_]+&.* HTTP/1\.1\r\nHost: [^\r]+\r\nAccept: \*/\*\r\n\r\n detector_id: 54293
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Rukometa"; flow:established,to_server; content:"HEAD"; nocase; http_method; content:"HEAD "; content:"/?prod="; content:"&action="; content:" HTTP/1.1|0D||0A|Host|3A| "; content:"|0D||0A|Accept|3A| |2A|/|2A||0D||0A||0D||0A|"; pcre:"/HEAD (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?prod=[a-z\_]+(&version=[0-9\.]+)?&action=[a-z\_]+&.* HTTP\/1\.1\r\nHost: [^\r]+\r\nAccept: \*\/\*\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054293; rev:1414;)

# Adware: (Adware) LoadMoney - regex: to_server:POST /get_json\?stb=\d+&did=.*&file_id=\d+(&delay=\d+)? HTTP.*User-Agent: Downloader [\d\.]+ detector_id: 54314
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) LoadMoney"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/get_json?stb="; content:"&did="; content:"&file_id="; content:" HTTP"; content:"User-Agent|3A| Downloader "; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get_json\?stb=\d+&did=.*&file_id=\d+(&delay=\d+)? HTTP.*User-Agent: Downloader [\d\.]+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054314; rev:1415;)

# Adware: (Adware) LoadMoney - regex: to_server:GET /get_json\?stb=\d+&did=.*&file_id=\d+(&delay=\d+)? HTTP.*User-Agent: Downloader [\d\.]+ detector_id: 54315
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) LoadMoney"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get_json?stb="; content:"&did="; content:"&file_id="; content:" HTTP"; content:"User-Agent|3A| Downloader "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get_json\?stb=\d+&did=.*&file_id=\d+(&delay=\d+)? HTTP.*User-Agent: Downloader [\d\.]+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054315; rev:1415;)

# Adware: (BHO) Crossrider - regex: to_server:GET \/apps\.gif\?action=[a-z]+&app=\d+&appver=\d&ver=[\d\_]+&version\_date=\d{2}\-\d{2}\-\d{2}&bic=.*&verifier=.*&upi=[a-f0-9]{32}&procid=[A-F0-9]{32}..&srcid=\d+&subid=\d&zdata=\d&browser=[a-z]+&browserver=\d+&default=[a-z]+&chver=[\d\.]+&ffver=[\d\.]+&iever=[\d\.]+&curtime=\d+&country=[a-z]{2}&aver=.*&os=[A-Za-z0-9]+&arp=\d&parent=[a-z]+&silent=\d&crtnm=.*&procstarttime=\d+&procruntime=\d+&rnd=\d+ HTTP detector_id: 54316
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (BHO) Crossrider"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/apps.gif?action="; content:"&app="; content:"&appver="; content:"&ver="; content:"&version_date="; content:"&bic="; content:"&verifier="; content:"&upi="; content:"&procid="; content:"&srcid="; content:"&subid="; content:"&zdata="; content:"&browser="; content:"&browserver="; content:"&default="; content:"&chver="; content:"&ffver="; content:"&iever="; content:"&curtime="; content:"&country="; content:"&aver="; content:"&os="; content:"&arp="; content:"&parent="; content:"&silent="; content:"&crtnm="; content:"&procstarttime="; content:"&procruntime="; content:"&rnd="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/apps\.gif\?action=[a-z]+&app=\d+&appver=\d&ver=[\d\_]+&version\_date=\d{2}\-\d{2}\-\d{2}&bic=.*&verifier=.*&upi=[a-f0-9]{32}&procid=[A-F0-9]{32}..&srcid=\d+&subid=\d&zdata=\d&browser=[a-z]+&browserver=\d+&default=[a-z]+&chver=[\d\.]+&ffver=[\d\.]+&iever=[\d\.]+&curtime=\d+&country=[a-z]{2}&aver=.*&os=[A-Za-z0-9]+&arp=\d&parent=[a-z]+&silent=\d&crtnm=.*&procstarttime=\d+&procruntime=\d+&rnd=\d+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054316; rev:1416;)

# Command&Control: (Trojan) Pasta - regex: to_server:GET (/[a-z]+)?/[a-z]+\.txt HTTP/1\.1\r\nUser-Agent: Mozilla/4\.0 \(compatible; MSIE 6\.0; Windows NT 5\.0\)\r\nAccept: \*/\*\r\nHost: [a-zA-Z][^\r]+\r\nCache-Control: no-cache\r\n\r\n detector_id: 54331
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Pasta"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".txt HTTP/1.1|0D||0A|User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 6.0|3B| Windows NT 5.0|29||0D||0A|Accept|3A| |2A|/|2A||0D||0A|Host|3A| "; content:"|0D||0A|Cache-Control|3A| no-cache|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(\/[a-z]+)?\/[a-z]+\.txt HTTP\/1\.1\r\nUser-Agent: Mozilla\/4\.0 \(compatible\; MSIE 6\.0\; Windows NT 5\.0\)\r\nAccept: \*\/\*\r\nHost: [a-zA-Z][^\r]+\r\nCache-Control: no-cache\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054331; rev:1418;)

# Adware: (Riskware) VKontakteDJ - regex: to_server:GET .*\?srandom=.*&djversion=&version=[0-9\.]+&uid=.*&close=\d&letsgo=\d&options=\d+&mindtime=.*&advert\_key=.* HTTP detector_id: 54332
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Riskware) VKontakteDJ"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?srandom="; content:"&djversion=&version="; content:"&uid="; content:"&close="; content:"&letsgo="; content:"&options="; content:"&mindtime="; content:"&advert_key="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\?srandom=.*&djversion=&version=[0-9\.]+&uid=.*&close=\d&letsgo=\d&options=\d+&mindtime=.*&advert\_key=.* HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054332; rev:1418;)

# Adware: (PUA) PullUpdate - regex: to_server:POST \/[a-z]{2,3}\?v=\d HTTP.*Content\-Type: text\/plain\r\nContent\-Length:\d+ detector_id: 54333
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUA) PullUpdate"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"?v="; content:" HTTP"; content:"Content-Type|3A| text/plain|0D||0A|Content-Length|3A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{2,3}\?v=\d HTTP.*Content\-Type: text\/plain\r\nContent\-Length:\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054333; rev:1418;)

# Malware distribution: Badur.igh - regex: to_server:GET /[a-z]{2,3}\d{2}[a-z]\d{3}\.exe HTTP/1\.1\r\nUser-Agent: Mozilla/4\.0\r\nHost: \d+\.\d+\.\d+\.\d+\r\n\r\n detector_id: 54348
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Malware distribution: Badur.igh"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".exe HTTP/1.1|0D||0A|User-Agent|3A| Mozilla/4.0|0D||0A|Host|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{2,3}\d{2}[a-z]\d{3}\.exe HTTP\/1\.1\r\nUser-Agent: Mozilla\/4\.0\r\nHost: \d+\.\d+\.\d+\.\d+\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054348; rev:1419;)

# command&control: Fareit - regex: to_server:POST .*gate\.php HTTP..\..\r\n.*\r\n\r\n[\x80-\xFF]{3,4} detector_id: 54349
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: Fareit"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"gate.php HTTP"; content:"|0D||0A|"; content:"|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*gate\.php HTTP..\..\r\n.*\r\n\r\n[\x80-\xFF]{3,4}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054349; rev:1422;)

# Command&Control: (Trojan) Lurk - regex: to_server:GET \/index\.php\?hl=.*&source=.*&q=\d+&aq=.*&aqi=.*&aql=.*&oq=\d+ HTTP detector_id: 54353
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Lurk"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?hl="; content:"&source="; content:"&q="; content:"&aq="; content:"&aqi="; content:"&aql="; content:"&oq="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\?hl=.*&source=.*&q=\d+&aq=.*&aqi=.*&aql=.*&oq=\d+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054353; rev:1424;)

# Command&Control: (Dropper) Zusy - regex: to_server:GET .*\?sid=[A-F0-9]{32}&uv=\d&tm=\d+\.\d HTTP\/1\.1\r\nAccept: \*\/\*\r\n detector_id: 54354
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Zusy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?sid="; content:"&uv="; content:"&tm="; content:" HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\?sid=[A-F0-9]{32}&uv=\d&tm=\d+\.\d HTTP\/1\.1\r\nAccept: \*\/\*\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054354; rev:1424;)

# Command&Control: (Downloader) Agent - regex: to_server:GET \/adn\.php\?br=\d&s=\d+&i=\x257B[a-f0-9\-]+\x257D&adv=\d&v=[\d\.]+ HTTP detector_id: 54356
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Downloader) Agent"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/adn.php?br="; content:"&s="; content:"&i=|25|7B"; content:"|25|7D&adv="; content:"&v="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/adn\.php\?br=\d&s=\d+&i=\x257B[a-f0-9\-]+\x257D&adv=\d&v=[\d\.]+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054356; rev:1424;)

# Adware: (Downloader) 4shared download manager - regex: to_server:GET .*\?preloader=\d&preloadergrip=.*&ua=.*&ts=\d+ detector_id: 54387
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downloader) 4shared download manager"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?preloader="; content:"&preloadergrip="; content:"&ua="; content:"&ts="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\?preloader=\d&preloadergrip=.*&ua=.*&ts=\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054387; rev:1426;)

# Suspicious test pattern - regex: to_server:GET /test\d+/[a-zA-Z0-9\_\-\.]+ HTTP detector_id: 54392
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Suspicious test pattern"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/test"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/test\d+\/[a-zA-Z0-9\_\-\.]+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054392; rev:1428;)

# Command&Control: (Dropper) Badur - regex: to_server:HEAD \/getinfo\.php\?r=\d&snid=[A-Za-z0-9\+\/\=]+&getid=[a-f0-9]{32}&rnd=\d+ HTTP.*User-Agent: Mozilla\/\d\.0\ \(compatible\;\ Indy\ Library\) detector_id: 55235
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Badur"; flow:established,to_server; content:"HEAD"; nocase; http_method; content:"HEAD "; content:"/getinfo.php?r="; content:"&snid="; content:"&getid="; content:"&rnd="; content:" HTTP"; content:"User-Agent|3A| Mozilla/"; content:".0 |28|compatible|3B| Indy Library|29|"; pcre:"/HEAD (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/getinfo\.php\?r=\d&snid=[A-Za-z0-9\+\/\=]+&getid=[a-f0-9]{32}&rnd=\d+ HTTP.*User-Agent: Mozilla\/\d\.0\ \(compatible\;\ Indy\ Library\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1055235; rev:1432;)

# Adware: (Downware) BTmagnat - regex: to_server:GET \/log\.php\?pcid=\d+&type=[a-zA-Z]+&msg=.*&fileid=\d+&siteid=\d+&id1=\d+&id2=\d+&pcid=\d+&lang=[a-z]{2}&version=\d HTTP\/1\.1\r\nUser\-Agent: tebeinteresno detector_id: 55236
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) BTmagnat"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/log.php?pcid="; content:"&type="; content:"&msg="; content:"&fileid="; content:"&siteid="; content:"&id1="; content:"&id2="; content:"&pcid="; content:"&lang="; content:"&version="; content:" HTTP/1.1|0D||0A|User-Agent|3A| tebeinteresno"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/log\.php\?pcid=\d+&type=[a-zA-Z]+&msg=.*&fileid=\d+&siteid=\d+&id1=\d+&id2=\d+&pcid=\d+&lang=[a-z]{2}&version=\d HTTP\/1\.1\r\nUser\-Agent: tebeinteresno/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1055236; rev:1432;)

# Command&Control: (Trojan) MediaDrug - regex: to_server:GET \/client\.config\/\?format=json&advert\_key=[a-zA-Z0-9\+\/\=]+&app=[a-zA-Z\_]+&oslang=[a-z]{2}\-[a-z]{2}&brlang=&uid=[a-f0-9\-]{77} HTTP\/1\.1\r\nAccept: \*\/\*\r\n detector_id: 55237
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) MediaDrug"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/client.config/?format=json&advert_key="; content:"&app="; content:"&oslang="; content:"&brlang=&uid="; content:" HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/client\.config\/\?format=json&advert\_key=[a-zA-Z0-9\+\/\=]+&app=[a-zA-Z\_]+&oslang=[a-z]{2}\-[a-z]{2}&brlang=&uid=[a-f0-9\-]{77} HTTP\/1\.1\r\nAccept: \*\/\*\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1055237; rev:1432;)

# Command&Control: (Ransomware) Gulcrypt - regex: to_server:POST .*\.php HTTP.*User\-Agent: User\-Agent.*\r\n\r\nhello=\d detector_id: 55238
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) Gulcrypt"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"User-Agent|3A| User-Agent"; content:"|0D||0A||0D||0A|hello="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php HTTP.*User\-Agent: User\-Agent.*\r\n\r\nhello=\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1055238; rev:1432;)

# Command&Control: (RAT) PlugX - regex: to_server:GET \/[A-F0-9]{24} HTTP\/1\.1\r\nAccept: \*\/\*\r\nCookie: detector_id: 55255
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (RAT) PlugX"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|Cookie|3A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[A-F0-9]{24} HTTP\/1\.1\r\nAccept: \*\/\*\r\nCookie:/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1055255; rev:1437;)

# Adware: (BundleInstaller) InstallUI - regex: to_server:GET \/ui\.php\?key=[^\ ]{200,} HTTP\/1\.1\r\nUser\-Agent: inet_provider\r\n detector_id: 55256
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (BundleInstaller) InstallUI"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ui.php?key="; content:" HTTP/1.1|0D||0A|User-Agent|3A| inet_provider|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ui\.php\?key=[^\ ]{200,} HTTP\/1\.1\r\nUser\-Agent: inet_provider\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1055256; rev:1437;)

# Command&Control: (Trojan) Reconyc - regex: to_server:GET \/.*\.htm HTTP\/1\.1\r\nUser\-Agent: My Session\r\nHost: [^\r]+\r\n\r\n detector_id: 55304
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Reconyc"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".htm HTTP/1.1|0D||0A|User-Agent|3A| My Session|0D||0A|Host|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\.htm HTTP\/1\.1\r\nUser\-Agent: My Session\r\nHost: [^\r]+\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1055304; rev:1444;)

# Command&Control: (Trojan) Pasta - regex: to_server:POST \/kss\_api\/io\.php\?c=\d&&lgid=\d&f=&apiver=\d+&x=\d+ HTTP.*\r\n\r\ns=.* detector_id: 55305
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Pasta"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/kss_api/io.php?c="; content:"&&lgid="; content:"&f=&apiver="; content:"&x="; content:" HTTP"; content:"|0D||0A||0D||0A|s="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/kss\_api\/io\.php\?c=\d&&lgid=\d&f=&apiver=\d+&x=\d+ HTTP.*\r\n\r\ns=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1055305; rev:1444;)

# Adware: (Bundler) SquareNet - regex: to_server:GET \/entry\/feedbackinfo\/[^\?\r]+\?id=[A-F0-9]{32}&os=x86\|\d+\|Win.+\|(32|64)&p=\d+&crc=\d+ HTTP.*User-Agent: wget detector_id: 55341
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Bundler) SquareNet"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/entry/feedbackinfo/"; content:"?id="; content:"&os=x86|7C|"; content:"|7C|Win"; content:"&p="; content:"&crc="; content:" HTTP"; content:"User-Agent|3A| wget"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/entry\/feedbackinfo\/[^\?\r]+\?id=[A-F0-9]{32}&os=x86\|\d+\|Win.+\|(32|64)&p=\d+&crc=\d+ HTTP.*User-Agent: wget/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1055341; rev:1450;)

# Adware: (PUA) Kuaiba - regex: to_server:GET \/advert\/map\_get\.php\?site=\d+&env=\d&id=\d+&name=[\%\+A-F0-9]{20,} HTTP detector_id: 55342
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUA) Kuaiba"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/advert/map_get.php?site="; content:"&env="; content:"&id="; content:"&name="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/advert\/map\_get\.php\?site=\d+&env=\d&id=\d+&name=[\%\+A-F0-9]{20,} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1055342; rev:1450;)

# Command&Control: (Trojan) Zbot - regex: to_server:GET .*\/load\.php\?module=\d HTTP\/1\.1\r\nAccept: */*\r\n detector_id: 55343
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zbot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/load.php?module="; content:" HTTP/1.1|0D||0A|Accept|3A|"; content:"|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/load\.php\?module=\d HTTP\/1\.1\r\nAccept: *\/*\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1055343; rev:1450;)

# Command&Control: (Trojan) StartPage - regex: to_server:GET .*\/qqz.*\.txt HTTP detector_id: 55344
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) StartPage"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/qqz"; content:".txt HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/qqz.*\.txt HTTP/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1055344; rev:1450;)

# Command&Control: (Dropper) Vundo - regex: to_server:GET \/BoxRedirect\.shtml HTTP.*Cookie: kayak= detector_id: 55345
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Vundo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/BoxRedirect.shtml HTTP"; content:"Cookie|3A| kayak="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/BoxRedirect\.shtml HTTP.*Cookie: kayak=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1055345; rev:1451;)

# Command&Control: (Dropper) Strictor - regex: to_server:GET \/rsc\.php\?mode=bu&key=[a-f0-9]{32}&scr=\d+&p=[a-z]+&callback=[a-zA-Z0-9]+ HTTP detector_id: 55346
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Strictor"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/rsc.php?mode=bu&key="; content:"&scr="; content:"&p="; content:"&callback="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/rsc\.php\?mode=bu&key=[a-f0-9]{32}&scr=\d+&p=[a-z]+&callback=[a-zA-Z0-9]+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1055346; rev:1451;)

# Command&Control: (TrojanBanker) ChePro - regex: to_server:GET .*\/clientes\.php\?tipo=[a-z]+&cliente=[^&]+&call=[^\ ]+ HTTP\/1\.[01]\r\nAccept: \*\/\*\r\n detector_id: 55347
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (TrojanBanker) ChePro"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/clientes.php?tipo="; content:"&cliente="; content:"&call="; content:" HTTP/1."; content:"|0D||0A|Accept|3A| |2A|/|2A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/clientes\.php\?tipo=[a-z]+&cliente=[^&]+&call=[^\ ]+ HTTP\/1\.[01]\r\nAccept: \*\/\*\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1055347; rev:1451;)

# Adware: (Hoax) Pameseg - regex: to_server:GET \/p\_f\.php\?sub\_id=\d+&user\_id=\d+ HTTP\/1\.1\r\nAccept: \*\/\*\r\n detector_id: 55348
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Hoax) Pameseg"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/p_f.php?sub_id="; content:"&user_id="; content:" HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/p\_f\.php\?sub\_id=\d+&user\_id=\d+ HTTP\/1\.1\r\nAccept: \*\/\*\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1055348; rev:1451;)

# Drive-by: (Metasploit) CVE-2011-2140 - regex: to_server:GET \/.*\r\n\r\n\x00\x00\x00.ftypisom\x00\x00.\x00[a-z0-9]{4} detector_id: 56944
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Metasploit) CVE-2011-2140"; flow:established,from_server; file_data; content:"|00||00||00|"; depth:3; content:"ftypisom|00||00|"; distance:1; within:10; pcre:"/\x00\x00\x00\x14\x66\x74\x79\x70\x69\x73\x6F\x6D\x00\x00\x00\x00\x6D\x70\x34\x31\x00\x00\x00\x9F\x6D\x6F\x6F\x76\x00\x00\x00\x6C\x6D\x76\x68\x64\x00\x00\x00\x00\xCB\x75\xF1\xC2\xCB\x75\xF1\xC2\x00\x01\x5F\x90\x00\x00\x00\x00\x00\x01\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x40\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x01\x00\x00\x00\x2B\x75\x64\x74\x61\x00\x00\x00\x23\xA9\x65\x6E\x63\x00\x17\x00\x00\x76\x6C\x63\x20\x30\x2E\x39\x2E\x34\x20\x73\x74\x72\x65\x61\x6D\x20\x6F\x75\x74\x70\x75\x74\x00\x00\x00\x08\x77\x69\x64\x65\x00\x00\x00\x08\x6D\x64\x61\x74/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1056944; rev:0;)

# Drive-by: (Metasploit) CVE-2012-0897 - regex: to_server:GET \/.*\r\n\r\n\x00\x00\x00\x0c\x6a\x50\x20\x20\x0d\x0a\x87\x0a\x00\x00\x00\x14\x66\x74\x79\x70\x6a\x70\x32\x20\x00\x00\x00\x00\x6a\x70\x32\x20\x00\x00\x00\x38\x75\x75\x69\x64\x61\x70\x00\xde\xec\x87\xd5\x11.{150}\x00\x05\x01\x05\x04\x04\x00\x00\xff\x5c\x00\xf5\x22 detector_id: 56986
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Metasploit) CVE-2012-0897"; flow:established,from_server; file_data; content:"|00||00||00||0C|jP  |0D||0A||87||0A||00||00||00||14|ftypjp2 |00||00||00||00|jp2 |00||00||00|8uuidap|00||DE||EC||87||D5||11|"; depth:48; content:"|00||05||01||05||04||04||00||00||FF||5C||00||F5||22|"; pcre:"/\x00\x00\x00\x0c\x6a\x50\x20\x20\x0d\x0a\x87\x0a\x00\x00\x00\x14\x66\x74\x79\x70\x6a\x70\x32\x20\x00\x00\x00\x00\x6a\x70\x32\x20\x00\x00\x00\x38\x75\x75\x69\x64\x61\x70\x00\xde\xec\x87\xd5\x11.{150}\x00\x05\x01\x05\x04\x04\x00\x00\xff\x5c\x00\xf5\x22/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1056986; rev:0;)

# Drive-by: (Metasploit) CVE-2013-1017 - regex: to_server:GET \/.*\r\n\r\n\<html\>\n\<head\>\n\<script\>\n.*unescape.*\);\nsprayHeap\(\{shellcode:s\}\);\n\<\/script\>\n\<\/head\>\n\<body\>\n\<embed src=\" detector_id: 56987
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Metasploit) CVE-2013-1017"; flow:established,from_server; file_data; content:"<html>|0A|<head>|0A|<script>|0A|"; depth:23; content:"unescape"; content:"|29||3B||0A|sprayHeap|28||7B|shellcode|3A|s|7D||29||3B||0A|</script>|0A|</head>|0A|<body>|0A|<embed src=|22|"; pcre:"/\<html\>\n\<head\>\n\<script\>\n.*unescape.*\)\;\nsprayHeap\(\{shellcode:s\}\)\;\n\<\/script\>\n\<\/head\>\n\<body\>\n\<embed src=\"/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1056987; rev:0;)

# Drive-by: (Metasploit) CVE-2014-2299 - regex: to_server:GET \/.*\r\n\r\n\xff\xfb\x41\x66\x7a\x68\x4b\x56\x72\x7a\x42\x61\x72\x6a\x44\x6b\x4e\x4c\x4e\x78\x48\x45\x6a\x52\x78\x69\x4a\x63\x70\x6f\x53\x72\x6a\x49\x48\x75\x55\x62\x75\x61\x5a\x70\x70\x56\x4c\x41\x66\x50\x6c\x48\x70\x72\x53\x59\x52\x70\x61\x50\x4b\x76\x52\x4b\x4e\x54\x44\x4d\x4a detector_id: 56988
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Metasploit) CVE-2014-2299"; flow:established,from_server; file_data; content:"|FF||FB|AfzhKVrzBarjDkNLNxHEjRxiJcpoSrjIHuUbuaZppVLAfPlHprSYRpaPKvRKNTDMJ"; depth:67; pcre:"/\xff\xfb\x41\x66\x7a\x68\x4b\x56\x72\x7a\x42\x61\x72\x6a\x44\x6b\x4e\x4c\x4e\x78\x48\x45\x6a\x52\x78\x69\x4a\x63\x70\x6f\x53\x72\x6a\x49\x48\x75\x55\x62\x75\x61\x5a\x70\x70\x56\x4c\x41\x66\x50\x6c\x48\x70\x72\x53\x59\x52\x70\x61\x50\x4b\x76\x52\x4b\x4e\x54\x44\x4d\x4a/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1056988; rev:0;)

# Drive-by: (Metasploit) CVE-2014-6352 - regex: to_server:GET \/.*\r\n\r\n.*ppt\/embeddings\/oleObject1\.bin.*ppt\/embeddings\/oleObject2\.bin detector_id: 56989
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Metasploit) CVE-2014-6352"; flow:established,from_server; file_data; content:"ppt/embeddings/oleObject1.bin"; content:"ppt/embeddings/oleObject2.bin"; pcre:"/.*ppt\/embeddings\/oleObject1\.bin.*ppt\/embeddings\/oleObject2\.bin/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1056989; rev:0;)

# Drive-by: (Metasploit) OSVDB-75096 - regex: to_server:GET \/.*\r\n\r\n\xdb\xc0\xba\x84\xac\xdf\xd6\xd9\x74\x24\xf4\x5e\x29\xc9\xb1\x74\x31\x56\x18\x83\xee detector_id: 56990
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Metasploit) OSVDB-75096"; flow:established,from_server; file_data; content:"|DB||C0||BA||84||AC||DF||D6||D9|t|24||F4||5E||29||C9||B1|t1V|18||83||EE|"; depth:21; pcre:"/\xdb\xc0\xba\x84\xac\xdf\xd6\xd9\x74\x24\xf4\x5e\x29\xc9\xb1\x74\x31\x56\x18\x83\xee/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1056990; rev:0;)

# Drive-by: (Metasploit) OSVDB-92939 - regex: to_server:GET \/.*\r\n\r\nhttp:\/\/.{750,780}\x56\x1b\x01\x66 detector_id: 56991
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Metasploit) OSVDB-92939"; flow:established,from_server; file_data; content:"http|3A|//"; depth:7; content:"V|1B||01|f"; pcre:"/http:\/\/.{750,780}\x56\x1b\x01\x66/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1056991; rev:0;)

# Drive-by: (Metasploit) OSVDB-100619 - regex: to_server:GET \/.*\r\n\r\n\[Support Groups\]\r\nVideo=.{256}\x48\x28\x01\x10 detector_id: 56992
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Metasploit) OSVDB-100619"; flow:established,from_server; file_data; content:"|5B|Support Groups|5D||0D||0A|Video="; depth:24; content:"H|28||01||10|"; pcre:"/\[Support Groups\]\r\nVideo=.{256}\x48\x28\x01\x10/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1056992; rev:0;)

# Drive-by: (Metasploit) OSVDB-94522 - regex: to_server:GET \/.*\r\n\r\nhttp:\/\/.{830,850}\x35\x44\xfd\x6a(\x02\x62\xb1\x6a){35} detector_id: 56993
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Metasploit) OSVDB-94522"; flow:established,from_server; file_data; content:"http|3A|//"; depth:7; content:"5D|FD|j"; pcre:"/http:\/\/.{830,850}\x35\x44\xfd\x6a(\x02\x62\xb1\x6a){35}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1056993; rev:0;)

# Drive-by: (Metasploit) CVE-2009-2484 - regex: to_server:GET \/.*\r\n\r\n\<\?xml version=\"1\.0\" encoding=\"UTF\-8\"\?\>\x0a\<playlist version=\"1\" xmlns=\"http:\/\/xspf\.org\/ns\/0\/\" xmlns:vlc=\"http:\/\/www\.videolan\.org\/vlc\/playlist\/ns\/0\/\"\>\x0a\<title\>Playlist\<\/title\>\x0a\<trackList\>\x0a\<track\>\x0a\<location\>smb:\/\/.*\<\/location\>\x0a\<extension application=\"http:\/\/www\.videolan\.org\/vlc\/playlist\/0\"\>\x0a\<vlc:id\>0\<\/vlc:id\>\x0a\<\/extension\> detector_id: 56994
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Metasploit) CVE-2009-2484"; flow:established,from_server; file_data; content:"<?xml version=|22|1.0|22| encoding=|22|UTF-8|22|?>|0A|<playlist version=|22|1|22| xmlns=|22|http|3A|//xspf.org/ns/0/|22| xmlns|3A|vlc=|22|http|3A|//www.videolan.org/vlc/playlist/ns/0/|22|>|0A|<title>Playlist</title>|0A|<trackList>|0A|<track>|0A|<location>smb|3A|//"; depth:207; content:"</location>|0A|<extension application=|22|http|3A|//www.videolan.org/vlc/playlist/0|22|>|0A|<vlc|3A|id>0</vlc|3A|id>|0A|</extension>"; pcre:"/\<\?xml version=\"1\.0\" encoding=\"UTF\-8\"\?\>\x0a\<playlist version=\"1\" xmlns=\"http:\/\/xspf\.org\/ns\/0\/\" xmlns:vlc=\"http:\/\/www\.videolan\.org\/vlc\/playlist\/ns\/0\/\"\>\x0a\<title\>Playlist\<\/title\>\x0a\<trackList\>\x0a\<track\>\x0a\<location\>smb:\/\/.*\<\/location\>\x0a\<extension application=\"http:\/\/www\.videolan\.org\/vlc\/playlist\/0\"\>\x0a\<vlc:id\>0\<\/vlc:id\>\x0a\<\/extension\>/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1056994; rev:0;)

# Drive-by: (Metasploit) CVE-2009-3129 - regex: to_server:GET \/.*\r\n\r\n\xd0\xcf\x11\xe0\xa1\xb1\x1a\xe1\x00\x00 detector_id: 56995
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Metasploit) CVE-2009-3129"; flow:established,from_server; file_data; content:"|D0||CF||11||E0||A1||B1||1A||E1||00||00|"; depth:10; pcre:"/\x00\x06\x05\x00\xAA\x1F\xCD\x07\xC1\x00\x01\x00\x06\x04\x00\x00\x67\x08\x0A\x02\x67\x08\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x04\x00\x01\x04\x00\x00\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1056995; rev:0;)

# Drive-by: (Metasploit) CVE-2011-1591 - regex: to_server:GET \/.*\r\n\r\n\xd4\xc3\xb2\xa1\x02\x00\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\x7f\x00\x00\x01\x00\x00\x00\x26\x32\xac\x4d\xda\xfa\x00\x08\xdc\x05\x00\x00\xdc\x05\x00\x00\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x23\x23.{131}(\x0e\x7d\x8d\x61){3} detector_id: 56996
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Metasploit) CVE-2011-1591"; flow:established,from_server; file_data; content:"|D4||C3||B2||A1||02||00||04||00||00||00||00||00||00||00||00||00||FF||7F||00||00||01||00||00||00|&2|AC|M|DA||FA||00||08||DC||05||00||00||DC||05||00||00||FF||FF||FF||FF||FF||FF||00||00||00||00||00||00||23||23|"; depth:54; pcre:"/\xd4\xc3\xb2\xa1\x02\x00\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\xff\x7f\x00\x00\x01\x00\x00\x00\x26\x32\xac\x4d\xda\xfa\x00\x08\xdc\x05\x00\x00\xdc\x05\x00\x00\xff\xff\xff\xff\xff\xff\x00\x00\x00\x00\x00\x00\x23\x23.{131}(\x0e\x7d\x8d\x61){3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1056996; rev:0;)

# Drive-by: (Metasploit) CVE-2010-3333 - regex: to_server:GET \/.*\r\n\r\n\{\\rtf1\{\\shp\{\\sp\{\\sn pFragments\}\{\\sv \d+;\d+;[a-f0-9]{100} detector_id: 56997
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Metasploit) CVE-2010-3333"; flow:established,from_server; file_data; content:"|7B||5C|rtf1|7B||5C|shp|7B||5C|sp|7B||5C|sn pFragments|7D||7B||5C|sv "; depth:36; pcre:"/\{\\rtf1\{\\shp\{\\sp\{\\sn pFragments\}\{\\sv \d+\;\d+\;[a-f0-9]{100}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1056997; rev:0;)

# Drive-by: (Metasploit) CVE-2011-0105 - regex: to_server:GET \/.*\r\n\r\n\xd0\xcf\x11.{1553}\xa7\x00\x04\x00\xb0[\x0d\x0f]\x0c\x00\x3c\x00 detector_id: 56998
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Metasploit) CVE-2011-0105"; flow:established,from_server; file_data; content:"|D0||CF||11|"; depth:3; content:"|A7||00||04||00||B0|"; distance:1553; within:1558; content:"|0C||00|<|00|"; pcre:"/\xd0\xcf\x11.{1553}\xa7\x00\x04\x00\xb0[\x0d\x0f]\x0c\x00\x3c\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1056998; rev:0;)

# Drive-by: (Metasploit) CVE-2011-0531 - regex: to_server:GET \/.*\r\n\r\n\x1A\x45\xDF\xA3\x01\x00\x00\x00\x00\x00\x00\x1F\x42\x86\x81\x01\x42\xF7\x81\x01\x42\xF2\x81\x04\x42\xF3\x81\x08\x42\x82\x84\x77\x65\x62\x6D\x42\x87\x81\x02\x42\x85\x81\x02\x18\x53\x80\x67\x01\x00\x00\x00\x01\xD6\x22\xF1\x11\x4D\x9B\x74\x40\x3F\x4D\xBB\x8B\x53\xAB\x84\x15\x49\xA9\x66\x53\xAC\x81\xff\x53\xAB\x84\x16\x54\xAE\x6B\x42{228}\x15\x49\xA9\x66\x01\x00\x00\x00\x01\xff\xff\xff detector_id: 56999
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Metasploit) CVE-2011-0531"; flow:established,from_server; file_data; content:"|1A|E|DF||A3||01||00||00||00||00||00||00||1F|B|86||81||01|B|F7||81||01|B|F2||81||04|B|F3||81||08|B|82||84|webmB|87||81||02|B|85||81||02||18|S|80|g|01||00||00||00||01||D6||22||F1||11|M|9B|t|40|?M|BB||8B|S|AB||84||15|I|A9|fS|AC||81||FF|S|AB||84||16|T|AE|k"; depth:82; content:"|15|I|A9|f|01||00||00||00||01||FF||FF||FF|"; pcre:"/\x1A\x45\xDF\xA3\x01\x00\x00\x00\x00\x00\x00\x1F\x42\x86\x81\x01\x42\xF7\x81\x01\x42\xF2\x81\x04\x42\xF3\x81\x08\x42\x82\x84\x77\x65\x62\x6D\x42\x87\x81\x02\x42\x85\x81\x02\x18\x53\x80\x67\x01\x00\x00\x00\x01\xD6\x22\xF1\x11\x4D\x9B\x74\x40\x3F\x4D\xBB\x8B\x53\xAB\x84\x15\x49\xA9\x66\x53\xAC\x81\xff\x53\xAB\x84\x16\x54\xAE\x6B\x42{228}\x15\x49\xA9\x66\x01\x00\x00\x00\x01\xff\xff\xff/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1056999; rev:0;)

# Drive-by: (Metasploit) CVE-2011-1574 - regex: to_server:GET \/.*\r\n\r\n\x00{28}\x1a\x10\x00\x00\x14\x00....\x20\x13\x02\x00SCRM\x40\x06\x8a\xb0\x10\xfb\x00{10}\x00\x08\x01\x09\x02\x0a\x03\x0b\x04\x0c\x05\x0d\x06\x0e\x07\x0f\xff{16}\x07\x08\x0c\x09\x0a\x0b\x0b\x0d\x0e\x0f\x0f\x0f\x10\x11\x12\x13\x14\x16\x17\xff(\x0f\x00)+(\x78\x00)+\x00{32}\x80*\x01metasplo\.ity detector_id: 57000
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Metasploit) CVE-2011-1574"; flow:established,from_server; file_data; content:"|1A||10||00||00||14||00|"; depth:34; content:"|20||13||02||00|SCRM|40||06||8A||B0||10||FB|"; distance:6; within:20; content:"|00||08||01||09||02||0A||03||0B||04||0C||05||0D||06||0E||07||0F|"; content:"|07||08||0C||09||0A||0B||0B||0D||0E||0F||0F||0F||10||11||12||13||14||16||17||FF|"; content:"|01|metasplo.ity"; pcre:"/\x00{28}\x1a\x10\x00\x00\x14\x00......\x20\x13\x02\x00SCRM\x40\x06\x8a\xb0\x10\xfb\x00{10}\x00\x08\x01\x09\x02\x0a\x03\x0b\x04\x0c\x05\x0d\x06\x0e\x07\x0f\xff{16}\x07\x08\x0c\x09\x0a\x0b\x0b\x0d\x0e\x0f\x0f\x0f\x10\x11\x12\x13\x14\x16\x17\xff(\x0f\x00)+(\x78\x00)+\x00{32}\x80*\x01metasplo\.ity/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057000; rev:0;)

# Drive-by: (Metasploit) CVE-2012-0158 - regex: to_server:GET \/.*\r\n\r\n\{\\rtf1\{\\fonttbl\{\\f0\\fnil\\fcharset0 Verdana;\}\}\\viewkind4\\uc1\\pard\\sb100\\sa100\\lang9\\f0\\fs22\\par\\pard\\sa200\\sl276\\slmult1\\lang9\\fs22\\par\{\\object\\objocx\{\\\*\\objdata\n01050000020000001B0000004D53436F6D63746C4C69622E4C697374566965774374726C2E32000000000000000000000E0000\nD0CF11E0A1B11AE1000000000000000000000000000000003E000300FEFF09000600000000000000 detector_id: 57001
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Metasploit) CVE-2012-0158"; flow:established,from_server; file_data; content:"|7B||5C|rtf1|7B||5C|fonttbl|7B||5C|f0|5C|fnil|5C|fcharset0 Verdana|3B||7D||7D||5C|viewkind4|5C|uc1|5C|pard|5C|sb100|5C|sa100|5C|lang9|5C|f0|5C|fs22|5C|par|5C|pard|5C|sa200|5C|sl276|5C|slmult1|5C|lang9|5C|fs22|5C|par|7B||5C|object|5C|objocx|7B||5C||2A||5C|objdata|0A|"; content:"01050000020000001B0000004D53436F6D63746C4C69622E4C697374566965774374726C2E32000000000000000000000E0000|0A|D0CF11E0A1B11AE1000000000000000000000000000000003E000300FEFF09000600000000000000"; depth:353; pcre:"/\{\\rtf1\{\\fonttbl\{\\f0\\fnil\\fcharset0 Verdana\;\}\}\\viewkind4\\uc1\\pard\\sb100\\sa100\\lang9\\f0\\fs22\\par\\pard\\sa200\\sl276\\slmult1\\lang9\\fs22\\par\{\\object\\objocx\{\\\*\\objdata\n01050000020000001B0000004D53436F6D63746C4C69622E4C697374566965774374726C2E32000000000000000000000E0000\nD0CF11E0A1B11AE1000000000000000000000000000000003E000300FEFF09000600000000000000/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057001; rev:0;)

# Drive-by: (Metasploit) CVE-2013-1017 - regex: to_server:GET \/.*\r\n\r\n.{4}moov\x00\x00\x06\xD7rmra\x00\x00\x06\xCFrmda\x00\x00\x06\xBFrdrf\x00\x00\x00\x00alis\x00\x00\x06\xAA.{8}\x00\x00\x06\x61.{38}\x12 detector_id: 57002
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Metasploit) CVE-2013-1017"; flow:established,from_server; file_data; content:"moov|00||00||06||D7|rmra|00||00||06||CF|rmda|00||00||06||BF|rdrf|00||00||00||00|alis|00||00||06||AA|"; depth:44; content:"|00||00||06|a"; pcre:"/.{4}moov\x00\x00\x06\xD7rmra\x00\x00\x06\xCFrmda\x00\x00\x06\xBFrdrf\x00\x00\x00\x00alis\x00\x00\x06\xAA.{8}\x00\x00\x06\x61.{38}\x12/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057002; rev:0;)

# Command&Control: (Ransomware) Crowti - regex: to_server:POST .*/img\d\.php\?[a-z]=[a-z0-9]{8,} HTTP.*User-Agent: Mozilla\/4\.0 \(compatible\; MSIE 7\.0\; Windows NT 5\.1\; Trident\/4\.0\; \.NET4\.0C\; \.NET4\.0E\; \.NET CLR 2\.0\.50727\; \.NET CLR 3\.0\.4506\.2152\; \.NET CLR 3\.5\.30729\; \.NET CLR 1\.1\.4322\).*\r\n\r\n[a-z]=[0-9a-f]{10,} detector_id: 57120
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) Crowti"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/img"; content:".php?"; content:" HTTP"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 7.0|3B| Windows NT 5.1|3B| Trident/4.0|3B| .NET4.0C|3B| .NET4.0E|3B| .NET CLR 2.0.50727|3B| .NET CLR 3.0.4506.2152|3B| .NET CLR 3.5.30729|3B| .NET CLR 1.1.4322|29|"; content:"|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/img\d\.php\?[a-z]=[a-z0-9]{8,} HTTP.*User-Agent: Mozilla\/4\.0 \(compatible\; MSIE 7\.0\; Windows NT 5\.1\; Trident\/4\.0\; \.NET4\.0C\; \.NET4\.0E\; \.NET CLR 2\.0\.50727\; \.NET CLR 3\.0\.4506\.2152\; \.NET CLR 3\.5\.30729\; \.NET CLR 1\.1\.4322\).*\r\n\r\n[a-z]=[0-9a-f]{10,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057120; rev:1465;)

# Command&Control: (Trojan) Cutwail - regex: to_server:POST \/ HTTP.*Content-Type: application/octet-stream.*User-Agent: Mozilla\/4\.0\ \(compatible\;\ MSIE\ 6\.0\;\ Windows\ NT\ 5\.1\;\ SV1\).*\r\n\r\n([ -~]{64}\r\n){3,} detector_id: 57121
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Cutwail"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ HTTP"; content:"Content-Type|3A| application/octet-stream"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 6.0|3B| Windows NT 5.1|3B| SV1|29|"; content:"|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ HTTP.*Content-Type: application\/octet-stream.*User-Agent: Mozilla\/4\.0\ \(compatible\;\ MSIE\ 6\.0\;\ Windows\ NT\ 5\.1\;\ SV1\).*\r\n\r\n([ -~]{64}\r\n){3,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057121; rev:1465;)

# Malware download: exploit payload delivery - regex: to_server:GET /.*\.exe HTTP/1\.1\r\nUser-Agent: wininet\.dll\r\nHost: \d+\.\d+\.\d+\.\d+\r\n\r\n detector_id: 57122
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Malware download: exploit payload delivery"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".exe HTTP/1.1|0D||0A|User-Agent|3A| wininet.dll|0D||0A|Host|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\.exe HTTP\/1\.1\r\nUser-Agent: wininet\.dll\r\nHost: \d+\.\d+\.\d+\.\d+\r\n\r\n/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057122; rev:1465;)

# Command&Control: (Virus) MadAngel - regex: to_server:GET .*\.php\?region=[A-Z]:\\.{8,} HTTP detector_id: 57280
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Virus) MadAngel"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?region="; content:"|3A||5C|"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php\?region=[A-Z]:\\.{8,} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057280; rev:1480;)

# Command&Control: (Trojan) Chepro - regex: to_server:POST .*\/notify\.php HTTP.*CHAVE=[\%A-F0-9]+ detector_id: 57281
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Chepro"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/notify.php HTTP"; content:"CHAVE="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/notify\.php HTTP.*CHAVE=[\%A-F0-9]+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057281; rev:1480;)

# Drive-by: (Metasploit) JS Browser Exploit - regex: to_server:GET ^[\x20\n]*\<html\>\n\x20*\<object [^\>]*id=[\'\"]([a-zA-Z]+)[\'\"][^\>]*\>\<\/object\>\n\x20*\<script language=[\"\'][Jj]ava[sS]cript[\"\']\>\n(?:[^\n]*\n)?(?:[^\n]*\n)?\x20{0,8}\1\.[a-zA-Z][^\n]*\n\x20*\<\/script\>[\x20\n]*\<\/html\> detector_id: 57317
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Metasploit) Browser exploit attempt"; flow:established,from_server; file_data; content:"<object "; content:"></object>"; content:"<script language="; pcre:"/^[\x20\n]*\<html\>\n\x20*\<object [^\>]*id=[\'\x22]([a-zA-Z]+)[\'\x22][^\>]*\>\<\/object\>\n\x20*\<script language=[\x22\'][Jj]ava[sS]cript[\x22\']\>\n(?:[^\n]*\n)?(?:[^\n]*\n)?\x20{0,8}\1\.[a-zA-Z][^\n]*\n\x20*\<\/script\>[\x20\n]*\<\/html\>/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057317; rev:0;)

# Drive-by: (Metasploit) JS Browser Exploit with long blob - regex: to_server:GET ^[\x20\r\t\n]*\<html\>[\n\r\t\x20]*(?:\<body\>)?[\n\r\t\x20]*\<object[^\>]+id=[\'\"]([a-zA-Z]+)[\'\"]\>\<\/object\>[\r\t\n\x20]*\<script[\r\n\t\x20]+language=[\"\'][Jj]ava[sS]cript[\"\']\>[\x20\r\t\n]+var[\x20\r\t\n]+\1[\x20\r\t\n]*=[\x20\r\t\n]*document\.getElementById\(\'\1\'\)\;[\x20\r\n\t]+var[\x20\r\n\t]+[a-zA-Z]+[\x20\r\n\t]*=[\x20\r\n\t]*new[\x20\r\n\t]+String\(\' detector_id: 57318
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Metasploit) Browser exploit attempt (long blob)"; flow:established,from_server; file_data; content:"<object"; content:"></object>"; content:"<script"; content:"language="; pcre:"/^[\x20\r\t\n]*\<html\>[\n\r\t\x20]*(?:\<body\>)?[\n\r\t\x20]*\<object[^\>]+id=[\'\x22]([a-zA-Z]+)[\'\x22]\>\<\/object\>[\r\t\n\x20]*\<script[\r\n\t\x20]+language=[\x22\'][Jj]ava[sS]cript[\x22\']\>[\x20\r\t\n]+var[\x20\r\t\n]+\1[\x20\r\t\n]*=[\x20\r\t\n]*document\.getElementById\(\'\1\'\)\;[\x20\r\n\t]+var[\x20\r\n\t]+[a-zA-Z]+[\x20\r\n\t]*=[\x20\r\n\t]*new[\x20\r\n\t]+String\(\'/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057318; rev:0;)

# Drive-by: (Metasploit) JS Browser Exploit with unescape - regex: to_server:GET ^[\x20\n]*\<html\>\n\x20*(?:\<object [^\n]+\<\/object\>\n)?\<(?:object|OBJECT) [^\>]*id=[\'\"]([a-zA-Z]+)[\'\"][^\>]*\>\<\/(?:object|OBJECT)\>\n\x20*\<script language=[\"\'][Jj]ava[sS]cript[\"\']\>\n(?:[^\n]*\n)?(?:[^\n]+=\x20*unescape\(\x27\x25u[a-f0-9]{4}[^\n]+\n)(?:[^\n]*\n){4,18}\x20{0,8}\1\.[A-Z][^\n]*\n(?:[^\n]*\n){0,4}\x20*\<\/script\>[\x20\n]*\<\/html\> detector_id: 57319
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Metasploit) Browser exploit attempt (unescape)"; flow:established,from_server; file_data; content:"<object "; nocase; content:"></object>"; nocase; content:"<script language="; content:"unescape|28||27||25|u"; pcre:"/^[\x20\n]*\<html\>\n\x20*(?:\<object [^\n]+\<\/object\>\n)?\<(?:object|OBJECT) [^\>]*id=[\'\x22]([a-zA-Z]+)[\'\x22][^\>]*\>\<\/(?:object|OBJECT)\>\n\x20*\<script language=[\x22\'][Jj]ava[sS]cript[\x22\']\>\n(?:[^\n]*\n)?(?:[^\n]+=\x20*unescape\(\x27\x25u[a-f0-9]{4}[^\n]+\n)(?:[^\n]*\n){4,18}\x20{0,8}\1\.[A-Z][^\n]*\n(?:[^\n]*\n){0,4}\x20*\<\/script\>[\x20\n]*\<\/html\>/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057319; rev:0;)

# PE EXE or DLL Windows file download (from ET POLICY) - regex: to_server:GET MZ_PE_00_00 detector_id: 57320
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS PE EXE or DLL Windows file download (from ET POLICY)"; flow:established,to_client; content:"MZ"; byte_jump:4,58,relative,little; content:"PE|00 00|"; distance:-64; within:4; reference:url,doc.emergingthreats.net/bin/view/Main/2000419; classtype:trojan-activity; sid:1057320; rev:0;)

# PE EXE file download (http) - regex: to_server:GET .{0,16}MZ.{70,80}This\x20program.*PE\x00\x00 detector_id: 57322
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS PE EXE file download (http)"; flow:established,to_client; file_data; content:"MZ"; depth:18; content:"This program"; distance:70; within:92; content:"PE|00||00|"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057322; rev:0;)

# Command&Control: (Worm) AAEH - regex: to_server:GET /[a-z0-9A-Z]+/\?[a-z]\|[a-zA-Z0-9]+ HTTP/1\.1\r\nUser-Agent: Mozilla/4\.0 [^\r]+\r\nHost: [^\r]+\r\n\r\n detector_id: 57395
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) AAEH"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?"; content:" HTTP/1.1|0D||0A|User-Agent|3A| Mozilla/4.0 "; content:"|0D||0A|Host|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z0-9A-Z]+\/\?[a-z]\|[a-zA-Z0-9]+ HTTP\/1\.1\r\nUser-Agent: Mozilla\/4\.0 [^\r]+\r\nHost: [^\r]+\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057395; rev:1489;)

# Command&Control: (Backdoor) Tenpeq - regex: to_server:GET \/ip\.php\?=\d+ HTTP.*Host: \d+\.\d+\.\d+\.\d+\r\n detector_id: 57396
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Tenpeq"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ip.php?="; content:" HTTP"; content:"Host|3A| "; content:"|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ip\.php\?=\d+ HTTP.*Host: \d+\.\d+\.\d+\.\d+\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057396; rev:1489;)

# Command&Control: (Backdoor) Tenpeq.D - regex: to_server:GET /Count\.asp\?ver=\d+&mac=..\-..\-..\-..\-..\-.. HTTP.*Accept-Language: zh\-(CN|cn) detector_id: 57397
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Tenpeq.D"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Count.asp?ver="; content:"&mac="; content:" HTTP"; content:"Accept-Language|3A| zh-"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Count\.asp\?ver=\d+&mac=..\-..\-..\-..\-..\-.. HTTP.*Accept-Language: zh\-(CN|cn)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057397; rev:1489;)

# Command&Control: (Ransomware) Crowti - regex: to_server:GET /(.*\.cgi|)\?[a-z]=[a-z0-9]{10,} HTTP.*User-Agent: Mozilla\/4\.0\ \(compatible\;\ MSIE\ 7\.0\;\ Windows\ NT\ 5\.1\;\ Trident\/4\.0\;\ \.NET4\.0C\;\ \.NET4\.0E\;\ \.NET\ CLR\ 2\.0\.50727\;\ \.NET\ CLR\ 3\.0\.4506\.2152\;\ \.NET\ CLR\ 3\.5\.30729\;\ \.NET\ CLR\ 1\.1\.4322\) detector_id: 57398
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) Crowti"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 7.0|3B| Windows NT 5.1|3B| Trident/4.0|3B| .NET4.0C|3B| .NET4.0E|3B| .NET CLR 2.0.50727|3B| .NET CLR 3.0.4506.2152|3B| .NET CLR 3.5.30729|3B| .NET CLR 1.1.4322|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(.*\.cgi|)\?[a-z]=[a-z0-9]{10,} HTTP.*User-Agent: Mozilla\/4\.0\ \(compatible\;\ MSIE\ 7\.0\;\ Windows\ NT\ 5\.1\;\ Trident\/4\.0\;\ \.NET4\.0C\;\ \.NET4\.0E\;\ \.NET\ CLR\ 2\.0\.50727\;\ \.NET\ CLR\ 3\.0\.4506\.2152\;\ \.NET\ CLR\ 3\.5\.30729\;\ \.NET\ CLR\ 1\.1\.4322\)/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057398; rev:1489;)

# Command&Control: (Trojan) Fynloski - regex: to_server:POST [^\n]+\.php HTTP.*User\-Agent: MyBrowser.*\r\n\r\nid=\d+&pass=[a-f0-9]{32}&osbot= detector_id: 57400
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"User-Agent|3A| MyBrowser"; content:"|0D||0A||0D||0A|id="; content:"&pass="; content:"&osbot="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?[^\n]+\.php HTTP.*User\-Agent: MyBrowser.*\r\n\r\nid=\d+&pass=[a-f0-9]{32}&osbot=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057400; rev:1490;)

# Command&Control: (Trojan) Banker - regex: to_server:POST .*\/escritor\.php HTTP.*\r\n\r\nremetente= detector_id: 57401
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Banker"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/escritor.php HTTP"; content:"|0D||0A||0D||0A|remetente="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/escritor\.php HTTP.*\r\n\r\nremetente=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057401; rev:1490;)

# Command&Control: (Backdoor) Agobot - regex: to_server:POST \/report\/reporting\.php HTTP.*\r\n\r\n&key=[a-f0-9]{32}&val=[a-zA-Z0-9\%]+ detector_id: 57402
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Agobot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/report/reporting.php HTTP"; content:"|0D||0A||0D||0A|&key="; content:"&val="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/report\/reporting\.php HTTP.*\r\n\r\n&key=[a-f0-9]{32}&val=[a-zA-Z0-9\%]+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057402; rev:1490;)

# Adware: (Downware) TinyDownloadManager - regex: to_server:GET \/version\/\?current=\d\.\d HTTP\/1\.1\r\nUser\-Agent: TinyDownloadManager\/\d\.\d \{ detector_id: 57403
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) TinyDownloadManager"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/version/?current="; content:" HTTP/1.1|0D||0A|User-Agent|3A| TinyDownloadManager/"; content:" |7B|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/version\/\?current=\d\.\d HTTP\/1\.1\r\nUser\-Agent: TinyDownloadManager\/\d\.\d \{/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057403; rev:1490;)

# Command&Control: (Trojan) SkSocket - regex: to_server:GET .*\/tip\.asp\?action=(scanid&id=\d+|aip) HTTP detector_id: 57453
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) SkSocket"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/tip.asp?action="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/tip\.asp\?action=(scanid&id=\d+|aip) HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057453; rev:1493;)

# Command&Control: (Trojan) SkSocket - regex: to_server:GET .*\/js\.asp\?action=zt&bh=[a-z0-9]* HTTP detector_id: 57454
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) SkSocket"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/js.asp?action=zt&bh="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/js\.asp\?action=zt&bh=[a-z0-9]* HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057454; rev:1493;)

# Command&Control: (Trojan) Sisron - regex: to_server:GET \/sp\.txt\?[a-z0-9]+=[0-9]+ HTTP detector_id: 57455
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sisron"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/sp.txt?"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/sp\.txt\?[a-z0-9]+=[0-9]+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057455; rev:1493;)

# Command&Control: (Trojan) QQPass - regex: to_server:POST .*\/piaoyh\.asp HTTP.*\r\n\r\np= detector_id: 57456
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) QQPass"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/piaoyh.asp HTTP"; content:"|0D||0A||0D||0A|p="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/piaoyh\.asp HTTP.*\r\n\r\np=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057456; rev:1493;)

# Adware: (PUA) Amonetize - regex: to_server:GET \/direct\-download\.html\?&version=[\d\.]+&ci=\d+&ti1= HTTP detector_id: 57457
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUA) Amonetize"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/direct-download.html?&version="; content:"&ci="; content:"&ti1= HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/direct\-download\.html\?&version=[\d\.]+&ci=\d+&ti1= HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057457; rev:1493;)

# Command&Control: (Worm) Gamarue - regex: to_server:POST \/[^\r]+\.php HTTP(?!.*\nReferer: )(?!.*\nAccept: )(?=.*Content\-Type: application\/octet\-stream\r\n)(?=.*Connection: )(?=.*User\-Agent: Mozilla\/4\.0\r\n)(?=.*Host: )(?=.*Content\-Length: \d{2,3}\r\n)(?=.*\nCache\-Control: )(?=.*\nPragma: ).*\r\n\r\n.{0,15}?[\x00-\x1f\x80-\xff] detector_id: 57517
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Gamarue"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[^\r]+\.php HTTP(?!.*\nReferer: )(?!.*\nAccept: )(?=.*Content\-Type: application\/octet\-stream\r\n)(?=.*Connection: )(?=.*User\-Agent: Mozilla\/4\.0\r\n)(?=.*Host: )(?=.*Content\-Length: \d{2,3}\r\n)(?=.*\nCache\-Control: )(?=.*\nPragma: ).*\r\n\r\n.{0,15}?[\x00-\x1f\x80-\xff]/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057517; rev:1497;)

# Adware: (adware) InstallCore - regex: to_server:POST \/details HTTP.*\r\n\r\nfoo=bar detector_id: 57519
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (adware) InstallCore"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/details HTTP"; content:"|0D||0A||0D||0A|foo=bar"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/details HTTP.*\r\n\r\nfoo=bar/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057519; rev:1497;)

# Adware: (BHO) etranslater - regex: to_server:GET /gets/get\_areaid\.php\?dir=\d+ HTTP.*User-Agent: Mozilla/3\.0\ \(compatible\; Indy Library\) detector_id: 57520
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (BHO) etranslater"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/gets/get_areaid.php?dir="; content:" HTTP"; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/gets\/get\_areaid\.php\?dir=\d+ HTTP.*User-Agent: Mozilla\/3\.0\ \(compatible\; Indy Library\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057520; rev:1497;)

# Command&Control: (Backdoor) Androm - regex: to_server:GET \/Count\.asp\?ver=\d+&mac=[\d\-]{17,25} HTTP.*User-Agent: Mozilla\/\d\.0\ \(compatible\;\ Win32\;\ WinHttp\.WinHttpRequest\.\d\) detector_id: 57523
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Androm"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Count.asp?ver="; content:"&mac="; content:" HTTP"; content:"User-Agent|3A| Mozilla/"; content:".0 |28|compatible|3B| Win32|3B| WinHttp.WinHttpRequest."; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Count\.asp\?ver=\d+&mac=[\d\-]{17,25} HTTP.*User-Agent: Mozilla\/\d\.0\ \(compatible\;\ Win32\;\ WinHttp\.WinHttpRequest\.\d\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057523; rev:1498;)

# Adware: (Toolbar) CrushArcade - regex: to_server:GET .*\/\?options=[a-zA-Z0-9\+\%=]+ HTTP/1\.1\r\nUser-Agent: ca\_v\d+\.\d+\.\d+ detector_id: 57524
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) CrushArcade"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?options="; content:" HTTP/1.1|0D||0A|User-Agent|3A| ca_v"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/\?options=[a-zA-Z0-9\+\%=]+ HTTP\/1\.1\r\nUser-Agent: ca\_v\d+\.\d+\.\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057524; rev:1498;)

# Adware: (BundleInstaller) InstallUI - regex: to_server:POST \/stats\/startDebug HTTP.*User-Agent: Mozilla\/\d\.0\ \(compatible\;\ Win32\;\ WinHttp\.WinHttpRequest\.\d\).*debug=\{ detector_id: 57525
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (BundleInstaller) InstallUI"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/stats/startDebug HTTP"; content:"User-Agent|3A| Mozilla/"; content:".0 |28|compatible|3B| Win32|3B| WinHttp.WinHttpRequest."; content:"debug=|7B|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/stats\/startDebug HTTP.*User-Agent: Mozilla\/\d\.0\ \(compatible\;\ Win32\;\ WinHttp\.WinHttpRequest\.\d\).*debug=\{/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057525; rev:1498;)

# Command&Control: (Virus) Fujacks - regex: to_server:GET \/entry\.php\?zoneid=\d+&var=[a-z0-9\.]+ HTTP detector_id: 57529
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Virus) Fujacks"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/entry.php?zoneid="; content:"&var="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/entry\.php\?zoneid=\d+&var=[a-z0-9\.]+ HTTP/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057529; rev:1498;)

# Command&Control: (Trojan) Parite - regex: to_server:POST \/index\.php\?r=site\/login HTTP.*\r\n\r\n&LoginForm\[ detector_id: 57530
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Parite"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/index.php?r=site/login HTTP"; content:"|0D||0A||0D||0A|&LoginForm|5B|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\?r=site\/login HTTP.*\r\n\r\n&LoginForm\[/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057530; rev:1498;)

# Command&Control: (Trojan) Rodecap - regex: to_server:GET \/index\.php\?data=.*\@.*&len HTTP/1\.0 detector_id: 57569
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Rodecap"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?data="; content:"&len HTTP/1.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\?data=.*\@.*&len HTTP\/1\.0/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057569; rev:1506;)

# Command&Control: (Trojan) Rodecap - regex: to_server:GET \/index\.php\?method&len HTTP/1\.0 detector_id: 57570
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Rodecap"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?method&len HTTP/1.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\?method&len HTTP\/1\.0/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057570; rev:1506;)

# Adware: (Downloader) DownloadAdmin - regex: to_server:POST /install\?bc=\d+&pid=.*&brand=.*HTTP.*User-Agent: Tightrope Bundle Manager detector_id: 57571
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downloader) DownloadAdmin"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/install?bc="; content:"&pid="; content:"&brand="; content:"HTTP"; content:"User-Agent|3A| Tightrope Bundle Manager"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/install\?bc=\d+&pid=.*&brand=.*HTTP.*User-Agent: Tightrope Bundle Manager/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057571; rev:1506;)

# Fake-AV: (Updater) OpenSoftwareUpdater - regex: to_server:GET \/installer\.php\?CODE=.*&UID=[A-F0-9\-]+(&quant=\d+)?&action=\d+ HTTP.*User-Agent: NSIS\_Inetc\ \(Mozilla\) detector_id: 57572
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Fake-AV: (Updater) OpenSoftwareUpdater"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/installer.php?CODE="; content:"&UID="; content:"&action="; content:" HTTP"; content:"User-Agent|3A| NSIS_Inetc |28|Mozilla|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/installer\.php\?CODE=.*&UID=[A-F0-9\-]+(&quant=\d+)?&action=\d+ HTTP.*User-Agent: NSIS\_Inetc\ \(Mozilla\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057572; rev:1506;)

# Adware: (Adware) Gigaclicks - regex: to_server:GET /DataInfo/ver/\d+/sid/\d+/ HTTP detector_id: 57585
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Gigaclicks"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/DataInfo/ver/"; content:"/sid/"; content:"/ HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/DataInfo\/ver\/\d+\/sid\/\d+\/ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057585; rev:1507;)

# Command&Control: (Banker) Banbra - regex: to_server:POST /consulta2\.php HTTP.*User-Agent: Mozilla/3\.0 \(compatible\; Indy Library\).*\r\n\r\ntexto= detector_id: 57586
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Banbra"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/consulta2.php HTTP"; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29|"; content:"|0D||0A||0D||0A|texto="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/consulta2\.php HTTP.*User-Agent: Mozilla\/3\.0 \(compatible\; Indy Library\).*\r\n\r\ntexto=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057586; rev:1507;)

# Fake-av: (Fake-AV) AntivirusPro2015 - regex: to_server:GET .*\.php\?id=\d+ HTTP.*User\-Agent: Mozilla\r\n detector_id: 57587
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Fake-av: (Fake-AV) AntivirusPro2015"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?id="; content:" HTTP"; content:"User-Agent|3A| Mozilla|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php\?id=\d+ HTTP.*User\-Agent: Mozilla\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057587; rev:1508;)

# Command&Control: (Spyware) GomyHit - regex: to_server:GET \/glp\?r=&u=http.* HTTP detector_id: 57589
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Spyware) GomyHit"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/glp?r=&u=http"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/glp\?r=&u=http.* HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057589; rev:1508;)

# Adware: (Riskware) Yantai - regex: to_server:POST \/conf\.php HTTP.*User\-Agent: NSIS\_Inetc\ \(Mozilla\).*\r\n\r\na=[a-z]+&configname= detector_id: 57672
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Riskware) Yantai"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/conf.php HTTP"; content:"User-Agent|3A| NSIS_Inetc |28|Mozilla|29|"; content:"|0D||0A||0D||0A|a="; content:"&configname="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/conf\.php HTTP.*User\-Agent: NSIS\_Inetc\ \(Mozilla\).*\r\n\r\na=[a-z]+&configname=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057672; rev:1518;)

# Adware: (Downware) Solimba - regex: to_server:POST \/installer\/.*||to_client:HTTP.*\r\n\r\nc\r\n\{\"code\":200\} detector_id: 57674
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Solimba (0) (no alert)"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/installer/"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/installer\/.*/s"; flowbits:set,LL.57674_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105767400; rev:1522;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Adware: (Downware) Solimba (1)"; flowbits:isset,LL.57674_0; flow:established,to_client; content:"HTTP"; content:"|0D||0A||0D||0A|c|0D||0A||7B||22|code|22||3A|200|7D|"; pcre:"/HTTP.*\r\n\r\nc\r\n\{\"code\":200\}/s"; flowbits:unset,LL.57674_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105767401; rev:1522;)

# Adware: (PUA) Truedownloader - regex: to_server:GET \/tr\/sdm\_px\/\?id=\d+(&data=.*&ses\_id=.*&down\_id=.*&\_=\d+)? HTTP detector_id: 57716
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUA) Truedownloader"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/tr/sdm_px/?id="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/tr\/sdm\_px\/\?id=\d+(&data=.*&ses\_id=.*&down\_id=.*&\_=\d+)? HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057716; rev:1519;)

# Test composite 2 - regex: to_server:POST \/iplookup\/iplookup\.php\?format=json HTTP||to_client:HTTP\/1\.1 200 OK\r\nServer: Tengine detector_id: 57718
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Test composite 2 (0) (no alert)"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/iplookup/iplookup.php?format=json HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/iplookup\/iplookup\.php\?format=json HTTP/"; flowbits:set,LL.57718_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105771800; rev:1522;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Test composite 2 (1)"; flowbits:isset,LL.57718_0; flow:established,to_client; content:"HTTP/1.1 200 OK|0D||0A|Server|3A| Tengine"; flowbits:unset,LL.57718_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105771801; rev:1522;)

# Adware: (Downware) Solimba - regex: to_server:POST /installer/[a-f0-9]{8}(-[a-f0-9]{4}){3}-[a-f0-9]{12}/\d+/event HTTP detector_id: 57719
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Solimba"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/installer/"; content:"/event HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/installer\/[a-f0-9]{8}(-[a-f0-9]{4}){3}-[a-f0-9]{12}\/\d+\/event HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057719; rev:1520;)

# FakeAV: KoreanFakeAV - regex: to_server:GET /mbk\.php\?v1=.*&amp;v2=.* detector_id: 57751
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS FakeAV: KoreanFakeAV"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mbk.php?v1="; content:"&amp|3B|v2="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mbk\.php\?v1=.*&amp\;v2=.*/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057751; rev:1522;)

# Signature to test workflow - regex: to_server:POST \/index\.php\/api\/updater\-status HTTP.*uuid=87b84dd2\-284a\-ff9c\-e808\-3ad49fa223c2&nuuid=45e58627c8690af94eef9e4bbe7d5dfb&status=.*&version=.* detector_id: 57752
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Signature to test workflow"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/index.php/api/updater-status HTTP"; content:"uuid=87b84dd2-284a-ff9c-e808-3ad49fa223c2&nuuid=45e58627c8690af94eef9e4bbe7d5dfb&status="; content:"&version="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\/api\/updater\-status HTTP.*uuid=87b84dd2\-284a\-ff9c\-e808\-3ad49fa223c2&nuuid=45e58627c8690af94eef9e4bbe7d5dfb&status=.*&version=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057752; rev:1522;)

# Adware: (PUA) MultiPlug - regex: to_server:POST \/ HTTP\/1\.1\r\nRange: bytes=0\-.*\r\n\r\ndata=.*&report= detector_id: 57813
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUA) MultiPlug"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ HTTP/1.1|0D||0A|Range|3A| bytes=0-"; content:"|0D||0A||0D||0A|data="; content:"&report="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ HTTP\/1\.1\r\nRange: bytes=0\-.*\r\n\r\ndata=.*&report=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057813; rev:1533;)

# Command&Control: (Trojan) Zegost - regex: to_server:GET \/.*\.php\?MAC=[A-Fa-f0-9\:]{17} HTTP/1\.1\r\nUser\-Agent: GetMac\r\n detector_id: 57814
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?MAC="; content:" HTTP/1.1|0D||0A|User-Agent|3A| GetMac|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\.php\?MAC=[A-Fa-f0-9\:]{17} HTTP\/1\.1\r\nUser\-Agent: GetMac\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057814; rev:1533;)

# Command&Control: (Trojan) Zlob - regex: to_server:GET \/[a-z]+\.php\?t=\d&guid=.*&channel=\d+&ua=.* HTTP.*User\-Agent: Microsoft BITS detector_id: 57815
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zlob"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?t="; content:"&guid="; content:"&channel="; content:"&ua="; content:" HTTP"; content:"User-Agent|3A| Microsoft BITS"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]+\.php\?t=\d&guid=.*&channel=\d+&ua=.* HTTP.*User\-Agent: Microsoft BITS/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057815; rev:1533;)

# Command&Control: (Dropper) Banload - regex: to_server:HEAD .*(?![^\r]+Installer)(?![^\r]+Proclaim)(?![^\r]+\.lbxdat)[^\w]pagador[^\w].*(?:dll|exe|xpi|zip) HTTP.*User\-Agent: Microsoft BITS detector_id: 57816
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Banload"; flow:established,to_server; content:"HEAD"; nocase; http_method; content:"HEAD "; content:"pagador"; content:" HTTP"; content:"User-Agent|3A| Microsoft BITS"; pcre:"/HEAD (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*(?![^\r]+Installer)(?![^\r]+Proclaim)(?![^\r]+\.lbxdat)[^\w]pagador[^\w].*(?:dll|exe|xpi|zip) HTTP.*User\-Agent: Microsoft BITS/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057816; rev:1533;)

# Command&Control: (Rootkit) Rootkitdrv - regex: to_server:POST \/api\/xmlapi\.asmx\/GetInfo HTTP.*Content\-Length: 1\d\r\n.*\r\nAppCode=[a-z\d]+ detector_id: 57817
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Rootkit) Rootkitdrv"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/api/xmlapi.asmx/GetInfo HTTP"; content:"Content-Length|3A| 1"; content:"|0D||0A|"; content:"|0D||0A|AppCode="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/xmlapi\.asmx\/GetInfo HTTP.*Content\-Length: 1\d\r\n.*\r\nAppCode=[a-z\d]+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057817; rev:1534;)

#  - regex: to_server:POST \/api\/xmlapi\.asmx\/Login HTTP.*\r\n\r\nUserName=.*&UserPwd=.*&Machine=.*&Mark=.*&Vercode=&AppCode=.*&cd=.*&SignData=[a-f0-9]{32} detector_id: 57818
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS "; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/api/xmlapi.asmx/Login HTTP"; content:"|0D||0A||0D||0A|UserName="; content:"&UserPwd="; content:"&Machine="; content:"&Mark="; content:"&Vercode=&AppCode="; content:"&cd="; content:"&SignData="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/xmlapi\.asmx\/Login HTTP.*\r\n\r\nUserName=.*&UserPwd=.*&Machine=.*&Mark=.*&Vercode=&AppCode=.*&cd=.*&SignData=[a-f0-9]{32}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057818; rev:1534;)

# New Dyre User-Agent - regex: to_server:GET \/.*User\-Agent: Mozilla\/5\.0 \(Windows NT 6\.1; WOW64; Trident\/7\.0; SLCC2; \.NET CLR 2\.0\.50727; \.NET CLR 3\.5\.30729; \.NET CLR 3\.0\.30729; Media Center PC 6\.0; \.NET4\.0E; \.NET4\.0C; rv:11\.0\) like Gecko\r\n detector_id: 57819
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS New Dyre User-Agent"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"User-Agent|3A| Mozilla/5.0 |28|Windows NT 6.1|3B| WOW64|3B| Trident/7.0|3B| SLCC2|3B| .NET CLR 2.0.50727|3B| .NET CLR 3.5.30729|3B| .NET CLR 3.0.30729|3B| Media Center PC 6.0|3B| .NET4.0E|3B| .NET4.0C|3B| rv|3A|11.0|29| like Gecko|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*User\-Agent: Mozilla\/5\.0 \(Windows NT 6\.1\; WOW64\; Trident\/7\.0\; SLCC2\; \.NET CLR 2\.0\.50727\; \.NET CLR 3\.5\.30729\; \.NET CLR 3\.0\.30729\; Media Center PC 6\.0\; \.NET4\.0E\; \.NET4\.0C\; rv:11\.0\) like Gecko\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057819; rev:1534;)

# Command&Control: (Beacon) CVE-2012-2539 - regex: to_server:GET /[a-z0-9A-Z]+\/(img|image)\.php\?id=\d{8}(&act=\d+)? HTTP detector_id: 57821
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Beacon) CVE-2012-2539"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?id="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z0-9A-Z]+\/(img|image)\.php\?id=\d{8}(&act=\d+)? HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057821; rev:1534;)

# Command&Control: (Trojan) Rowmanti - regex: to_server:GET /update\.php HTTP.*User-Agent: AutoIt detector_id: 57822
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Rowmanti"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/update.php HTTP"; content:"User-Agent|3A| AutoIt"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/update\.php HTTP.*User-Agent: AutoIt/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057822; rev:1534;)

# Command&Control: (Trojan) Rowmanti - regex: to_server:GET /json\.gp HTTP.*User-Agent: AutoIt detector_id: 57823
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Rowmanti"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/json.gp HTTP"; content:"User-Agent|3A| AutoIt"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/json\.gp HTTP.*User-Agent: AutoIt/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057823; rev:1534;)

# Adware: (Downware) Adload - regex: to_server:POST \/index\.php\?r=[a-zA-Z0-9\/]+&cpt=[a-f0-9]+ HTTP.*User\-Agent: MSDN\ Safa\ HTTP\ Retriever\ \d\.\d\r\n.*\r\nc= detector_id: 57840
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Adload"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/index.php?r="; content:"&cpt="; content:" HTTP"; content:"User-Agent|3A| MSDN Safa HTTP Retriever "; content:"|0D||0A|"; content:"|0D||0A|c="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php\?r=[a-zA-Z0-9\/]+&cpt=[a-f0-9]+ HTTP.*User\-Agent: MSDN\ Safa\ HTTP\ Retriever\ \d\.\d\r\n.*\r\nc=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057840; rev:1538;)

# Command&Control: (Trojan) Rofin - regex: to_server:GET \/.*\/[a-z0-9]+\.\d\.bin\?ver=\d.\d+&lip=[\d\.]{7,15}&mac=[A-F0-9]{12} HTTP detector_id: 57842
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Rofin"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".bin?ver="; content:"&lip="; content:"&mac="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\/[a-z0-9]+\.\d\.bin\?ver=\d.\d+&lip=[\d\.]{7,15}&mac=[A-F0-9]{12} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057842; rev:1538;)

# test 2 sigs - regex: to_client:HTTP FOO BAR BAZ detector_id: 57881
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS test 2 sigs"; flow:established,to_client; content:"HTTP FOO BAR BAZ"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057881; rev:1547;)

# Command&Control: (Trojan) Staser - regex: to_server:POST \/index\.php HTTP\/1\.0\r\n.*\r\n\r\nenv=[a-zA-Z0-9\+\/]+={0,2}||to_client:HTTP\/1\.0.*\nServer: ATS\/\d detector_id: 57884
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Staser (0) (no alert)"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/index.php HTTP/1.0|0D||0A|"; content:"|0D||0A||0D||0A|env="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php HTTP\/1\.0\r\n.*\r\n\r\nenv=[a-zA-Z0-9\+\/]+={0,2}/s"; flowbits:set,LL.57884_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105788400; rev:1547;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Trojan) Staser (1)"; flowbits:isset,LL.57884_0; flow:established,to_client; content:"HTTP/1.0"; content:"|0A|Server|3A| ATS/"; pcre:"/HTTP\/1\.0.*\nServer: ATS\/\d/s"; flowbits:unset,LL.57884_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105788401; rev:1547;)

# Command&Control: (Trojan-Spy) Odlanor - regex: to_server:POST \/pkrw\/r\.php\?m=\d&v=[\d\.]+&os=.*&c=\w{4}\-\w{2}&u=[a-zA-Z0-9\-\_]+ HTTP\/1\.0\r.*\r\n\r\n\d+\|\|\|[a-f0-9]{8}\-[a-f0-9]{4}\-[a-f0-9]{4}\-[a-f0-9]{4}\-[a-f0-9]{12}||to_client:HTTP\/.*\r\n\r\n(?:UPDATEMZ|DESTROY) detector_id: 57885
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan-Spy) Odlanor (0) (no alert)"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/pkrw/r.php?m="; content:"&v="; content:"&os="; content:"&c="; content:"&u="; content:" HTTP/1.0|0D|"; content:"|0D||0A||0D||0A|"; content:"|7C||7C||7C|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/pkrw\/r\.php\?m=\d&v=[\d\.]+&os=.*&c=\w{4}\-\w{2}&u=[a-zA-Z0-9\-\_]+ HTTP\/1\.0\r.*\r\n\r\n\d+\|\|\|[a-f0-9]{8}\-[a-f0-9]{4}\-[a-f0-9]{4}\-[a-f0-9]{4}\-[a-f0-9]{12}/s"; flowbits:set,LL.57885_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105788500; rev:1547;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Trojan-Spy) Odlanor (1)"; flowbits:isset,LL.57885_0; flow:established,to_client; content:"HTTP/"; content:"|0D||0A||0D||0A|"; pcre:"/HTTP\/.*\r\n\r\n(?:UPDATEMZ|DESTROY)/s"; flowbits:unset,LL.57885_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105788501; rev:1547;)

# Adware: (BHO) Zwangi - regex: to_server:GET \/\?vn=\d+&partner=.*&ptag=.*&cid=[a-f0-9]+&initial\_install=\d&b=.*&se=\d&au=\d&am=\d&pver=\d&retries=\d HTTP.*User-Agent: Mozilla\/4\.0 \(compatible\; MSIE 8\.0\; Windows NT 6\.1\) detector_id: 57911
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (BHO) Zwangi"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?vn="; content:"&partner="; content:"&ptag="; content:"&cid="; content:"&initial_install="; content:"&b="; content:"&se="; content:"&au="; content:"&am="; content:"&pver="; content:"&retries="; content:" HTTP"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 8.0|3B| Windows NT 6.1|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?vn=\d+&partner=.*&ptag=.*&cid=[a-f0-9]+&initial\_install=\d&b=.*&se=\d&au=\d&am=\d&pver=\d&retries=\d HTTP.*User-Agent: Mozilla\/4\.0 \(compatible\; MSIE 8\.0\; Windows NT 6\.1\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057911; rev:1547;)

# Adware: (Downware) Chinad - regex: to_server:GET .*/read\.php\?t=.*&d=\d+&c=.* HTTP/1\.0 detector_id: 57913
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Chinad"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/read.php?t="; content:"&d="; content:"&c="; content:" HTTP/1.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/read\.php\?t=.*&d=\d+&c=.* HTTP\/1\.0/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057913; rev:1547;)

# Adware: (PUA) bmMedia - regex: to_server:POST \/red\/alarm\/\?product=\w+&version=\d\.\d&s=[a-f0-9]{32} HTTP||to_client:HTTP\/1\.1 100 Continue detector_id: 57925
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUA) bmMedia (0) (no alert)"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/red/alarm/?product="; content:"&version="; content:"&s="; content:" HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/red\/alarm\/\?product=\w+&version=\d\.\d&s=[a-f0-9]{32} HTTP/"; flowbits:set,LL.57925_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105792500; rev:1547;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Adware: (PUA) bmMedia (1)"; flowbits:isset,LL.57925_0; flow:established,to_client; content:"HTTP/1.1 100 Continue"; flowbits:unset,LL.57925_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105792501; rev:1547;)

# Command&Control: (PwdStealer) MCLauncher - regex: to_server:POST \/ml\/login\.php HTTP\/1\.0.*\r\n\r\nusername=\w+&hash=[a-f0-9]{32}&launcher=\w+ detector_id: 57926
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (PwdStealer) MCLauncher"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ml/login.php HTTP/1.0"; content:"|0D||0A||0D||0A|username="; content:"&hash="; content:"&launcher="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ml\/login\.php HTTP\/1\.0.*\r\n\r\nusername=\w+&hash=[a-f0-9]{32}&launcher=\w+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057926; rev:1547;)

# Command&Control: (Trojan) Depok - regex: to_server:GET \/bluecgi\/counter\/counter\d+\.php\?dbname=torrener1 HTTP detector_id: 57927
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Depok"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bluecgi/counter/counter"; content:".php?dbname=torrener1 HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bluecgi\/counter\/counter\d+\.php\?dbname=torrener1 HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057927; rev:1547;)

# Command&Control: (Trojan) Autorun - regex: to_server:GET \/dd\.txt HTTP/1\.1\r\nAccept: \*\/\*\r\nAccept\-Encoding: gzip, deflate\r\nUser\-Agent: [^\r]+\r\nHost: [^\r]+\.ma\r\nConnection: Keep\-Alive\r\n detector_id: 57928
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Autorun"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/dd.txt HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|Accept-Encoding|3A| gzip|2C| deflate|0D||0A|User-Agent|3A| "; content:"|0D||0A|Host|3A| "; content:".ma|0D||0A|Connection|3A| Keep-Alive|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/dd\.txt HTTP\/1\.1\r\nAccept: \*\/\*\r\nAccept\-Encoding: gzip, deflate\r\nUser\-Agent: [^\r]+\r\nHost: [^\r]+\.ma\r\nConnection: Keep\-Alive\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057928; rev:1547;)

# Malware Distribution: (Download) Khelios.f - regex: to_server:GET (/[a-z]+\d*)?/\d?\w+\d*?\.exe HTTP/1\.0\r\nHost: \d+\.\d+\.\d+\.\d+\r\n\r\n detector_id: 57981
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Malware Distribution: (Download) Khelios.f"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".exe HTTP/1.0|0D||0A|Host|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(\/[a-z]+\d*)?\/\d?\w+\d*?\.exe HTTP\/1\.0\r\nHost: \d+\.\d+\.\d+\.\d+\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057981; rev:1549;)

# Malware Distribution: (Download) Khelios.F - regex: to_client:HTTP/1.1 200 Ok.*Last-Modified: [^ -~]{2}, \d+ [^ -~]{3} \d+ \d+:\d+:\d+ GMT detector_id: 57982
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Malware Distribution: (Download) Khelios.F"; flow:established,to_client; content:"HTTP/1"; content:"1 200 Ok"; content:"Last-Modified|3A| "; content:"|2C| "; content:" GMT"; pcre:"/HTTP\/1.1 200 Ok.*Last-Modified: [^ -~]{2}, \d+ [^ -~]{3} \d+ \d+:\d+:\d+ GMT/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057982; rev:1549;)

# Malware distribution: (Download) Khelios.F - regex: to_client:HTTP/1\.1 200 \r.*Server: .*Last\-Modified: [^ -~]{2}, \d+ [^ -~]{3} \d+ \d+:\d+:\d+ GMT.*Server:\S detector_id: 57985
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Malware distribution: (Download) Khelios.F"; flow:established,to_client; content:"HTTP/1.1 200 |0D|"; content:"Server|3A| "; content:"Last-Modified|3A| "; content:"|2C| "; content:" GMT"; content:"Server|3A|"; pcre:"/HTTP\/1\.1 200 \r.*Server: .*Last\-Modified: [^ -~]{2}, \d+ [^ -~]{3} \d+ \d+:\d+:\d+ GMT.*Server:\S/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057985; rev:1549;)

# Drive-by: Angler EK - regex: to_server:GET (http://.*)?\/[A-Za-z0-9_\-]{48} HTTP||to_client:HTTP.*\r\n\r\n.{1728,1736}\x51\xcb\x7b\xfc\x19\x9b\x77\xfb detector_id: 58027
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: Angler EK (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(http:\/\/.*)?\/[A-Za-z0-9_\-]{48} HTTP/s"; flowbits:set,LL.58027_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105802700; rev:1555;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: Angler EK (1)"; flowbits:isset,LL.58027_0; flow:established,to_client; content:"HTTP"; content:"|0D||0A||0D||0A|"; content:"Q|CB||7B||FC||19||9B|w|FB|"; pcre:"/HTTP.*\r\n\r\n.{1728,1736}\x51\xcb\x7b\xfc\x19\x9b\x77\xfb/s"; flowbits:unset,LL.58027_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105802701; rev:1555;)

# Command&Control: (Trojan) Bublik - regex: to_server:POST \/ft\/ff\.php HTTP.*Content\-Type: application\/x\-www\-form\-urlencoded.*\r\n\r\n[A-Za-z0-9\+/]{20,}={0,2} detector_id: 58028
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bublik"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ft/ff.php HTTP"; content:"Content-Type|3A| application/x-www-form-urlencoded"; content:"|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ft\/ff\.php HTTP.*Content\-Type: application\/x\-www\-form\-urlencoded.*\r\n\r\n[A-Za-z0-9\+\/]{20,}={0,2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058028; rev:1555;)

# Drive-by: Angler EK - regex: to_server:GET (http://.*)?\/[A-Za-z0-9_\-]{48} HTTP||to_client:HTTP.*\r\n\r\n.{1728,1736}\x08\xfe\x4a\xac\xc6\xd6\x06\x8d detector_id: 58180
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: Angler EK (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(http:\/\/.*)?\/[A-Za-z0-9_\-]{48} HTTP/s"; flowbits:set,LL.58180_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105818000; rev:1591;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: Angler EK (1)"; flowbits:isset,LL.58180_0; flow:established,to_client; content:"HTTP"; content:"|0D||0A||0D||0A|"; content:"|08||FE|J|AC||C6||D6||06||8D|"; pcre:"/HTTP.*\r\n\r\n.{1728,1736}\x08\xfe\x4a\xac\xc6\xd6\x06\x8d/s"; flowbits:unset,LL.58180_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105818001; rev:1591;)

# Drive-by: Angler EK - regex: to_server:GET (http://.*)?\/[A-Za-z0-9_\-]{48} HTTP||to_client:HTTP.*\r\n\r\n.{1728,1736}\xc5\x91\xb0\x40\xed\xd9\x90\xe2 detector_id: 58181
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: Angler EK (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(http:\/\/.*)?\/[A-Za-z0-9_\-]{48} HTTP/s"; flowbits:set,LL.58181_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105818100; rev:1591;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: Angler EK (1)"; flowbits:isset,LL.58181_0; flow:established,to_client; content:"HTTP"; content:"|0D||0A||0D||0A|"; content:"|C5||91||B0||40||ED||D9||90||E2|"; pcre:"/HTTP.*\r\n\r\n.{1728,1736}\xc5\x91\xb0\x40\xed\xd9\x90\xe2/s"; flowbits:unset,LL.58181_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105818101; rev:1591;)

# Drive-by: Angler EK - regex: to_server:GET (http://.*)?\/[A-Za-z0-9_\-]{48} HTTP||to_client:HTTP.*\r\n\r\n.{1728,1736}\x0e\xc7\x9d\x28\x8c\xcb\xae\x85 detector_id: 58207
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: Angler EK (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(http:\/\/.*)?\/[A-Za-z0-9_\-]{48} HTTP/s"; flowbits:set,LL.58207_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105820700; rev:1593;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: Angler EK (1)"; flowbits:isset,LL.58207_0; flow:established,to_client; content:"HTTP"; content:"|0D||0A||0D||0A|"; content:"|0E||C7||9D||28||8C||CB||AE||85|"; pcre:"/HTTP.*\r\n\r\n.{1728,1736}\x0e\xc7\x9d\x28\x8c\xcb\xae\x85/s"; flowbits:unset,LL.58207_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105820701; rev:1593;)

# Drive-by: Angler EK - regex: to_server:GET (http://.*)?\/[A-Za-z0-9_\-]{48} HTTP||to_client:HTTP.*\r\n\r\n.{1728,1736}\x69\xb8\x3c\x09\x08\x6c\xb1\x4c detector_id: 58208
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: Angler EK (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(http:\/\/.*)?\/[A-Za-z0-9_\-]{48} HTTP/s"; flowbits:set,LL.58208_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105820800; rev:1593;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: Angler EK (1)"; flowbits:isset,LL.58208_0; flow:established,to_client; content:"HTTP"; content:"|0D||0A||0D||0A|"; content:"i|B8|<|09||08|l|B1|L"; pcre:"/HTTP.*\r\n\r\n.{1728,1736}\x69\xb8\x3c\x09\x08\x6c\xb1\x4c/s"; flowbits:unset,LL.58208_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105820801; rev:1593;)

# Drive-by: Angler EK - regex: to_server:GET (http://.*)?\/[A-Za-z0-9_\-]{48} HTTP||to_client:HTTP.*\r\n\r\n.{1728,1736}\x28\x46\xc5\x83\xdf\xef\xa3\x2a detector_id: 58209
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: Angler EK (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(http:\/\/.*)?\/[A-Za-z0-9_\-]{48} HTTP/s"; flowbits:set,LL.58209_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105820900; rev:1593;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: Angler EK (1)"; flowbits:isset,LL.58209_0; flow:established,to_client; content:"HTTP"; content:"|0D||0A||0D||0A|"; content:"|28|F|C5||83||DF||EF||A3||2A|"; pcre:"/HTTP.*\r\n\r\n.{1728,1736}\x28\x46\xc5\x83\xdf\xef\xa3\x2a/s"; flowbits:unset,LL.58209_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105820901; rev:1593;)

# Drive-by: Angler EK - regex: to_server:GET (http://.*)?\/[A-Za-z0-9_\-]{48} HTTP||to_client:HTTP.*\r\n\r\n.{1728,1736}\x41\xad\x58\x53\x4c\x7f\x25\x9e detector_id: 58210
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: Angler EK (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(http:\/\/.*)?\/[A-Za-z0-9_\-]{48} HTTP/s"; flowbits:set,LL.58210_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105821000; rev:1593;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: Angler EK (1)"; flowbits:isset,LL.58210_0; flow:established,to_client; content:"HTTP"; content:"|0D||0A||0D||0A|"; content:"A|AD|XSL|7F||25||9E|"; pcre:"/HTTP.*\r\n\r\n.{1728,1736}\x41\xad\x58\x53\x4c\x7f\x25\x9e/s"; flowbits:unset,LL.58210_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105821001; rev:1593;)

# Drive-by: Angler EK - regex: to_server:GET (http://.*)?\/[A-Za-z0-9_\-]{48} HTTP||to_client:HTTP.*\r\n\r\n.{1728,1736}\xb8\x67\xf0\x44\x43\x1e\xfe\x5b detector_id: 58211
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: Angler EK (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(http:\/\/.*)?\/[A-Za-z0-9_\-]{48} HTTP/s"; flowbits:set,LL.58211_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105821100; rev:1593;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: Angler EK (1)"; flowbits:isset,LL.58211_0; flow:established,to_client; content:"HTTP"; content:"|0D||0A||0D||0A|"; content:"|B8|g|F0|DC|1E||FE||5B|"; pcre:"/HTTP.*\r\n\r\n.{1728,1736}\xb8\x67\xf0\x44\x43\x1e\xfe\x5b/s"; flowbits:unset,LL.58211_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105821101; rev:1593;)

# Drive-by: Angler EK - regex: to_server:GET (http://.*)?\/[A-Za-z0-9_\-]{48} HTTP||to_client:HTTP.*\r\n\r\n.{1728,1736}\x82\x67\x9f\xc3\xf1\x71\x70\xfc detector_id: 58212
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: Angler EK (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(http:\/\/.*)?\/[A-Za-z0-9_\-]{48} HTTP/s"; flowbits:set,LL.58212_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105821200; rev:1593;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: Angler EK (1)"; flowbits:isset,LL.58212_0; flow:established,to_client; content:"HTTP"; content:"|0D||0A||0D||0A|"; content:"|82|g|9F||C3||F1|qp|FC|"; pcre:"/HTTP.*\r\n\r\n.{1728,1736}\x82\x67\x9f\xc3\xf1\x71\x70\xfc/s"; flowbits:unset,LL.58212_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105821201; rev:1593;)

# Drive-by: Angler EK - regex: to_server:GET (http://.*)?\/[A-Za-z0-9_\-]{48} HTTP||to_client:HTTP.*\r\n\r\n.{1728,1736}\x04\x6e\x76\x82\x2e\x2c\x2c\x48 detector_id: 58213
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: Angler EK (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(http:\/\/.*)?\/[A-Za-z0-9_\-]{48} HTTP/s"; flowbits:set,LL.58213_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105821300; rev:1593;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: Angler EK (1)"; flowbits:isset,LL.58213_0; flow:established,to_client; content:"HTTP"; content:"|0D||0A||0D||0A|"; content:"|04|nv|82|.|2C||2C|H"; pcre:"/HTTP.*\r\n\r\n.{1728,1736}\x04\x6e\x76\x82\x2e\x2c\x2c\x48/s"; flowbits:unset,LL.58213_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105821301; rev:1593;)

# Drive-by: Angler EK - regex: to_server:GET (http://.*)?\/[A-Za-z0-9_\-]{48} HTTP||to_client:HTTP.*\r\n\r\n.{1728,1736}\x31\x90\x49\xae\xc8\x2b\x73\x75 detector_id: 58214
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: Angler EK (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(http:\/\/.*)?\/[A-Za-z0-9_\-]{48} HTTP/s"; flowbits:set,LL.58214_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105821400; rev:1593;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: Angler EK (1)"; flowbits:isset,LL.58214_0; flow:established,to_client; content:"HTTP"; content:"|0D||0A||0D||0A|"; content:"1|90|I|AE||C8||2B|su"; pcre:"/HTTP.*\r\n\r\n.{1728,1736}\x31\x90\x49\xae\xc8\x2b\x73\x75/s"; flowbits:unset,LL.58214_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105821401; rev:1593;)

# Drive-by: Angler EK - regex: to_server:GET (http://.*)?\/[A-Za-z0-9_\-]{48} HTTP||to_client:HTTP.*\r\n\r\n.{1728,1736}\x0b\xc7\x6a\x1e\x7c\xc2\x43\xea detector_id: 58215
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: Angler EK (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(http:\/\/.*)?\/[A-Za-z0-9_\-]{48} HTTP/s"; flowbits:set,LL.58215_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105821500; rev:1593;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: Angler EK (1)"; flowbits:isset,LL.58215_0; flow:established,to_client; content:"HTTP"; content:"|0D||0A||0D||0A|"; content:"|0B||C7|j|1E||7C||C2|C|EA|"; pcre:"/HTTP.*\r\n\r\n.{1728,1736}\x0b\xc7\x6a\x1e\x7c\xc2\x43\xea/s"; flowbits:unset,LL.58215_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105821501; rev:1593;)

# Drive-by: Angler EK - regex: to_server:GET (http://.*)?\/[A-Za-z0-9_\-]{48} HTTP||to_client:HTTP.*\r\n\r\n.{1728,1736}\xc1\xe4\x07\x2f\x13\xad\x23\x2e detector_id: 58216
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: Angler EK (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(http:\/\/.*)?\/[A-Za-z0-9_\-]{48} HTTP/s"; flowbits:set,LL.58216_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105821600; rev:1593;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: Angler EK (1)"; flowbits:isset,LL.58216_0; flow:established,to_client; content:"HTTP"; content:"|0D||0A||0D||0A|"; content:"|C1||E4||07|/|13||AD||23|."; pcre:"/HTTP.*\r\n\r\n.{1728,1736}\xc1\xe4\x07\x2f\x13\xad\x23\x2e/s"; flowbits:unset,LL.58216_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105821601; rev:1593;)

# Drive-by: Angler EK - regex: to_server:GET (http://.*)?\/[A-Za-z0-9_\-]{48} HTTP||to_client:HTTP.*\r\n\r\n.{1728,1736}\xc5\x91\xb0\x40\xed\xd9\x90\xe2 detector_id: 58218
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: Angler EK (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(http:\/\/.*)?\/[A-Za-z0-9_\-]{48} HTTP/s"; flowbits:set,LL.58218_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105821800; rev:1593;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: Angler EK (1)"; flowbits:isset,LL.58218_0; flow:established,to_client; content:"HTTP"; content:"|0D||0A||0D||0A|"; content:"|C5||91||B0||40||ED||D9||90||E2|"; pcre:"/HTTP.*\r\n\r\n.{1728,1736}\xc5\x91\xb0\x40\xed\xd9\x90\xe2/s"; flowbits:unset,LL.58218_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105821801; rev:1593;)

# Drive-by: Angler EK - regex: to_server:GET (http://.*)?\/[A-Za-z0-9_\-]{48} HTTP||to_client:HTTP.*\r\n\r\n.{1728,1736}\x71\x37\x53\xd7\x19\x3c\x44\xac detector_id: 58219
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: Angler EK (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(http:\/\/.*)?\/[A-Za-z0-9_\-]{48} HTTP/s"; flowbits:set,LL.58219_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105821900; rev:1593;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: Angler EK (1)"; flowbits:isset,LL.58219_0; flow:established,to_client; content:"HTTP"; content:"|0D||0A||0D||0A|"; content:"q7S|D7||19|<D|AC|"; pcre:"/HTTP.*\r\n\r\n.{1728,1736}\x71\x37\x53\xd7\x19\x3c\x44\xac/s"; flowbits:unset,LL.58219_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105821901; rev:1593;)

# Drive-by: Angler EK - regex: to_server:GET (http://.*)?\/[A-Za-z0-9_\-]{48} HTTP||to_client:HTTP.*\r\n\r\n.{1728,1736}\xff\xbe\xd1\x79\xe8\x64\x54\xd1 detector_id: 58220
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: Angler EK (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(http:\/\/.*)?\/[A-Za-z0-9_\-]{48} HTTP/s"; flowbits:set,LL.58220_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105822000; rev:1593;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: Angler EK (1)"; flowbits:isset,LL.58220_0; flow:established,to_client; content:"HTTP"; content:"|0D||0A||0D||0A|"; content:"|FF||BE||D1|y|E8|dT|D1|"; pcre:"/HTTP.*\r\n\r\n.{1728,1736}\xff\xbe\xd1\x79\xe8\x64\x54\xd1/s"; flowbits:unset,LL.58220_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105822001; rev:1593;)

# Drive-by: Angler EK - regex: to_server:GET (http://.*)?\/[A-Za-z0-9_\-]{48} HTTP||to_client:HTTP.*\r\n\r\n.{1728,1736}\x64\x4e\x63\x0d\x03\x30\xd6\xa5 detector_id: 58221
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: Angler EK (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(http:\/\/.*)?\/[A-Za-z0-9_\-]{48} HTTP/s"; flowbits:set,LL.58221_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105822100; rev:1593;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: Angler EK (1)"; flowbits:isset,LL.58221_0; flow:established,to_client; content:"HTTP"; content:"|0D||0A||0D||0A|"; content:"dNc|0D||03|0|D6||A5|"; pcre:"/HTTP.*\r\n\r\n.{1728,1736}\x64\x4e\x63\x0d\x03\x30\xd6\xa5/s"; flowbits:unset,LL.58221_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105822101; rev:1593;)

# Command&Control: (Drive-by) Angler EK - regex: to_server:GET \/[A-Za-z0-9_\-]{48} HTTP||to_client:HTTP.*\r\n\r\n\r\n.{1728,1736}\xc5\x91\xb0\x40\xed\xd9\x90\xe2 detector_id: 58222
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Drive-by) Angler EK (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[A-Za-z0-9_\-]{48} HTTP/s"; flowbits:set,LL.58222_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105822200; rev:1597;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Drive-by) Angler EK (1)"; flowbits:isset,LL.58222_0; flow:established,to_client; content:"HTTP"; content:"|0D||0A||0D||0A||0D||0A|"; content:"|C5||91||B0||40||ED||D9||90||E2|"; pcre:"/HTTP.*\r\n\r\n\r\n.{1728,1736}\xc5\x91\xb0\x40\xed\xd9\x90\xe2/s"; flowbits:unset,LL.58222_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105822201; rev:1597;)

# Command&Control: (Dropper) Horst - regex: to_server:GET .*\?sid=\d{9}&att=\d HTTP.*User\-Agent: \-\r\n detector_id: 58223
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Horst"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?sid="; content:"&att="; content:" HTTP"; content:"User-Agent|3A| -|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\?sid=\d{9}&att=\d HTTP.*User\-Agent: \-\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058223; rev:1597;)

# Command&Control: (Backdoor) Ciadoor - regex: to_server:GET .*/add\.php\?action=[a-z]+&ip=[0-9\.]{7,15}&port=\d{1,5}&vicname=.*&usrname=.*&server=.*&password=[^\ ]* HTTP.*User\-Agent: http\ protocol\r detector_id: 58224
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Ciadoor"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/add.php?action="; content:"&ip="; content:"&port="; content:"&vicname="; content:"&usrname="; content:"&server="; content:"&password="; content:" HTTP"; content:"User-Agent|3A| http protocol|0D|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/add\.php\?action=[a-z]+&ip=[0-9\.]{7,15}&port=\d{1,5}&vicname=.*&usrname=.*&server=.*&password=[^\ ]* HTTP.*User\-Agent: http\ protocol\r/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058224; rev:1597;)

# Command&Control: (Trojan) KeyBase - regex: to_server:GET .*\/post\.php\?type=passwords&machinename=.*&application=.*&link=.*&username=.*&password=[^\ ]* HTTP detector_id: 58226
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) KeyBase"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/post.php?type=passwords&machinename="; content:"&application="; content:"&link="; content:"&username="; content:"&password="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/post\.php\?type=passwords&machinename=.*&application=.*&link=.*&username=.*&password=[^\ ]* HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058226; rev:1597;)

# Command&Control: (Trojan) Fsysna.bwc - regex: to_server:GET \/hive\_chksz\.php\?id=.*&obj=.*&user=.* HTTP.*User\-Agent: DS\_||to_client:HTTP.*\r\n\r\nsize:\d+ detector_id: 58227
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fsysna.bwc (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/hive_chksz.php?id="; content:"&obj="; content:"&user="; content:" HTTP"; content:"User-Agent|3A| DS_"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/hive\_chksz\.php\?id=.*&obj=.*&user=.* HTTP.*User\-Agent: DS\_/s"; flowbits:set,LL.58227_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105822700; rev:1597;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Trojan) Fsysna.bwc (1)"; flowbits:isset,LL.58227_0; flow:established,to_client; content:"HTTP"; content:"|0D||0A||0D||0A|size|3A|"; pcre:"/HTTP.*\r\n\r\nsize:\d+/s"; flowbits:unset,LL.58227_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105822701; rev:1597;)

# Command&Control: (Trojan) Fsysna.bwc - regex: to_server:POST \/hive\_append\.php\?id=.*&obj=.*&user=.* HTTP\/1\.0\r\n(?=.*filename: \x2566\x2569\x256C\x2565\r\n)(?=.*User\-Agent: DS_).*\r\n\r\n detector_id: 58228
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fsysna.bwc"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/hive_append.php?id="; content:"&obj="; content:"&user="; content:" HTTP/1.0|0D||0A|"; content:"|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/hive\_append\.php\?id=.*&obj=.*&user=.* HTTP\/1\.0\r\n(?=.*filename: \x2566\x2569\x256C\x2565\r\n)(?=.*User\-Agent: DS_).*\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058228; rev:1597;)

# Command&Control: (Trojan) Glupteba - regex: to_server:GET .*/index HTTP.*User\-Agent: Go http package\r\n||to_client:HTTP.*Transfer\-Encoding: chunked\r\n.*\r\n\r\n[7-9a-f]\r\n[0-9\.]{7,15}\r\n detector_id: 58229
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Glupteba (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index HTTP"; content:"User-Agent|3A| Go http package|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/index HTTP.*User\-Agent: Go http package\r\n/s"; flowbits:set,LL.58229_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105822900; rev:1597;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Trojan) Glupteba (1)"; flowbits:isset,LL.58229_0; flow:established,to_client; content:"HTTP"; content:"Transfer-Encoding|3A| chunked|0D||0A|"; content:"|0D||0A||0D||0A|"; content:"|0D||0A|"; content:"|0D||0A|"; pcre:"/HTTP.*Transfer\-Encoding: chunked\r\n.*\r\n\r\n[7-9a-f]\r\n[0-9\.]{7,15}\r\n/s"; flowbits:unset,LL.58229_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105822901; rev:1597;)

# Adware: (PUA) Navagaki - regex: to_server:POST \/s2\.php HTTP.*MREQ\-MODULE: seed\r\n.*\{\"uid\":.*,\"channel\"\:\"seed\"\,\"version\"\:\"\d\.\d\.\d\.\d+\"\,\" detector_id: 58664
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUA) Navagaki"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/s2.php HTTP"; content:"MREQ-MODULE|3A| seed|0D||0A|"; content:"|7B||22|uid|22||3A|"; content:"|2C||22|channel|22||3A||22|seed|22||2C||22|version|22||3A||22|"; content:"|22||2C||22|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/s2\.php HTTP.*MREQ\-MODULE: seed\r\n.*\{\"uid\":.*,\"channel\"\:\"seed\"\,\"version\"\:\"\d\.\d\.\d\.\d+\"\,\"/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058664; rev:1687;)

# Command&Control: (Trojan) Reconyc - regex: to_server:POST \/\/API\/(GetBotVer|Init|Rdp|GetNeedPathFiles|CheckFile|Files|GetTargets) HTTP detector_id: 58685
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Reconyc"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"//API/"; content:" HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\/API\/(GetBotVer|Init|Rdp|GetNeedPathFiles|CheckFile|Files|GetTargets) HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058685; rev:1705;)

# Command&Control: (Trojan) Banload - regex: to_server:POST .*/salvaconteudo\.php HTTP.*User-Agent: Mozilla/\d\.0.*\r\n\r\nnome=.*&conteudo=.* detector_id: 58711
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Banload"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/salvaconteudo.php HTTP"; content:"User-Agent|3A| Mozilla/"; content:".0"; content:"|0D||0A||0D||0A|nome="; content:"&conteudo="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/salvaconteudo\.php HTTP.*User-Agent: Mozilla\/\d\.0.*\r\n\r\nnome=.*&conteudo=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058711; rev:1708;)

# Command&Control: (Trojan) Viking - regex: to_server:GET .*(click|campaign)\.php\?ID=adnetosu4&sub=adnetosu&subid=11165151\-puma163com HTTP detector_id: 58820
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Viking"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?ID=adnetosu4&sub=adnetosu&subid=11165151-puma163com HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*(click|campaign)\.php\?ID=adnetosu4&sub=adnetosu&subid=11165151\-puma163com HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058820; rev:1745;)

# Adware: (Downware) Outbrowse - regex: to_server:GET //offers\/DynamicOfferScreen\?offerid=[0-9]+.* HTTP detector_id: 58821
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Outbrowse"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"//offers/DynamicOfferScreen?offerid="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\/offers\/DynamicOfferScreen\?offerid=[0-9]+.* HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058821; rev:1747;)

# Adware: (PUA) AdGazelle - regex: to_server:GET \/ad\/offer2\/mo\?pkey=.*&guid=mo detector_id: 58822
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUA) AdGazelle"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ad/offer2/mo?pkey="; content:"&guid=mo"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ad\/offer2\/mo\?pkey=.*&guid=mo/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058822; rev:1747;)

# Command&Control: (Trojan) Viking - regex: to_server:GET \/\d{4}\.txt HTTP/1\.1\r\nAccept: \*\/\*\r\n||to_server:GET \/\d{4}\.exe HTTP/1\.1\r\nAccept: \*\/\*\r\n detector_id: 58824
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Viking (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".txt HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d{4}\.txt HTTP\/1\.1\r\nAccept: \*\/\*\r\n/"; flowbits:set,LL.58824_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105882400; rev:1747;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Viking (1)"; flowbits:isset,LL.58824_0; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".exe HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d{4}\.exe HTTP\/1\.1\r\nAccept: \*\/\*\r\n/"; flowbits:unset,LL.58824_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105882401; rev:1747;)

# Adware: (PUA) RakNet - regex: to_server:POST \/testServer HTTP.*Host\: masterserver\d\.raknet\.com.*\{\'\_\_gameId\'\: \'.*\'\,\'un\'\: \'.*\'\,\'cn\'\: \'.*\' detector_id: 58825
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUA) RakNet"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/testServer HTTP"; content:"Host|3A| masterserver"; content:".raknet.com"; content:"|7B||27|__gameId|27||3A| |27|"; content:"|27||2C||27|un|27||3A| |27|"; content:"|27||2C||27|cn|27||3A| |27|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/testServer HTTP.*Host\: masterserver\d\.raknet\.com.*\{\'\_\_gameId\'\: \'.*\'\,\'un\'\: \'.*\'\,\'cn\'\: \'.*\'/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058825; rev:1747;)

# Command&Control: (InfoStealer) SpyAgent - regex: to_server:GET \/AuthTech\/authpUb\.php\?user=.*&pass=.*&GUID=\d+ HTTP.*User\-Agent: PHG\. UA_\.PASS Auth\r\nReferer: [^\r]+\r\n\r\n[^ -~]+ detector_id: 58826
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (InfoStealer) SpyAgent"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/AuthTech/authpUb.php?user="; content:"&pass="; content:"&GUID="; content:" HTTP"; content:"User-Agent|3A| PHG. UA_.PASS Auth|0D||0A|Referer|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/AuthTech\/authpUb\.php\?user=.*&pass=.*&GUID=\d+ HTTP.*User\-Agent: PHG\. UA_\.PASS Auth\r\nReferer: [^\r]+\r\n\r\n[^ -~]+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058826; rev:1747;)

# Command&Control: (Trojan) FlyStudio - regex: to_server:POST .*\/[a-z]{4,15}\.asp HTTP.*Content\-Length: \d{2}\r\n.*\r\np=[A-Za-z0-9\+\/]{4,}\={0,2} detector_id: 58827
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) FlyStudio"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".asp HTTP"; content:"Content-Length|3A| "; content:"|0D||0A|"; content:"|0D||0A|p="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/[a-z]{4,15}\.asp HTTP.*Content\-Length: \d{2}\r\n.*\r\np=[A-Za-z0-9\+\/]{4,}\={0,2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058827; rev:1747;)

# Adware: (BHO) BrowSecX - regex: to_server:GET .*\/installLog\.php\?scheme=.*&cpuid=.*&vdbg=1 HTTP\/1\.1\r\nHost: [^\r]+\r\n\r\n\x00 detector_id: 58828
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (BHO) BrowSecX"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/installLog.php?scheme="; content:"&cpuid="; content:"&vdbg=1 HTTP/1.1|0D||0A|Host|3A| "; content:"|0D||0A||0D||0A||00|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/installLog\.php\?scheme=.*&cpuid=.*&vdbg=1 HTTP\/1\.1\r\nHost: [^\r]+\r\n\r\n\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058828; rev:1747;)

# Command&Control: (Infostealer) Limitail - regex: to_server:POST .*\/logs\.php HTTP.*Expect: 100\-continue\r\n\r\ncomp=.*&logtype=(Keystrokes|Passwords|PC\ Information|Notification)&content= detector_id: 58891
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Infostealer) Limitail"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/logs.php HTTP"; content:"Expect|3A| 100-continue|0D||0A||0D||0A|comp="; content:"&logtype="; content:"&content="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/logs\.php HTTP.*Expect: 100\-continue\r\n\r\ncomp=.*&logtype=(Keystrokes|Passwords|PC\ Information|Notification)&content=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058891; rev:1762;)

# Command&Control: (Trojan) CryptoWall - regex: to_server:POST /[a-z0-9]{10,15} HTTP/1\.1.*User\-Agent: Mozilla/4\.0.*\r\n\r\n[a-z]=[a-z0-9]{88,100} detector_id: 58892
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) CryptoWall"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:" HTTP/1.1"; content:"User-Agent|3A| Mozilla/4.0"; content:"|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z0-9]{10,15} HTTP\/1\.1.*User\-Agent: Mozilla\/4\.0.*\r\n\r\n[a-z]=[a-z0-9]{88,100}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058892; rev:1762;)

# Malware distribution: (Generic) Obfuscated PE file - regex: to_client:HTTP\/1\.1 200 OK.*\r\n\r\nM[^Z].*This program cannot be run in DOS mode detector_id: 58913
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Malware distribution: (Generic) Obfuscated PE file"; flow:established,to_client; content:"HTTP/1.1 200 OK"; content:"|0D||0A||0D||0A|M"; content:"This program cannot be run in DOS mode"; pcre:"/HTTP\/1\.1 200 OK.*\r\n\r\nM[^Z].*This program cannot be run in DOS mode/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058913; rev:1771;)

# Adware: (PUP) Browsefox - regex: to_server:GET \/.*\/[a-z]{3}\?(beid=.*&)?v=\d\.\d\.\d{4}\.\d{5} HTTP.*User-Agent: NSIS\_Inetc\ \(Mozilla\) detector_id: 58921
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUP) Browsefox"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"v="; content:" HTTP"; content:"User-Agent|3A| NSIS_Inetc |28|Mozilla|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\/[a-z]{3}\?(beid=.*&)?v=\d\.\d\.\d{4}\.\d{5} HTTP.*User-Agent: NSIS\_Inetc\ \(Mozilla\)/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058921; rev:1786;)

# Command&Control: (Ransomware) Urausy - regex: to_server:GET (/[A-Za-z0-9\-\_]{30,})+\.(html|php) HTTP/1\.1\r\nUser\-Agent: Mozilla/5\.0 \(compatible\; MSIE 9\.0\; Windows NT 6\.1\; Trident/5\.0\)\r\n detector_id: 58922
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) Urausy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP/1.1|0D||0A|User-Agent|3A| Mozilla/5.0 |28|compatible|3B| MSIE 9.0|3B| Windows NT 6.1|3B| Trident/5.0|29||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(\/[A-Za-z0-9\-\_]{30,})+\.(html|php) HTTP\/1\.1\r\nUser\-Agent: Mozilla\/5\.0 \(compatible\; MSIE 9\.0\; Windows NT 6\.1\; Trident\/5\.0\)\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058922; rev:1789;)

# Command&Control: (Trojan) FortDisco - regex: to_server:GET \/cmd\.php\?v=\d{8}&o=.* HTTP\/1\.0.*User\-Agent: Mozilla\/4\.0\ \(compatible\;\ Synapse\) detector_id: 59005
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) FortDisco"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cmd.php?v="; content:"&o="; content:" HTTP/1.0"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| Synapse|29|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cmd\.php\?v=\d{8}&o=.* HTTP\/1\.0.*User\-Agent: Mozilla\/4\.0\ \(compatible\;\ Synapse\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059005; rev:1810;)

# Command&Control: (Trojan) Dloader - regex: to_server:GET \/.*?mac=[0-9A-F]{12}&ver=\d{8,10}(&makedate=.*&userID=.*&ComPut=.*&os=.*&ie=.*&key=.*)? HTTP/1\.1\r\nUser-Agent: GOOGLE\r\n detector_id: 59006
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Dloader"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"mac="; content:"&ver="; content:" HTTP/1.1|0D||0A|User-Agent|3A| GOOGLE|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*?mac=[0-9A-F]{12}&ver=\d{8,10}(&makedate=.*&userID=.*&ComPut=.*&os=.*&ie=.*&key=.*)? HTTP\/1\.1\r\nUser-Agent: GOOGLE\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059006; rev:1810;)

# Command&Control: (Trojan) EvilGif - regex: to_client:HTTP\/1\.1 200 OK.*\r\n\r\nGIF89a=.*;url=.*iframe.*https:\/\/%67%\"\+\"6f%6f%2e%\"\+\"67%6c\/\/(.*src=\\\'res:\/\/InvGuestIE\.dll\/icon\.png)?.*Image\(.*pcap.*chls.*saz.*security.*;tail= detector_id: 59063
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Trojan) EvilGif"; flow:established,to_client; content:"HTTP/1.1 200 OK"; content:"|0D||0A||0D||0A|GIF89a="; content:"|3B|url="; content:"iframe"; content:"https|3A|//|25|67|25||22||2B||22|6f|25|6f|25|2e|25||22||2B||22|67|25|6c//"; content:"Image|28|"; content:"pcap"; content:"chls"; content:"saz"; content:"security"; content:"|3B|tail="; pcre:"/HTTP\/1\.1 200 OK.*\r\n\r\nGIF89a=.*\;url=.*iframe.*https:\/\/%67%\"\+\"6f%6f%2e%\"\+\"67%6c\/\/(.*src=\\\'res:\/\/InvGuestIE\.dll\/icon\.png)?.*Image\(.*pcap.*chls.*saz.*security.*\;tail=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059063; rev:1834;)

# Command&Control: (Trojan) Gotango - regex: to_server:POST \/mailanonymous HTTP\/1\.1.*\r\n\r\ndata=.*&type=.*&arg=.*&beforeSend=.* detector_id: 59067
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Gotango"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/mailanonymous HTTP/1.1"; content:"|0D||0A||0D||0A|data="; content:"&type="; content:"&arg="; content:"&beforeSend="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mailanonymous HTTP\/1\.1.*\r\n\r\ndata=.*&type=.*&arg=.*&beforeSend=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059067; rev:1834;)

# Command&Control: (Ransomware) Gatak - regex: to_server:GET /report_[a-zA-Z]_\d+_[A-Z0-9\_\-]+_\d+_[a-zA-Z\_]+ HTTP detector_id: 59101
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) Gatak"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/report_"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/report_[a-zA-Z]_\d+_[A-Z0-9\_\-]+_\d+_[a-zA-Z\_]+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059101; rev:1843;)

# Adware: (PUP) Jelbrus - regex: to_server:POST \/api\/get\-config HTTP.*\r\n\r\nuser\_agent=.*&uuid=[0-9a-f\-]+&user\_os=.*&proc=.*&main=\d&v=\d+\.\d+&nuuid=[0-9a-f]{32}&user\_hash=[0-9a-f]{32,}&trsrc=\d&aff=.*&enc=.* detector_id: 59156
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUP) Jelbrus"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/api/get-config HTTP"; content:"|0D||0A||0D||0A|user_agent="; content:"&uuid="; content:"&user_os="; content:"&proc="; content:"&main="; content:"&v="; content:"&nuuid="; content:"&user_hash="; content:"&trsrc="; content:"&aff="; content:"&enc="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/get\-config HTTP.*\r\n\r\nuser\_agent=.*&uuid=[0-9a-f\-]+&user\_os=.*&proc=.*&main=\d&v=\d+\.\d+&nuuid=[0-9a-f]{32}&user\_hash=[0-9a-f]{32,}&trsrc=\d&aff=.*&enc=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059156; rev:1846;)

# Command&Control: (Worm) Locksky - regex: to_server:GET \/(report\.php\?hid=\d{8,10}&proc=.*\.exe HTTP\/1\.0|check\.php\?hid=\d{8,10}&cp=\d+&ver=\d+\.\d+ HTTP\/1\.1)\r\nHost: [^\r\n]+\r\n(\r\n\x00)? detector_id: 59165
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Locksky"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"|0D||0A|Host|3A| "; content:"|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(report\.php\?hid=\d{8,10}&proc=.*\.exe HTTP\/1\.0|check\.php\?hid=\d{8,10}&cp=\d+&ver=\d+\.\d+ HTTP\/1\.1)\r\nHost: [^\r\n]+\r\n(\r\n\x00)?/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059165; rev:1855;)

# Command&Control: (Worm) Locksky - regex: to_server:POST \/harvest\/harvest\.php HTTP\/1\.0\r\nContent\-Type: [^\r\n]+\r\nContent\-Length: \d+\r\nHost: [^\r\n]+\r\n\r\ndata=(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4}) detector_id: 59166
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Locksky"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/harvest/harvest.php HTTP/1.0|0D||0A|Content-Type|3A| "; content:"|0D||0A|Content-Length|3A| "; content:"|0D||0A|Host|3A| "; content:"|0D||0A||0D||0A|data="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/harvest\/harvest\.php HTTP\/1\.0\r\nContent\-Type: [^\r\n]+\r\nContent\-Length: \d+\r\nHost: [^\r\n]+\r\n\r\ndata=(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{4})/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059166; rev:1855;)

# Adware: (PUA) Bprotector - regex: to_server:GET \/\?s=[0-9a-f]{64}&v=\d+\.\d+\.\d+&u=[0-9a-f]{32}&dp=.*&i=[0-9A-F\-]+&tsa=\d&tst=\d&tdr=\d HTTP detector_id: 59186
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUA) Bprotector"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?s="; content:"&v="; content:"&u="; content:"&dp="; content:"&i="; content:"&tsa="; content:"&tst="; content:"&tdr="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?s=[0-9a-f]{64}&v=\d+\.\d+\.\d+&u=[0-9a-f]{32}&dp=.*&i=[0-9A-F\-]+&tsa=\d&tst=\d&tdr=\d HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059186; rev:1870;)

# Command&Control: (Trojan) Arcdoor - regex: to_server:POST \/unk\/connect\.php HTTP.*\r\n\r\npcname=.*&botver=\d+\.\d+&Country=[A-Z]+&winver=.*&hwid=[0-9a-f]{32} detector_id: 59187
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Arcdoor"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/unk/connect.php HTTP"; content:"|0D||0A||0D||0A|pcname="; content:"&botver="; content:"&Country="; content:"&winver="; content:"&hwid="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/unk\/connect\.php HTTP.*\r\n\r\npcname=.*&botver=\d+\.\d+&Country=[A-Z]+&winver=.*&hwid=[0-9a-f]{32}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059187; rev:1870;)

# Command&Control: (Trojan) Sfuzuan - regex: to_server:GET .*\/[0-9a-zA-Z\.]+\.(ini|zip) HTTP\/1\.1\r\nUser\-Agent: (IEDLL|MSDN Read) detector_id: 59188
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sfuzuan"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP/1.1|0D||0A|User-Agent|3A| "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/[0-9a-zA-Z\.]+\.(ini|zip) HTTP\/1\.1\r\nUser\-Agent: (IEDLL|MSDN Read)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059188; rev:1870;)

# Command&Control: (Trojan) RealtimeSpy - regex: to_server:GET \/[a-zA-Z\_]+\.php\?username=.*&password=[0-9a-f]+&id=\d+(&comp=.*)?(&user=.*)? HTTP.*UA\-CPU: (x86|x64) detector_id: 59189
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) RealtimeSpy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?username="; content:"&password="; content:"&id="; content:" HTTP"; content:"UA-CPU|3A| "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-zA-Z\_]+\.php\?username=.*&password=[0-9a-f]+&id=\d+(&comp=.*)?(&user=.*)? HTTP.*UA\-CPU: (x86|x64)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059189; rev:1870;)

# Command&Control: (Trojan) RealtimeSpy - regex: to_server:POST \/add\_rt\_log\.php HTTP.*\r\n\r\nraptor\_un=.*&raptor\_pw\_hash=[0-9a-f]+&logtype=\d&raptor\_account\_id=\d+&computer\_username=.*&computer\_name=.*&event\_title=.*&event\_target=.*&capture\_timestamp=.*&submit=.* detector_id: 59190
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) RealtimeSpy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/add_rt_log.php HTTP"; content:"|0D||0A||0D||0A|raptor_un="; content:"&raptor_pw_hash="; content:"&logtype="; content:"&raptor_account_id="; content:"&computer_username="; content:"&computer_name="; content:"&event_title="; content:"&event_target="; content:"&capture_timestamp="; content:"&submit="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/add\_rt\_log\.php HTTP.*\r\n\r\nraptor\_un=.*&raptor\_pw\_hash=[0-9a-f]+&logtype=\d&raptor\_account\_id=\d+&computer\_username=.*&computer\_name=.*&event\_title=.*&event\_target=.*&capture\_timestamp=.*&submit=.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059190; rev:1870;)

# Fake-av: (PUA) OneSystemCare - regex: to_server:GET .*\/[a-z]{1,8}\?sid=[0-9a-zA-Z]+.* HTTP\/1\.1\r\nUser\-Agent: (One System Care|BI\/0\.1)\r\nHost: [^\r\n]+\r\nCache\-Control: no-cache detector_id: 59191
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Fake-av: (PUA) OneSystemCare"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?sid="; content:" HTTP/1.1|0D||0A|User-Agent|3A| "; content:"|0D||0A|Host|3A| "; content:"|0D||0A|Cache-Control|3A| no-cache"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/[a-z]{1,8}\?sid=[0-9a-zA-Z]+.* HTTP\/1\.1\r\nUser\-Agent: (One System Care|BI\/0\.1)\r\nHost: [^\r\n]+\r\nCache\-Control: no-cache/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059191; rev:1870;)

# Command&Control: (Trojan) RealtimeSpy - regex: to_server:POST \/.*\.php HTTP.*\r\n\r\nraptor\_un=.*&raptor\_pw\_hash=[0-9a-f]+ detector_id: 59192
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) RealtimeSpy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP"; content:"|0D||0A||0D||0A|raptor_un="; content:"&raptor_pw_hash="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\.php HTTP.*\r\n\r\nraptor\_un=.*&raptor\_pw\_hash=[0-9a-f]+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059192; rev:1870;)

# Command&Control: (Trojan) RealtimeSpy - regex: to_server:GET \/[a-zA-Z\_]+\.php\?username=.*&password=[0-9a-f]+&id=\d+ HTTP.*UA\-CPU: (x86|x64) detector_id: 59193
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) RealtimeSpy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?username="; content:"&password="; content:"&id="; content:" HTTP"; content:"UA-CPU|3A| "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-zA-Z\_]+\.php\?username=.*&password=[0-9a-f]+&id=\d+ HTTP.*UA\-CPU: (x86|x64)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059193; rev:1870;)

# Adware: (PUA) PCKeeper - regex: to_server:GET \/.*\.php\?step=.* HTTP.*User-Agent: PCKInstaller \d+\.\d+\.\d+\.\d+ detector_id: 59194
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUA) PCKeeper"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?step="; content:" HTTP"; content:"User-Agent|3A| PCKInstaller "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\.php\?step=.* HTTP.*User-Agent: PCKInstaller \d+\.\d+\.\d+\.\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059194; rev:1870;)

# Adware: (Traffic Exchange Bot) Liuliangbao - regex: to_server:POST \/[0-9a-z]{1,3}\/[0-9a-z]{1,3}\/[0-9a-z]{1,3}\/ HTTP.*User\-Agent\: llb\/\d\.\d\.\d+\.\d+.*\r\n\r\nd=[0-9a-f]{100,} detector_id: 59195
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Traffic Exchange Bot) Liuliangbao"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ HTTP"; content:"User-Agent|3A| llb/"; content:"|0D||0A||0D||0A|d="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[0-9a-z]{1,3}\/[0-9a-z]{1,3}\/[0-9a-z]{1,3}\/ HTTP.*User\-Agent\: llb\/\d\.\d\.\d+\.\d+.*\r\n\r\nd=[0-9a-f]{100,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059195; rev:1870;)

# Command&Control: (Worm) Phorpiex - regex: to_server:GET \/[a-z]\/\d{4}.txt HTTP\/1\.1||to_client:HTTP\/1\.1 200 OK.*Content\-Type: text\/plain.*\r\n\r\n([^\r\n]+\.com\r\n){100,} detector_id: 59196
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Phorpiex (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"txt HTTP/1.1"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]\/\d{4}.txt HTTP\/1\.1/s"; flowbits:set,LL.59196_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105919600; rev:1870;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Worm) Phorpiex (1)"; flowbits:isset,LL.59196_0; flow:established,to_client; content:"HTTP/1.1 200 OK"; content:"Content-Type|3A| text/plain"; content:"|0D||0A||0D||0A|"; pcre:"/HTTP\/1\.1 200 OK.*Content\-Type: text\/plain.*\r\n\r\n([^\r\n]+\.com\r\n){100,}/s"; flowbits:unset,LL.59196_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105919601; rev:1870;)

# Adware (PUA) Iminent - regex: to_server:GET \/userStateBeacon\/\?appId=.* HTTP.*User\-Agent: HartBeatCall\r\n detector_id: 59226
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware (PUA) Iminent"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/userStateBeacon/?appId="; content:" HTTP"; content:"User-Agent|3A| HartBeatCall|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/userStateBeacon\/\?appId=.* HTTP.*User\-Agent: HartBeatCall\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059226; rev:1876;)

# Adware: (PUA) Iminent - regex: to_server:GET \/vz\/[0-9A-F\-]{32,36}\/\d{3}\/config\.json\d{5} HTTP.*User\-Agent: VersionDwl\r\n detector_id: 59227
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUA) Iminent"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/vz/"; content:"/config.json"; content:" HTTP"; content:"User-Agent|3A| VersionDwl|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/vz\/[0-9A-F\-]{32,36}\/\d{3}\/config\.json\d{5} HTTP.*User\-Agent: VersionDwl\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059227; rev:1876;)

# Adware: (PUA) Uniblue - regex: to_server:POST \/v1\/collect HTTP\/1\.1\r\nContent\-Type: application\/json.*User\-Agent: Mozilla\/\d\.0\ \(compatible\;\ Win32\;\ WinHttp\.WinHttpRequest\.\d\).*\{\"recipient\"\:\"uniblue\..{9,12}\.web\"\,\"client\_id\"\:\"\"\,\"event\"\:\"[^\"]+\"(\,\"buildtest\_id\"\:\"[0-9a-z\-]*\")?(\,\"unit\_id\"\:\"[0-9\-]*\")?\} detector_id: 59230
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUA) Uniblue"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/v1/collect HTTP/1.1|0D||0A|Content-Type|3A| application/json"; content:"User-Agent|3A| Mozilla/"; content:".0 |28|compatible|3B| Win32|3B| WinHttp.WinHttpRequest."; content:"|7B||22|recipient|22||3A||22|uniblue."; content:".web|22||2C||22|client_id|22||3A||22||22||2C||22|event|22||3A||22|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/v1\/collect HTTP\/1\.1\r\nContent\-Type: application\/json.*User\-Agent: Mozilla\/\d\.0\ \(compatible\;\ Win32\;\ WinHttp\.WinHttpRequest\.\d\).*\{\"recipient\"\:\"uniblue\..{9,12}\.web\"\,\"client\_id\"\:\"\"\,\"event\"\:\"[^\"]+\"(\,\"buildtest\_id\"\:\"[0-9a-z\-]*\")?(\,\"unit\_id\"\:\"[0-9\-]*\")?\}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059230; rev:1876;)

# Adware: (PUP) Multibar - regex: to_server:GET /\d+/\?act=.* HTTP/1\.0 detector_id: 59231
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUP) Multibar"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?act="; content:" HTTP/1.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d+\/\?act=.* HTTP\/1\.0/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059231; rev:1876;)

# Command&Control: (Trojan) TeslaCrypt - regex: to_server:GET \/.*\.php\?U3ViamVj(?:[A-Za-z0-9+/]{4}){50,}(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4}) HTTP.*User\-Agent: Mozilla\/4\.0 \(compatible\; MSIE 8\.0\; Windows NT 5\.1\; Trident\/4\.0\; \.NET CLR 2\.0\.50727\; \.NET CLR 3\.0\.4506\.2152\; \.NET CLR 3\.5\.30729\)\r\n detector_id: 59232
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) TeslaCrypt"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?U3ViamVj"; content:" HTTP"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| MSIE 8.0|3B| Windows NT 5.1|3B| Trident/4.0|3B| .NET CLR 2.0.50727|3B| .NET CLR 3.0.4506.2152|3B| .NET CLR 3.5.30729|29||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\.php\?U3ViamVj(?:[A-Za-z0-9+\/]{4}){50,}(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{4}) HTTP.*User\-Agent: Mozilla\/4\.0 \(compatible\; MSIE 8\.0\; Windows NT 5\.1\; Trident\/4\.0\; \.NET CLR 2\.0\.50727\; \.NET CLR 3\.0\.4506\.2152\; \.NET CLR 3\.5\.30729\)\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059232; rev:1879;)

# Command&Control: (Trojan) Skeeyah - regex: to_server:GET /.+\.txt HTTP.*User-Agent: Internet Explorer 6\.0.*||to_server:GET /.+\.php\?mac=[0-9-]+&os=.*&errorcode=\d detector_id: 59289
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Skeeyah (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".txt HTTP"; content:"User-Agent|3A| Internet Explorer 6.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.+\.txt HTTP.*User-Agent: Internet Explorer 6\.0.*/"; flowbits:set,LL.59289_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105928900; rev:1888;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Skeeyah (1)"; flowbits:isset,LL.59289_0; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?mac="; content:"&os="; content:"&errorcode="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.+\.php\?mac=[0-9-]+&os=.*&errorcode=\d/"; flowbits:unset,LL.59289_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105928901; rev:1888;)

# Adware: (Adware) Hebogo - regex: to_server:GET /(C|c)onfig/.*\.asp.* HTTP/1\.1\r\nAccept: image/[^,]+,.*User-Agent: Microsoft URL Control - 6\.01\.9782 detector_id: 59290
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Hebogo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"onfig/"; content:".asp"; content:" HTTP/1.1|0D||0A|Accept|3A| image/"; content:"User-Agent|3A| Microsoft URL Control - 6.01.9782"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(C|c)onfig\/.*\.asp.* HTTP\/1\.1\r\nAccept: image\/[^,]+,.*User-Agent: Microsoft URL Control - 6\.01\.9782/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059290; rev:1888;)

# Command&Control: (Trojan) Fakon - regex: to_server:GET .*\/GetTaskData\?mac=(\%[0-9A-F]{2})+&cpuid=(\%[0-9A-F]{2})+.* HTTP.*User\-Agent: Internet Explorer\r\n detector_id: 59291
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fakon"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/GetTaskData?mac="; content:"&cpuid="; content:" HTTP"; content:"User-Agent|3A| Internet Explorer|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/GetTaskData\?mac=(\%[0-9A-F]{2})+&cpuid=(\%[0-9A-F]{2})+.* HTTP.*User\-Agent: Internet Explorer\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059291; rev:1888;)

# Adware: (PUA) SBYinYing - regex: to_server:GET /setup/az_jg.php\?op=.*&ri=.*&vs=\d\.\d&mc=[0-9\-]{17}&tm=\d+&key=.* HTTP.*User\-Agent: Http\r\nHost: [^\r\n]+\r\n detector_id: 59292
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUA) SBYinYing"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/setup/az_jg"; content:"php?op="; content:"&ri="; content:"&vs="; content:"&mc="; content:"&tm="; content:"&key="; content:" HTTP"; content:"User-Agent|3A| Http|0D||0A|Host|3A| "; content:"|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/setup\/az_jg.php\?op=.*&ri=.*&vs=\d\.\d&mc=[0-9\-]{17}&tm=\d+&key=.* HTTP.*User\-Agent: Http\r\nHost: [^\r\n]+\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059292; rev:1888;)

# Command&Control: (Trojan) TeslaCrypt - regex: to_server:GET \/.*\.php\?[0-9A-F]{300,} HTTP||to_client:HTTP\/1\.1 200 OK.*\r\n\r\n.*\-\-\-\!\!\!INSERTED\!\!\!\-\-\- detector_id: 59293
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) TeslaCrypt (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\.php\?[0-9A-F]{300,} HTTP/s"; flowbits:set,LL.59293_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105929300; rev:1888;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Trojan) TeslaCrypt (1)"; flowbits:isset,LL.59293_0; flow:established,to_client; content:"HTTP/1.1 200 OK"; content:"|0D||0A||0D||0A|"; content:"---|21||21||21|INSERTED|21||21||21|---"; pcre:"/HTTP\/1\.1 200 OK.*\r\n\r\n.*\-\-\-\!\!\!INSERTED\!\!\!\-\-\-/s"; flowbits:unset,LL.59293_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105929301; rev:1888;)

# Adware: (PUA) LTV - regex: to_server:GET \/ltv\/install\/\?idapp=\d+&action=.* HTTP detector_id: 59310
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUA) LTV"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ltv/install/?idapp="; content:"&action="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ltv\/install\/\?idapp=\d+&action=.* HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059310; rev:1894;)

# Foo - regex: to_server:GET /yet_another_stupid_test\.xyz1 HTTP detector_id: 59334
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Foo"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/yet_another_stupid_test.xyz1 HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/yet_another_stupid_test\.xyz1 HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059334; rev:1913;)

# Command&Control: (Trojan) Plugx - regex: to_server:POST /[A-F0-9]{24} HTTP/1\.1\r\nAccept: \*/\*\r\n[A-Z0-9]+: 0\r\n[A-Z0-9]+: 0\r\n[A-Z0-9]+: 61456\r\n[A-Z0-9]+: 1 detector_id: 59365
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Plugx"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:" HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|"; content:"|3A| 0|0D||0A|"; content:"|3A| 0|0D||0A|"; content:"|3A| 61456|0D||0A|"; content:"|3A| 1"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[A-F0-9]{24} HTTP\/1\.1\r\nAccept: \*\/\*\r\n[A-Z0-9]+: 0\r\n[A-Z0-9]+: 0\r\n[A-Z0-9]+: 61456\r\n[A-Z0-9]+: 1/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059365; rev:1918;)

# Command&Control: (Trojan) Upatre - regex: to_server:GET /\d*[a-zA-Z_]+\d*/[a-zA-Z0-9-]+/\d+/[a-zA-Z0-9-]+/\d+/[a-zA-Z]* HTTP.*Host: [\d.]+\:\d+ detector_id: 59366
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Upatre"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP"; content:"Host|3A| "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d*[a-zA-Z_]+\d*\/[a-zA-Z0-9-]+\/\d+\/[a-zA-Z0-9-]+\/\d+\/[a-zA-Z]* HTTP.*Host: [\d.]+\:\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059366; rev:1995;)

# Command&Control: (Trojan) PlugX - regex: to_server:GET /[A-Z0-9]{24} HTTP/1\.1\r\nAccept: \*/\*\r\n(Cookie|AppleId): ([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})\r\n detector_id: 59367
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) PlugX"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|"; content:"|3A| "; content:"|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[A-Z0-9]{24} HTTP\/1\.1\r\nAccept: \*\/\*\r\n(Cookie|AppleId): ([A-Za-z0-9+\/]{4})*([A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{4})\r\n/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059367; rev:1918;)

# Command&Control: (Ransomware) TeslaCrypt - regex: to_client:HTTP\/1\.1 200 OK.*\r\n\r\n.*\-\-\-\!\!\![a-zA-Z]{1,10}\!\!\!\-\-\- detector_id: 59368
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Ransomware) TeslaCrypt"; flow:established,to_client; content:"HTTP/1.1 200 OK"; content:"|0D||0A||0D||0A|"; content:"---|21||21||21|"; content:"|21||21||21|---"; pcre:"/HTTP\/1\.1 200 OK.*\r\n\r\n.*\-\-\-\!\!\![a-zA-Z]{1,10}\!\!\!\-\-\-/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059368; rev:1918;)

# Test - regex: to_server:POST \/ HTTP.*User-Agent: Mozilla\/5\.0\ \(TESTFOOBARBABABABARBA.* detector_id: 59369
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Test"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ HTTP"; content:"User-Agent|3A| Mozilla/5.0 |28|TESTFOOBARBABABABARBA"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ HTTP.*User-Agent: Mozilla\/5\.0\ \(TESTFOOBARBABABABARBA.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059369; rev:1921;)

# Drive-by: (Exploit Toolkit) Magnitude EOT - regex: to_server:GET .*\/include\/[a-f0-9]{32}\.eot HTTP||to_client:HTTP\/.*\r\n\r\nPK detector_id: 59371
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: (Exploit Toolkit) Magnitude EOT (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/include/"; content:".eot HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/include\/[a-f0-9]{32}\.eot HTTP/s"; flowbits:set,LL.59371_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105937100; rev:1921;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Exploit Toolkit) Magnitude EOT (1)"; flowbits:isset,LL.59371_0; flow:established,to_client; content:"HTTP/"; content:"|0D||0A||0D||0A|PK"; pcre:"/HTTP\/.*\r\n\r\nPK/s"; flowbits:unset,LL.59371_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105937101; rev:1921;)

# another test - regex: to_server:POST \/another_stupid_test\/xyz HTTP||to_client:HTTP cicicicic||to_server:GET foooooo detector_id: 59373
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS another test (0) (no alert)"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/another_stupid_test/xyz HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/another_stupid_test\/xyz HTTP/"; flowbits:set,LL.59373_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105937300; rev:1921;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS another test (1) (no alert)"; flowbits:isset,LL.59373_0; flow:established,to_client; content:"HTTP cicicicic"; flowbits:unset,LL.59373_0; flowbits:set,LL.59373_1; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105937301; rev:1921;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS another test (2)"; flowbits:isset,LL.59373_1; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"foooooo"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?foooooo/"; flowbits:unset,LL.59373_1; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105937302; rev:1921;)

# Adware: (PUP) BrowseFox - regex: to_server:POST /[a-z]h HTTP.*User-Agent: (winhttp|NSIS_Inetc \(Mozilla\))\r\n.*qs=.+ detector_id: 59414
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUP) BrowseFox"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"h HTTP"; content:"User-Agent|3A| "; content:"|0D||0A|"; content:"qs="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]h HTTP.*User-Agent: (winhttp|NSIS_Inetc \(Mozilla\))\r\n.*qs=.+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059414; rev:1924;)

# Command&Control: (Trojan) Bafruz - regex: to_server:GET /l_rezerv/l\d\.php\?serial=\d{12,13}&ver=[\d.]+ HTTP detector_id: 59415
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bafruz"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/l_rezerv/l"; content:".php?serial="; content:"&ver="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/l_rezerv\/l\d\.php\?serial=\d{12,13}&ver=[\d.]+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059415; rev:1924;)

# Command&Control: (Trojan) Bafruz - regex: to_server:GET /distrib_serv/ip_list(_\d)?\.php HTTP detector_id: 59416
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bafruz"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/distrib_serv/ip_list"; content:".php HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/distrib_serv\/ip_list(_\d)?\.php HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059416; rev:1924;)

# Adware: (Downware) Vittalia - regex: to_server:GET \/installer\_stats\/\?action\_id=\d+&action\_description=.*&channel\_id=\d+.*&user\_antivirus=.* HTTP.*User-Agent: NSIS\_ToolkitOffers\ \(Mozilla\)\r\n detector_id: 59417
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Vittalia"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/installer_stats/?action_id="; content:"&action_description="; content:"&channel_id="; content:"&user_antivirus="; content:" HTTP"; content:"User-Agent|3A| NSIS_ToolkitOffers |28|Mozilla|29||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/installer\_stats\/\?action\_id=\d+&action\_description=.*&channel\_id=\d+.*&user\_antivirus=.* HTTP.*User-Agent: NSIS\_ToolkitOffers\ \(Mozilla\)\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059417; rev:1924;)

# Adware: (Toolbar) Conduit - regex: to_server:POST .*\.ashx HTTP.*\r\n\r\n\<OFFER\_REQUEST\>||to_client:HTTP\/1\.1 200 OK.*\r\n\r\n.{,3}\<OFFER\_RESPONSE\> detector_id: 59418
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Conduit (0) (no alert)"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".ashx HTTP"; content:"|0D||0A||0D||0A|<OFFER_REQUEST>"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.ashx HTTP.*\r\n\r\n\<OFFER\_REQUEST\>/s"; flowbits:set,LL.59418_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105941800; rev:1924;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Adware: (Toolbar) Conduit (1)"; flowbits:isset,LL.59418_0; flow:established,to_client; content:"HTTP/1.1 200 OK"; content:"|0D||0A||0D||0A|"; content:"<OFFER_RESPONSE>"; pcre:"/HTTP\/1\.1 200 OK.*\r\n\r\n.{,3}\<OFFER\_RESPONSE\>/s"; flowbits:unset,LL.59418_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105941801; rev:1924;)

# Adware: (PUA) SaferBrowser - regex: to_server:GET \/installer\?action=.*&installer\_unicode=(true|false)&product\_id=\d+&product\_name=.*&product\_version=[0-9\.]+&product\_keyword=.*&product\_brand=.* HTTP detector_id: 59419
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUA) SaferBrowser"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/installer?action="; content:"&installer_unicode="; content:"&product_id="; content:"&product_name="; content:"&product_version="; content:"&product_keyword="; content:"&product_brand="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/installer\?action=.*&installer\_unicode=(true|false)&product\_id=\d+&product\_name=.*&product\_version=[0-9\.]+&product\_keyword=.*&product\_brand=.* HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059419; rev:1924;)

# Command&Control: (Trojan) Foosace - regex: to_server:POST /.*\.[a-z]{3,4}/\?[A-Za-z0-9]+=(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4}) HTTP/1\.1\r\nContent-Type: [^\r]+\r\nUser-Agent: [^\r]+\r\nHost: [^\r]+\r\nContent-Length: [^\r]+\r\nCache-Control: no-cache\r\n\r\n detector_id: 59517
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Foosace"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/?"; content:" HTTP/1.1|0D||0A|Content-Type|3A| "; content:"|0D||0A|User-Agent|3A| "; content:"|0D||0A|Host|3A| "; content:"|0D||0A|Content-Length|3A| "; content:"|0D||0A|Cache-Control|3A| no-cache|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\.[a-z]{3,4}\/\?[A-Za-z0-9]+=(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{4}) HTTP\/1\.1\r\nContent-Type: [^\r]+\r\nUser-Agent: [^\r]+\r\nHost: [^\r]+\r\nContent-Length: [^\r]+\r\nCache-Control: no-cache\r\n\r\n/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059517; rev:1956;)

# Command&Control: (Trojan-Downloader) CVE-2015-0097 - regex: to_server:GET /(?:\d/)?recordset\.txt HTTP/1\.1\r\nAccept: \*/\*\r\nAccept-Encoding: gzip, deflate\r\n.*Connection: Keep-Alive\r\n\r\n detector_id: 59518
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan-Downloader) CVE-2015-0097"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"recordset.txt HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|Accept-Encoding|3A| gzip|2C| deflate|0D||0A|"; content:"Connection|3A| Keep-Alive|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(?:\d\/)?recordset\.txt HTTP\/1\.1\r\nAccept: \*\/\*\r\nAccept-Encoding: gzip, deflate\r\n.*Connection: Keep-Alive\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059518; rev:1956;)

# Adware: (Downware) Softcnapp - regex: to_server:GET /[\d/]+\.html HTTP/1\.0\r\n.*\r\nUser-Agent: NSISDL/1\.2 \(Mozilla\)\r\nAccept: \*/\*\r\n detector_id: 59519
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Softcnapp"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".html HTTP/1.0|0D||0A|"; content:"|0D||0A|User-Agent|3A| NSISDL/1.2 |28|Mozilla|29||0D||0A|Accept|3A| |2A|/|2A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[\d\/]+\.html HTTP\/1\.0\r\n.*\r\nUser-Agent: NSISDL\/1\.2 \(Mozilla\)\r\nAccept: \*\/\*\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059519; rev:1956;)

# Malware distribution: (PE EXE Download) Malspam JS Downloader - regex: to_server:GET \/document.php\?rnd=\d+&id=[0-9A-F]{32,} HTTP detector_id: 59563
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Malware distribution: (PE EXE Download) Malspam JS Downloader"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/document"; content:"php?rnd="; content:"&id="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/document.php\?rnd=\d+&id=[0-9A-F]{32,} HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059563; rev:1998;)

# Command&Control: (Backdoor) PoisonIvy RAT - regex: to_server:GET /\d\.php\?id=[a-f0-9]{17}.*&id=[\d\.]{7,15}&id=.*&id=\d\.\d detector_id: 59630
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) PoisonIvy RAT"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?id="; content:"&id="; content:"&id="; content:"&id="; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d\.php\?id=[a-f0-9]{17}.*&id=[\d\.]{7,15}&id=.*&id=\d\.\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059630; rev:2019;)

# Command&Control: (Backdoor) PoisonIvy - regex: to_server:GET \/\d\.php\?id=[^:\/\n\r]+?(&id=[^:\/\n\r]+?)+?(&id=){0,2} HTTP.*User-Agent: Mozilla\/4\.0.*Cache-Control: no-cache\r\n detector_id: 59631
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) PoisonIvy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?id="; content:" HTTP"; content:"User-Agent|3A| Mozilla/4.0"; content:"Cache-Control|3A| no-cache|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d\.php\?id=[^:\/\n\r]+?(&id=[^:\/\n\r]+?)+?(&id=){0,2} HTTP.*User-Agent: Mozilla\/4\.0.*Cache-Control: no-cache\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059631; rev:2019;)

# Command&Control: (Backdoor) PoisonIvy - regex: to_server:GET /ver .*User-Agent: PoisonIvy detector_id: 59632
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) PoisonIvy"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ver "; content:"User-Agent|3A| PoisonIvy"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ver .*User-Agent: PoisonIvy/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059632; rev:2019;)

# Command&Control: (Backdoor) PoisonIvy - regex: to_server:POST \/main\.php HTTP.*User-Agent: AutoIt.*\r\n\r\ncmd=[a-zA-Z]+&id=\d+&Data=\d+ detector_id: 59634
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) PoisonIvy"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/main.php HTTP"; content:"User-Agent|3A| AutoIt"; content:"|0D||0A||0D||0A|cmd="; content:"&id="; content:"&Data="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/main\.php HTTP.*User-Agent: AutoIt.*\r\n\r\ncmd=[a-zA-Z]+&id=\d+&Data=\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059634; rev:2019;)

# Adware: (PUA) Gertokr - regex: to_server:GET \/productSystem\/api\/[report|custom\_report|product|affiliates|activity][^\r\n]* HTTP detector_id: 59716
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUA) Gertokr"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/productSystem/api/"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/productSystem\/api\/[report|custom\_report|product|affiliates|activity][^\r\n]* HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059716; rev:2040;)

# Command&Control: (Trojan) Skeeyah - regex: to_server:POST /Zero/main\.php\?cmd=[a-z]+&key=\d+ HTTP.+\r\n.*Expect: 100-continue.*\r\nConnection: Keep-Alive\r\n\r\nID=[a-z0-9-]+&Data= detector_id: 59717
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Skeeyah"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/Zero/main.php?cmd="; content:"&key="; content:" HTTP"; content:"|0D||0A|"; content:"Expect|3A| 100-continue"; content:"|0D||0A|Connection|3A| Keep-Alive|0D||0A||0D||0A|ID="; content:"&Data="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Zero\/main\.php\?cmd=[a-z]+&key=\d+ HTTP.+\r\n.*Expect: 100-continue.*\r\nConnection: Keep-Alive\r\n\r\nID=[a-z0-9-]+&Data=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059717; rev:2043;)

# Fake-av: (Trojan) FakeSpyPro - regex: to_server:GET \/[0-9a-z\.]{,12}\?(r=[0-9\.]+&)?pgid=\d+ HTTP.*User-Agent: Microsoft\ Internet\ Explorer detector_id: 59718
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Fake-av: (Trojan) FakeSpyPro"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"pgid="; content:" HTTP"; content:"User-Agent|3A| Microsoft Internet Explorer"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[0-9a-z\.]{,12}\?(r=[0-9\.]+&)?pgid=\d+ HTTP.*User-Agent: Microsoft\ Internet\ Explorer/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059718; rev:2043;)

# Adware: (PUA) RapidMediaConverter - regex: to_server:GET \/config\?brandid=\d+&uid=[0-9a-f]{64}&os=(\d+\.)+\d+&clientver=(\d+\.)+\d+.* HTTP detector_id: 59719
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUA) RapidMediaConverter"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/config?brandid="; content:"&uid="; content:"&os="; content:"&clientver="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/config\?brandid=\d+&uid=[0-9a-f]{64}&os=(\d+\.)+\d+&clientver=(\d+\.)+\d+.* HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059719; rev:2043;)

# Command&Control: (Trojan Downloader) Ymeta - regex: to_server:GET \/pz.txt HTTP\/1\.1\r\nUser-Agent: vc\r\n detector_id: 59781
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan Downloader) Ymeta"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/pz"; content:"txt HTTP/1.1|0D||0A|User-Agent|3A| vc|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/pz.txt HTTP\/1\.1\r\nUser-Agent: vc\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059781; rev:2048;)

# Command&Control: (Downloader) Bregent - regex: to_server:GET /\?s=.*&v=.*&u=.*&ts=.* HTTP[^\r\n]+\r\nHost: [^\r\n]+\r\nCache-Control: [^\r\n]+\r\n\r\n detector_id: 59809
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Downloader) Bregent"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?s="; content:"&v="; content:"&u="; content:"&ts="; content:" HTTP"; content:"|0D||0A|Host|3A| "; content:"|0D||0A|Cache-Control|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?s=.*&v=.*&u=.*&ts=.* HTTP[^\r\n]+\r\nHost: [^\r\n]+\r\nCache-Control: [^\r\n]+\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059809; rev:2055;)

# Drive-by: (Landing URI Struct) Angler ek - regex: to_server:GET \/(forums?|boards?|civis)\/index\.php\?PHPSESSID=[^&]{1,10}&action=.*& HTTP(?=.*Host: (?!www\.)(?!(\d{1,3}\.){3}\d{1,3})[^\.\r\n]+(?:\.[^\.\r\n]+){2,})(?!.*Cookie: ) detector_id: 59912
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: (Landing URI Struct) Angler ek"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?PHPSESSID="; content:"&action="; content:"& HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(forums?|boards?|civis)\/index\.php\?PHPSESSID=[^&]{1,10}&action=.*& HTTP(?=.*Host: (?!www\.)(?!(\d{1,3}\.){3}\d{1,3})[^\.\r\n]+(?:\.[^\.\r\n]+){2,})(?!.*Cookie: )/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059912; rev:2082;)

# Drive-by: (Landing Page) Angler ek - regex: to_client:HTTP\/1\.1 200 OK.*__EVENTVALIDATION.{1,100}\/vjxl9SJ\+9Vp8uKxhh detector_id: 59913
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Landing Page) Angler ek"; flow:established,to_client; content:"HTTP/1.1 200 OK"; content:"__EVENTVALIDATION"; content:"/vjxl9SJ|2B|9Vp8uKxhh"; pcre:"/HTTP\/1\.1 200 OK.*__EVENTVALIDATION.{1,100}\/vjxl9SJ\+9Vp8uKxhh/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059913; rev:2082;)

# Drive-by: (Payload URI Struct) Angler ek - regex: to_server:GET (?:[\/&\?](?:one|two|three|four|five|six|seven|eight|nine|ten)[=\.][a-zA-Z\d&=]*){3,}.* HTTP\/1\.1\r\nConnection: Keep\-Alive\r\nHost: (?!www\.)(?!(?:\d{1,3}\.){3}\d{1,3})[^\.\r\n]+(?:\.[^\.\r\n]+){2}\r\n detector_id: 59936
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: (Payload URI Struct) Angler ek"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP/1.1|0D||0A|Connection|3A| Keep-Alive|0D||0A|Host|3A| "; content:"|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(?:[\/&\?](?:one|two|three|four|five|six|seven|eight|nine|ten)[=\.][a-zA-Z\d&=]*){3,}.* HTTP\/1\.1\r\nConnection: Keep\-Alive\r\nHost: (?!www\.)(?!(?:\d{1,3}\.){3}\d{1,3})[^\.\r\n]+(?:\.[^\.\r\n]+){2}\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059936; rev:2088;)

# Drive-by: (Landing URI Struct) Angler ek - regex: to_client:HTTP\/1\.1 200 OK.*Content-Length: \d{5,}.*\r\n\r\n.*<title>.*UN Start.*<\/title>.*__EVENTVALIDATION detector_id: 59938
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Landing URI Struct) Angler ek"; flow:established,to_client; content:"HTTP/1.1 200 OK"; content:"Content-Length|3A| "; content:"|0D||0A||0D||0A|"; content:"<title>"; content:"UN Start"; content:"</title>"; content:"__EVENTVALIDATION"; pcre:"/HTTP\/1\.1 200 OK.*Content-Length: \d{5,}.*\r\n\r\n.*<title>.*UN Start.*<\/title>.*__EVENTVALIDATION/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059938; rev:2088;)

# Adware: (Toolbar) Conduit - regex: to_server:GET /spinstallersettings/.* HTTP[^\r\n]+\r\nUser-Agent: NSIS_Inetc \(Mozilla\)\r\nHost: [^\r\n]+\r\nConnection: Keep-Alive\r\nCache-Control: no-cache\r\n detector_id: 59939
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Conduit"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/spinstallersettings/"; content:" HTTP"; content:"|0D||0A|User-Agent|3A| NSIS_Inetc |28|Mozilla|29||0D||0A|Host|3A| "; content:"|0D||0A|Connection|3A| Keep-Alive|0D||0A|Cache-Control|3A| no-cache|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/spinstallersettings\/.* HTTP[^\r\n]+\r\nUser-Agent: NSIS_Inetc \(Mozilla\)\r\nHost: [^\r\n]+\r\nConnection: Keep-Alive\r\nCache-Control: no-cache\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059939; rev:2088;)

# Adware: (Toolbar) Conduit - regex: to_server:GET /Properties/JSON/.* HTTP[^\r\n]+\r\nAccept: \*/\*\r\n detector_id: 59940
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Conduit"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/Properties/JSON/"; content:" HTTP"; content:"|0D||0A|Accept|3A| |2A|/|2A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/Properties\/JSON\/.* HTTP[^\r\n]+\r\nAccept: \*\/\*\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059940; rev:2088;)

# Drive-by: (Landing URI Struct) Angler ek - regex: to_client:HTTP\/1\.1 200 OK.*Content-Length: \d{5,}.*<title>.*UN Start.*<\/title>.*__EVENTVALIDATION detector_id: 59941
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Landing URI Struct) Angler ek"; flow:established,to_client; content:"HTTP/1.1 200 OK"; content:"Content-Length|3A| "; content:"<title>"; content:"UN Start"; content:"</title>"; content:"__EVENTVALIDATION"; pcre:"/HTTP\/1\.1 200 OK.*Content-Length: \d{5,}.*<title>.*UN Start.*<\/title>.*__EVENTVALIDATION/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059941; rev:2088;)

# Command&Control: (Trojan) Dunsenr.B - regex: to_server:GET /pop\?v=\d+&type=\d+&id=\d+&t=\d+ HTTP[^\r\n]+\r\nUser-Agent: [^\r\n]+\r\nHost:[^\r\n]+\r\n\r\n detector_id: 59981
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Dunsenr.B"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/pop?v="; content:"&type="; content:"&id="; content:"&t="; content:" HTTP"; content:"|0D||0A|User-Agent|3A| "; content:"|0D||0A|Host|3A|"; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/pop\?v=\d+&type=\d+&id=\d+&t=\d+ HTTP[^\r\n]+\r\nUser-Agent: [^\r\n]+\r\nHost:[^\r\n]+\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059981; rev:2097;)

# Drive-by: (Landing) Magnitude ek - regex: to_client:HTTP\/1\.1 200 OK.*<param name="movie" value="http:\/\/(?:([\.g-z]*[a-f0-9][\.g-z]*){32}\.)[^"'\/\s]+\/.+?src["']?\s*[=,]\s*["']http:\/\/(?:[\.g-z]*[a-f0-9][\.g-z]*){32}\.[^"'\/\s]+\/ detector_id: 60034
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Landing) Magnitude ek"; flow:established,to_client; content:"HTTP/1.1 200 OK"; content:"<param name=|22|movie|22| value=|22|http|3A|//"; content:"src"; content:"http|3A|//"; pcre:"/HTTP\/1\.1 200 OK.*<param name="movie" value="http:\/\/(?:([\.g-z]*[a-f0-9][\.g-z]*){32}\.)[^"'\/\s]+\/.+?src["']?\s*[=,]\s*["']http:\/\/(?:[\.g-z]*[a-f0-9][\.g-z]*){32}\.[^"'\/\s]+\//s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060034; rev:2121;)

# Command&Control: (Trojan) Plugx - regex: to_server:POST /update\?id=[0-9a-f]{8} HTTP/1\.1\r\nAccept: \*/\*\r\n[A-Za-z0-9-]+: 0\r\n[A-Za-z0-9-]+: 0\r\n[A-Za-z0-9-]+: 61456\r\n[A-Za-z0-9-]+: 1 detector_id: 60090
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Plugx"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/update?id="; content:" HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|"; content:"|3A| 0|0D||0A|"; content:"|3A| 0|0D||0A|"; content:"|3A| 61456|0D||0A|"; content:"|3A| 1"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/update\?id=[0-9a-f]{8} HTTP\/1\.1\r\nAccept: \*\/\*\r\n[A-Za-z0-9-]+: 0\r\n[A-Za-z0-9-]+: 0\r\n[A-Za-z0-9-]+: 61456\r\n[A-Za-z0-9-]+: 1/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060090; rev:2133;)

# Command&Control: (Trojan) PlugX - regex: to_server:POST .* HTTP/1\.1\r\nAccept: \*/\*\r\n[A-Za-z0-9-]+: 0\r\n[A-Za-z0-9-]+: 0\r\n[A-Za-z0-9-]+: 61456\r\n[A-Za-z0-9-]+: 1 detector_id: 60091
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) PlugX"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:" HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|"; content:"|3A| 0|0D||0A|"; content:"|3A| 0|0D||0A|"; content:"|3A| 61456|0D||0A|"; content:"|3A| 1"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.* HTTP\/1\.1\r\nAccept: \*\/\*\r\n[A-Za-z0-9-]+: 0\r\n[A-Za-z0-9-]+: 0\r\n[A-Za-z0-9-]+: 61456\r\n[A-Za-z0-9-]+: 1/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060091; rev:2133;)

# Drive-by: (Landing URI Struct) Angler ek - regex: to_server:GET (?:\/(forums?|boards?|civis))?\/search\.php\?keywords=[a-z\d]+&fid\d=[a-z\d]+\.[a-z\d]+& HTTP(?=.*Host: (?!www\.)(?!(\d{1,3}\.){3}\d{1,3})[a-z\d\-]+(?:\.[a-z\d\-]+){2}(:\d{1,5})?\r\n)(?!.*Cookie: ) detector_id: 60127
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: (Landing URI Struct) Angler ek"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/search.php?keywords="; content:"&fid"; content:"& HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(?:\/(forums?|boards?|civis))?\/search\.php\?keywords=[a-z\d]+&fid\d=[a-z\d]+\.[a-z\d]+& HTTP(?=.*Host: (?!www\.)(?!(\d{1,3}\.){3}\d{1,3})[a-z\d\-]+(?:\.[a-z\d\-]+){2}(:\d{1,5})?\r\n)(?!.*Cookie: )/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060127; rev:2141;)

# Drive-by: (Landing URI Struct) Angler ek - regex: to_server:GET \/search\?q=[a-zA-Z\d\-\_]+(&[a-zA-Z\d\-\_]{1,5}=[a-zA-Z\d\-\_]*){3,} HTTP(?=.*Host: (?!www\.)(?!(\d{1,3}\.){3}\d{1,3})[a-z\d\-]+(?:\.[a-z\d\-]+){2}(:\d{1,5})?\r\n)(?!.*Cookie: ) detector_id: 60128
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: (Landing URI Struct) Angler ek"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/search?q="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/search\?q=[a-zA-Z\d\-\_]+(&[a-zA-Z\d\-\_]{1,5}=[a-zA-Z\d\-\_]*){3,} HTTP(?=.*Host: (?!www\.)(?!(\d{1,3}\.){3}\d{1,3})[a-z\d\-]+(?:\.[a-z\d\-]+){2}(:\d{1,5})?\r\n)(?!.*Cookie: )/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060128; rev:2141;)

# Drive-by: (IE Exploit) Angler ek - regex: to_server:POST .* HTTP(?=.*Content\-Type: application\/json)(?=.*Host: (?!www\.)(?!(\d{1,3}\.){3}\d{1,3})[a-z\d\-]+(?:\.[a-z\d\-]+){2}(:\d{1,5})?)(?!.*Cookie: ).*\{"g":"[a-f\d]{31,32}","A":"[a-f\d]{31,32}","p":"[a-f\d]{31,32}","v":"\d{1,5}"\} detector_id: 60132
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: (IE Exploit) Angler ek"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:" HTTP"; content:"|7B||22|g|22||3A||22|"; content:"|22||2C||22|A|22||3A||22|"; content:"|22||2C||22|p|22||3A||22|"; content:"|22||2C||22|v|22||3A||22|"; content:"|22||7D|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.* HTTP(?=.*Content\-Type: application\/json)(?=.*Host: (?!www\.)(?!(\d{1,3}\.){3}\d{1,3})[a-z\d\-]+(?:\.[a-z\d\-]+){2}(:\d{1,5})?)(?!.*Cookie: ).*\{"g":"[a-f\d]{31,32}","A":"[a-f\d]{31,32}","p":"[a-f\d]{31,32}","v":"\d{1,5}"\}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060132; rev:2141;)

# Drive-by: (Landing) Magnitude ek - regex: to_client:HTTP\/1\.1 200 OK.*<html>\r\n<body>\r\n<div id=\"[a-z0-9]{4,5}\">(?:\d{2,3}\*){50} detector_id: 60133
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Landing) Magnitude ek"; flow:established,to_client; content:"HTTP/1.1 200 OK"; content:"<html>|0D||0A|<body>|0D||0A|<div id=|22|"; content:"|22|>"; pcre:"/HTTP\/1\.1 200 OK.*<html>\r\n<body>\r\n<div id=\"[a-z0-9]{4,5}\">(?:\d{2,3}\*){50}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060133; rev:2141;)

# Drive-by: (Landing) Magnitude ek - regex: to_client:HTTP\/1\.1 200 OK.*<param name=\"movie\" value=\"http:\/\/(?:\.*[a-f0-9]\.*){32}\.[^\"\'\/\s]+\/\??[a-f0-9]{32}(?:\/[a-f0-9]{32})?\/?[\"\'] detector_id: 60134
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Landing) Magnitude ek"; flow:established,to_client; content:"HTTP/1.1 200 OK"; content:"<param name=|22|movie|22| value=|22|http|3A|//"; pcre:"/HTTP\/1\.1 200 OK.*<param name=\"movie\" value=\"http:\/\/(?:\.*[a-f0-9]\.*){32}\.[^\"\'\/\s]+\/\??[a-f0-9]{32}(?:\/[a-f0-9]{32})?\/?[\"\']/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060134; rev:2141;)

# Drive-by: (Silverlight Exploit) Magnitude ek - regex: to_server:GET .*\.xap HTTP(?=.*Host: (?:[g-z\.]*[a-f0-9][g-z\.]*){32}\.)(?!.*Referer:) detector_id: 60135
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: (Silverlight Exploit) Magnitude ek"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".xap HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.xap HTTP(?=.*Host: (?:[g-z\.]*[a-f0-9][g-z\.]*){32}\.)(?!.*Referer:)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060135; rev:2141;)

# Drive-by: (Silverlight Exploit) Magnitude ek - regex: to_client:HTTP\/1\.1 200 OK.*/r/n/r/nPK.*AppManifest.xaml.*\x00esilver.dll detector_id: 60136
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Silverlight Exploit) Magnitude ek"; flow:established,to_client; content:"HTTP/1.1 200 OK"; content:"/r/n/r/nPK"; content:"AppManifest"; content:"xaml"; content:"|00|esilver"; content:"dll"; pcre:"/HTTP\/1\.1 200 OK.*\/r\/n\/r\/nPK.*AppManifest.xaml.*\x00esilver.dll/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060136; rev:2141;)

# Drive-by: (Possible Exploit Payload) Magnitude ek - regex: to_server:HEAD \/\??[a-f0-9]{32}(?:\/[a-f0-9]{32})?\/? HTTP(?=.*User\-Agent: contype\r\n)(?=.*Host: (?:\.*[a-f0-9]\.*){32}\.)(?!.*Referer:) detector_id: 60137
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: (Possible Exploit Payload) Magnitude ek"; flow:established,to_server; content:"HEAD"; nocase; http_method; content:"HEAD "; content:" HTTP"; pcre:"/HEAD (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\??[a-f0-9]{32}(?:\/[a-f0-9]{32})?\/? HTTP(?=.*User\-Agent: contype\r\n)(?=.*Host: (?:\.*[a-f0-9]\.*){32}\.)(?!.*Referer:)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060137; rev:2141;)

# Drive-by: (Malicious Referer) Redirection to exploit url - regex: to_server:GET .* HTTP.*Referer: [^\r\n]+rowedmedia\.com\/search\.php detector_id: 60138
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: (Malicious Referer) Redirection to exploit url"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP"; content:"Referer|3A| "; content:"rowedmedia.com/search.php"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.* HTTP.*Referer: [^\r\n]+rowedmedia\.com\/search\.php/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060138; rev:2141;)

# Adware: (Downware) Peapoon - regex: to_server:GET /install\?uid=[a-z0-9]+&aid=\d+&z=\d+&success=\d+&fwrite=\d+ HTTP.*User-Agent: Update\r\n detector_id: 60139
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) Peapoon"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/install?uid="; content:"&aid="; content:"&z="; content:"&success="; content:"&fwrite="; content:" HTTP"; content:"User-Agent|3A| Update|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/install\?uid=[a-z0-9]+&aid=\d+&z=\d+&success=\d+&fwrite=\d+ HTTP.*User-Agent: Update\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060139; rev:2141;)

# Command&Control: (Trojan) Carbanak - regex: to_server:POST [^\r]{100,} HTTP.*Content-Disposition: form-data; name="upload"; filename="listprocess\.txt" detector_id: 60140
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Carbanak"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:" HTTP"; content:"Content-Disposition|3A| form-data|3B| name=|22|upload|22||3B| filename=|22|listprocess.txt|22|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?[^\r]{100,} HTTP.*Content-Disposition: form-data\; name="upload"\; filename="listprocess\.txt"/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060140; rev:2141;)

# Adware: (PUP) Software Updater - regex: to_server:GET /get/.*\?.*uid=[a-z0-9-]+(&.+)* HTTP/1\.\d\r\nUser-Agent: SoftwareUpdater detector_id: 60160
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUP) Software Updater"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/get/"; content:"uid="; content:" HTTP/1."; content:"|0D||0A|User-Agent|3A| SoftwareUpdater"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/get\/.*\?.*uid=[a-z0-9-]+(&.+)* HTTP\/1\.\d\r\nUser-Agent: SoftwareUpdater/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060160; rev:2162;)

# Command&Control: (Dropper) FakeMS - regex: to_server:GET \/stat\.php\?message=cnVu&id\_partner=Y2hhbmc\= HTTP detector_id: 60161
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) FakeMS"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/stat.php?message=cnVu&id_partner=Y2hhbmc= HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/stat\.php\?message=cnVu&id\_partner=Y2hhbmc\= HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060161; rev:2162;)

# Command&Control: (Trojan) Ymeta - regex: to_server:POST \/[^\r]+\.as[hp]x HTTP/1\.0.*User-Agent: Mozilla\/3\.0\ \(compatible\;\ Indy\ Library\)\r\n\r\ncontent=[A-F0-9]+ detector_id: 60162
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ymeta"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".as"; content:"x HTTP/1.0"; content:"User-Agent|3A| Mozilla/3.0 |28|compatible|3B| Indy Library|29||0D||0A||0D||0A|content="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[^\r]+\.as[hp]x HTTP\/1\.0.*User-Agent: Mozilla\/3\.0\ \(compatible\;\ Indy\ Library\)\r\n\r\ncontent=[A-F0-9]+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060162; rev:2162;)

# Command&Control: (Trojan) Nusbn.a - regex: to_server:GET \/\?api=giveFileDL&files=[a-z\.0-9]+ HTTP.*User-Agent: WinHTTP AppMain\/ detector_id: 60165
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Nusbn.a"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?api=giveFileDL&files="; content:" HTTP"; content:"User-Agent|3A| WinHTTP AppMain/"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?api=giveFileDL&files=[a-z\.0-9]+ HTTP.*User-Agent: WinHTTP AppMain\//"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060165; rev:2165;)

# Command&Control: (Trojan) Nusbn.A - regex: to_server:GET \/\?action=getFileDL&files=[a-z0-9A-Z\.]+ HTTP.*User-Agent: WinHTTP AppMain\/ detector_id: 60166
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Nusbn.A"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?action=getFileDL&files="; content:" HTTP"; content:"User-Agent|3A| WinHTTP AppMain/"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?action=getFileDL&files=[a-z0-9A-Z\.]+ HTTP.*User-Agent: WinHTTP AppMain\//s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060166; rev:2165;)

# Command&Control: (Trojan) Nusbn.A - regex: to_server:GET \/\?action=getVersion&pcid=.*&nowVer=.*&pid=\d+&subpid=\d*&runas=.* HTTP.*User-Agent: WinHTTP AppMain\/ detector_id: 60167
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Nusbn.A"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?action=getVersion&pcid="; content:"&nowVer="; content:"&pid="; content:"&subpid="; content:"&runas="; content:" HTTP"; content:"User-Agent|3A| WinHTTP AppMain/"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?action=getVersion&pcid=.*&nowVer=.*&pid=\d+&subpid=\d*&runas=.* HTTP.*User-Agent: WinHTTP AppMain\//s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060167; rev:2165;)

# Adware: (PUA) Uniblue - regex: to_server:POST \/v1\/track HTTP.*User-Agent: Mozilla/4\.0 [^\r]+WinHttp\.WinHttpRequest.*\{\"recipient\"\:.*\"client\_id\"\:.*\"event\"\: detector_id: 60168
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUA) Uniblue"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/v1/track HTTP"; content:"User-Agent|3A| Mozilla/4.0 "; content:"WinHttp.WinHttpRequest"; content:"|7B||22|recipient|22||3A|"; content:"|22|client_id|22||3A|"; content:"|22|event|22||3A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/v1\/track HTTP.*User-Agent: Mozilla\/4\.0 [^\r]+WinHttp\.WinHttpRequest.*\{\"recipient\"\:.*\"client\_id\"\:.*\"event\"\:/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060168; rev:2165;)

# Command&Control: (Trojan) Simda - regex: to_server:GET /\?..=[a-zA-Z0-9%]{196,} HTTP/1\.\d\r\nHost: [^\r\n]+\r\nUser-Agent: Mozilla/5\.0 \(Windows NT 6\.1; WOW64; rv:2\.0b8pre\) Gecko/20101114 Firefox/4\.0b8pre\r\n detector_id: 60170
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Simda"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?"; content:" HTTP/1."; content:"|0D||0A|Host|3A| "; content:"|0D||0A|User-Agent|3A| Mozilla/5.0 |28|Windows NT 6.1|3B| WOW64|3B| rv|3A|2.0b8pre|29| Gecko/20101114 Firefox/4.0b8pre|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?..=[a-zA-Z0-9%]{196,} HTTP\/1\.\d\r\nHost: [^\r\n]+\r\nUser-Agent: Mozilla\/5\.0 \(Windows NT 6\.1\; WOW64\; rv:2\.0b8pre\) Gecko\/20101114 Firefox\/4\.0b8pre\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060170; rev:2165;)

# Adware: (Toolbar) Pricepeep - regex: to_server:POST \/(request|report)\_v2\.aspx\?action=.*&version=[0-9\.]+&platform=.*&jigcb=[a-f0-9\-]+ HTTP.*\r\n\r\njigsaw detector_id: 60171
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Toolbar) Pricepeep"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"_v2.aspx?action="; content:"&version="; content:"&platform="; content:"&jigcb="; content:" HTTP"; content:"|0D||0A||0D||0A|jigsaw"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(request|report)\_v2\.aspx\?action=.*&version=[0-9\.]+&platform=.*&jigcb=[a-f0-9\-]+ HTTP.*\r\n\r\njigsaw/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060171; rev:2168;)

# Adware: (Monetization) Wiseinstaller - regex: to_server:POST /api/offer\-status HTTP/1\.1\r\nContent-Type: application/x\-www\-form\-urlencoded\r\nHost: [^\r]+\r\nContent-Length: \d+\r\nConnection: Keep\-Alive\r\n\r\noffer_id=\d+&offer_status= detector_id: 60172
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Monetization) Wiseinstaller"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/api/offer-status HTTP/1.1|0D||0A|Content-Type|3A| application/x-www-form-urlencoded|0D||0A|Host|3A| "; content:"|0D||0A|Content-Length|3A| "; content:"|0D||0A|Connection|3A| Keep-Alive|0D||0A||0D||0A|offer_id="; content:"&offer_status="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/offer\-status HTTP\/1\.1\r\nContent-Type: application\/x\-www\-form\-urlencoded\r\nHost: [^\r]+\r\nContent-Length: \d+\r\nConnection: Keep\-Alive\r\n\r\noffer_id=\d+&offer_status=/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060172; rev:2168;)

# Adware: (PUP) MultiPlug - regex: to_server:GET /(get/)?\?q=[a-zA-Z0-9+/%]+ HTTP/1\.\d\r\nAccept: \*/\*\r\nUser-Agent: [^\r\n]+\r\nHost: [^\r\n]+\r\n\r\n detector_id: 60173
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUP) MultiPlug"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?q="; content:" HTTP/1."; content:"|0D||0A|Accept|3A| |2A|/|2A||0D||0A|User-Agent|3A| "; content:"|0D||0A|Host|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(get\/)?\?q=[a-zA-Z0-9+\/%]+ HTTP\/1\.\d\r\nAccept: \*\/\*\r\nUser-Agent: [^\r\n]+\r\nHost: [^\r\n]+\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060173; rev:2168;)

# Command&Control: (Trojan) Zbot - regex: to_server:POST .*User-Agent: [^\r]+Windows NT 7\.1[^\r]+Firefox\/9\.1\.2.*\r\n\r\n\x6e\x25\x29.*\x7e\x6c\x68\x25 detector_id: 60204
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zbot"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"User-Agent|3A| "; content:"Windows NT 7.1"; content:"Firefox/9.1.2"; content:"|0D||0A||0D||0A|n|25||29|"; content:"|7E|lh|25|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*User-Agent: [^\r]+Windows NT 7\.1[^\r]+Firefox\/9\.1\.2.*\r\n\r\n\x6e\x25\x29.*\x7e\x6c\x68\x25/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060204; rev:2207;)

# Command&Control: (Trojan) FlyStudio - regex: to_server:GET .*Accept-Language: zh-cn\r\n.*Content-Type: application\/x-www-form-urlencoded\r\n.*User-Agent: [^\r]+MSIE 9\.0; Windows NT 6\.1; 125LA; \.NET CLR 2\.0\.50727; \.NET CLR 3\.0\.04506\.648; \.NET CLR 3\.5\.21022\)\r\n detector_id: 60205
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) FlyStudio"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"Accept-Language|3A| zh-cn|0D||0A|"; content:"Content-Type|3A| application/x-www-form-urlencoded|0D||0A|"; content:"User-Agent|3A| "; content:"MSIE 9.0|3B| Windows NT 6.1|3B| 125LA|3B| .NET CLR 2.0.50727|3B| .NET CLR 3.0.04506.648|3B| .NET CLR 3.5.21022|29||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*Accept-Language: zh-cn\r\n.*Content-Type: application\/x-www-form-urlencoded\r\n.*User-Agent: [^\r]+MSIE 9\.0\; Windows NT 6\.1\; 125LA\; \.NET CLR 2\.0\.50727\; \.NET CLR 3\.0\.04506\.648\; \.NET CLR 3\.5\.21022\)\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060205; rev:2207;)

# Command&Control: (PasswordStealer) Pony - regex: to_server:POST /.*gate\.php HTTP/\d\.\d\r\nHost:[^\r\n]+\r\nAccept: \*/\*\r\nAccept-Encoding:.*Content-Length:.*Content-Encoding:[^\r\n]+\r\nUser-Agent:[^\r\n]+\r\n\r\n detector_id: 60219
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (PasswordStealer) Pony"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"gate.php HTTP/"; content:"|0D||0A|Host|3A|"; content:"|0D||0A|Accept|3A| |2A|/|2A||0D||0A|Accept-Encoding|3A|"; content:"Content-Length|3A|"; content:"Content-Encoding|3A|"; content:"|0D||0A|User-Agent|3A|"; content:"|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*gate\.php HTTP\/\d\.\d\r\nHost:[^\r\n]+\r\nAccept: \*\/\*\r\nAccept-Encoding:.*Content-Length:.*Content-Encoding:[^\r\n]+\r\nUser-Agent:[^\r\n]+\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060219; rev:2216;)

# Command&Control: (PasswordStealer) Stimlina - regex: to_server:GET \/cp\/logs\_print\.php\?sid=[a-z0-9A-Z]+&m=[a-z]+ HTTP/1\.1\r\nHost: \d+\.\d+\.\d+\.\d+\r\nConnection: Keep-Alive\r\n\r\n detector_id: 60245
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (PasswordStealer) Stimlina"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/cp/logs_print.php?sid="; content:"&m="; content:" HTTP/1.1|0D||0A|Host|3A| "; content:"|0D||0A|Connection|3A| Keep-Alive|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/cp\/logs\_print\.php\?sid=[a-z0-9A-Z]+&m=[a-z]+ HTTP\/1\.1\r\nHost: \d+\.\d+\.\d+\.\d+\r\nConnection: Keep-Alive\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060245; rev:2249;)

# Command&Control: (Banking trojan) GenericBanker_33 - regex: to_server:POST \/bcms\/assets\/img\/(?:[a-zA-Z0-9\_]{6,25}\/){8,15}[a-zA-Z0-9]{1,8}\.bmp HTTP detector_id: 60246
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banking trojan) GenericBanker_33"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/bcms/assets/img/"; content:".bmp HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bcms\/assets\/img\/(?:[a-zA-Z0-9\_]{6,25}\/){8,15}[a-zA-Z0-9]{1,8}\.bmp HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060246; rev:2249;)

# Command&Control: (Banking Trojan) GenericBanker_33 - regex: to_server:GET \/bcms\/assets\/img\/(?:[a-zA-Z0-9\_]{6,25}\/){8,15}[a-zA-Z0-9]{1,8}\.gif HTTP detector_id: 60247
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banking Trojan) GenericBanker_33"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/bcms/assets/img/"; content:".gif HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/bcms\/assets\/img\/(?:[a-zA-Z0-9\_]{6,25}\/){8,15}[a-zA-Z0-9]{1,8}\.gif HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060247; rev:2249;)

# Malware distribution: (ge.tt) malicious file download - regex: to_server:GET /streams/[a-zA-Z0-9]+/[ -~]+\.(vb\w?|exe|scr|pif|msi|cpl|hta|jar|msc|bat|js\w?|ws\w?|ps\w*?|sh|pl|pyc?|rb)\?sig=[ -~]+&type=download HTTP.*Host: [^\r]\.blob detector_id: 60248
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Malware distribution: (ge.tt) malicious file download"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/streams/"; content:"?sig="; content:"&type=download HTTP"; content:"Host|3A| "; content:".blob"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/streams\/[a-zA-Z0-9]+\/[ -~]+\.(vb\w?|exe|scr|pif|msi|cpl|hta|jar|msc|bat|js\w?|ws\w?|ps\w*?|sh|pl|pyc?|rb)\?sig=[ -~]+&type=download HTTP.*Host: [^\r]\.blob/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060248; rev:2249;)

# Command&Control: (Trojan) Jorik - regex: to_server:GET \/ HTTP/1\.1\r\nUser-Agent: [^ -~]{52}\r\n detector_id: 60249
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Jorik"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ HTTP/1.1|0D||0A|User-Agent|3A| "; content:"|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ HTTP\/1\.1\r\nUser-Agent: [^ -~]{52}\r\n/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060249; rev:2249;)

# Command&Control: (Trojan) Toshliph - regex: to_server:GET /[a-z]+\.php\?[a-z]+=[a-f0-9]+ HTTP/1\.1\r\nAccept: \*/\*\r\nUser-Agent: Mozilla/4\.0[^\r]+\r\nHost: [^\r]+\r\n\r\n detector_id: 60250
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Toshliph"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?"; content:" HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|User-Agent|3A| Mozilla/4.0"; content:"|0D||0A|Host|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]+\.php\?[a-z]+=[a-f0-9]+ HTTP\/1\.1\r\nAccept: \*\/\*\r\nUser-Agent: Mozilla\/4\.0[^\r]+\r\nHost: [^\r]+\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060250; rev:2249;)

# Command&Control: (Trojan) Toshliph - regex: to_server:POST /[a-z]+\.php\?[a-z]+=[a-f0-9]+ HTTP/1\.1\r\nAccept: \*/\*\r\nContent-Type: application/octet-stream\r\n.*\r\n\r\n[A-Za-z0-9+/]+\={0,3} detector_id: 60251
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Toshliph"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php?"; content:" HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|Content-Type|3A| application/octet-stream|0D||0A|"; content:"|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]+\.php\?[a-z]+=[a-f0-9]+ HTTP\/1\.1\r\nAccept: \*\/\*\r\nContent-Type: application\/octet-stream\r\n.*\r\n\r\n[A-Za-z0-9+\/]+\={0,3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060251; rev:2249;)

# Command&Control: (Dropper) Jongiti - regex: to_server:GET \/count\.php\?mac=\d{2}\-\d{2}\-\d{2}\-\d{2}\-\d{2}\-\d{2} HTTP/1\.1\r\nAccept: \*/\*\r\nHost: [^\r]+\r\nCache-Control: no-cache\r\n\r\n detector_id: 60252
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Jongiti"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/count.php?mac="; content:" HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|Host|3A| "; content:"|0D||0A|Cache-Control|3A| no-cache|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/count\.php\?mac=\d{2}\-\d{2}\-\d{2}\-\d{2}\-\d{2}\-\d{2} HTTP\/1\.1\r\nAccept: \*\/\*\r\nHost: [^\r]+\r\nCache-Control: no-cache\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060252; rev:2249;)

# Command&Control: (Virus) Neshta - regex: to_server:GET .*\.inf HTTP/1\.1\r\nUser-Agent: Sverka detector_id: 60253
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Virus) Neshta"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".inf HTTP/1.1|0D||0A|User-Agent|3A| Sverka"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.inf HTTP\/1\.1\r\nUser-Agent: Sverka/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060253; rev:2249;)

# Command&Control: (Virus) Neshta - regex: to_server:GET .*\/log\.php\?kom=.*&prog=.* HTTP/1\.1\r\nUser-Agent: InetURL\:\/ detector_id: 60254
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Virus) Neshta"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/log.php?kom="; content:"&prog="; content:" HTTP/1.1|0D||0A|User-Agent|3A| InetURL|3A|/"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/log\.php\?kom=.*&prog=.* HTTP\/1\.1\r\nUser-Agent: InetURL\:\//s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060254; rev:2249;)

# Command&Control: (Downloader) Bagsu - regex: to_server:GET /setup/all/guding/Setup_[A-Z0-9]+_adr_\d\.exe HTTP detector_id: 60273
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Downloader) Bagsu"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/setup/all/guding/Setup_"; content:"_adr_"; content:".exe HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/setup\/all\/guding\/Setup_[A-Z0-9]+_adr_\d\.exe HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060273; rev:2261;)

# Command&Control: (Downloader) Bagsu - regex: to_server:GET /down/cj\.exe HTTP detector_id: 60274
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Downloader) Bagsu"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/down/cj.exe HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/down\/cj\.exe HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060274; rev:2261;)

# Command&Control: (Downloader) Bagsu - regex: to_server:GET /guding/QiJi_[A-Z0-9]+_\d\.exe HTTP detector_id: 60290
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Downloader) Bagsu"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/guding/QiJi_"; content:".exe HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/guding\/QiJi_[A-Z0-9]+_\d\.exe HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060290; rev:2291;)

# Command&Control: (Downloader) Bagsu - regex: to_server:GET /mw690/006czSTKjw1ev[^.]+\.gif HTTP detector_id: 60291
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Downloader) Bagsu"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/mw690/006czSTKjw1ev"; content:".gif HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/mw690\/006czSTKjw1ev[^.]+\.gif HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060291; rev:2291;)

# Command&Control: (Ransomware) PClock - regex: to_server:POST .+\?rnd=\d+ HTTP/\d\.\d.+?User-Agent: Mozilla/4\.0 \(compatible; Win32; WinHttp\.WinHttpRequest\.5\).+?\r\n\r\n..\d+ \d{1,2}:\d{1,2}:\d{1,2} (AM|PM) detector_id: 60319
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) PClock"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"?rnd="; content:" HTTP/"; content:"User-Agent|3A| Mozilla/4.0 |28|compatible|3B| Win32|3B| WinHttp.WinHttpRequest.5|29|"; content:"|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.+\?rnd=\d+ HTTP\/\d\.\d.+?User-Agent: Mozilla\/4\.0 \(compatible\; Win32\; WinHttp\.WinHttpRequest\.5\).+?\r\n\r\n..\d+ \d{1,2}:\d{1,2}:\d{1,2} (AM|PM)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060319; rev:2304;)

# Command&Control: (Virus) Sality - regex: to_server:GET \/.*\.jpg\?[0-9a-f]{4,8}=\-?\d+ HTTP/1\.1\r\nUser-Agent: [^\r]+\r\nHost: [^\r]+\r\nCache-Control: [^\r]+\r\n\r\n detector_id: 60339
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Virus) Sality"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".jpg?"; content:" HTTP/1.1|0D||0A|User-Agent|3A| "; content:"|0D||0A|Host|3A| "; content:"|0D||0A|Cache-Control|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.*\.jpg\?[0-9a-f]{4,8}=\-?\d+ HTTP\/1\.1\r\nUser-Agent: [^\r]+\r\nHost: [^\r]+\r\nCache-Control: [^\r]+\r\n\r\n/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060339; rev:2312;)

# Command&Control: (Trojan) KeyBase - regex: to_server:POST .*/image/upload\.php HTTP.*\r\nContent-Type: multipart/form-data.*\r\nExpect: 100-continue detector_id: 60340
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) KeyBase"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/image/upload.php HTTP"; content:"|0D||0A|Content-Type|3A| multipart/form-data"; content:"|0D||0A|Expect|3A| 100-continue"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/image\/upload\.php HTTP.*\r\nContent-Type: multipart\/form-data.*\r\nExpect: 100-continue/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060340; rev:2312;)

# Adware: (Downware) LoadMoney - regex: to_server:GET \/touch\_install\?name=.*&etag=[a-f0-9]+&hash=[a-f0-9]+\?launch=[a-f0-9]+ HTTP/1\.1\r\nUser-Agent: Downloader detector_id: 60341
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) LoadMoney"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/touch_install?name="; content:"&etag="; content:"&hash="; content:"?launch="; content:" HTTP/1.1|0D||0A|User-Agent|3A| Downloader"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/touch\_install\?name=.*&etag=[a-f0-9]+&hash=[a-f0-9]+\?launch=[a-f0-9]+ HTTP\/1\.1\r\nUser-Agent: Downloader/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060341; rev:2312;)

# Command&Control: (Trojan) ZBot - regex: to_server:GET .*/[a-z0-9]{1,31}\.bin HTTP/1\.1\r\nAccept: \*/\*\r\nUser-Agent: Mozilla/\d\.0 \(compatible; MSIE[^;]+; Windows[^;\)]+(; SV\d)?\)\r\nHost: \d+\.\d+\.\d+\.\d+\r\nCache-Control: [^\r]+\r\n(Cookie: DYNSRV=[^\r]+\r\n)?\r\n detector_id: 60342
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".bin HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|User-Agent|3A| Mozilla/"; content:".0 |28|compatible|3B| MSIE"; content:"|3B| Windows"; content:"|29||0D||0A|Host|3A| "; content:"|0D||0A|Cache-Control|3A| "; content:"|0D||0A|"; content:"|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\/[a-z0-9]{1,31}\.bin HTTP\/1\.1\r\nAccept: \*\/\*\r\nUser-Agent: Mozilla\/\d\.0 \(compatible\; MSIE[^\;]+\; Windows[^\;\)]+(\; SV\d)?\)\r\nHost: \d+\.\d+\.\d+\.\d+\r\nCache-Control: [^\r]+\r\n(Cookie: DYNSRV=[^\r]+\r\n)?\r\n/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060342; rev:2327;)

# Command&Control: (Backdoor) Venik - regex: to_client:HTTP/1\.1 200 OK\r\nConnection: close\r\nDate: [^\r]+\r\nServer: Microsoft-IIS/6\.0\r\nX\-Powered\-By: PHP/5\.\d\.\d+\r\nContent-type:application/[a-zA-Z0-9]+\r\n\r\n[^ -~]{8,16} detector_id: 60343
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Backdoor) Venik"; flow:established,to_client; content:"HTTP/1.1 200 OK|0D||0A|Connection|3A| close|0D||0A|Date|3A| "; content:"|0D||0A|Server|3A| Microsoft-IIS/6.0|0D||0A|X-Powered-By|3A| PHP/5."; content:"|0D||0A|Content-type|3A|application/"; content:"|0D||0A||0D||0A|"; pcre:"/HTTP\/1\.1 200 OK\r\nConnection: close\r\nDate: [^\r]+\r\nServer: Microsoft-IIS\/6\.0\r\nX\-Powered\-By: PHP\/5\.\d\.\d+\r\nContent-type:application\/[a-zA-Z0-9]+\r\n\r\n[^ -~]{8,16}/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060343; rev:2327;)

# Command&Control: (Trojan) Unknown - regex: to_server:GET .*\.php\?&\d{2}=\d+&dll=\d+ HTTP/1\.0 detector_id: 60344
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Unknown"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?&"; content:"&dll="; content:" HTTP/1.0"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php\?&\d{2}=\d+&dll=\d+ HTTP\/1\.0/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060344; rev:2327;)

# Command&Control: (Dropper) Esfury - regex: to_server:GET / HTTP/1\.1\r\n(Accept: [^\r\n]+\r\nAccept-Language: [^\r\n]+\r\nConnection: [^\r\n]+\r\n)?User-Agent: [\xa0-\xff]+\r\n detector_id: 60355
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Esfury"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ HTTP/1.1|0D||0A|"; content:"User-Agent|3A| "; content:"|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ HTTP\/1\.1\r\n(Accept: [^\r\n]+\r\nAccept-Language: [^\r\n]+\r\nConnection: [^\r\n]+\r\n)?User-Agent: [\xa0-\xff]+\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060355; rev:2333;)

# Command&Control: (Backdoor) Venik - regex: to_client:HTTP/1\.1 200 OK\r\nConnection: close\r\n.*\r\nConnection: close\r\nContent-Type: application/octet-stream\r\nContent-Disposition: attchment; filename="[A-Z0-9]+\.ZIP"\r\n\r\n[^ -~]{8,16} detector_id: 60373
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Backdoor) Venik"; flow:established,to_client; content:"HTTP/1.1 200 OK|0D||0A|Connection|3A| close|0D||0A|"; content:"|0D||0A|Connection|3A| close|0D||0A|Content-Type|3A| application/octet-stream|0D||0A|Content-Disposition|3A| attchment|3B| filename=|22|"; content:".ZIP|22||0D||0A||0D||0A|"; pcre:"/HTTP\/1\.1 200 OK\r\nConnection: close\r\n.*\r\nConnection: close\r\nContent-Type: application\/octet-stream\r\nContent-Disposition: attchment\; filename="[A-Z0-9]+\.ZIP"\r\n\r\n[^ -~]{8,16}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060373; rev:2341;)

# Adware: (Downloader) InstallCore - regex: to_server:POST /\?pcrc=\d+&v=\d\.\d HTTP detector_id: 60384
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downloader) InstallCore"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/?pcrc="; content:"&v="; content:" HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?pcrc=\d+&v=\d\.\d HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060384; rev:2350;)

# Command&Control: (Dropper) Upatre - regex: to_server:GET /\d*[a-zA-Z_]+\d*/[a-zA-Z0-9-]+/\d+/\d+/\d+/[A-Z0-9a-z]* HTTP/1\.1\r\nUser-Agent: [^\r]+\r\nHost: [\d.]+\:\d+ detector_id: 60385
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Upatre"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP/1.1|0D||0A|User-Agent|3A| "; content:"|0D||0A|Host|3A| "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d*[a-zA-Z_]+\d*\/[a-zA-Z0-9-]+\/\d+\/\d+\/\d+\/[A-Z0-9a-z]* HTTP\/1\.1\r\nUser-Agent: [^\r]+\r\nHost: [\d.]+\:\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060385; rev:2350;)

# Command&Control: (dropper) Upatre - regex: to_server:GET /\d*[a-zA-Z_]+\d*/[a-zA-Z0-9-]+/0/[a-zA-Z0-9-]+/0/[a-zA-Z0-9]* HTTP/1\.1\r\nUser-Agent: [^\r]+\r\nHost: [\d.]+\:\d+ detector_id: 60386
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (dropper) Upatre"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/0/"; content:"/0/"; content:" HTTP/1.1|0D||0A|User-Agent|3A| "; content:"|0D||0A|Host|3A| "; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d*[a-zA-Z_]+\d*\/[a-zA-Z0-9-]+\/0\/[a-zA-Z0-9-]+\/0\/[a-zA-Z0-9]* HTTP\/1\.1\r\nUser-Agent: [^\r]+\r\nHost: [\d.]+\:\d+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060386; rev:2350;)

# Command&Control: (Trojan) Fareit - regex: to_server:POST /\d+\.php HTTP/1\.0\r\nHost: [^\r\n]+\r\nContent-type: [^\r\n]+\r\nContent-length: [^\r\n]+\r\nConnection: [^\r\n]+\r\n\r\nd=[%A-Z0-9]+ detector_id: 60387
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fareit"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP/1.0|0D||0A|Host|3A| "; content:"|0D||0A|Content-type|3A| "; content:"|0D||0A|Content-length|3A| "; content:"|0D||0A|Connection|3A| "; content:"|0D||0A||0D||0A|d="; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\d+\.php HTTP\/1\.0\r\nHost: [^\r\n]+\r\nContent-type: [^\r\n]+\r\nContent-length: [^\r\n]+\r\nConnection: [^\r\n]+\r\n\r\nd=[%A-Z0-9]+/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060387; rev:2353;)

# Command&Control: (Trojan) Rofin - regex: to_server:GET /.+\?mac=[a-zA-Z0-9]+&lip=\d+\.\d+\.\d+\.\d+&user=[^&]+&ver=[\d.]+ HTTP.+n?Connection: detector_id: 60406
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Rofin"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?mac="; content:"&lip="; content:"&user="; content:"&ver="; content:" HTTP"; content:"Connection|3A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/.+\?mac=[a-zA-Z0-9]+&lip=\d+\.\d+\.\d+\.\d+&user=[^&]+&ver=[\d.]+ HTTP.+n?Connection:/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060406; rev:2374;)

# Command&Control: (Trojan) Rofin - regex: to_server:GET /client\?user=[^&]+&mac=[a-zA-Z0-9]+&lip=\d+\.\d+\.\d+\.\d+&ver=[\d.]+(&.+)?&t=\d+ HTTP/\d\.\d detector_id: 60407
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Rofin"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/client?user="; content:"&mac="; content:"&lip="; content:"&ver="; content:"&t="; content:" HTTP/"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/client\?user=[^&]+&mac=[a-zA-Z0-9]+&lip=\d+\.\d+\.\d+\.\d+&ver=[\d.]+(&.+)?&t=\d+ HTTP\/\d\.\d/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060407; rev:2374;)

# Command&Control: (Trojan) Vawtrak - regex: to_server:GET /module/[a-z0-9]{32} HTTP/\d\.\d\r\n.+Connection: keep-alive\r\nCache-Control: max-age=0\r\nUser-Agent: [^\r\n]+\r\nHost: [\d.]+\r\n\r\n detector_id: 60409
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Vawtrak"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/module/"; content:" HTTP/"; content:"|0D||0A|"; content:"Connection|3A| keep-alive|0D||0A|Cache-Control|3A| max-age=0|0D||0A|User-Agent|3A| "; content:"|0D||0A|Host|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/module\/[a-z0-9]{32} HTTP\/\d\.\d\r\n.+Connection: keep-alive\r\nCache-Control: max-age=0\r\nUser-Agent: [^\r\n]+\r\nHost: [\d.]+\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060409; rev:2374;)

# Command&Control: (Trojan) Vawtrak - regex: to_server:POST .+\.php\?.+=0(0|1|2)&.*=0+[a-zA-Z0-9]+&.*=[a-zA-Z0-9]{8}.* HTTP detector_id: 60418
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Vawtrak"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php?"; content:"=0"; content:" HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.+\.php\?.+=0(0|1|2)&.*=0+[a-zA-Z0-9]+&.*=[a-zA-Z0-9]{8}.* HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060418; rev:2380;)

# Command&Control: (Trojan) Vawtrak - regex: to_server:POST /(forum|blog|param|work|collection|channel)/[^/]+\.php\?.+=0(0|1|2)&.*=0{4,}[a-zA-Z0-9]{,4}&.*=[a-zA-Z0-9]{8}.* HTTP detector_id: 60420
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Vawtrak"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php?"; content:"=0"; content:" HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(forum|blog|param|work|collection|channel)\/[^\/]+\.php\?.+=0(0|1|2)&.*=0{4,}[a-zA-Z0-9]{,4}&.*=[a-zA-Z0-9]{8}.* HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060420; rev:2380;)

# Command&Control: (Trojan) Vawtrak - regex: to_server:POST /(forum|blog|param|work|collection|channel)/(0(0|1|2)|0{4,}[a-zA-Z0-9]{,4})/.*(?<=/)(0(0|1|2)|0{4,}[a-zA-Z0-9]{,4})/.*(?<=/)[a-zA-Z0-9]{8}.* HTTP detector_id: 60421
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Vawtrak"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:" HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(forum|blog|param|work|collection|channel)\/(0(0|1|2)|0{4,}[a-zA-Z0-9]{,4})\/.*(?<=\/)(0(0|1|2)|0{4,}[a-zA-Z0-9]{,4})\/.*(?<=\/)[a-zA-Z0-9]{8}.* HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060421; rev:2380;)

# Adware: (Installer) ProInstall - regex: to_server:GET /advplatform/api\.cgi\?act=[a-zA-Z]+&appid=\d+&ts=\d+&dlip=\d&dlid=\d&pnid=\d&proto=\d HTTP/\d\.\d\r\nUser-Agent: NSIS_Inetc \(Mozilla\)\r\n detector_id: 60449
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Installer) ProInstall"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/advplatform/api.cgi?act="; content:"&appid="; content:"&ts="; content:"&dlip="; content:"&dlid="; content:"&pnid="; content:"&proto="; content:" HTTP/"; content:"|0D||0A|User-Agent|3A| NSIS_Inetc |28|Mozilla|29||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/advplatform\/api\.cgi\?act=[a-zA-Z]+&appid=\d+&ts=\d+&dlip=\d&dlid=\d&pnid=\d&proto=\d HTTP\/\d\.\d\r\nUser-Agent: NSIS_Inetc \(Mozilla\)\r\n/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060449; rev:2422;)

# Command&Control: (Backdoor) Koceg - regex: to_server:GET \/\?&v=[^\&]+&lid=\d+ HTTP.*User-Agent: Mozilla\r\n detector_id: 60462
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Koceg"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?&v="; content:"&lid="; content:" HTTP"; content:"User-Agent|3A| Mozilla|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?&v=[^\&]+&lid=\d+ HTTP.*User-Agent: Mozilla\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060462; rev:2431;)

# Command&Control: (Dropper) Nusbn.a - regex: to_server:GET \/\?api=giveVersion&pcid=[A-Z\_\-0-9]+&nowVer=\d\.\d&pid=\d*&subpid=\d*&runas=[a-z]+ HTTP.*User-Agent: WinHTTP\ AppMain\/ detector_id: 60463
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Nusbn.a"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?api=giveVersion&pcid="; content:"&nowVer="; content:"&pid="; content:"&subpid="; content:"&runas="; content:" HTTP"; content:"User-Agent|3A| WinHTTP AppMain/"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?api=giveVersion&pcid=[A-Z\_\-0-9]+&nowVer=\d\.\d&pid=\d*&subpid=\d*&runas=[a-z]+ HTTP.*User-Agent: WinHTTP\ AppMain\//s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060463; rev:2431;)

# Command&Control: (Trojan) Vawtrak - regex: to_server:POST (?i)/work/new/index\.php(\?.+)? HTTP/\d\.\d\r\n.+Cookie: PHPSESSID=[A-Z0-9]+\r\nConnection: keep-alive\r\nCache-control: max-age=0\r\nContent-Type: application/octet-stream\r\n detector_id: 60464
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Vawtrak"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; nocase; content:"/work/new/index.php"; nocase; content:" HTTP/"; nocase; content:"|0D||0A|"; nocase; content:"Cookie|3A| PHPSESSID="; nocase; content:"|0D||0A|Connection|3A| keep-alive|0D||0A|Cache-control|3A| max-age=0|0D||0A|Content-Type|3A| application/octet-stream|0D||0A|"; nocase; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(?i)\/work\/new\/index\.php(\?.+)? HTTP\/\d\.\d\r\n.+Cookie: PHPSESSID=[A-Z0-9]+\r\nConnection: keep-alive\r\nCache-control: max-age=0\r\nContent-Type: application\/octet-stream\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060464; rev:2431;)

# Command&Control: (Ransomware) Cryptowall - regex: to_server:POST .*\.php\?[a-z]=[a-z0-9]{8,} HTTP.*User-Agent: Mozilla.*MSIE.*\r\n\r\n[a-z]=[a-f0-9]{100,} detector_id: 60480
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) Cryptowall"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php?"; content:" HTTP"; content:"User-Agent|3A| Mozilla"; content:"MSIE"; content:"|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?.*\.php\?[a-z]=[a-z0-9]{8,} HTTP.*User-Agent: Mozilla.*MSIE.*\r\n\r\n[a-z]=[a-f0-9]{100,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060480; rev:2477;)

# Adware: (Adware) Imali - regex: to_server:GET /\?domain=[a-zA-Z]+\.[a-z]{2,4}&dotnet=\d+&file=installer&ip=[0-9.]+:\d{2,5}&pub_id=\d+&setup_id=\d+.+ HTTP detector_id: 60491
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) Imali"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/?domain="; content:"&dotnet="; content:"&file=installer&ip="; content:"&pub_id="; content:"&setup_id="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/\?domain=[a-zA-Z]+\.[a-z]{2,4}&dotnet=\d+&file=installer&ip=[0-9.]+:\d{2,5}&pub_id=\d+&setup_id=\d+.+ HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060491; rev:2513;)

# Adware: (Adware) IC Loader - regex: to_server:POST \/api\/auth\/getToken\?user=.*&key=[a-f0-9]{32} HTTP.*User-Agent: (IC Loader|File Downloader) detector_id: 60492
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Adware) IC Loader"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/api/auth/getToken?user="; content:"&key="; content:" HTTP"; content:"User-Agent|3A| "; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/api\/auth\/getToken\?user=.*&key=[a-f0-9]{32} HTTP.*User-Agent: (IC Loader|File Downloader)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060492; rev:2515;)

# Command&Control: (Dropper) Donoff - regex: to_server:POST [^\r]+\.php HTTP/1\.1\r\nAccept: \*/\*\r\n.*Content-Length: 0\r\n||to_client:HTTP.*Content-Disposition: attachment\; filename=[^\r]+\.exe\r\nContent-Transfer-Encoding: binary\r\nExpires: 0\r detector_id: 60513
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Donoff (0) (no alert)"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:".php HTTP/1.1|0D||0A|Accept|3A| |2A|/|2A||0D||0A|"; content:"Content-Length|3A| 0|0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?[^\r]+\.php HTTP\/1\.1\r\nAccept: \*\/\*\r\n.*Content-Length: 0\r\n/s"; flowbits:set,LL.60513_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106051300; rev:2533;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Dropper) Donoff (1)"; flowbits:isset,LL.60513_0; flow:established,to_client; content:"HTTP"; content:"Content-Disposition|3A| attachment|3B| filename="; content:".exe|0D||0A|Content-Transfer-Encoding|3A| binary|0D||0A|Expires|3A| 0|0D|"; pcre:"/HTTP.*Content-Disposition: attachment\; filename=[^\r]+\.exe\r\nContent-Transfer-Encoding: binary\r\nExpires: 0\r/s"; flowbits:unset,LL.60513_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106051301; rev:2533;)

# Command&Control: (Trojan) Rovnix - regex: to_server:GET /login\.asp HTTP/1\.0\r\nHost: [^\r\n]+\r\n\r\n||to_client:HTTP/\d\.\d.+\r\n\r\n\x00\x08\x00\x00 detector_id: 60657
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Rovnix (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/login.asp HTTP/1.0|0D||0A|Host|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/login\.asp HTTP\/1\.0\r\nHost: [^\r\n]+\r\n\r\n/s"; flowbits:set,LL.60657_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106065700; rev:2659;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Trojan) Rovnix (1)"; flowbits:isset,LL.60657_0; flow:established,to_client; content:"HTTP/"; content:"|0D||0A||0D||0A||00||08||00||00|"; pcre:"/HTTP\/\d\.\d.+\r\n\r\n\x00\x08\x00\x00/s"; flowbits:unset,LL.60657_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106065701; rev:2659;)

# Adware: (PUA) WeatherApp - regex: to_server:GET /AF/sucess/thanks\.php\?rnd=\d+&affid=\d+&affsource=\d+&av=.* HTTP detector_id: 60667
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUA) WeatherApp"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/AF/sucess/thanks.php?rnd="; content:"&affid="; content:"&affsource="; content:"&av="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/AF\/sucess\/thanks\.php\?rnd=\d+&affid=\d+&affsource=\d+&av=.* HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060667; rev:2694;)

# Command&Control: (Browser Hijacker) sso.anbtr.com - regex: to_server:GET /domain/(?:(?:[a-z\d\-]+\.)+[a-z]{1,63}|(?:\d{1,3}\.){3}\d{1,3}) HTTP||to_client:HTTP/1\.1 302 Moved Temporarily.*\r\n\r\n.{0,5}Go detector_id: 60668
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Browser Hijacker) sso.anbtr.com (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/domain/"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/domain\/(?:(?:[a-z\d\-]+\.)+[a-z]{1,63}|(?:\d{1,3}\.){3}\d{1,3}) HTTP/"; flowbits:set,LL.60668_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106066800; rev:2694;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Browser Hijacker) sso.anbtr.com (1)"; flowbits:isset,LL.60668_0; flow:established,to_client; content:"HTTP/1.1 302 Moved Temporarily"; content:"|0D||0A||0D||0A|"; content:"Go"; flowbits:unset,LL.60668_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106066801; rev:2694;)

# Command&Control: (Trojan) GenericTrojan_160 - regex: to_server:GET /[a-z]+\?c=[^&]+&i=[^&]+&v=[^&]+ HTTP/\d\.\d\r\nHost: [^\r\n]+\r\n\r\n detector_id: 60669
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_160"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?c="; content:"&i="; content:"&v="; content:" HTTP/"; content:"|0D||0A|Host|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]+\?c=[^&]+&i=[^&]+&v=[^&]+ HTTP\/\d\.\d\r\nHost: [^\r\n]+\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060669; rev:2694;)

# Command&Control: (Downloader) Nivdort - regex: to_server:GET /index\.php HTTP/1\.0\r\nAccept: \*/\*\r\nConnection: close\r\nHost: [^\r\n]+\r\n\r\n detector_id: 60671
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Downloader) Nivdort"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php HTTP/1.0|0D||0A|Accept|3A| |2A|/|2A||0D||0A|Connection|3A| close|0D||0A|Host|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php HTTP\/1\.0\r\nAccept: \*\/\*\r\nConnection: close\r\nHost: [^\r\n]+\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060671; rev:2694;)

# Adware: (Downloader) Quireap - regex: to_server:GET /launch_[a-z0-9]+\.php\?p=[a-z]+&(p|t)id=\d+&(p|t)id=\d+(&b_typ=pe&n=([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})|&n=([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})&b_typ=pe)(&.+)? HTTP detector_id: 60672
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downloader) Quireap"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/launch_"; content:".php?p="; content:"id="; content:"id="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/launch_[a-z0-9]+\.php\?p=[a-z]+&(p|t)id=\d+&(p|t)id=\d+(&b_typ=pe&n=([A-Za-z0-9+\/]{4})*([A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{4})|&n=([A-Za-z0-9+\/]{4})*([A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{4})&b_typ=pe)(&.+)? HTTP/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060672; rev:2695;)

# Command&Control: (Banker) Ranbyus - regex: to_server:POST /(?:.+/)? HTTP/\d\.\d\r\n\Content-Type: multipart/form-data, boundary=([A-Z0-9]+)\r\nHost: [a-z]+\.[a-z]{2,3}\r\nContent-Length: \d+\r\nConnection: Keep-Alive\r\nCache-Control: no-cache\r\n\r\n--\1\r\nContent-Disposition: form-data; name="[a-zA-Z0-9]+"\r\n\r\n detector_id: 60673
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) Ranbyus"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:" HTTP/"; content:"|0D||0A|Content-Type|3A| multipart/form-data|2C| boundary="; content:"|0D||0A|Host|3A| "; content:"|0D||0A|Content-Length|3A| "; content:"|0D||0A|Connection|3A| Keep-Alive|0D||0A|Cache-Control|3A| no-cache|0D||0A||0D||0A|--"; content:"|0D||0A|Content-Disposition|3A| form-data|3B| name=|22|"; content:"|22||0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(?:.+\/)? HTTP\/\d\.\d\r\n\Content-Type: multipart\/form-data, boundary=([A-Z0-9]+)\r\nHost: [a-z]+\.[a-z]{2,3}\r\nContent-Length: \d+\r\nConnection: Keep-Alive\r\nCache-Control: no-cache\r\n\r\n--\1\r\nContent-Disposition: form-data\; name="[a-zA-Z0-9]+"\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060673; rev:2696;)

# Drive-By: (Malware download) Magniture EK - regex: to_server:GET /[a-f0-9]{32} HTTP/1\.1\r\nHost: \d+\.\d+\.\d+\.\d+\r\n\r\n detector_id: 60697
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-By: (Malware download) Magniture EK"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP/1.1|0D||0A|Host|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-f0-9]{32} HTTP\/1\.1\r\nHost: \d+\.\d+\.\d+\.\d+\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060697; rev:2708;)

# Command&Control: (Clicker) Fleercivet - regex: to_server:GET /geoip HTTP/1\.1\r\nHost: www\.telize\.com\r\n\r\n detector_id: 60717
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Clicker) Fleercivet"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/geoip HTTP/1.1|0D||0A|Host|3A| www.telize.com|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/geoip HTTP\/1\.1\r\nHost: www\.telize\.com\r\n\r\n/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060717; rev:2742;)

# Drive-by: (Landing URI Struct) Angler ek - regex: to_server:GET /[a-z]{3,16}\.php\?[a-z]=[a-zA-Z\d\-\_]+(?:&[a-z]{1,2}=[a-zA-Z\d\-\_]*){3,} HTTP(?!.*Cookie: )||to_client:HTTP/1\.1 200 OK.*Content\-Type: text/html.*Content\-Length: \d{5,} detector_id: 60730
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: (Landing URI Struct) Angler ek (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".php?"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{3,16}\.php\?[a-z]=[a-zA-Z\d\-\_]+(?:&[a-z]{1,2}=[a-zA-Z\d\-\_]*){3,} HTTP(?!.*Cookie: )/s"; flowbits:set,LL.60730_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106073000; rev:2752;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Landing URI Struct) Angler ek (1)"; flowbits:isset,LL.60730_0; flow:established,to_client; content:"HTTP/1.1 200 OK"; content:"Content-Type|3A| text/html"; content:"Content-Length|3A| "; pcre:"/HTTP\/1\.1 200 OK.*Content\-Type: text\/html.*Content\-Length: \d{5,}/s"; flowbits:unset,LL.60730_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106073001; rev:2752;)

# Drive-by: (Landing URI Struct) Angler ek - regex: to_server:GET (?:/[a-z]{3,20})?/viewtopic\.php(?:[\?&][a-z\d]{1,5}=[a-z\d\.]+){2,}&? HTTP(?!.*Cookie: )||to_client:HTTP/1\.1 200 OK.*Content\-Type: text/html.*Content\-Length: \d{5,} detector_id: 60731
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: (Landing URI Struct) Angler ek (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/viewtopic.php"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(?:\/[a-z]{3,20})?\/viewtopic\.php(?:[\?&][a-z\d]{1,5}=[a-z\d\.]+){2,}&? HTTP(?!.*Cookie: )/s"; flowbits:set,LL.60731_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106073100; rev:2752;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Landing URI Struct) Angler ek (1)"; flowbits:isset,LL.60731_0; flow:established,to_client; content:"HTTP/1.1 200 OK"; content:"Content-Type|3A| text/html"; content:"Content-Length|3A| "; pcre:"/HTTP\/1\.1 200 OK.*Content\-Type: text\/html.*Content\-Length: \d{5,}/s"; flowbits:unset,LL.60731_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106073101; rev:2752;)

# Drive-by: (Landing URI Struct) Angler ek - regex: to_server:GET (?:/[a-z]{3,20})?/viewforum\.php\?[a-z]=[a-z\d\.]+&sid=[a-z\d\.]+&? HTTP(?!.*Cookie: )||to_client:HTTP/1\.1 200 OK.*Content\-Type: text/html.*Content\-Length: \d{5,} detector_id: 60732
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: (Landing URI Struct) Angler ek (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/viewforum.php?"; content:"&sid="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(?:\/[a-z]{3,20})?\/viewforum\.php\?[a-z]=[a-z\d\.]+&sid=[a-z\d\.]+&? HTTP(?!.*Cookie: )/s"; flowbits:set,LL.60732_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106073200; rev:2754;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Landing URI Struct) Angler ek (1)"; flowbits:isset,LL.60732_0; flow:established,to_client; content:"HTTP/1.1 200 OK"; content:"Content-Type|3A| text/html"; content:"Content-Length|3A| "; pcre:"/HTTP\/1\.1 200 OK.*Content\-Type: text\/html.*Content\-Length: \d{5,}/s"; flowbits:unset,LL.60732_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106073201; rev:2754;)

# Drive-by: (Landing URI Struct) Angler EK - regex: to_server:GET /[a-z]{3,20}(?:[\_\-][a-z]{3,20}){2,3}/(?:\?[a-z]{1,25}=)?\d{10,20} HTTP(?!.*Cookie: )||to_client:HTTP/1\.1 200 OK.*Content\-Type: text/html.*Content\-Length: \d{5,} detector_id: 60734
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-by: (Landing URI Struct) Angler EK (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{3,20}(?:[\_\-][a-z]{3,20}){2,3}\/(?:\?[a-z]{1,25}=)?\d{10,20} HTTP(?!.*Cookie: )/s"; flowbits:set,LL.60734_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106073400; rev:2754;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-by: (Landing URI Struct) Angler EK (1)"; flowbits:isset,LL.60734_0; flow:established,to_client; content:"HTTP/1.1 200 OK"; content:"Content-Type|3A| text/html"; content:"Content-Length|3A| "; pcre:"/HTTP\/1\.1 200 OK.*Content\-Type: text\/html.*Content\-Length: \d{5,}/s"; flowbits:unset,LL.60734_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106073401; rev:2754;)

# Drive-By: (Landing URI Struct) Angler Ek - regex: to_server:GET (?:/(forums|boards|civis))?/search\.php\?keywords=[a-z\d]+&fid\d=[a-z\d]+\.[a-z\d]+&? HTTP(?!.*Cookie: )||to_client:HTTP/1\.1 200 OK.*Content\-Type: text/html.*Content\-Length: \d{5,} detector_id: 60764
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-By: (Landing URI Struct) Angler Ek (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/search.php?keywords="; content:"&fid"; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?(?:\/(forums|boards|civis))?\/search\.php\?keywords=[a-z\d]+&fid\d=[a-z\d]+\.[a-z\d]+&? HTTP(?!.*Cookie: )/s"; flowbits:set,LL.60764_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106076400; rev:2790;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-By: (Landing URI Struct) Angler Ek (1)"; flowbits:isset,LL.60764_0; flow:established,to_client; content:"HTTP/1.1 200 OK"; content:"Content-Type|3A| text/html"; content:"Content-Length|3A| "; pcre:"/HTTP\/1\.1 200 OK.*Content\-Type: text\/html.*Content\-Length: \d{5,}/s"; flowbits:unset,LL.60764_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106076401; rev:2790;)

# Drive-By: (Landing URI Struct) Angler Ek - regex: to_server:GET /(forums|boards|civis)/index\.php\?PHPSESSID=[^&]{1,10}&action=[^&]*&? HTTP(?!.*Cookie: )||to_client:HTTP/1\.1 200 OK.*Content\-Type: text/html.*Content\-Length: \d{5,} detector_id: 60765
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Drive-By: (Landing URI Struct) Angler Ek (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/index.php?PHPSESSID="; content:"&action="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(forums|boards|civis)\/index\.php\?PHPSESSID=[^&]{1,10}&action=[^&]*&? HTTP(?!.*Cookie: )/s"; flowbits:set,LL.60765_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106076500; rev:2790;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Drive-By: (Landing URI Struct) Angler Ek (1)"; flowbits:isset,LL.60765_0; flow:established,to_client; content:"HTTP/1.1 200 OK"; content:"Content-Type|3A| text/html"; content:"Content-Length|3A| "; pcre:"/HTTP\/1\.1 200 OK.*Content\-Type: text\/html.*Content\-Length: \d{5,}/s"; flowbits:unset,LL.60765_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106076501; rev:2790;)

# Malware Distribution: (Trojan) Dridex - regex: to_server:GET /[a-z]{2}\.jpg\?\d{3,4} HTTP/\d\.\d\r\nAccept: \*/\*\r\nAccept-Encoding: gzip, deflate\r\n detector_id: 60791
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Malware Distribution: (Trojan) Dridex"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:".jpg?"; content:" HTTP/"; content:"|0D||0A|Accept|3A| |2A|/|2A||0D||0A|Accept-Encoding|3A| gzip|2C| deflate|0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-z]{2}\.jpg\?\d{3,4} HTTP\/\d\.\d\r\nAccept: \*\/\*\r\nAccept-Encoding: gzip, deflate\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060791; rev:2817;)

# Adware: (PUA) ConvertAd - regex: to_server:POST / HTTP.*User-Agent: NSIS\_Inetc \(Mozilla\).*\r\n\r\n\{(?=.*"data":\s*"(?=.*event_event_id)(?=.*channel_id)(?=.*utm_addition).*")(?=.*"table":\s*".*") detector_id: 60792
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUA) ConvertAd"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/ HTTP"; content:"User-Agent|3A| NSIS_Inetc |28|Mozilla|29|"; content:"|0D||0A||0D||0A||7B|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ HTTP.*User-Agent: NSIS\_Inetc \(Mozilla\).*\r\n\r\n\{(?=.*"data":\s*"(?=.*event_event_id)(?=.*channel_id)(?=.*utm_addition).*")(?=.*"table":\s*".*")/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060792; rev:2817;)

# Command&Control: (Ransomware) Ryzerlo - regex: to_server:POST /panel/[^.]+\.php HTTP/\d\.\d\r\nContent-Type: application/x-www-form-urlencoded\r\nHost: [^\r\n]+\r\nContent-Length: \d+\r\nExpect: 100-continue\r\n(Connection: Keep-Alive\r\n)?\r\n detector_id: 60797
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) Ryzerlo"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/panel/"; content:".php HTTP/"; content:"|0D||0A|Content-Type|3A| application/x-www-form-urlencoded|0D||0A|Host|3A| "; content:"|0D||0A|Content-Length|3A| "; content:"|0D||0A|Expect|3A| 100-continue|0D||0A|"; content:"|0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/panel\/[^.]+\.php HTTP\/\d\.\d\r\nContent-Type: application\/x-www-form-urlencoded\r\nHost: [^\r\n]+\r\nContent-Length: \d+\r\nExpect: 100-continue\r\n(Connection: Keep-Alive\r\n)?\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060797; rev:2824;)

# Command&Control: (Downloader) Nivdort - regex: to_server:POST /index\.php HTTP/1\.0\r\nAccept: \*/\*\r\nConnection: close\r\nHost: [^\r\n]+\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: \d+\r\n\r\n[a-z0-9]+=(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4}) detector_id: 60804
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Downloader) Nivdort"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/index.php HTTP/1.0|0D||0A|Accept|3A| |2A|/|2A||0D||0A|Connection|3A| close|0D||0A|Host|3A| "; content:"|0D||0A|Content-Type|3A| application/x-www-form-urlencoded|0D||0A|Content-Length|3A| "; content:"|0D||0A||0D||0A|"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/index\.php HTTP\/1\.0\r\nAccept: \*\/\*\r\nConnection: close\r\nHost: [^\r\n]+\r\nContent-Type: application\/x-www-form-urlencoded\r\nContent-Length: \d+\r\n\r\n[a-z0-9]+=(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{4})/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060804; rev:2830;)

# Adware: (PUA) SoftPulse - regex: to_server:GET / HTTP/\d\.\d\r\nAccept: \*/\*\r\nProxy-Authorization: [^\r\n]+\r\nUser-Agent: [^\r\n]+\r\nHost: [^\r\n]+\r\nConnection: Keep-Alive\r\n\r\n detector_id: 60825
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (PUA) SoftPulse"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/ HTTP/"; content:"|0D||0A|Accept|3A| |2A|/|2A||0D||0A|Proxy-Authorization|3A| "; content:"|0D||0A|User-Agent|3A| "; content:"|0D||0A|Host|3A| "; content:"|0D||0A|Connection|3A| Keep-Alive|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/ HTTP\/\d\.\d\r\nAccept: \*\/\*\r\nProxy-Authorization: [^\r\n]+\r\nUser-Agent: [^\r\n]+\r\nHost: [^\r\n]+\r\nConnection: Keep-Alive\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060825; rev:2895;)

# Command&Control: (Trojan) Neshta - regex: to_server:GET /analysis/(live|ins)\.php\?(pid=[^&]+&)?uq=([^&]+)?(&pid=[^&]+)? HTTP detector_id: 60827
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Neshta"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/analysis/"; content:".php?"; content:"uq="; content:" HTTP"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/analysis\/(live|ins)\.php\?(pid=[^&]+&)?uq=([^&]+)?(&pid=[^&]+)? HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060827; rev:2896;)

# Command&Control: (Trojan) Neshta - regex: to_server:POST /analysis/ins\.php\?(pid=[^&]+&uq={[A-Z0-9-]+}|uq={[A-Z0-9-]+}&pid=[^&]+) HTTP detector_id: 60828
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Neshta"; flow:established,to_server; content:"POST"; nocase; http_method; content:"POST "; content:"/analysis/ins.php?"; content:" HTTP"; pcre:"/POST (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/analysis\/ins\.php\?(pid=[^&]+&uq={[A-Z0-9-]+}|uq={[A-Z0-9-]+}&pid=[^&]+) HTTP/"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060828; rev:2896;)

# Adware: (Downware) DownloadAdmin - regex: to_server:GET /(?:env|install)\?(?:browserVersion=|productKey=)?(?=.*s=|.*variation=)(?=.*&brand=)(?=.*&pid=)(?=.*&bc=)(?=.*&country=).* HTTP.*(?i)User-Agent: [^\r\n]+\(ref=\[[a-f0-9]{40} detector_id: 60830
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) DownloadAdmin"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; nocase; content:" HTTP"; nocase; content:"User-Agent|3A| "; nocase; content:"|28|ref=|5B|"; nocase; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/(?:env|install)\?(?:browserVersion=|productKey=)?(?=.*s=|.*variation=)(?=.*&brand=)(?=.*&pid=)(?=.*&bc=)(?=.*&country=).* HTTP.*(?i)User-Agent: [^\r\n]+\(ref=\[[a-f0-9]{40}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060830; rev:2898;)

# Command&Control: (Trojan) Microsoft Word Intruder - regex: to_server:GET /[a-zA-Z0-9/]+\.(php|jpg)\?id=[1-9][0-9]{7}(?:&act=\d)? HTTP[^\r\n]+\r\nAccept: \*/\*\r\nUser-Agent: [^\r\n]+office.+Connection: Keep-Alive\r\n\r\n||to_client:HTTP/\d\.\d 200 OK\r\n.*Content-Type: image/.*\r\n\r\n detector_id: 60833
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Microsoft Word Intruder (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"?id="; content:" HTTP"; content:"|0D||0A|Accept|3A| |2A|/|2A||0D||0A|User-Agent|3A| "; content:"office"; content:"Connection|3A| Keep-Alive|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/[a-zA-Z0-9\/]+\.(php|jpg)\?id=[1-9][0-9]{7}(?:&act=\d)? HTTP[^\r\n]+\r\nAccept: \*\/\*\r\nUser-Agent: [^\r\n]+office.+Connection: Keep-Alive\r\n\r\n/s"; flowbits:set,LL.60833_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106083300; rev:2898;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Trojan) Microsoft Word Intruder (1)"; flowbits:isset,LL.60833_0; flow:established,to_client; content:"HTTP/"; content:" 200 OK|0D||0A|"; content:"Content-Type|3A| image/"; content:"|0D||0A||0D||0A|"; pcre:"/HTTP\/\d\.\d 200 OK\r\n.*Content-Type: image\/.*\r\n\r\n/s"; flowbits:unset,LL.60833_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106083301; rev:2898;)

# Adware: (Downware) ChinAd - regex: to_server:GET /advert/get\.php\?(ver=\d&)?type=\d&name=.+&site=\d HTTP/\d\.\d\r\nHost: [^\r\n]+\r\nConnection: Keep-Alive(\r\nCache-Control: no-cache)?\r\n\r\n detector_id: 60842
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) ChinAd"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/advert/get.php?"; content:"type="; content:"&name="; content:"&site="; content:" HTTP/"; content:"|0D||0A|Host|3A| "; content:"|0D||0A|Connection|3A| Keep-Alive"; content:"|0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/advert\/get\.php\?(ver=\d&)?type=\d&name=.+&site=\d HTTP\/\d\.\d\r\nHost: [^\r\n]+\r\nConnection: Keep-Alive(\r\nCache-Control: no-cache)?\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060842; rev:2912;)

# Adware: (Downware) ChinAd - regex: to_server:GET /soft\.xml HTTP/\d\.\d\r\nHost: [^\r\n]+\r\nUser-Agent: NSISDL/1\.2 \(Mozilla\)\r\nAccept: \*/\*\r\n\r\n detector_id: 60843
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Downware) ChinAd"; flow:established,to_server; content:"GET"; nocase; http_method; content:"GET "; content:"/soft.xml HTTP/"; content:"|0D||0A|Host|3A| "; content:"|0D||0A|User-Agent|3A| NSISDL/1.2 |28|Mozilla|29||0D||0A|Accept|3A| |2A|/|2A||0D||0A||0D||0A|"; pcre:"/GET (?:http(s)?|HTTP(S)?:\/\/[^\/ ]+)?\/soft\.xml HTTP\/\d\.\d\r\nHost: [^\r\n]+\r\nUser-Agent: NSISDL\/1\.2 \(Mozilla\)\r\nAccept: \*\/\*\r\n\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060843; rev:2912;)

# Command&Control: (Backdoor) Refpron - regex: to_server:^\x00{2}x\xe3\x00{2}.{2}\x00{3}.\d.\d_downer.exe detector_id: 310
alert tcp $HOME_NET any -> $EXTERNAL_NET 8792 (msg:"OpenBDS Command&Control: (Backdoor) Refpron"; flow:established,to_server,only_stream; content:"|00 00|x|E3 00 00|"; depth:6; content:"|00 00 00|"; distance:2; within:5; content:"_downer"; distance:4; within:11; content:"exe"; distance:1; within:4; pcre:"/^\x00{2}x\xe3\x00{2}.{2}\x00{3}.\d.\d_downer.exe/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000310; rev:0;)

# Command&Control: (Ransomware) Reveton - regex: to_server:^\x9a\x02\x00\x00.\d{11}.{9}\x00{3}.\x00{3} detector_id: 311
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) Reveton"; flow:established,to_server,only_stream; content:"|9A 02 00 00|"; depth:4; content:"|00 00 00|"; distance:21; within:24; content:"|00 00 00|"; distance:1; within:4; pcre:"/^\x9a\x02\x00\x00.\d{11}.{9}\x00{3}.\x00{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000311; rev:0;)

# Command&Control: (Backdoor) Heolag - regex: to_server:^\x01pc\d+\x00+$ detector_id: 312
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Heolag"; flow:established,to_server,only_stream; content:"|01|pc"; depth:3; content:"|00|"; distance:0; pcre:"/^\x01pc\d+\x00+$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000312; rev:0;)

# Command&Control: (Trojan) Pushdo - regex: to_server:^\x01\x00{3}.{4}\x15\xc8\xfc\x31\x95\x20\x3f\x19 detector_id: 313
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Pushdo"; flow:established,to_server,only_stream; content:"|01 00 00 00|"; depth:4; content:"|15 C8 FC|1|95| ?|19|"; distance:4; within:12; pcre:"/^\x01\x00{3}.{4}\x15\xc8\xfc\x31\x95\x20\x3f\x19/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000313; rev:0;)

# Command&Control: (Trojan) Cutwail - regex: to_server:^.{2}\x00{2}.{5}\x00{11}\x05\x01\x28\x0a.\x00{7} detector_id: 315
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Cutwail"; flow:established,to_server,only_stream; content:"|00 00|"; offset:2; depth:4; content:"|00 00 00 00 00 00 00 00 00 00 00 05 01 28 0A|"; distance:5; within:20; content:"|00 00 00 00 00 00 00|"; distance:1; within:8; pcre:"/^.{2}\x00{2}.{5}\x00{11}\x05\x01\x28\x0a.\x00{7}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000315; rev:0;)

# Command&Control: (Trojan) Bifrose - regex: to_server:^.{5}-\xd6g\xccD.{4}\xb2K\xd5\xe4\x9c\x8a\xf2\x91\x97\x11\xb0D detector_id: 316
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bifrose"; flow:established,to_server,only_stream; content:"-|D6|g|CC|D"; offset:5; depth:10; content:"|B2|K|D5 E4 9C 8A F2 91 97 11 B0|D"; distance:4; within:16; pcre:"/^.{5}-\xd6g\xccD.{4}\xb2K\xd5\xe4\x9c\x8a\xf2\x91\x97\x11\xb0D/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000316; rev:0;)

# Command&Control: (Trojan) Bifrose - regex: to_server:^.{2}\x00{2}.{2}\xb9\x74\xe2\x75\x94\x0a\x5a\xf3\xe3\x46 detector_id: 317
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bifrose"; flow:established,to_server,only_stream; content:"|00 00|"; offset:2; depth:4; content:"|B9|t|E2|u|94 0A|Z|F3 E3|F"; distance:2; within:12; pcre:"/^.{2}\x00{2}.{2}\xb9\x74\xe2\x75\x94\x0a\x5a\xf3\xe3\x46/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000317; rev:0;)

# Command&Control: (Trojan) Zegost - regex: to_server:^Gh0st.{2}\x00{2}.{2}\x00{2}[a-zA-Z] detector_id: 318
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Gh0st"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^Gh0st.{2}\x00{2}.{2}\x00{2}[a-zA-Z]/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000318; rev:0;)

# Command&Control: (Trojan) PoisonIvy - regex: to_server:^k\xb0\x041\x9f0\xc1\xb8\xca\xc5\x2c\xa1 detector_id: 319
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) PoisonIvy"; flow:established,to_server,only_stream; content:"k|B0 04|1|9F|0|C1 B8 CA C5 2C A1|"; depth:12; pcre:"/^k\xb0\x041\x9f0\xc1\xb8\xca\xc5\x2c\xa1/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000319; rev:0;)

# Command&Control: (Backdoor) PcClient - regex: to_server:^\x00{3}\x11.\x00{3}.{11}(.)\1{29} detector_id: 320
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) PcClient"; flow:established,to_server,only_stream; content:"|00 00 00 11|"; depth:4; content:"|00 00 00|"; distance:1; within:4; pcre:"/^\x00{3}\x11.\x00{3}.{11}(.)\1{29}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000320; rev:0;)

# Command&Control: (Backdoor) PcClient - regex: to_server:^.\xe8\xf7\xf7.*\xf7\xf7\xf7\xf7 detector_id: 321
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) PcClient"; flow:established,to_server,only_stream; content:"|E8 F7 F7|"; offset:1; depth:4; content:"|F7 F7 F7 F7|"; distance:0; pcre:"/^.\xe8\xf7\xf7.*\xf7\xf7\xf7\xf7/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000321; rev:0;)

# Command&Control: (Trojan) Lethic - regex: to_server:^(.{3}).!\x01\1 detector_id: 323
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Lethic"; flow:established,to_server,only_stream; content:"|21 01|"; offset:4; depth:6; pcre:"/^(.{3}).!\x01\1/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000323; rev:0;)

# Command&Control: (Backdoor) PCRat - regex: to_server:^PCRat detector_id: 325
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) PCRat"; flow:established,to_server,only_stream; content:"PCRat"; depth:5; pcre:"/^PCRat/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000325; rev:0;)

# Command&Control: (Tool) CZ32ts - regex: to_server:^CMD PUTLINK detector_id: 327
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Tool) CZ32ts"; flow:established,to_server,only_stream; content:"CMD PUTLINK"; depth:11; pcre:"/^CMD PUTLINK/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000327; rev:0;)

# Command&Control: (Trojan) Prosti - regex: to_server:^MY\$YM detector_id: 328
alert tcp $HOME_NET any -> $EXTERNAL_NET 81 (msg:"OpenBDS Command&Control: (Trojan) Prosti"; flow:established,to_server,only_stream; content:"MY|24|YM"; depth:5; pcre:"/^MY\$YM/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000328; rev:0;)

# Command&Control: (Trojan) Bybz - regex: to_server:^\[S\]ADDNEW detector_id: 330
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bybz"; flow:established,to_server,only_stream; content:"|5B|S|5D|ADDNEW"; depth:9; pcre:"/^\[S\]ADDNEW/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000330; rev:0;)

# Command&Control: (DDOS) Storm - regex: to_server:^STORM:.*\|.*\|.*MB?\|.*[GM]Hz\| detector_id: 331
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (DDOS) Storm"; flow:established,to_server,only_stream; content:"STORM|3A|"; depth:6; content:"|7C|"; distance:0; content:"|7C|"; distance:0; content:"M"; distance:0; content:"|7C|"; distance:0; content:"GHz|7C|"; distance:0; pcre:"/^STORM:.*\|.*\|.*MB?\|.*[GM]Hz\|/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100033100; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (DDOS) Storm"; flow:established,to_server,only_stream; content:"STORM|3A|"; depth:6; content:"|7C|"; distance:0; content:"|7C|"; distance:0; content:"M"; distance:0; content:"|7C|"; distance:0; content:"MHz|7C|"; distance:0; pcre:"/^STORM:.*\|.*\|.*MB?\|.*[GM]Hz\|/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100033101; rev:0;)

# Command&Control: (Backdoor) Mielit - regex: to_server:^\$0&1.*\.[a-z]{2,4}$ detector_id: 332
alert tcp $HOME_NET any -> $EXTERNAL_NET 5011 (msg:"OpenBDS Command&Control: (Backdoor) Mielit"; flow:established,to_server,only_stream; content:"|24|0&1"; depth:4; content:"."; distance:0; pcre:"/^\$0&1.*\.[a-z]{2,4}$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000332; rev:0;)

# Command&Control: (Trojan) Bybz - regex: to_server:^\*\\SNEW\*/2\|\|\*\|\| detector_id: 333
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bybz"; flow:established,to_server,only_stream; content:"|2A 5C|SNEW|2A|/2|7C 7C 2A 7C 7C|"; depth:14; pcre:"/^\*\\SNEW\*\/2\|\|\*\|\|/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000333; rev:0;)

# Command&Control: (Dropper) Forcud - regex: to_server:^\x0c\x14\x00\x00\x00.{4}\x00{16}\x02 detector_id: 334
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Forcud"; flow:established,to_server,only_stream; content:"|0C 14 00 00 00|"; depth:5; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 02|"; distance:4; within:21; pcre:"/^\x0c\x14\x00\x00\x00.{4}\x00{16}\x02/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000334; rev:0;)

# Command&Control: (Backdoor) Nitol - regex: to_server:^\x01\x00{3}.*\x00{16}.*\x00{16}Windows.*\x00{16}\d+ MB.*\x00{16}\d+ MHz.*\x00{16} detector_id: 335
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Nitol"; flow:established,to_server,only_stream; content:"|01 00 00 00|"; depth:4; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|Windows"; distance:0; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; content:" MB"; distance:0; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; content:" MHz"; distance:0; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; pcre:"/^\x01\x00{3}.*\x00{16}.*\x00{16}Windows.*\x00{16}\d+ MB.*\x00{16}\d+ MHz.*\x00{16}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000335; rev:0;)

# Command&Control: (Spambot) GenericSpambot_2 - regex: to_server:^\x00{4}\xff{4}\?W\xff\xfd.\xfe\xff{2} detector_id: 338
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Spambot) GenericSpambot_2"; flow:established,to_server,only_stream; content:"|00 00 00 00 FF FF FF FF|?W|FF FD|"; depth:12; content:"|FE FF FF|"; distance:1; within:4; pcre:"/^\x00{4}\xff{4}\?W\xff\xfd.\xfe\xff{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000338; rev:0;)

# Command&Control: (Trojan) GenericTrojan_107 - regex: to_server:^[\x10-\x12]\x00{3}Windows XP\x00{2}.{18}\d+Mhz.*\d+\(M\) detector_id: 339
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_107"; flow:established,to_server,only_stream; content:"|00 00 00|Windows XP|00 00|"; offset:1; depth:16; content:"Mhz"; distance:0; content:"|28|M|29|"; distance:0; pcre:"/^[\x10-\x12]\x00{3}Windows XP\x00{2}.{18}\d+Mhz.*\d+\(M\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000339; rev:0;)

# Command&Control: (Trojan) Turkojan - regex: to_server:^ams[A-Z]+(\?|\|) detector_id: 341
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Turkojan"; flow:established,to_server,only_stream; content:"ams"; depth:3; content:"?"; distance:0; pcre:"/^ams[A-Z]+(\?|\|)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100034100; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Turkojan"; flow:established,to_server,only_stream; content:"ams"; depth:3; content:"|7C|"; distance:0; pcre:"/^ams[A-Z]+(\?|\|)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100034101; rev:0;)

# Command&Control: (Trojan) Turkojan - regex: to_server:^scrnxt detector_id: 343
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Turkojan"; flow:established,to_server,only_stream; content:"scrnxt"; depth:6; pcre:"/^scrnxt/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000343; rev:0;)

# Command&Control: (Trojan) Prosti - regex: to_server:^\x1c\x00{7}.{4}\xaa{4}.{4}\x80{2}.@ detector_id: 344
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Prosti"; flow:established,to_server,only_stream; content:"|1C 00 00 00 00 00 00 00|"; depth:8; content:"|AA AA AA AA|"; distance:4; within:8; content:"|80 80|"; distance:4; within:6; content:"|40|"; distance:1; within:2; pcre:"/^\x1c\x00{7}.{4}\xaa{4}.{4}\x80{2}.@/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000344; rev:0;)

# Command&Control: (Backdoor) SpyNet - regex: to_server:^oNF/nrbLQ48 detector_id: 347
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) SpyNet"; flow:established,to_server,only_stream; content:"oNF/nrbLQ48"; depth:11; pcre:"/^oNF\/nrbLQ48/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000347; rev:0;)

# Command&Control: (Trojan) GenericTrojan_108 - regex: to_server:^#\d+/\d+!$ detector_id: 348
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_108"; flow:established,to_server,only_stream; content:"|23|"; depth:1; content:"/"; distance:0; content:"|21|"; distance:0; pcre:"/^#\d+\/\d+!$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000348; rev:0;)

# Command&Control: (Trojan) Hupigon - regex: to_server:^MDAw\x0d\x0a detector_id: 349
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Hupigon"; flow:established,to_server,only_stream; content:"MDAw|0D 0A|"; depth:6; pcre:"/^MDAw\x0d\x0a/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000349; rev:0;)

# Command&Control: (Trojan) Drstwex - regex: to_server:^\x04\x00{2}\x01\x05\x00{4}\x07\x00\x01\x00\x04\x00{2} detector_id: 350
alert tcp $HOME_NET any -> $EXTERNAL_NET 8014 (msg:"OpenBDS Command&Control: (Trojan) Drstwex"; flow:established,to_server,only_stream; content:"|04 00 00 01 05 00 00 00 00 07 00 01 00 04 00 00|"; depth:16; pcre:"/^\x04\x00{2}\x01\x05\x00{4}\x07\x00\x01\x00\x04\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000350; rev:0;)

# Command&Control: (Trojan) Winspy - regex: to_server:^/L[A-Z0-9]{10}\-[A-Z0-9]{4}\-\d\x18 detector_id: 351
alert tcp $HOME_NET any -> $EXTERNAL_NET 14001 (msg:"OpenBDS Command&Control: (Trojan) Winspy"; flow:established,to_server,only_stream; content:"/L"; depth:2; content:"-"; distance:10; within:11; content:"-"; distance:4; within:5; content:"|18|"; distance:1; within:2; pcre:"/^\/L[A-Z0-9]{10}\-[A-Z0-9]{4}\-\d\x18/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000351; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^SERVER.*infoes detector_id: 352
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"SERVER"; depth:6; content:"infoes"; distance:0; pcre:"/^SERVER.*infoes/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000352; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^TRANSFER.*(BROWSEDRIVE|DOSCAP|REGISTRY|SEARCH) detector_id: 353
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"TRANSFER"; depth:8; content:"BROWSEDRIVE"; distance:0; pcre:"/^TRANSFER.*(BROWSEDRIVE|DOSCAP|REGISTRY|SEARCH)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100035300; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"TRANSFER"; depth:8; content:"DOSCAP"; distance:0; pcre:"/^TRANSFER.*(BROWSEDRIVE|DOSCAP|REGISTRY|SEARCH)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100035301; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"TRANSFER"; depth:8; content:"REGISTRY"; distance:0; pcre:"/^TRANSFER.*(BROWSEDRIVE|DOSCAP|REGISTRY|SEARCH)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100035302; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"TRANSFER"; depth:8; content:"SEARCH"; distance:0; pcre:"/^TRANSFER.*(BROWSEDRIVE|DOSCAP|REGISTRY|SEARCH)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100035303; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^SCREEN.*SCREEN.\d+ detector_id: 354
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"SCREEN"; depth:6; content:"SCREEN"; distance:0; pcre:"/^SCREEN.*SCREEN.\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000354; rev:0;)

# Command&Control: (Backdoor) Neglemir - regex: to_server:^#[0-9]<<<<<(BL|IDC|I@C) detector_id: 356
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Neglemir"; flow:established,to_server,only_stream; content:"|23|"; depth:1; content:"<<<<<BL"; distance:1; within:8; pcre:"/^#[0-9]<<<<<(BL|IDC|I@C)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100035600; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Neglemir"; flow:established,to_server,only_stream; content:"|23|"; depth:1; content:"<<<<<IDC"; distance:1; within:9; pcre:"/^#[0-9]<<<<<(BL|IDC|I@C)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100035601; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Neglemir"; flow:established,to_server,only_stream; content:"|23|"; depth:1; content:"<<<<<I|40|C"; distance:1; within:9; pcre:"/^#[0-9]<<<<<(BL|IDC|I@C)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100035602; rev:0;)

# Command&Control: (Backdoor) Poison - regex: to_server:^\xf7\xe4\xef\x19\x1d\x54\x01\xe6\xcf\x85\x9b\x54 detector_id: 357
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Poison"; flow:established,to_server,only_stream; content:"|F7 E4 EF 19 1D|T|01 E6 CF 85 9B|T"; depth:12; pcre:"/^\xf7\xe4\xef\x19\x1d\x54\x01\xe6\xcf\x85\x9b\x54/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000357; rev:0;)

# Command&Control: (Trojan) Apotriphis - regex: to_server:^q\x00{15}\x02\x00{3}\x05\x00{3} detector_id: 358
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Apotriphis"; flow:established,to_server,only_stream; content:"q|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 02 00 00 00 05 00 00 00|"; depth:24; pcre:"/^q\x00{15}\x02\x00{3}\x05\x00{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000358; rev:0;)

# Command&Control: (Backdoor) Darkshell - regex: to_server:^\xb4{128}.{3}qr detector_id: 561
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Darkshell"; flow:established,to_server,only_stream; content:"|B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4 B4|"; depth:128; content:"qr"; distance:3; within:5; pcre:"/^\xb4{128}.{3}qr/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000561; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^BE6CBE87AE094 detector_id: 568
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"BE6CBE87AE094"; depth:13; pcre:"/^BE6CBE87AE094/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000568; rev:0;)

# Command&Control: (Backdoor) Darkshell - regex: to_server:.{2}\xb8{24,}\xc9\xca\xc0\x6d\x7a\xb8+\x67\x91\x8e\xd8\x60\x68\xb8+\x62\x82\x90\xb8*\xe1\xb7\xb8+ detector_id: 768
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Darkshell"; flow:established,to_server,only_stream; content:"|B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 C9 CA C0|mz|B8|g|91 8E D8 60|h|B8|b|82 90|"; content:"|E1 B7 B8|"; distance:0; pcre:"/.{2}\xb8{24,}\xc9\xca\xc0\x6d\x7a\xb8+\x67\x91\x8e\xd8\x60\x68\xb8+\x62\x82\x90\xb8*\xe1\xb7\xb8+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000768; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^0B65865397F9314EB26AB7D8 detector_id: 769
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"0B65865397F9314EB26AB7D8"; depth:24; pcre:"/^0B65865397F9314EB26AB7D8/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000769; rev:0;)

# Command&Control: (Trojan) Hioles - regex: to_server:^\x85\xb2\x04\x77\xce\x38\xe0\x33\x04\x01.{2}\x00\x00.*\x32\xbb\xef detector_id: 770
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Hioles"; flow:established,to_server,only_stream; content:"|85 B2 04|w|CE|8|E0|3|04 01|"; depth:10; content:"|00 00|"; distance:2; within:4; content:"2|BB EF|"; distance:0; pcre:"/^\x85\xb2\x04\x77\xce\x38\xe0\x33\x04\x01.{2}\x00\x00.*\x32\xbb\xef/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000770; rev:0;)

# Command&Control: (Trojan) Usteal - regex: to_server:^USER.*\x0d\x0aPASS.*\x0d\x0a.*(MKD|CWD) UFR_Stealer detector_id: 773
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 (msg:"OpenBDS Command&Control: (Trojan) Usteal"; flow:established,to_server,only_stream; content:"USER"; depth:4; content:"|0D 0A|PASS"; distance:0; content:"|0D 0A|"; distance:0; content:"MKD UFR_Stealer"; distance:0; pcre:"/^USER.*\x0d\x0aPASS.*\x0d\x0a.*(MKD|CWD) UFR_Stealer/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100077300; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 (msg:"OpenBDS Command&Control: (Trojan) Usteal"; flow:established,to_server,only_stream; content:"USER"; depth:4; content:"|0D 0A|PASS"; distance:0; content:"|0D 0A|"; distance:0; content:"CWD UFR_Stealer"; distance:0; pcre:"/^USER.*\x0d\x0aPASS.*\x0d\x0a.*(MKD|CWD) UFR_Stealer/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100077301; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^0C688148909[0-9A-F]9[0-9A-F]E[0-9A-F]A[0-9A-F]x detector_id: 790
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"0C688148909"; depth:11; content:"9"; distance:1; within:2; content:"E"; distance:1; within:2; content:"A"; distance:1; within:2; content:"x"; distance:1; within:2; pcre:"/^0C688148909[0-9A-F]9[0-9A-F]E[0-9A-F]A[0-9A-F]x/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000790; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^1B6F9A5180E4E091D2C detector_id: 791
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"1B6F9A5180E4E091D2C"; depth:19; pcre:"/^1B6F9A5180E4E091D2C/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000791; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^(KEEPALIVE\d+)+$ detector_id: 795
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"KEEPALIVE"; depth:9; pcre:"/^(KEEPALIVE\d+)+$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000795; rev:0;)

# Command&Control: (Backdoor) BlackShades - regex: to_server:^\d+\x0c\d+\x0c\d+\x0c.*\x0cPC\x0cAdministrator\x0c detector_id: 796
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) BlackShades"; flow:established,to_server,only_stream; content:"|0C|"; content:"|0C|"; distance:0; content:"|0C|"; distance:0; content:"|0C|PC|0C|Administrator|0C|"; distance:0; pcre:"/^\d+\x0c\d+\x0c\d+\x0c.*\x0cPC\x0cAdministrator\x0c/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000796; rev:0;)

# Command&Control: (Trojan) Sefbov - regex: to_server:^.{2}xt\x00.[\x03-\x04]\x00{2}$ detector_id: 797
alert tcp $HOME_NET any -> $EXTERNAL_NET 3000 (msg:"OpenBDS Command&Control: (Trojan) Sefbov"; flow:established,to_server,only_stream; content:"xt|00|"; offset:2; depth:5; content:"|03 00 00|"; distance:0; pcre:"/^.{2}xt\x00.[\x03-\x04]\x00{2}$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100079700; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3000 (msg:"OpenBDS Command&Control: (Trojan) Sefbov"; flow:established,to_server,only_stream; content:"xt|00|"; offset:2; depth:5; content:"|04 00 00|"; distance:0; pcre:"/^.{2}xt\x00.[\x03-\x04]\x00{2}$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100079701; rev:0;)

# Command&Control: (Trojan) Sefbov - regex: to_server:^.{2}\x00{2}\x01\x05\x00\x05\x00\x00\x01\x7F\x00\x00\x01\x04.HTTP/1.1 \d+ detector_id: 798
alert tcp $HOME_NET any -> $EXTERNAL_NET 3000 (msg:"OpenBDS Command&Control: (Trojan) Sefbov"; flow:established,to_server,only_stream; content:"|00 00 01 05 00 05 00 00 01 7F 00 00 01 04|"; offset:2; depth:16; content:"HTTP/1"; distance:1; within:7; content:"1 "; distance:1; within:3; pcre:"/^.{2}\x00{2}\x01\x05\x00\x05\x00\x00\x01\x7F\x00\x00\x01\x04.HTTP\/1.1 \d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000798; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^0F5DAB3EB30835769F079329[0-9A-F][0-9A-F][0-9A-F][0-9A-F]4E detector_id: 799
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"0F5DAB3EB30835769F079329"; depth:24; content:"4E"; distance:4; within:6; pcre:"/^0F5DAB3EB30835769F079329[0-9A-F][0-9A-F][0-9A-F][0-9A-F]4E/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000799; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^0850AC25B46BC[0-9A-F]B[0-9A-F]1[0-9A-F] detector_id: 800
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"0850AC25B46BC"; depth:13; content:"B"; distance:1; within:2; content:"1"; distance:1; within:2; pcre:"/^0850AC25B46BC[0-9A-F]B[0-9A-F]1[0-9A-F]/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000800; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^185DAA23A215A7F357570[0-9A-F]2[0-9A-F]{3}6B58.*JFIF detector_id: 801
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"185DAA23A215A7F357570"; depth:21; content:"2"; distance:1; within:2; content:"6B58"; distance:3; within:7; content:"JFIF"; distance:0; pcre:"/^185DAA23A215A7F357570[0-9A-F]2[0-9A-F]{3}6B58.*JFIF/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000801; rev:0;)

# Command&Control: (Trojan) Hioles - regex: to_server:^\xac\x6b\xbe\x56\x1a\xeb\x14\x28\x01\x00{3} detector_id: 802
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"OpenBDS Command&Control: (Trojan) Hioles"; flow:established,to_server,only_stream; content:"|AC|k|BE|V|1A EB 14 28 01 00 00 00|"; depth:12; pcre:"/^\xac\x6b\xbe\x56\x1a\xeb\x14\x28\x01\x00{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000802; rev:0;)

# Command&Control: (Trojan) Chebri - regex: to_server:^\x02\x01\x00{14}\x06\x5c\x36\x00{2}\x21\x01\x5c\x36\x00{2}\x03\x2b\x00 detector_id: 803
alert tcp $HOME_NET any -> $EXTERNAL_NET 20001 (msg:"OpenBDS Command&Control: (Trojan) Chebri"; flow:established,to_server,only_stream; content:"|02 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 06 5C|6|00 00 21 01 5C|6|00 00 03 2B 00|"; depth:30; pcre:"/^\x02\x01\x00{14}\x06\x5c\x36\x00{2}\x21\x01\x5c\x36\x00{2}\x03\x2b\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000803; rev:0;)

# Command&Control: (Trojan) Zegost - regex: to_server:^cb1st[\x00-\xff]\x02\x00\x00\x1f\x05\x00\x00x.*\x9cKc detector_id: 809
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"cb1st"; depth:5; content:"|02 00 00 1F 05 00 00|x"; distance:1; within:9; content:"|9C|Kc"; distance:0; pcre:"/^cb1st[\x00-\xff]\x02\x00\x00\x1f\x05\x00\x00x.*\x9cKc/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000809; rev:0;)

# Command&Control: (Trojan) Zegost - regex: to_server:^[A-Za-z0-9]{5}.{2}\x00{2}.{2}\x00{2}x\x9c detector_id: 810
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"|00 00|"; offset:7; depth:9; content:"|00 00|x|9C|"; distance:2; within:6; pcre:"/^[A-Za-z0-9]{5}.{2}\x00{2}.{2}\x00{2}x\x9c/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000810; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^94A5AD0AEF69AE8E9933CF48 detector_id: 846
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"94A5AD0AEF69AE8E9933CF48"; depth:24; pcre:"/^94A5AD0AEF69AE8E9933CF48/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000846; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^1C65874E86E4FCE[\x00-\xff]*JFIF detector_id: 847
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"1C65874E86E4FCE"; depth:15; content:"JFIF"; distance:0; pcre:"/^1C65874E86E4FCE[\x00-\xff]*JFIF/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000847; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^F5B3BC0EEF7ED9C.*JFIF detector_id: 848
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"F5B3BC0EEF7ED9C"; depth:15; content:"JFIF"; distance:0; pcre:"/^F5B3BC0EEF7ED9C.*JFIF/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000848; rev:0;)

# Command&Control: (Dialer) Smabo - regex: to_server:^\x02\x00\xC8\x00{5}\x40\x00\x09\x00{3}\x04\x00{3}\x01\x00\x08\x00{3}\x04j2me\x00\x07\x00{3}\x09J2MEv detector_id: 867
alert tcp $HOME_NET any -> $EXTERNAL_NET 9119 (msg:"OpenBDS Command&Control: (Dialer) Smabo"; flow:established,to_server,only_stream; content:"|02 00 C8 00 00 00 00 00 40 00 09 00 00 00 04 00 00 00 01 00 08 00 00 00 04|j2me|00 07 00 00 00 09|J2MEv"; depth:40; pcre:"/^\x02\x00\xC8\x00{5}\x40\x00\x09\x00{3}\x04\x00{3}\x01\x00\x08\x00{3}\x04j2me\x00\x07\x00{3}\x09J2MEv/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000867; rev:0;)

# FakeAV: GenericFakeAV_11 - regex: to_server:^Han~RO detector_id: 868
alert tcp $HOME_NET any -> $EXTERNAL_NET 12000 (msg:"OpenBDS FakeAV: GenericFakeAV_11"; flow:established,to_server,only_stream; content:"Han|7E|RO"; depth:6; pcre:"/^Han~RO/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000868; rev:0;)

# Command&Control: (Trojan) ZeroAccess - regex: to_server:^\xe5\xaa\xc0\x31[\x00-\xff]{4}\x31\x5b\x74\x08\x4d\x9b\x39\xc1 detector_id: 869
alert tcp $HOME_NET any -> $EXTERNAL_NET 22292 (msg:"OpenBDS Command&Control: (Trojan) ZeroAccess"; flow:established,to_server,only_stream; content:"|E5 AA C0|1"; depth:4; content:"1|5B|t|08|M|9B|9|C1|"; distance:4; within:12; pcre:"/^\xe5\xaa\xc0\x31[\x00-\xff]{4}\x31\x5b\x74\x08\x4d\x9b\x39\xc1/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000869; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^[0-9A-F]{16}x\x9c\xedZoL detector_id: 870
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"x|9C ED|ZoL"; offset:16; depth:22; pcre:"/^[0-9A-F]{16}x\x9c\xedZoL/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000870; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^A57DAD495BEC9F5699707BCD detector_id: 915
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"A57DAD495BEC9F5699707BCD"; depth:24; pcre:"/^A57DAD495BEC9F5699707BCD/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000915; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^B577B14B4CF1C3FB7B detector_id: 916
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"B577B14B4CF1C3FB7B"; depth:18; pcre:"/^B577B14B4CF1C3FB7B/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000916; rev:0;)

# Command&Control: (Trojan) Bifrose - regex: to_server:XmaininfoX|Coffin Of Evil detector_id: 917
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bifrose"; flow:established,to_server,only_stream; content:"XmaininfoX"; pcre:"/XmaininfoX|Coffin Of Evil/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100091700; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bifrose"; flow:established,to_server,only_stream; content:"Coffin Of Evil"; pcre:"/XmaininfoX|Coffin Of Evil/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100091701; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^B279AB5E58F2DAEA detector_id: 918
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"B279AB5E58F2DAEA"; depth:16; pcre:"/^B279AB5E58F2DAEA/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000918; rev:0;)

# Command&Control: (Dropper) Metsiseyt - regex: to_server:^\x0d\x0aActive Connections\x0d\x0a\x0d\x0a detector_id: 919
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Metsiseyt"; flow:established,to_server,only_stream; content:"|0D 0A|Active Connections|0D 0A 0D 0A|"; depth:24; pcre:"/^\x0d\x0aActive Connections\x0d\x0a\x0d\x0a/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000919; rev:0;)

# Command&Control: (Rootkit) GenericRootkit_1 - regex: to_server:In SSDT01DriverUnload ! detector_id: 927
alert tcp $HOME_NET any -> $EXTERNAL_NET 22555 (msg:"OpenBDS Command&Control: (Rootkit) GenericRootkit_1"; flow:established,to_server,only_stream; content:"In SSDT01DriverUnload |21|"; pcre:"/In SSDT01DriverUnload !/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000927; rev:0;)

# Command&Control: (Spambot) GenericSpambot_3 - regex: to_server:^[B|D]\x00{2}\x01\x8d\xa2\x00{5}\x40\x08\x00{23}[sender|searcher] detector_id: 928
alert tcp $HOME_NET any -> $EXTERNAL_NET 3306 (msg:"OpenBDS Command&Control: (Spambot) GenericSpambot_3"; flow:established,to_server,only_stream; content:"|00 00 01 8D A2 00 00 00 00 00 40 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; offset:1; depth:36; pcre:"/^[B|D]\x00{2}\x01\x8d\xa2\x00{5}\x40\x08\x00{23}[sender|searcher]/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000928; rev:0;)

# Command&Control: (Trojan) Usteal - regex: to_server:^UFR!.{8}\x00{4}\x2c\x00{3}\x08\x02\x00{2}\x10\x66\x00{2}\x20\x00{3} detector_id: 929
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Usteal"; flow:established,to_server,only_stream; content:"UFR|21|"; depth:4; content:"|00 00 00 00 2C 00 00 00 08 02 00 00 10|f|00 00| |00 00 00|"; distance:8; within:28; pcre:"/^UFR!.{8}\x00{4}\x2c\x00{3}\x08\x02\x00{2}\x10\x66\x00{2}\x20\x00{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000929; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^[A-F0-9]{16,18}x\x9c\xed detector_id: 931
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"x|9C ED|"; pcre:"/^[A-F0-9]{16,18}x\x9c\xed/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000931; rev:0;)

# Command&Control: (Backdoor) BlackShades - regex: to_server:^\d+\x0c\d+\x0c\d+\x0cCD.KEY\x0bMicrosoft Windows detector_id: 933
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) BlackShades"; flow:established,to_server,only_stream; content:"|0C|"; content:"|0C|"; distance:0; content:"|0C|CD"; distance:0; content:"KEY|0B|Microsoft Windows"; distance:1; within:22; pcre:"/^\d+\x0c\d+\x0c\d+\x0cCD.KEY\x0bMicrosoft Windows/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000933; rev:0;)

# Command&Control: (Trojan) Chebri - regex: to_server:^\x02\x01\x00*[\x00-\xff]{4}\x00! detector_id: 934
alert tcp $HOME_NET any -> $EXTERNAL_NET 20001 (msg:"OpenBDS Command&Control: (Trojan) Chebri"; flow:established,to_server,only_stream; content:"|02 01|"; depth:2; content:"|00 21|"; distance:0; pcre:"/^\x02\x01\x00*[\x00-\xff]{4}\x00!/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000934; rev:0;)

# Command&Control: (Trojan) Gee - regex: to_server:^Login:[a-z]@[a-z] detector_id: 935
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Gee"; flow:established,to_server,only_stream; content:"Login|3A|"; depth:6; content:"|40|"; distance:1; within:2; pcre:"/^Login:[a-z]@[a-z]/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000935; rev:0;)

# Command&Control: (Trojan) Usteal - regex: to_server:^UFR!.\x00{3}.\x9c\xca detector_id: 936
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Usteal"; flow:established,to_server,only_stream; content:"UFR|21|"; depth:4; content:"|00 00 00|"; distance:1; within:4; content:"|9C CA|"; distance:1; within:3; pcre:"/^UFR!.\x00{3}.\x9c\xca/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000936; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^[A-F0-9]{20,}\xff\xd8\xff\xe0\x00\x10JFIF detector_id: 938
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"|FF D8 FF E0 00 10|JFIF"; pcre:"/^[A-F0-9]{20,}\xff\xd8\xff\xe0\x00\x10JFIF/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000938; rev:0;)

# Command&Control: (Trojan) GenericTrojan_110 - regex: to_server:^\xfd\xfd\x00{5}\x18\x00{3}\x18\x00{6}\x01 detector_id: 939
alert tcp $HOME_NET any -> $EXTERNAL_NET 9906 (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_110"; flow:established,to_server,only_stream; content:"|FD FD 00 00 00 00 00 18 00 00 00 18 00 00 00 00 00 00 01|"; depth:19; pcre:"/^\xfd\xfd\x00{5}\x18\x00{3}\x18\x00{6}\x01/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000939; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}\xa4\x68.{20}\x37\xbe\x4d\x01 detector_id: 940
alert tcp $HOME_NET any -> $EXTERNAL_NET 20369 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|A4|h"; offset:2; depth:4; content:"7|BE|M|01|"; distance:20; within:24; pcre:"/^.{2}\xa4\x68.{20}\x37\xbe\x4d\x01/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000940; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^THUMB\d+\xff\xd8\xff\xe0\x00\x10JFIF detector_id: 941
alert tcp $HOME_NET any -> $EXTERNAL_NET 1604 (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"THUMB"; depth:5; content:"|FF D8 FF E0 00 10|JFIF"; distance:0; pcre:"/^THUMB\d+\xff\xd8\xff\xe0\x00\x10JFIF/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000941; rev:0;)

# Command&Control: (Trojan)  Cospet - regex: to_server:^v1ct1m\[.AS.\] detector_id: 942
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan)  Cospet"; flow:established,to_server,only_stream; content:"v1ct1m|5B|"; depth:7; content:"AS"; distance:1; within:3; content:"|5D|"; distance:1; within:2; pcre:"/^v1ct1m\[.AS.\]/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000942; rev:0;)

# Command&Control: (Backdoor) Darkshell - regex: to_server:^\xb8{128}.{3}mz detector_id: 943
alert tcp $HOME_NET any -> $EXTERNAL_NET 8000 (msg:"OpenBDS Command&Control: (Backdoor) Darkshell"; flow:established,to_server,only_stream; content:"|B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8 B8|"; depth:128; content:"mz"; distance:3; within:5; pcre:"/^\xb8{128}.{3}mz/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000943; rev:0;)

# Command&Control: (Trojan) Ramnit - regex: to_server:^\x00\xff\x4b\x00{3}\xe2\x00\x20\x00{3} detector_id: 960
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ramnit"; flow:established,to_server,only_stream; content:"|00 FF|K|00 00 00 E2 00| |00 00 00|"; depth:12; pcre:"/^\x00\xff\x4b\x00{3}\xe2\x00\x20\x00{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000960; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.NR\{ detector_id: 961
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"NR|7B|"; offset:1; depth:4; pcre:"/^.NR\{/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000961; rev:0;)

# Command&Control: (Virus) Selfish - regex: to_server:^\x45\x00\x00\x01\xad\xe2\x03\x00{4}\x01\x08\x00{23}kodi\d+ detector_id: 962
alert tcp $HOME_NET any -> $EXTERNAL_NET 3306 (msg:"OpenBDS Command&Control: (Virus) Selfish"; flow:established,to_server,only_stream; content:"E|00 00 01 AD E2 03 00 00 00 00 01 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|kodi"; depth:40; pcre:"/^\x45\x00\x00\x01\xad\xe2\x03\x00{4}\x01\x08\x00{23}kodi\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000962; rev:0;)

# Command&Control: (Trojan) Hupigon - regex: to_server:^\x00{4}.{12}\x00{16}.*Windows.*\x00{32}.*[^\x00]+\x00\x00$ detector_id: 977
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Hupigon"; flow:established,to_server,only_stream; content:"|00 00 00 00|"; depth:4; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:12; within:28; content:"Windows"; distance:0; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; content:"|00 00|"; distance:0; pcre:"/^\x00{4}.{12}\x00{16}.*Windows.*\x00{32}.*[^\x00]+\x00\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1000977; rev:0;)

# Command&Control: (Backdoor) BackHole - regex: to_server:^\x00{3}\x20[0-9a-f]+\x00{3}[0-9a-zA-Z+=]+\x00\x00\x00\([0-9A-F]+ detector_id: 1004
alert tcp $HOME_NET any -> $EXTERNAL_NET 2046 (msg:"OpenBDS Command&Control: (Backdoor) BackHole"; flow:established,to_server,only_stream; content:"|00 00 00| "; depth:4; content:"|00 00 00|"; distance:0; content:"|00 00 00 28|"; distance:0; pcre:"/^\x00{3}\x20[0-9a-f]+\x00{3}[0-9a-zA-Z+=]+\x00\x00\x00\([0-9A-F]+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001004; rev:0;)

# Command&Control: (Backdoor) Nitol - regex: to_server:^\x01\x00{3}g&\x89&t&\x91&\x85&\x90&F&N&e&y&s&z&t&\x8d&\x85&M&{5} detector_id: 1292
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Nitol"; flow:established,to_server,only_stream; content:"|01 00 00 00|g&|89|&t&|91|&|85|&|90|&F&N&e&y&s&z&t&|8D|&|85|&M&&&&&"; depth:40; pcre:"/^\x01\x00{3}g&\x89&t&\x91&\x85&\x90&F&N&e&y&s&z&t&\x8d&\x85&M&{5}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001292; rev:0;)

# Command&Control: (Backdoor) Morix - regex: to_server:^0{8}.\x00{3}\x60\x01\x00{2}x\x9cKc\x60{2} detector_id: 1294
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Morix"; flow:established,to_server,only_stream; content:"00000000"; depth:8; content:"|00 00 00 60 01 00 00|x|9C|Kc|60 60|"; distance:1; within:14; pcre:"/^0{8}.\x00{3}\x60\x01\x00{2}x\x9cKc\x60{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001294; rev:0;)

# Command&Control: (Backdoor) Khelios  - regex: to_server:^\x0e\x81\xf5\x7e.\x81\xf5\x7e.\x81\xf5\x7e.[\x85-\x87]\xf5\x7e.[\x85-\x87]\xf5\x7e detector_id: 1295
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios "; flow:established,to_server,only_stream; content:"|0E 81 F5 7E|"; depth:4; content:"|81 F5 7E|"; distance:1; within:4; content:"|81 F5 7E|"; distance:1; within:4; content:"|F5 7E|"; distance:2; within:4; content:"|F5 7E|"; distance:2; within:4; pcre:"/^\x0e\x81\xf5\x7e.\x81\xf5\x7e.\x81\xf5\x7e.[\x85-\x87]\xf5\x7e.[\x85-\x87]\xf5\x7e/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001295; rev:0;)

# Command&Control: (Backdoor) Khelios  - regex: to_server:^\xf7\x80\x0c\x7f.\x81\x0c\x7f.\x81\x0c\x7f.[\x85-\x87]\x0c\x7f.[\x85-\x87]\x0c detector_id: 1296
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios "; flow:established,to_server,only_stream; content:"|F7 80 0C 7F|"; depth:4; content:"|81 0C 7F|"; distance:1; within:4; content:"|81 0C 7F|"; distance:1; within:4; content:"|0C 7F|"; distance:2; within:4; content:"|0C|"; distance:2; within:3; pcre:"/^\xf7\x80\x0c\x7f.\x81\x0c\x7f.\x81\x0c\x7f.[\x85-\x87]\x0c\x7f.[\x85-\x87]\x0c/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001296; rev:0;)

# Command&Control: (Trojan) Bladabindi - regex: to_server:^\S+\|\x27\|\x27\|.+\[endof\] detector_id: 1297
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bladabindi"; flow:established,to_server,only_stream; content:"|7C 27 7C 27 7C|"; content:"|5B|endof|5D|"; distance:0; pcre:"/^\S+\|\x27\|\x27\|.+\[endof\]/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001297; rev:0;)

# Command&Control: (Trojan) Bunitu - regex: to_server:\x00\x01{2}\x00{2}\x01\x00{6}[\x00-\xff]{4}\x05\x00[\x00-\xff]\x00[\x00-\xff]{8}\x00{8} detector_id: 1326
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bunitu"; flow:established,to_server,only_stream; content:"|00 01 01 00 00 01 00 00 00 00 00 00|"; content:"|05 00|"; distance:4; within:6; content:"|00|"; distance:1; within:2; content:"|00 00 00 00 00 00 00 00|"; distance:8; within:16; pcre:"/\x00\x01{2}\x00{2}\x01\x00{6}[\x00-\xff]{4}\x05\x00[\x00-\xff]\x00[\x00-\xff]{8}\x00{8}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001326; rev:0;)

# Command&Control: (Backdoor) Nitol - regex: to_server:^[\x64\x28]\x01\x00\x00\x77[\x00-\xff]+Windows \S+\x00+[0-9]{3,5} MB\x00+[0-9]{3,4} MHz\x00+[\x00-\xff]+\x00$ detector_id: 1667
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Nitol"; flow:established,to_server,only_stream; content:"d|01 00 00|w"; depth:5; content:"Windows "; distance:0; content:"|00|"; distance:0; content:" MB|00|"; distance:0; content:" MHz|00|"; distance:0; content:"|00|"; distance:0; pcre:"/^[\x64\x28]\x01\x00\x00\x77[\x00-\xff]+Windows \S+\x00+[0-9]{3,5} MB\x00+[0-9]{3,4} MHz\x00+[\x00-\xff]+\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100166700; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Nitol"; flow:established,to_server,only_stream; content:"|28 01 00 00|w"; depth:5; content:"Windows "; distance:0; content:"|00|"; distance:0; content:" MB|00|"; distance:0; content:" MHz|00|"; distance:0; content:"|00|"; distance:0; pcre:"/^[\x64\x28]\x01\x00\x00\x77[\x00-\xff]+Windows \S+\x00+[0-9]{3,5} MB\x00+[0-9]{3,4} MHz\x00+[\x00-\xff]+\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100166701; rev:0;)

# Command&Control: (Trojan) Hupigon - regex: to_server:^HGZ5\x01(<FT>.+</FT>)?(<IM>[0-9]+</IM>)?(<VER>.+</VER>)?.*</GR>.+<IP>.*</IP>(\x0d\x0a){2}$ detector_id: 1668
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Hupigon"; flow:established,to_server,only_stream; content:"HGZ5|01|"; depth:5; content:"</GR>"; distance:0; content:"<IP>"; distance:0; content:"</IP>|0D 0A 0D 0A|"; distance:0; pcre:"/^HGZ5\x01(<FT>.+<\/FT>)?(<IM>[0-9]+<\/IM>)?(<VER>.+<\/VER>)?.*<\/GR>.+<IP>.*<\/IP>(\x0d\x0a){2}$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001668; rev:0;)

# Command&Control: (Backdoor) Gupboot - regex: to_server:^\x0b\x02AS101.[\x00-\xff]+\xff\xff\xff\xff$ detector_id: 1669
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Gupboot"; flow:established,to_server,only_stream; content:"|0B 02|AS101"; depth:7; content:"|FF FF FF FF|"; distance:0; pcre:"/^\x0b\x02AS101.[\x00-\xff]+\xff\xff\xff\xff$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001669; rev:0;)

# Command&Control: (Trojan) Yoddos - regex: to_server:^.{32}\xb6{32}.{164,}[^\xb6]{4}$ detector_id: 1670
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Yoddos"; flow:established,to_server,only_stream; content:"|B6 B6 B6 B6 B6 B6 B6 B6 B6 B6 B6 B6 B6 B6 B6 B6 B6 B6 B6 B6 B6 B6 B6 B6 B6 B6 B6 B6 B6 B6 B6 B6|"; offset:32; depth:64; pcre:"/^.{32}\xb6{32}.{164,}[^\xb6]{4}$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001670; rev:0;)

# Command&Control: (Trojan) Zegost - regex: to_server:^YinLe(ee|KO).(\x00|\x01)\x00\x00..\x00\x00\x78 detector_id: 1671
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"YinLeee"; depth:7; content:"|00 00 00|"; distance:1; within:4; content:"|00 00|x"; distance:2; within:5; pcre:"/^YinLe(ee|KO).(\x00|\x01)\x00\x00..\x00\x00\x78/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100167100; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"YinLeKO"; depth:7; content:"|00 00 00|"; distance:1; within:4; content:"|00 00|x"; distance:2; within:5; pcre:"/^YinLe(ee|KO).(\x00|\x01)\x00\x00..\x00\x00\x78/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100167101; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"YinLeee"; depth:7; content:"|01 00 00|"; distance:1; within:4; content:"|00 00|x"; distance:2; within:5; pcre:"/^YinLe(ee|KO).(\x00|\x01)\x00\x00..\x00\x00\x78/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100167102; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"YinLeKO"; depth:7; content:"|01 00 00|"; distance:1; within:4; content:"|00 00|x"; distance:2; within:5; pcre:"/^YinLe(ee|KO).(\x00|\x01)\x00\x00..\x00\x00\x78/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100167103; rev:0;)

# Command&Control: (Backdoor) Nitol - regex: to_server:^\x64\x01\x00\x00\x77[\x00-\xff]+WinXP\x00+[0-9]{3,5} MB\x00+[0-9]{3,4} MHz\x00+[\x00-\xff]+\x00$ detector_id: 1678
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Nitol"; flow:established,to_server,only_stream; content:"d|01 00 00|w"; depth:5; content:"WinXP|00|"; distance:0; content:" MB|00|"; distance:0; content:" MHz|00|"; distance:0; content:"|00|"; distance:0; pcre:"/^\x64\x01\x00\x00\x77[\x00-\xff]+WinXP\x00+[0-9]{3,5} MB\x00+[0-9]{3,4} MHz\x00+[\x00-\xff]+\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001678; rev:0;)

# Command&Control: (Trojan) Ceatrg - regex: to_server:^\x44\x4d\x7f\x49\x51\x48\x50\x62\x7d\x74\x61\x77\x4e\x55\x32\x2f detector_id: 1679
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ceatrg"; flow:established,to_server,only_stream; content:"DM|7F|IQHPb|7D|tawNU2/"; depth:16; pcre:"/^\x44\x4d\x7f\x49\x51\x48\x50\x62\x7d\x74\x61\x77\x4e\x55\x32\x2f/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001679; rev:0;)

# Command&Control: (Trojan) GenericTrojan_109 - regex: to_server:^x0\x0c\d{3}\x0c[\S ]+\x0c\d+\.\d+\.\d+\.\d+ detector_id: 1680
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_109"; flow:established,to_server,only_stream; content:"x0|0C|"; depth:3; content:"|0C|"; distance:3; within:4; content:"|0C|"; distance:0; content:"."; distance:0; content:"."; distance:0; content:"."; distance:0; pcre:"/^x0\x0c\d{3}\x0c[\S ]+\x0c\d+\.\d+\.\d+\.\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001680; rev:0;)

# Command&Control: (Backdoor) Khelios - regex: to_server:^\x83{4}\x85...\x83\xa2\x82 detector_id: 1682
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|83 83 83 83 85|"; depth:5; content:"|83 A2 82|"; distance:3; within:6; pcre:"/^\x83{4}\x85...\x83\xa2\x82/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001682; rev:0;)

# Command&Control: (Backdoor) Nitol - regex: to_server:^\xe1\x00[\x00-\xff]+Windows \S+\x00+[0-9]{3,5} Mb\x00+[0-9]{3,4} Mhz\x00+[\x00-\xff]+ detector_id: 1685
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Nitol"; flow:established,to_server,only_stream; content:"|E1 00|"; depth:2; content:"Windows "; distance:0; content:"|00|"; distance:0; content:" Mb|00|"; distance:0; content:" Mhz|00|"; distance:0; pcre:"/^\xe1\x00[\x00-\xff]+Windows \S+\x00+[0-9]{3,5} Mb\x00+[0-9]{3,4} Mhz\x00+[\x00-\xff]+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001685; rev:0;)

# Command&Control: (Backdoor) Nitol - regex: to_server:^\x60\x01[\x00-\xff]+Windows \S+\x00+[0-9]{3,5} MB\x00+[0-9]{3,4} MHz\x00+[\x00-\xff]+\x00$ detector_id: 1687
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Nitol"; flow:established,to_server,only_stream; content:"|60 01|"; depth:2; content:"Windows "; distance:0; content:"|00|"; distance:0; content:" MB|00|"; distance:0; content:" MHz|00|"; distance:0; content:"|00|"; distance:0; pcre:"/^\x60\x01[\x00-\xff]+Windows \S+\x00+[0-9]{3,5} MB\x00+[0-9]{3,4} MHz\x00+[\x00-\xff]+\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001687; rev:0;)

# Command&Control: (Trojan) Hupigon - regex: to_server:^Y21kfA==\x0d\x0a detector_id: 1726
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Hupigon"; flow:established,to_server,only_stream; content:"Y21kfA==|0D 0A|"; depth:10; pcre:"/^Y21kfA==\x0d\x0a/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001726; rev:0;)

# Command&Control: (Trojan) Hupigon - regex: to_server:^\x00{4}.{40}Windows.{93}\$.{149}[A-Z]{4,}\x00{2} detector_id: 1727
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Hupigon"; flow:established,to_server,only_stream; content:"|00 00 00 00|"; depth:4; content:"Windows"; distance:40; within:47; content:"|24|"; distance:93; within:94; content:"|00 00|"; distance:0; pcre:"/^\x00{4}.{40}Windows.{93}\$.{149}[A-Z]{4,}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001727; rev:0;)

# Command&Control: (Trojan) Spyrat - regex: to_server:^\d+\|\x0d?\x0a(\x78\x5f|\xf4\x66\xf0|\xc7\x5f\xa5|\xb9\x71\x9c|\xa4\xcc\x24|\xa3\xc5\xec|\x70\xc0\xe4) detector_id: 1728
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Spyrat"; flow:established,to_server,only_stream; content:"|7C|"; content:"|0A|x_"; distance:0; pcre:"/^\d+\|\x0d?\x0a(\x78\x5f|\xf4\x66\xf0|\xc7\x5f\xa5|\xb9\x71\x9c|\xa4\xcc\x24|\xa3\xc5\xec|\x70\xc0\xe4)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100172800; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Spyrat"; flow:established,to_server,only_stream; content:"|7C|"; content:"|0A F4|f|F0|"; distance:0; pcre:"/^\d+\|\x0d?\x0a(\x78\x5f|\xf4\x66\xf0|\xc7\x5f\xa5|\xb9\x71\x9c|\xa4\xcc\x24|\xa3\xc5\xec|\x70\xc0\xe4)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100172801; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Spyrat"; flow:established,to_server,only_stream; content:"|7C|"; content:"|0A C7|_|A5|"; distance:0; pcre:"/^\d+\|\x0d?\x0a(\x78\x5f|\xf4\x66\xf0|\xc7\x5f\xa5|\xb9\x71\x9c|\xa4\xcc\x24|\xa3\xc5\xec|\x70\xc0\xe4)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100172802; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Spyrat"; flow:established,to_server,only_stream; content:"|7C|"; content:"|0A B9|q|9C|"; distance:0; pcre:"/^\d+\|\x0d?\x0a(\x78\x5f|\xf4\x66\xf0|\xc7\x5f\xa5|\xb9\x71\x9c|\xa4\xcc\x24|\xa3\xc5\xec|\x70\xc0\xe4)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100172803; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Spyrat"; flow:established,to_server,only_stream; content:"|7C|"; content:"|0A A4 CC 24|"; distance:0; pcre:"/^\d+\|\x0d?\x0a(\x78\x5f|\xf4\x66\xf0|\xc7\x5f\xa5|\xb9\x71\x9c|\xa4\xcc\x24|\xa3\xc5\xec|\x70\xc0\xe4)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100172804; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Spyrat"; flow:established,to_server,only_stream; content:"|7C|"; content:"|0A A3 C5 EC|"; distance:0; pcre:"/^\d+\|\x0d?\x0a(\x78\x5f|\xf4\x66\xf0|\xc7\x5f\xa5|\xb9\x71\x9c|\xa4\xcc\x24|\xa3\xc5\xec|\x70\xc0\xe4)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100172805; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Spyrat"; flow:established,to_server,only_stream; content:"|7C|"; content:"|0A|p|C0 E4|"; distance:0; pcre:"/^\d+\|\x0d?\x0a(\x78\x5f|\xf4\x66\xf0|\xc7\x5f\xa5|\xb9\x71\x9c|\xa4\xcc\x24|\xa3\xc5\xec|\x70\xc0\xe4)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100172806; rev:0;)

# Command&Control: (Trojan) Farfli - regex: to_server:^.[\x01\x00]\x00\x00.*KuGou detector_id: 1729
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Farfli"; flow:established,to_server,only_stream; content:"|01 00 00|"; offset:1; depth:4; content:"KuGou"; distance:0; pcre:"/^.[\x01\x00]\x00\x00.*KuGou/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100172900; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Farfli"; flow:established,to_server,only_stream; content:"|00 00 00|"; offset:1; depth:4; content:"KuGou"; distance:0; pcre:"/^.[\x01\x00]\x00\x00.*KuGou/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100172901; rev:0;)

# Command&Control: (Backdoor) FAKEM RAT - regex: to_server:^MSG 5 N.*\xf6{9,} detector_id: 1733
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) FAKEM RAT"; flow:established,to_server,only_stream; content:"MSG 5 N"; depth:7; content:"|F6 F6 F6 F6 F6 F6 F6 F6 F6|"; distance:0; pcre:"/^MSG 5 N.*\xf6{9,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001733; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x00\x00\x01.*\x00\x08\x00{2}\x50\x00{3} detector_id: 1735
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|00 00 01|"; offset:1; depth:4; content:"|00 08 00 00|P|00 00 00|"; distance:0; pcre:"/^.\x00\x00\x01.*\x00\x08\x00{2}\x50\x00{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001735; rev:0;)

# Command&Control: (Backdoor) FAKEM RAT - regex: to_server:^<html><title>.+</title><body>\x96\xf4\xf6{2}[\xf6\xf7]\xf6{3}\x74\x3e\x2c\x24\x2a\x24\x10\x1e detector_id: 1736
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) FAKEM RAT"; flow:established,to_server,only_stream; content:"<html><title>"; depth:13; content:"</title><body>|96 F4 F6 F6 F6 F6 F6 F6|t>|2C 24 2A 24 10 1E|"; distance:0; pcre:"/^<html><title>.+<\/title><body>\x96\xf4\xf6{2}[\xf6\xf7]\xf6{3}\x74\x3e\x2c\x24\x2a\x24\x10\x1e/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100173600; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) FAKEM RAT"; flow:established,to_server,only_stream; content:"<html><title>"; depth:13; content:"</title><body>|96 F4 F6 F6 F7 F6 F6 F6|t>|2C 24 2A 24 10 1E|"; distance:0; pcre:"/^<html><title>.+<\/title><body>\x96\xf4\xf6{2}[\xf6\xf7]\xf6{3}\x74\x3e\x2c\x24\x2a\x24\x10\x1e/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100173601; rev:0;)

# Command&Control: (Trojan) Ramnit - regex: to_server:^\x00\xff\x01\x00\x00\x00\xe8?$ detector_id: 1737
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ramnit"; flow:established,to_server,only_stream; content:"|00 FF 01 00 00 00|"; depth:6; pcre:"/^\x00\xff\x01\x00\x00\x00\xe8?$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1001737; rev:0;)

# Command&Control: (Trojan) Junkbot - regex: to_server:^(LL|GJN21|SX):.+\|.+\|.*\x00$ detector_id: 1738
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Junkbot"; flow:established,to_server,only_stream; content:"LL|3A|"; depth:3; content:"|7C|"; distance:0; content:"|7C|"; distance:0; content:"|00|"; distance:0; pcre:"/^(LL|GJN21|SX):.+\|.+\|.*\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100173800; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Junkbot"; flow:established,to_server,only_stream; content:"GJN21|3A|"; depth:6; content:"|7C|"; distance:0; content:"|7C|"; distance:0; content:"|00|"; distance:0; pcre:"/^(LL|GJN21|SX):.+\|.+\|.*\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100173801; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Junkbot"; flow:established,to_server,only_stream; content:"SX|3A|"; depth:3; content:"|7C|"; distance:0; content:"|7C|"; distance:0; content:"|00|"; distance:0; pcre:"/^(LL|GJN21|SX):.+\|.+\|.*\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:100173802; rev:0;)

# Command&Control: (Backdoor) Darkshell - regex: to_server:^\xb8{4,}\xc9\xca\xc7mz\xb8{3,}\x67\x91\x8e\xd8\x60\x68 detector_id: 22124
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Darkshell"; flow:established,to_server,only_stream; content:"|B8 B8 B8 B8|"; depth:4; content:"|C9 CA C7|mz|B8 B8 B8|g|91 8E D8 60|h"; distance:0; pcre:"/^\xb8{4,}\xc9\xca\xc7mz\xb8{3,}\x67\x91\x8e\xd8\x60\x68/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022124; rev:0;)

# Command&Control: (Trojan) Pabueri - regex: to_server:(\x93\xaa\x00\x8a\x1b\x4f\x47\xc0){4,} detector_id: 22126
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Pabueri"; flow:established,to_server,only_stream; content:"|93 AA 00 8A 1B|OG|C0 93 AA 00 8A 1B|OG|C0 93 AA 00 8A 1B|OG|C0 93 AA 00 8A 1B|OG|C0|"; pcre:"/(\x93\xaa\x00\x8a\x1b\x4f\x47\xc0){4,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022126; rev:0;)

# Command&Control: (Trojan) Hupigon - regex: to_server:^http:.\x00{3}\x28\x01\x00{2}x\x9cK detector_id: 22151
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Hupigon"; flow:established,to_server,only_stream; content:"http|3A|"; depth:5; content:"|00 00 00 28 01 00 00|x|9C|K"; distance:1; within:11; pcre:"/^http:.\x00{3}\x28\x01\x00{2}x\x9cK/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022151; rev:0;)

# Command&Control: (Trojan) Zegost - regex: to_server:^WALL-E.{2}\x00{2}.{2}\x00{2}x\x9c detector_id: 22152
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"WALL-E"; depth:6; content:"|00 00|"; distance:2; within:4; content:"|00 00|x|9C|"; distance:2; within:6; pcre:"/^WALL-E.{2}\x00{2}.{2}\x00{2}x\x9c/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022152; rev:0;)

# Command&Control: (Trojan) Farfli - regex: to_server:^Black.\x01\x00 detector_id: 22153
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Farfli"; flow:established,to_server,only_stream; content:"Black"; depth:5; content:"|01 00|"; distance:1; within:3; pcre:"/^Black.\x01\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022153; rev:0;)

# Command&Control: (Trojan) IRC Bot - regex: to_server:^USER ImGay detector_id: 22261
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"OpenBDS Command&Control: (Trojan) IRC Bot"; flow:established,to_server,only_stream; content:"USER ImGay"; depth:10; pcre:"/^USER ImGay/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022261; rev:0;)

# Command&Control: (Trojan) Hupigon - regex: to_server:^MTIz\x0d\x0a detector_id: 22262
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Hupigon"; flow:established,to_server,only_stream; content:"MTIz|0D 0A|"; depth:6; pcre:"/^MTIz\x0d\x0a/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022262; rev:0;)

# Command&Control: (Trojan) Zegost - regex: to_server:^Heart(.{2}\x00{2}){2} detector_id: 22263
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Heart"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^Heart(.{2}\x00{2}){2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022263; rev:0;)

# Command&Control: (Trojan) Lostorin - regex: to_server:^xV4.*CPU:.*MHZ.*MB.*GB detector_id: 22264
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Lostorin"; flow:established,to_server,only_stream; content:"xV4"; depth:3; content:"CPU|3A|"; distance:0; content:"MHZ"; distance:0; content:"MB"; distance:0; content:"GB"; distance:0; pcre:"/^xV4.*CPU:.*MHZ.*MB.*GB/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022264; rev:0;)

# Command&Control: (Backdoor) BackHole - regex: to_server:^\x00{3} 7e3b2c09992429da9766fe42565a35bd detector_id: 22266
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) BackHole"; flow:established,to_server,only_stream; content:"|00 00 00| 7e3b2c09992429da9766fe42565a35bd"; depth:36; pcre:"/^\x00{3} 7e3b2c09992429da9766fe42565a35bd/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022266; rev:0;)

# Command&Control: (Backdoor) Darkshell - regex: to_server:^\x00{3}.{4}\xde{20,}.{5}\xde{20,}.upzo detector_id: 22342
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Darkshell"; flow:established,to_server,only_stream; content:"|00 00 00|"; depth:3; content:"|DE DE DE DE DE DE DE DE DE DE DE DE DE DE DE DE DE DE DE DE|"; distance:4; within:24; content:"|DE DE DE DE DE DE DE DE DE DE DE DE DE DE DE DE DE DE DE DE|"; distance:0; content:"upzo"; distance:1; within:5; pcre:"/^\x00{3}.{4}\xde{20,}.{5}\xde{20,}.upzo/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022342; rev:0;)

# Command&Control: (Backdoor) Xtrat - regex: to_server:^myversion\|\d\.\d\x0d\x0a.{4}\x00{4}.{4}\x00{4} detector_id: 22343
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Xtrat"; flow:established,to_server,only_stream; content:"myversion|7C|"; depth:10; content:"."; distance:1; within:2; content:"|0D 0A|"; distance:1; within:3; content:"|00 00 00 00|"; distance:4; within:8; content:"|00 00 00 00|"; distance:4; within:8; pcre:"/^myversion\|\d\.\d\x0d\x0a.{4}\x00{4}.{4}\x00{4}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022343; rev:0;)

# Command&Control: (Banker) Banload - regex: to_server:^(\x52|\x58)\x00{2}\x01\x8d\xa2\x00{5}\x40\x08\x00{23}bdappleb detector_id: 22344
alert tcp $HOME_NET any -> $EXTERNAL_NET 3306 (msg:"OpenBDS Command&Control: (Banker) Banload"; flow:established,to_server,only_stream; content:"R|00 00 01 8D A2 00 00 00 00 00 40 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|bdappleb"; depth:44; pcre:"/^(\x52|\x58)\x00{2}\x01\x8d\xa2\x00{5}\x40\x08\x00{23}bdappleb/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102234400; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3306 (msg:"OpenBDS Command&Control: (Banker) Banload"; flow:established,to_server,only_stream; content:"X|00 00 01 8D A2 00 00 00 00 00 40 08 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|bdappleb"; depth:44; pcre:"/^(\x52|\x58)\x00{2}\x01\x8d\xa2\x00{5}\x40\x08\x00{23}bdappleb/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102234401; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^93B2BE12F97DD2A90096 detector_id: 22346
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"93B2BE12F97DD2A90096"; depth:20; pcre:"/^93B2BE12F97DD2A90096/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022346; rev:0;)

# Command&Control: (Trojan) Crime - regex: to_server:^Crime24-Stealer\x0d\x0a detector_id: 22347
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Crime"; flow:established,to_server,only_stream; content:"Crime24-Stealer|0D 0A|"; depth:17; pcre:"/^Crime24-Stealer\x0d\x0a/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022347; rev:0;)

# Command&Control: (Trojan) Zeleffo - regex: to_server:^\x88\x00{2}\x10\x00.{10}[\x00\x80].*Windows detector_id: 22348
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zeleffo"; flow:established,to_server,only_stream; content:"|88 00 00 10 00|"; depth:5; content:"|00|"; distance:10; within:11; content:"Windows"; distance:0; pcre:"/^\x88\x00{2}\x10\x00.{10}[\x00\x80].*Windows/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102234800; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zeleffo"; flow:established,to_server,only_stream; content:"|88 00 00 10 00|"; depth:5; content:"|80|"; distance:10; within:11; content:"Windows"; distance:0; pcre:"/^\x88\x00{2}\x10\x00.{10}[\x00\x80].*Windows/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102234801; rev:0;)

# Command&Control: (Trojan) Zbot - regex: to_server:^.{2}R(\x84|\x86).{20}\x61\xf1\x12\x3a\xd1\x93\x07\xb4\x8a\x5b\x02\xa0\xcf\xd3\x2f\x48 detector_id: 22350
alert tcp $HOME_NET any -> $EXTERNAL_NET 20641 (msg:"OpenBDS Command&Control: (Trojan) Zbot"; flow:established,to_server,only_stream; content:"R|84|"; offset:2; depth:4; content:"a|F1 12 3A D1 93 07 B4 8A 5B 02 A0 CF D3|/H"; distance:20; within:36; pcre:"/^.{2}R(\x84|\x86).{20}\x61\xf1\x12\x3a\xd1\x93\x07\xb4\x8a\x5b\x02\xa0\xcf\xd3\x2f\x48/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102235000; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 20641 (msg:"OpenBDS Command&Control: (Trojan) Zbot"; flow:established,to_server,only_stream; content:"R|86|"; offset:2; depth:4; content:"a|F1 12 3A D1 93 07 B4 8A 5B 02 A0 CF D3|/H"; distance:20; within:36; pcre:"/^.{2}R(\x84|\x86).{20}\x61\xf1\x12\x3a\xd1\x93\x07\xb4\x8a\x5b\x02\xa0\xcf\xd3\x2f\x48/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102235001; rev:0;)

# Command&Control: (Trojan) Zbot - regex: to_server:^.{2}R(\x84|\x86).{20}\xfd\x35\xbd\x29\x32\x74\x71\x26\x86\x22\xee\x14\xe3\x7d\x67\x39 detector_id: 22351
alert tcp $HOME_NET any -> $EXTERNAL_NET 20641 (msg:"OpenBDS Command&Control: (Trojan) Zbot"; flow:established,to_server,only_stream; content:"R|84|"; offset:2; depth:4; content:"|FD|5|BD 29|2tq&|86 22 EE 14 E3 7D|g9"; distance:20; within:36; pcre:"/^.{2}R(\x84|\x86).{20}\xfd\x35\xbd\x29\x32\x74\x71\x26\x86\x22\xee\x14\xe3\x7d\x67\x39/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102235100; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 20641 (msg:"OpenBDS Command&Control: (Trojan) Zbot"; flow:established,to_server,only_stream; content:"R|86|"; offset:2; depth:4; content:"|FD|5|BD 29|2tq&|86 22 EE 14 E3 7D|g9"; distance:20; within:36; pcre:"/^.{2}R(\x84|\x86).{20}\xfd\x35\xbd\x29\x32\x74\x71\x26\x86\x22\xee\x14\xe3\x7d\x67\x39/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102235101; rev:0;)

# Command&Control: (Trojan) Yunsip - regex: to_server:^HTTP 1\.1\x19\x00{3}\x01\x00{3}x\x9cK detector_id: 22353
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Yunsip"; flow:established,to_server,only_stream; content:"HTTP 1.1|19 00 00 00 01 00 00 00|x|9C|K"; depth:19; pcre:"/^HTTP 1\.1\x19\x00{3}\x01\x00{3}x\x9cK/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022353; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xb7\xe2\xd3.{20}\xa3\x20\x50\xb1\x8f\xc9\xde\xe6\x8a\x7d\x75\x24\x2f\x51\x02\xf2 detector_id: 22354
alert tcp $HOME_NET any -> $EXTERNAL_NET 22277 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|B7 E2 D3|"; offset:1; depth:4; content:"|A3| P|B1 8F C9 DE E6 8A 7D|u|24|/Q|02 F2|"; distance:20; within:36; pcre:"/^.\xb7\xe2\xd3.{20}\xa3\x20\x50\xb1\x8f\xc9\xde\xe6\x8a\x7d\x75\x24\x2f\x51\x02\xf2/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022354; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}\x8c(\x81|\x83).{20}\x84\x2d\x11\xb3\xc2\x48\x06\x32\xbc\x67\xd6\xb5\x54\x6d\xe8\xd1 detector_id: 22355
alert tcp $HOME_NET any -> $EXTERNAL_NET 16629 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|8C 81|"; offset:2; depth:4; content:"|84|-|11 B3 C2|H|06|2|BC|g|D6 B5|Tm|E8 D1|"; distance:20; within:36; pcre:"/^.{2}\x8c(\x81|\x83).{20}\x84\x2d\x11\xb3\xc2\x48\x06\x32\xbc\x67\xd6\xb5\x54\x6d\xe8\xd1/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102235500; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 16629 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|8C 83|"; offset:2; depth:4; content:"|84|-|11 B3 C2|H|06|2|BC|g|D6 B5|Tm|E8 D1|"; distance:20; within:36; pcre:"/^.{2}\x8c(\x81|\x83).{20}\x84\x2d\x11\xb3\xc2\x48\x06\x32\xbc\x67\xd6\xb5\x54\x6d\xe8\xd1/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102235501; rev:0;)

# Command&Control: (Trojan) ZBot  - regex: to_server:^.{2}\x8c(\x81|\x83).{20}\x06\x71\x07\x61\xb1\x3e\xcc\x9b\xc5\xc5\x6b\x0b\x72\x6e\xcc\x84 detector_id: 22356
alert tcp $HOME_NET any -> $EXTERNAL_NET 16629 (msg:"OpenBDS Command&Control: (Trojan) ZBot "; flow:established,to_server,only_stream; content:"|8C 81|"; offset:2; depth:4; content:"|06|q|07|a|B1|>|CC 9B C5 C5|k|0B|rn|CC 84|"; distance:20; within:36; pcre:"/^.{2}\x8c(\x81|\x83).{20}\x06\x71\x07\x61\xb1\x3e\xcc\x9b\xc5\xc5\x6b\x0b\x72\x6e\xcc\x84/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102235600; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 16629 (msg:"OpenBDS Command&Control: (Trojan) ZBot "; flow:established,to_server,only_stream; content:"|8C 83|"; offset:2; depth:4; content:"|06|q|07|a|B1|>|CC 9B C5 C5|k|0B|rn|CC 84|"; distance:20; within:36; pcre:"/^.{2}\x8c(\x81|\x83).{20}\x06\x71\x07\x61\xb1\x3e\xcc\x9b\xc5\xc5\x6b\x0b\x72\x6e\xcc\x84/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102235601; rev:0;)

# Command&Control: (Trojan) Zegost - regex: to_server:^.\x00{3}\x7c\x01\x00{2}[a-zA-Z]{5,7}x\x9cK.{4}\x87\x81{3} detector_id: 22357
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"|00 00 00 7C 01 00 00|"; offset:1; depth:8; content:"x|9C|K"; distance:0; content:"|87 81 81 81|"; distance:4; within:8; pcre:"/^.\x00{3}\x7c\x01\x00{2}[a-zA-Z]{5,7}x\x9cK.{4}\x87\x81{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022357; rev:0;)

# Adware: BitCoinMiner - regex: to_server:^\{.*"method": "mining\.subscribe".*\}\x0a detector_id: 22358
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: BitCoinMiner"; flow:established,to_server,only_stream; content:"|7B|"; depth:1; content:"|22|method|22 3A| |22|mining.subscribe|22|"; distance:0; content:"|7D 0A|"; distance:0; pcre:"/^\{.*"method": "mining\.subscribe".*\}\x0a/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022358; rev:0;)

# Adware: BitCoinMiner - regex: to_server:\{"method": "mining\.authorize", "id": \d+, "params": \[.*\]\} detector_id: 22359
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: BitCoinMiner"; flow:established,to_server,only_stream; content:"|7B 22|method|22 3A| |22|mining.authorize|22 2C| |22|id|22 3A| "; content:"|2C| |22|params|22 3A| |5B|"; distance:0; content:"|5D 7D|"; distance:0; pcre:"/\{"method": "mining\.authorize", "id": \d+, "params": \[.*\]\}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022359; rev:0;)

# Command&Control: (Trojan) Ainslot - regex: to_server:^SS\x0c\d+\x0c\d+\x0c.{4}\x00\x10JFIF\x00\x01{3}(\x00\x60){2} detector_id: 22360
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ainslot"; flow:established,to_server,only_stream; content:"SS|0C|"; depth:3; content:"|0C|"; distance:0; content:"|0C|"; distance:0; content:"|00 10|JFIF|00 01 01 01 00 60 00 60|"; distance:4; within:18; pcre:"/^SS\x0c\d+\x0c\d+\x0c.{4}\x00\x10JFIF\x00\x01{3}(\x00\x60){2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022360; rev:0;)

# Command&Control: (Trojan) Gupboot - regex: to_server:^\)\x02AS101E\xf4\xe1\xfd\xff\xff\xb8\xff\x9d\xff\x8f\xff\xb6\xff\x91\xff\x8c\xff\x8b\xff\x9e\xff detector_id: 22361
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Gupboot"; flow:established,to_server,only_stream; content:"|29 02|AS101E|F4 E1 FD FF FF B8 FF 9D FF 8F FF B6 FF 91 FF 8C FF 8B FF 9E FF|"; depth:29; pcre:"/^\)\x02AS101E\xf4\xe1\xfd\xff\xff\xb8\xff\x9d\xff\x8f\xff\xb6\xff\x91\xff\x8c\xff\x8b\xff\x9e\xff/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022361; rev:0;)

# Command&Control: (Trojan) Ramnit - regex: to_server:^\x00\xff\x4b\x00{3}$ detector_id: 22362
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ramnit"; flow:established,to_server,only_stream; content:"|00 FF|K|00 00 00|"; depth:6; pcre:"/^\x00\xff\x4b\x00{3}$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022362; rev:0;)

# Command&Control: (Trojan) Ramnit - regex: to_server:^\x00\xff\x4d\x00{3}\xe2\x00\x22\x00{3} detector_id: 22363
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ramnit"; flow:established,to_server,only_stream; content:"|00 FF|M|00 00 00 E2 00 22 00 00 00|"; depth:12; pcre:"/^\x00\xff\x4d\x00{3}\xe2\x00\x22\x00{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022363; rev:0;)

# Command&Control: (Trojan) Bifrose - regex: to_server:^DxGT3CmBf9s9ltbj5aJ\|\x0a detector_id: 22364
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bifrose"; flow:established,to_server,only_stream; content:"DxGT3CmBf9s9ltbj5aJ|7C 0A|"; depth:21; pcre:"/^DxGT3CmBf9s9ltbj5aJ\|\x0a/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022364; rev:0;)

# Command&Control: (Trojan) GenericTrojan_104 - regex: to_server:^x\xdar\x0e\x0f\x0e\x08\xf2\x0f\x31\x32\xe0\xe5\x02\x00{3}\xff{2}\x62\x60{2}\x68\x00{4}\xff{2}\x00\x80\x00\x7f\xff detector_id: 22365
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_104"; flow:established,to_server,only_stream; content:"x|DA|r|0E 0F 0E 08 F2 0F|12|E0 E5 02 00 00 00 FF FF|b|60 60|h|00 00 00 00 FF FF 00 80 00 7F FF|"; depth:34; pcre:"/^x\xdar\x0e\x0f\x0e\x08\xf2\x0f\x31\x32\xe0\xe5\x02\x00{3}\xff{2}\x62\x60{2}\x68\x00{4}\xff{2}\x00\x80\x00\x7f\xff/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022365; rev:0;)

# Command&Control: (Dropper) Egapel - regex: to_server:^http://\d+\.\d+\.\d+\.\d+:8055/\d\.txt\x00{8} detector_id: 22366
alert tcp $HOME_NET any -> $EXTERNAL_NET 8000 (msg:"OpenBDS Command&Control: (Dropper) Egapel"; flow:established,to_server,only_stream; content:"http|3A|//"; depth:7; content:"."; distance:0; content:"."; distance:0; content:"."; distance:0; content:"|3A|8055/"; distance:0; content:".txt|00 00 00 00 00 00 00 00|"; distance:1; within:13; pcre:"/^http:\/\/\d+\.\d+\.\d+\.\d+:8055\/\d\.txt\x00{8}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022366; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}R(\x84|\x86).{20}\xf8\xd2\x99\x7d\x8b\xc5\x3b\xce\x84\x0a\xd8\x74\xf1\x50\xf5\x24 detector_id: 22367
alert tcp $HOME_NET any -> $EXTERNAL_NET 20641 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"R|84|"; offset:2; depth:4; content:"|F8 D2 99 7D 8B C5 3B CE 84 0A D8|t|F1|P|F5 24|"; distance:20; within:36; pcre:"/^.{2}R(\x84|\x86).{20}\xf8\xd2\x99\x7d\x8b\xc5\x3b\xce\x84\x0a\xd8\x74\xf1\x50\xf5\x24/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102236700; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 20641 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"R|86|"; offset:2; depth:4; content:"|F8 D2 99 7D 8B C5 3B CE 84 0A D8|t|F1|P|F5 24|"; distance:20; within:36; pcre:"/^.{2}R(\x84|\x86).{20}\xf8\xd2\x99\x7d\x8b\xc5\x3b\xce\x84\x0a\xd8\x74\xf1\x50\xf5\x24/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102236701; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}R(\x84|\x86).{20}\x67\x17\x5a\xf1\x6b\xc5\x41\x63\x04\xbc\x8c\x57\x60\xed\x83\x1d detector_id: 22368
alert tcp $HOME_NET any -> $EXTERNAL_NET 20641 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"R|84|"; offset:2; depth:4; content:"g|17|Z|F1|k|C5|Ac|04 BC 8C|W|60 ED 83 1D|"; distance:20; within:36; pcre:"/^.{2}R(\x84|\x86).{20}\x67\x17\x5a\xf1\x6b\xc5\x41\x63\x04\xbc\x8c\x57\x60\xed\x83\x1d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102236800; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 20641 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"R|86|"; offset:2; depth:4; content:"g|17|Z|F1|k|C5|Ac|04 BC 8C|W|60 ED 83 1D|"; distance:20; within:36; pcre:"/^.{2}R(\x84|\x86).{20}\x67\x17\x5a\xf1\x6b\xc5\x41\x63\x04\xbc\x8c\x57\x60\xed\x83\x1d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102236801; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}\x8c(\x81|\x83).{20}\x82\xcb\x59\x78\x78\x1e\x40\xe5\x32\x80\x58\x42\xfb\x53\x44\x84 detector_id: 22369
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|8C 81|"; offset:2; depth:4; content:"|82 CB|Yxx|1E 40 E5|2|80|XB|FB|SD|84|"; distance:20; within:36; pcre:"/^.{2}\x8c(\x81|\x83).{20}\x82\xcb\x59\x78\x78\x1e\x40\xe5\x32\x80\x58\x42\xfb\x53\x44\x84/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102236900; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|8C 83|"; offset:2; depth:4; content:"|82 CB|Yxx|1E 40 E5|2|80|XB|FB|SD|84|"; distance:20; within:36; pcre:"/^.{2}\x8c(\x81|\x83).{20}\x82\xcb\x59\x78\x78\x1e\x40\xe5\x32\x80\x58\x42\xfb\x53\x44\x84/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102236901; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}\x8c(\x81|\x83).{20}\xb6\xf5\x51\x15\xb0\xcf\xff\x59\xe8\xd9\x13\x68\x07\x27\x70\x1e detector_id: 22370
alert tcp $HOME_NET any -> $EXTERNAL_NET 16629 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|8C 81|"; offset:2; depth:4; content:"|B6 F5|Q|15 B0 CF FF|Y|E8 D9 13|h|07 27|p|1E|"; distance:20; within:36; pcre:"/^.{2}\x8c(\x81|\x83).{20}\xb6\xf5\x51\x15\xb0\xcf\xff\x59\xe8\xd9\x13\x68\x07\x27\x70\x1e/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102237000; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 16629 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|8C 83|"; offset:2; depth:4; content:"|B6 F5|Q|15 B0 CF FF|Y|E8 D9 13|h|07 27|p|1E|"; distance:20; within:36; pcre:"/^.{2}\x8c(\x81|\x83).{20}\xb6\xf5\x51\x15\xb0\xcf\xff\x59\xe8\xd9\x13\x68\x07\x27\x70\x1e/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102237001; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^D573BA5A4EFFC3FB629308 detector_id: 22371
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"D573BA5A4EFFC3FB629308"; depth:22; pcre:"/^D573BA5A4EFFC3FB629308/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022371; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xf4\x54\x9d.{20}\x92\x1f\x92\x2d\x5f\x16\x44\x92\x47\x0e\x75\xf5\x04\xdb\x8a\xb5 detector_id: 22372
alert tcp $HOME_NET any -> $EXTERNAL_NET 25299 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|F4|T|9D|"; offset:1; depth:4; content:"|92 1F 92|-_|16|D|92|G|0E|u|F5 04 DB 8A B5|"; distance:20; within:36; pcre:"/^.\xf4\x54\x9d.{20}\x92\x1f\x92\x2d\x5f\x16\x44\x92\x47\x0e\x75\xf5\x04\xdb\x8a\xb5/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022372; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xf4\x54\x9d.{20}\xc2\x31\x4e\x5c\x2e\xa7\x12\xcb\xcd\xa9\xb0\xff\x0b\x05\xf4\xce detector_id: 22373
alert tcp $HOME_NET any -> $EXTERNAL_NET 25299 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|F4|T|9D|"; offset:1; depth:4; content:"|C2|1N|5C|.|A7 12 CB CD A9 B0 FF 0B 05 F4 CE|"; distance:20; within:36; pcre:"/^.\xf4\x54\x9d.{20}\xc2\x31\x4e\x5c\x2e\xa7\x12\xcb\xcd\xa9\xb0\xff\x0b\x05\xf4\xce/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022373; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x35\x78\x23.{20}\x0e\xae\x68\x83\xf2\x14\x0e\x66\x68\xc6\x43\x42\x6d\xa1\xf3\x10 detector_id: 22374
alert tcp $HOME_NET any -> $EXTERNAL_NET 11944 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"5x|23|"; offset:1; depth:4; content:"|0E AE|h|83 F2 14 0E|fh|C6|CBm|A1 F3 10|"; distance:20; within:36; pcre:"/^.\x35\x78\x23.{20}\x0e\xae\x68\x83\xf2\x14\x0e\x66\x68\xc6\x43\x42\x6d\xa1\xf3\x10/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022374; rev:0;)

# Command&Control: (Backdoor) Khelios - regex: to_server:^\xc2\x80\x41\x7f.\x81\x41\x7f.\x81\x41\x7f.\x86\x41\x7f.\x85\x41\x7f.\x86\x41\x7f detector_id: 22375
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|C2 80|A|7F|"; depth:4; content:"|81|A|7F|"; distance:1; within:4; content:"|81|A|7F|"; distance:1; within:4; content:"|86|A|7F|"; distance:1; within:4; content:"|85|A|7F|"; distance:1; within:4; content:"|86|A|7F|"; distance:1; within:4; pcre:"/^\xc2\x80\x41\x7f.\x81\x41\x7f.\x81\x41\x7f.\x86\x41\x7f.\x85\x41\x7f.\x86\x41\x7f/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022375; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x35\x39\x7f.{20}\x1c\x74\x74\xb7\xd1\x08\x9c\x68\xa8\x10\x78\x55\xca\x14\xec\x2e detector_id: 22376
alert tcp $HOME_NET any -> $EXTERNAL_NET 16433 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"59|7F|"; offset:1; depth:4; content:"|1C|tt|B7 D1 08 9C|h|A8 10|xU|CA 14 EC|."; distance:20; within:36; pcre:"/^.\x35\x39\x7f.{20}\x1c\x74\x74\xb7\xd1\x08\x9c\x68\xa8\x10\x78\x55\xca\x14\xec\x2e/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022376; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x35\x39\x7f.{20}\x19\x93\x50\xe3\x68\xb9\xd6\x80\xaa\x38\x4e\x35\xd8\x39\x7e\x33 detector_id: 22377
alert tcp $HOME_NET any -> $EXTERNAL_NET 16433 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"59|7F|"; offset:1; depth:4; content:"|19 93|P|E3|h|B9 D6 80 AA|8N5|D8|9|7E|3"; distance:20; within:36; pcre:"/^.\x35\x39\x7f.{20}\x19\x93\x50\xe3\x68\xb9\xd6\x80\xaa\x38\x4e\x35\xd8\x39\x7e\x33/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022377; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^B27DAC544AF1DF830[0-9A-F]E[0-9A-F]1[0-9A-F] detector_id: 22378
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"B27DAC544AF1DF830"; depth:17; content:"E"; distance:1; within:2; content:"1"; distance:1; within:2; pcre:"/^B27DAC544AF1DF830[0-9A-F]E[0-9A-F]1[0-9A-F]/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022378; rev:0;)

# Command&Control: (Trojan) Zbot - regex: to_server:^.\xb7\xe2\xd3.{20}\xa7\x2e\xab\x25\xa2\xb7\x08\x8a\xad\x8e\xe9\xfa\x1f\xbd\xce\x64 detector_id: 22379
alert tcp $HOME_NET any -> $EXTERNAL_NET 22277 (msg:"OpenBDS Command&Control: (Trojan) Zbot"; flow:established,to_server,only_stream; content:"|B7 E2 D3|"; offset:1; depth:4; content:"|A7|.|AB 25 A2 B7 08 8A AD 8E E9 FA 1F BD CE|d"; distance:20; within:36; pcre:"/^.\xb7\xe2\xd3.{20}\xa7\x2e\xab\x25\xa2\xb7\x08\x8a\xad\x8e\xe9\xfa\x1f\xbd\xce\x64/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022379; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xf4\x54\x9d.{20}\xc2\x31\x4e\x5c\x2e\xa7\x12\xcb\xcd\xa9\xb0\xff\x0b\x05\xf4\xce detector_id: 22385
alert tcp $HOME_NET any -> $EXTERNAL_NET 25299 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|F4|T|9D|"; offset:1; depth:4; content:"|C2|1N|5C|.|A7 12 CB CD A9 B0 FF 0B 05 F4 CE|"; distance:20; within:36; pcre:"/^.\xf4\x54\x9d.{20}\xc2\x31\x4e\x5c\x2e\xa7\x12\xcb\xcd\xa9\xb0\xff\x0b\x05\xf4\xce/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022385; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xf4\x54\x9d.{20}\x92\x1f\x92\x2d\x5f\x16\x44\x92\x47\x0e\x75\xf5\x04\xdb\x8a\xb5 detector_id: 22386
alert tcp $HOME_NET any -> $EXTERNAL_NET 25299 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|F4|T|9D|"; offset:1; depth:4; content:"|92 1F 92|-_|16|D|92|G|0E|u|F5 04 DB 8A B5|"; distance:20; within:36; pcre:"/^.\xf4\x54\x9d.{20}\x92\x1f\x92\x2d\x5f\x16\x44\x92\x47\x0e\x75\xf5\x04\xdb\x8a\xb5/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022386; rev:0;)

# Command&Control: (Trojan) Recslurp - regex: to_server:^\x20\x01\x09\x00{3}.\x00{3}\x06.\x14\x00\x09\x00{3}.\x00{3}\x01\x00{3}\x05\x00{3}\x01\x00{7} detector_id: 22387
alert tcp $HOME_NET any -> $EXTERNAL_NET 7000 (msg:"OpenBDS Command&Control: (Trojan) Recslurp"; flow:established,to_server,only_stream; content:" |01 09 00 00 00|"; depth:6; content:"|00 00 00 06|"; distance:1; within:5; content:"|14 00 09 00 00 00|"; distance:1; within:7; content:"|00 00 00 01 00 00 00 05 00 00 00 01 00 00 00 00 00 00 00|"; distance:1; within:20; pcre:"/^\x20\x01\x09\x00{3}.\x00{3}\x06.\x14\x00\x09\x00{3}.\x00{3}\x01\x00{3}\x05\x00{3}\x01\x00{7}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022387; rev:0;)

# Command&Control: (Backdoor) Khelios - regex: to_server:^(.[\x80-\x81].\x7f){3}(.[\x85-\x87].\x7f){3} detector_id: 22388
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|80|"; offset:1; depth:2; content:"|7F|"; distance:1; within:2; content:"|80|"; distance:1; within:2; content:"|7F|"; distance:1; within:2; content:"|80|"; distance:1; within:2; content:"|7F|"; distance:1; within:2; content:"|7F|"; distance:3; within:4; content:"|7F|"; distance:3; within:4; content:"|7F|"; distance:3; within:4; pcre:"/^(.[\x80-\x81].\x7f){3}(.[\x85-\x87].\x7f){3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102238800; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|81|"; offset:1; depth:2; content:"|7F|"; distance:1; within:2; content:"|80|"; distance:1; within:2; content:"|7F|"; distance:1; within:2; content:"|80|"; distance:1; within:2; content:"|7F|"; distance:1; within:2; content:"|7F|"; distance:3; within:4; content:"|7F|"; distance:3; within:4; content:"|7F|"; distance:3; within:4; pcre:"/^(.[\x80-\x81].\x7f){3}(.[\x85-\x87].\x7f){3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102238801; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|80|"; offset:1; depth:2; content:"|7F|"; distance:1; within:2; content:"|81|"; distance:1; within:2; content:"|7F|"; distance:1; within:2; content:"|80|"; distance:1; within:2; content:"|7F|"; distance:1; within:2; content:"|7F|"; distance:3; within:4; content:"|7F|"; distance:3; within:4; content:"|7F|"; distance:3; within:4; pcre:"/^(.[\x80-\x81].\x7f){3}(.[\x85-\x87].\x7f){3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102238802; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|81|"; offset:1; depth:2; content:"|7F|"; distance:1; within:2; content:"|81|"; distance:1; within:2; content:"|7F|"; distance:1; within:2; content:"|80|"; distance:1; within:2; content:"|7F|"; distance:1; within:2; content:"|7F|"; distance:3; within:4; content:"|7F|"; distance:3; within:4; content:"|7F|"; distance:3; within:4; pcre:"/^(.[\x80-\x81].\x7f){3}(.[\x85-\x87].\x7f){3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102238803; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|80|"; offset:1; depth:2; content:"|7F|"; distance:1; within:2; content:"|80|"; distance:1; within:2; content:"|7F|"; distance:1; within:2; content:"|81|"; distance:1; within:2; content:"|7F|"; distance:1; within:2; content:"|7F|"; distance:3; within:4; content:"|7F|"; distance:3; within:4; content:"|7F|"; distance:3; within:4; pcre:"/^(.[\x80-\x81].\x7f){3}(.[\x85-\x87].\x7f){3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102238804; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|81|"; offset:1; depth:2; content:"|7F|"; distance:1; within:2; content:"|80|"; distance:1; within:2; content:"|7F|"; distance:1; within:2; content:"|81|"; distance:1; within:2; content:"|7F|"; distance:1; within:2; content:"|7F|"; distance:3; within:4; content:"|7F|"; distance:3; within:4; content:"|7F|"; distance:3; within:4; pcre:"/^(.[\x80-\x81].\x7f){3}(.[\x85-\x87].\x7f){3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102238805; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|80|"; offset:1; depth:2; content:"|7F|"; distance:1; within:2; content:"|81|"; distance:1; within:2; content:"|7F|"; distance:1; within:2; content:"|81|"; distance:1; within:2; content:"|7F|"; distance:1; within:2; content:"|7F|"; distance:3; within:4; content:"|7F|"; distance:3; within:4; content:"|7F|"; distance:3; within:4; pcre:"/^(.[\x80-\x81].\x7f){3}(.[\x85-\x87].\x7f){3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102238806; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|81|"; offset:1; depth:2; content:"|7F|"; distance:1; within:2; content:"|81|"; distance:1; within:2; content:"|7F|"; distance:1; within:2; content:"|81|"; distance:1; within:2; content:"|7F|"; distance:1; within:2; content:"|7F|"; distance:3; within:4; content:"|7F|"; distance:3; within:4; content:"|7F|"; distance:3; within:4; pcre:"/^(.[\x80-\x81].\x7f){3}(.[\x85-\x87].\x7f){3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102238807; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x35\x78\x23.{20}\x8c\xf2\x7e\x51\x81\x62\xc4\xcf\x11\x64\xfe\xfc\x4b\xa2\xd7\x45 detector_id: 22390
alert tcp $HOME_NET any -> $EXTERNAL_NET 11944 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"5x|23|"; offset:1; depth:4; content:"|8C F2 7E|Q|81|b|C4 CF 11|d|FE FC|K|A2 D7|E"; distance:20; within:36; pcre:"/^.\x35\x78\x23.{20}\x8c\xf2\x7e\x51\x81\x62\xc4\xcf\x11\x64\xfe\xfc\x4b\xa2\xd7\x45/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022390; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x35\x78\x23.{20}\x0e\xae\x68\x83\xf2\x14\x0e\x66\x68\xc6\x43\x42\x6d\xa1\xf3\x10 detector_id: 22391
alert tcp $HOME_NET any -> $EXTERNAL_NET 11944 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"5x|23|"; offset:1; depth:4; content:"|0E AE|h|83 F2 14 0E|fh|C6|CBm|A1 F3 10|"; distance:20; within:36; pcre:"/^.\x35\x78\x23.{20}\x0e\xae\x68\x83\xf2\x14\x0e\x66\x68\xc6\x43\x42\x6d\xa1\xf3\x10/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022391; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xb7\xe2\xd3.{20}\xa7\x2e\xab\x25\xa2\xb7\x08\x8a\xad\x8e\xe9\xfa\x1f\xbd\xce\x64 detector_id: 22392
alert tcp $HOME_NET any -> $EXTERNAL_NET 22277 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|B7 E2 D3|"; offset:1; depth:4; content:"|A7|.|AB 25 A2 B7 08 8A AD 8E E9 FA 1F BD CE|d"; distance:20; within:36; pcre:"/^.\xb7\xe2\xd3.{20}\xa7\x2e\xab\x25\xa2\xb7\x08\x8a\xad\x8e\xe9\xfa\x1f\xbd\xce\x64/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022392; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xb7\xe2\xd3.{20}\x12\x78\xaa\x72\xc0\x61\x1c\x32\xb5\x01\x18\x24\xa9\xbb\x19\xda detector_id: 22393
alert tcp $HOME_NET any -> $EXTERNAL_NET 22277 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|B7 E2 D3|"; offset:1; depth:4; content:"|12|x|AA|r|C0|a|1C|2|B5 01 18 24 A9 BB 19 DA|"; distance:20; within:36; pcre:"/^.\xb7\xe2\xd3.{20}\x12\x78\xaa\x72\xc0\x61\x1c\x32\xb5\x01\x18\x24\xa9\xbb\x19\xda/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022393; rev:0;)

# Command&Control: (Trojan) Cosmiproc - regex: to_server:^\x14\x00{3}\x02\x00.\x20\x02\x05{2}\x00[a-zA-Z0-9]+$ detector_id: 22394
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Cosmiproc"; flow:established,to_server,only_stream; content:"|14 00 00 00 02 00|"; depth:6; content:" |02 05 05 00|"; distance:1; within:6; pcre:"/^\x14\x00{3}\x02\x00.\x20\x02\x05{2}\x00[a-zA-Z0-9]+$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022394; rev:0;)

# Command&Control: (Trojan) GenericTrojan_105 - regex: to_server:^4t0hDrTg\x0a detector_id: 22395
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_105"; flow:established,to_server,only_stream; content:"4t0hDrTg|0A|"; depth:9; pcre:"/^4t0hDrTg\x0a/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022395; rev:0;)

# Command&Control: (Trojan) Chebri - regex: to_server:^\x02\x01\x00{10}$ detector_id: 22396
alert tcp $HOME_NET any -> $EXTERNAL_NET 20001 (msg:"OpenBDS Command&Control: (Trojan) Chebri"; flow:established,to_server,only_stream; content:"|02 01 00 00 00 00 00 00 00 00 00 00|"; depth:12; pcre:"/^\x02\x01\x00{10}$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022396; rev:0;)

# Command&Control: (Trojan) Farfli - regex: to_server:^.{2}\x00{2}.\x01\x00{2}KuGoux\x9cK.{4}\x1c\x06{3} detector_id: 22397
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Farfli"; flow:established,to_server,only_stream; content:"|00 00|"; offset:2; depth:4; content:"|01 00 00|KuGoux|9C|K"; distance:1; within:12; content:"|1C 06 06 06|"; distance:4; within:8; pcre:"/^.{2}\x00{2}.\x01\x00{2}KuGoux\x9cK.{4}\x1c\x06{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022397; rev:0;)

# Command&Control: (Trojan) Farfli - regex: to_server:^.{2}\x00{2}\|\x01\x00{2}MXWVIPx\x9cK.{4}\x1c\x06{3} detector_id: 22398
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Farfli"; flow:established,to_server,only_stream; content:"|00 00 7C 01 00 00|MXWVIPx|9C|K"; offset:2; depth:17; content:"|1C 06 06 06|"; distance:4; within:8; pcre:"/^.{2}\x00{2}\|\x01\x00{2}MXWVIPx\x9cK.{4}\x1c\x06{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022398; rev:0;)

# Command&Control: (Trojan) GenericTrojan_106 - regex: to_server:^IM00\d(\$|%|&|#)\x01\x00{2}\x88\x01\x00{2}\x47.\x01 detector_id: 22399
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_106"; flow:established,to_server,only_stream; content:"IM00"; depth:4; content:"|01 00 00 88 01 00 00|G"; distance:2; within:10; content:"|01|"; distance:1; within:2; pcre:"/^IM00\d(\$|%|&|#)\x01\x00{2}\x88\x01\x00{2}\x47.\x01/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022399; rev:0;)

# Command&Control: (Trojan) Farfli - regex: to_server:^.[\x00-\x01]\x00{2}.[\x01-\x02]\x00{2}Xjjhjx\x9c detector_id: 22400
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Farfli"; flow:established,to_server,only_stream; content:"|00 00 00|"; offset:1; depth:4; content:"|01 00 00|Xjjhjx|9C|"; distance:0; pcre:"/^.[\x00-\x01]\x00{2}.[\x01-\x02]\x00{2}Xjjhjx\x9c/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102240000; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Farfli"; flow:established,to_server,only_stream; content:"|01 00 00|"; offset:1; depth:4; content:"|01 00 00|Xjjhjx|9C|"; distance:0; pcre:"/^.[\x00-\x01]\x00{2}.[\x01-\x02]\x00{2}Xjjhjx\x9c/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102240001; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Farfli"; flow:established,to_server,only_stream; content:"|00 00 00|"; offset:1; depth:4; content:"|02 00 00|Xjjhjx|9C|"; distance:0; pcre:"/^.[\x00-\x01]\x00{2}.[\x01-\x02]\x00{2}Xjjhjx\x9c/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102240002; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Farfli"; flow:established,to_server,only_stream; content:"|01 00 00|"; offset:1; depth:4; content:"|02 00 00|Xjjhjx|9C|"; distance:0; pcre:"/^.[\x00-\x01]\x00{2}.[\x01-\x02]\x00{2}Xjjhjx\x9c/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102240003; rev:0;)

# Command&Control: (Trojan) Farfli - regex: to_server:^.[\x00-\x01]\x00{2}.[\x01-\x02]\x00{2}[A-Za-z]{5}x\x9cKc\x60{2} detector_id: 22402
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Farfli"; flow:established,to_server,only_stream; content:"|00 00 00|"; offset:1; depth:4; content:"|01 00 00|"; distance:0; content:"x|9C|Kc|60 60|"; distance:5; within:11; pcre:"/^.[\x00-\x01]\x00{2}.[\x01-\x02]\x00{2}[A-Za-z]{5}x\x9cKc\x60{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102240200; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Farfli"; flow:established,to_server,only_stream; content:"|01 00 00|"; offset:1; depth:4; content:"|01 00 00|"; distance:0; content:"x|9C|Kc|60 60|"; distance:5; within:11; pcre:"/^.[\x00-\x01]\x00{2}.[\x01-\x02]\x00{2}[A-Za-z]{5}x\x9cKc\x60{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102240201; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Farfli"; flow:established,to_server,only_stream; content:"|00 00 00|"; offset:1; depth:4; content:"|02 00 00|"; distance:0; content:"x|9C|Kc|60 60|"; distance:5; within:11; pcre:"/^.[\x00-\x01]\x00{2}.[\x01-\x02]\x00{2}[A-Za-z]{5}x\x9cKc\x60{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102240202; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Farfli"; flow:established,to_server,only_stream; content:"|01 00 00|"; offset:1; depth:4; content:"|02 00 00|"; distance:0; content:"x|9C|Kc|60 60|"; distance:5; within:11; pcre:"/^.[\x00-\x01]\x00{2}.[\x01-\x02]\x00{2}[A-Za-z]{5}x\x9cKc\x60{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102240203; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}R(\x84|\x86).{20}\x67\x17\x5a\xf1\x6b\xc5\x41\x63\x04\xbc\x8c\x57\x60\xed\x83\x1d detector_id: 22403
alert tcp $HOME_NET any -> $EXTERNAL_NET 20641 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"R|84|"; offset:2; depth:4; content:"g|17|Z|F1|k|C5|Ac|04 BC 8C|W|60 ED 83 1D|"; distance:20; within:36; pcre:"/^.{2}R(\x84|\x86).{20}\x67\x17\x5a\xf1\x6b\xc5\x41\x63\x04\xbc\x8c\x57\x60\xed\x83\x1d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102240300; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 20641 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"R|86|"; offset:2; depth:4; content:"g|17|Z|F1|k|C5|Ac|04 BC 8C|W|60 ED 83 1D|"; distance:20; within:36; pcre:"/^.{2}R(\x84|\x86).{20}\x67\x17\x5a\xf1\x6b\xc5\x41\x63\x04\xbc\x8c\x57\x60\xed\x83\x1d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102240301; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}R(\x84|\x86).{20}\xe5\x4b\x4c\x23\x18\xb3\x8b\xca\x7d\x1e\x31\xe9\x46\xee\xa7\x48 detector_id: 22404
alert tcp $HOME_NET any -> $EXTERNAL_NET 20641 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"R|84|"; offset:2; depth:4; content:"|E5|KL|23 18 B3 8B CA 7D 1E|1|E9|F|EE A7|H"; distance:20; within:36; pcre:"/^.{2}R(\x84|\x86).{20}\xe5\x4b\x4c\x23\x18\xb3\x8b\xca\x7d\x1e\x31\xe9\x46\xee\xa7\x48/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102240400; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 20641 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"R|86|"; offset:2; depth:4; content:"|E5|KL|23 18 B3 8B CA 7D 1E|1|E9|F|EE A7|H"; distance:20; within:36; pcre:"/^.{2}R(\x84|\x86).{20}\xe5\x4b\x4c\x23\x18\xb3\x8b\xca\x7d\x1e\x31\xe9\x46\xee\xa7\x48/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102240401; rev:0;)

# Command&Control: (Backdoor) Khelios - regex: to_server:^(.[\x80-\x81].\x7e){3}(.[\x85-\x87].\x7e){3}  detector_id: 22405
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|80|"; offset:1; depth:2; content:"|7E|"; distance:1; within:2; content:"|80|"; distance:1; within:2; content:"|7E|"; distance:1; within:2; content:"|80|"; distance:1; within:2; content:"|7E|"; distance:1; within:2; content:"|7E|"; distance:3; within:4; content:"|7E|"; distance:3; within:4; content:"|7E| "; distance:3; within:5; pcre:"/^(.[\x80-\x81].\x7e){3}(.[\x85-\x87].\x7e){3} /s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102240500; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|81|"; offset:1; depth:2; content:"|7E|"; distance:1; within:2; content:"|80|"; distance:1; within:2; content:"|7E|"; distance:1; within:2; content:"|80|"; distance:1; within:2; content:"|7E|"; distance:1; within:2; content:"|7E|"; distance:3; within:4; content:"|7E|"; distance:3; within:4; content:"|7E| "; distance:3; within:5; pcre:"/^(.[\x80-\x81].\x7e){3}(.[\x85-\x87].\x7e){3} /s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102240501; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|80|"; offset:1; depth:2; content:"|7E|"; distance:1; within:2; content:"|81|"; distance:1; within:2; content:"|7E|"; distance:1; within:2; content:"|80|"; distance:1; within:2; content:"|7E|"; distance:1; within:2; content:"|7E|"; distance:3; within:4; content:"|7E|"; distance:3; within:4; content:"|7E| "; distance:3; within:5; pcre:"/^(.[\x80-\x81].\x7e){3}(.[\x85-\x87].\x7e){3} /s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102240502; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|81|"; offset:1; depth:2; content:"|7E|"; distance:1; within:2; content:"|81|"; distance:1; within:2; content:"|7E|"; distance:1; within:2; content:"|80|"; distance:1; within:2; content:"|7E|"; distance:1; within:2; content:"|7E|"; distance:3; within:4; content:"|7E|"; distance:3; within:4; content:"|7E| "; distance:3; within:5; pcre:"/^(.[\x80-\x81].\x7e){3}(.[\x85-\x87].\x7e){3} /s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102240503; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|80|"; offset:1; depth:2; content:"|7E|"; distance:1; within:2; content:"|80|"; distance:1; within:2; content:"|7E|"; distance:1; within:2; content:"|81|"; distance:1; within:2; content:"|7E|"; distance:1; within:2; content:"|7E|"; distance:3; within:4; content:"|7E|"; distance:3; within:4; content:"|7E| "; distance:3; within:5; pcre:"/^(.[\x80-\x81].\x7e){3}(.[\x85-\x87].\x7e){3} /s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102240504; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|81|"; offset:1; depth:2; content:"|7E|"; distance:1; within:2; content:"|80|"; distance:1; within:2; content:"|7E|"; distance:1; within:2; content:"|81|"; distance:1; within:2; content:"|7E|"; distance:1; within:2; content:"|7E|"; distance:3; within:4; content:"|7E|"; distance:3; within:4; content:"|7E| "; distance:3; within:5; pcre:"/^(.[\x80-\x81].\x7e){3}(.[\x85-\x87].\x7e){3} /s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102240505; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|80|"; offset:1; depth:2; content:"|7E|"; distance:1; within:2; content:"|81|"; distance:1; within:2; content:"|7E|"; distance:1; within:2; content:"|81|"; distance:1; within:2; content:"|7E|"; distance:1; within:2; content:"|7E|"; distance:3; within:4; content:"|7E|"; distance:3; within:4; content:"|7E| "; distance:3; within:5; pcre:"/^(.[\x80-\x81].\x7e){3}(.[\x85-\x87].\x7e){3} /s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102240506; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|81|"; offset:1; depth:2; content:"|7E|"; distance:1; within:2; content:"|81|"; distance:1; within:2; content:"|7E|"; distance:1; within:2; content:"|81|"; distance:1; within:2; content:"|7E|"; distance:1; within:2; content:"|7E|"; distance:3; within:4; content:"|7E|"; distance:3; within:4; content:"|7E| "; distance:3; within:5; pcre:"/^(.[\x80-\x81].\x7e){3}(.[\x85-\x87].\x7e){3} /s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102240507; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}R(\x84|\x86).{20}\x72\xcc\x4d\xda\x14\xd8\xe8\xa1\x0a\xf4\x3e\xb1\x3f\x30\xbe\xc0 detector_id: 22406
alert tcp $HOME_NET any -> $EXTERNAL_NET 20641 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"R|84|"; offset:2; depth:4; content:"r|CC|M|DA 14 D8 E8 A1 0A F4|>|B1|?0|BE C0|"; distance:20; within:36; pcre:"/^.{2}R(\x84|\x86).{20}\x72\xcc\x4d\xda\x14\xd8\xe8\xa1\x0a\xf4\x3e\xb1\x3f\x30\xbe\xc0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102240600; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 20641 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"R|86|"; offset:2; depth:4; content:"r|CC|M|DA 14 D8 E8 A1 0A F4|>|B1|?0|BE C0|"; distance:20; within:36; pcre:"/^.{2}R(\x84|\x86).{20}\x72\xcc\x4d\xda\x14\xd8\xe8\xa1\x0a\xf4\x3e\xb1\x3f\x30\xbe\xc0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102240601; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}R(\x84|\x86).{20}\xc5\xd8\xa7\x65\xad\x4d\xac\x96\xe0\x6f\xd1\x03\xda\x83\xc4\x66 detector_id: 22407
alert tcp $HOME_NET any -> $EXTERNAL_NET 20641 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"R|84|"; offset:2; depth:4; content:"|C5 D8 A7|e|AD|M|AC 96 E0|o|D1 03 DA 83 C4|f"; distance:20; within:36; pcre:"/^.{2}R(\x84|\x86).{20}\xc5\xd8\xa7\x65\xad\x4d\xac\x96\xe0\x6f\xd1\x03\xda\x83\xc4\x66/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102240700; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 20641 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"R|86|"; offset:2; depth:4; content:"|C5 D8 A7|e|AD|M|AC 96 E0|o|D1 03 DA 83 C4|f"; distance:20; within:36; pcre:"/^.{2}R(\x84|\x86).{20}\xc5\xd8\xa7\x65\xad\x4d\xac\x96\xe0\x6f\xd1\x03\xda\x83\xc4\x66/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102240701; rev:0;)

# Command&Control: (Trojan) Otlard - regex: to_server:^\x13e.{7}\x13\x00{2}.{2}\x00{2} detector_id: 22409
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"OpenBDS Command&Control: (Trojan) Otlard"; flow:established,to_server,only_stream; content:"|13|e"; depth:2; content:"|13 00 00|"; distance:7; within:10; content:"|00 00|"; distance:2; within:4; pcre:"/^\x13e.{7}\x13\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022409; rev:0;)

# Command&Control: (Trojan) Microjoin - regex: to_server:^\x02\x00{7}\xc8\x00{3}.{2}\x00{2}.*o\.dll detector_id: 22410
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Microjoin"; flow:established,to_server,only_stream; content:"|02 00 00 00 00 00 00 00 C8 00 00 00|"; depth:12; content:"|00 00|"; distance:2; within:4; content:"o.dll"; distance:0; pcre:"/^\x02\x00{7}\xc8\x00{3}.{2}\x00{2}.*o\.dll/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022410; rev:0;)

# Command&Control: (Backdoor) Defsel - regex: to_server:^(CONNECTED\?\x0a)+$ detector_id: 22411
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Defsel"; flow:established,to_server,only_stream; content:"CONNECTED?|0A|"; depth:11; pcre:"/^(CONNECTED\?\x0a)+$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022411; rev:0;)

# Command&Control: (Backdoor) Defsel - regex: to_server:^MAININFO\|.+\|\d+\.\d+\.\d+\.\d+\| detector_id: 22412
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Defsel"; flow:established,to_server,only_stream; content:"MAININFO|7C|"; depth:9; content:"|7C|"; distance:0; content:"."; distance:0; content:"."; distance:0; content:"."; distance:0; content:"|7C|"; distance:0; pcre:"/^MAININFO\|.+\|\d+\.\d+\.\d+\.\d+\|/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022412; rev:0;)

# Command&Control: (Trojan) Usteal - regex: to_server:^UFR!.{8}\x01\x00{3}\x40\x00{3} detector_id: 22413
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Usteal"; flow:established,to_server,only_stream; content:"UFR|21|"; depth:4; content:"|01 00 00 00 40 00 00 00|"; distance:8; within:16; pcre:"/^UFR!.{8}\x01\x00{3}\x40\x00{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022413; rev:0;)

# Command&Control: (Backdoor) Khelios - regex: to_server:^\x9d{4}\x9b...\x9d\xbc\x9c detector_id: 22418
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|9D 9D 9D 9D 9B|"; depth:5; content:"|9D BC 9C|"; distance:3; within:6; pcre:"/^\x9d{4}\x9b...\x9d\xbc\x9c/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022418; rev:0;)

# Command&Control: (Trojan) Zutwoxy - regex: to_server:^SERVER\|Bot-\d+\| detector_id: 22419
alert tcp $HOME_NET any -> $EXTERNAL_NET 8889 (msg:"OpenBDS Command&Control: (Trojan) Zutwoxy"; flow:established,to_server,only_stream; content:"SERVER|7C|Bot-"; depth:11; content:"|7C|"; distance:0; pcre:"/^SERVER\|Bot-\d+\|/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022419; rev:0;)

# Command&Control: (Trojan) Hupigon - regex: to_server:^\d+\|V\d+\|Windows detector_id: 22420
alert tcp $HOME_NET any -> $EXTERNAL_NET 2009 (msg:"OpenBDS Command&Control: (Trojan) Hupigon"; flow:established,to_server,only_stream; content:"|7C|V"; content:"|7C|Windows"; distance:0; pcre:"/^\d+\|V\d+\|Windows/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022420; rev:0;)

# Command&Control: (Backdoor) GenericBackdoor_6 - regex: to_server:^\d+\|OnConnect\| detector_id: 22421
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) GenericBackdoor_6"; flow:established,to_server,only_stream; content:"|7C|OnConnect|7C|"; pcre:"/^\d+\|OnConnect\|/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022421; rev:0;)

# Command&Control: (Backdoor) GenericBackdoor_7 - regex: to_server:^\d+\|\S+\|0\|0\|0$ detector_id: 22422
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) GenericBackdoor_7"; flow:established,to_server,only_stream; content:"|7C|"; content:"|7C|0|7C|0|7C|0"; distance:0; pcre:"/^\d+\|\S+\|0\|0\|0$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022422; rev:0;)

# Command&Control: (Backdoor) Lypsacop - regex: to_server:^\d+\|x\x01.[A-Z].[A-Z] detector_id: 22423
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Lypsacop"; flow:established,to_server,only_stream; content:"|7C|x|01|"; pcre:"/^\d+\|x\x01.[A-Z].[A-Z]/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022423; rev:0;)

# Command&Control: (Trojan) Carberp - regex: to_server:^@?[0-9A-F]{8}\x3abpass detector_id: 22424
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Carberp"; flow:established,to_server,only_stream; content:"|3A|bpass"; pcre:"/^@?[0-9A-F]{8}\x3abpass/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022424; rev:0;)

# Command&Control: (Dropper) GenericDropper_100 - regex: to_server:^1#2#5#\d#0#5#\S+#2600-5-1-148-2 detector_id: 22425
alert tcp $HOME_NET any -> $EXTERNAL_NET 5673 (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_100"; flow:established,to_server,only_stream; content:"1|23|2|23|5|23|"; depth:6; content:"|23|0|23|5|23|"; distance:1; within:6; content:"|23|2600-5-1-148-2"; distance:0; pcre:"/^1#2#5#\d#0#5#\S+#2600-5-1-148-2/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022425; rev:0;)

# Command&Control: (Trojan) Ramnit - regex: to_server:^\x00\xff\x49\x00{3}$ detector_id: 22426
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ramnit"; flow:established,to_server,only_stream; content:"|00 FF|I|00 00 00|"; depth:6; pcre:"/^\x00\xff\x49\x00{3}$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022426; rev:0;)

# Command&Control: (Trojan) Ramnit - regex: to_server:^\x00\xff\x49\x00{3}\xe2\x00\x1e\x00{3} detector_id: 22427
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ramnit"; flow:established,to_server,only_stream; content:"|00 FF|I|00 00 00 E2 00 1E 00 00 00|"; depth:12; pcre:"/^\x00\xff\x49\x00{3}\xe2\x00\x1e\x00{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022427; rev:0;)

# Command&Control: (Trojan) Farfli - regex: to_server:^(.{2}\x00{2}){2}[A-Za-z]{5,7}(\|)?x\x9cK detector_id: 22430
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Farfli"; flow:established,to_server,only_stream; content:"|00 00|"; offset:2; depth:4; content:"|00 00|"; distance:2; within:4; content:"x|9C|K"; distance:0; pcre:"/^(.{2}\x00{2}){2}[A-Za-z]{5,7}(\|)?x\x9cK/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022430; rev:0;)

# Command&Control: (Trojan) Waprox - regex: to_server:^(C|W)4604\xc8/\x87\{-5b9 detector_id: 22431
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Waprox"; flow:established,to_server,only_stream; content:"C4604|C8|/|87 7B|-5b9"; depth:13; pcre:"/^(C|W)4604\xc8\/\x87\{-5b9/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102243100; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Waprox"; flow:established,to_server,only_stream; content:"W4604|C8|/|87 7B|-5b9"; depth:13; pcre:"/^(C|W)4604\xc8\/\x87\{-5b9/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102243101; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}\xc6\x69.{20}\xdf\xaf\x59\x9a\xa1\xcb\x91\x77\x95\xdc\xd9\xf8\x66\x55\x2a\x8b detector_id: 22432
alert tcp $HOME_NET any -> $EXTERNAL_NET 20525 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|C6|i"; offset:2; depth:4; content:"|DF AF|Y|9A A1 CB 91|w|95 DC D9 F8|fU|2A 8B|"; distance:20; within:36; pcre:"/^.{2}\xc6\x69.{20}\xdf\xaf\x59\x9a\xa1\xcb\x91\x77\x95\xdc\xd9\xf8\x66\x55\x2a\x8b/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022432; rev:0;)

# Command&Control: (Trojan) Zegost - regex: to_server:^Billx.\x00{3}\x30\x01\x00{3} detector_id: 22433
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Billx"; depth:5; content:"|00 00 00|0|01 00 00 00|"; distance:1; within:9; pcre:"/^Billx.\x00{3}\x30\x01\x00{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022433; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}R(\x84|\x86).{20}\xd2\x41\x5b\xa6\x09\x13\x55\xdb\x1c\x33\x7d\x89\xd6\xeb\x54\xa3 detector_id: 22434
alert tcp $HOME_NET any -> $EXTERNAL_NET 20641 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"R|84|"; offset:2; depth:4; content:"|D2|A|5B A6 09 13|U|DB 1C|3|7D 89 D6 EB|T|A3|"; distance:20; within:36; pcre:"/^.{2}R(\x84|\x86).{20}\xd2\x41\x5b\xa6\x09\x13\x55\xdb\x1c\x33\x7d\x89\xd6\xeb\x54\xa3/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102243400; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 20641 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"R|86|"; offset:2; depth:4; content:"|D2|A|5B A6 09 13|U|DB 1C|3|7D 89 D6 EB|T|A3|"; distance:20; within:36; pcre:"/^.{2}R(\x84|\x86).{20}\xd2\x41\x5b\xa6\x09\x13\x55\xdb\x1c\x33\x7d\x89\xd6\xeb\x54\xa3/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102243401; rev:0;)

# Command&Control: (Backdoor) Khelios - regex: to_server:^(.[\x81-\x82]\xef\x7e){3}(.[\x85-\x87]\xef\x7e){3} detector_id: 22435
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|81 EF 7E|"; offset:1; depth:4; content:"|81 EF 7E|"; distance:0; content:"|81 EF 7E|"; distance:0; content:"|EF 7E|"; distance:2; within:4; content:"|EF 7E|"; distance:2; within:4; content:"|EF 7E|"; distance:2; within:4; pcre:"/^(.[\x81-\x82]\xef\x7e){3}(.[\x85-\x87]\xef\x7e){3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102243500; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|82 EF 7E|"; offset:1; depth:4; content:"|81 EF 7E|"; distance:0; content:"|81 EF 7E|"; distance:0; content:"|EF 7E|"; distance:2; within:4; content:"|EF 7E|"; distance:2; within:4; content:"|EF 7E|"; distance:2; within:4; pcre:"/^(.[\x81-\x82]\xef\x7e){3}(.[\x85-\x87]\xef\x7e){3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102243501; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|81 EF 7E|"; offset:1; depth:4; content:"|82 EF 7E|"; distance:0; content:"|81 EF 7E|"; distance:0; content:"|EF 7E|"; distance:2; within:4; content:"|EF 7E|"; distance:2; within:4; content:"|EF 7E|"; distance:2; within:4; pcre:"/^(.[\x81-\x82]\xef\x7e){3}(.[\x85-\x87]\xef\x7e){3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102243502; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|82 EF 7E|"; offset:1; depth:4; content:"|82 EF 7E|"; distance:0; content:"|81 EF 7E|"; distance:0; content:"|EF 7E|"; distance:2; within:4; content:"|EF 7E|"; distance:2; within:4; content:"|EF 7E|"; distance:2; within:4; pcre:"/^(.[\x81-\x82]\xef\x7e){3}(.[\x85-\x87]\xef\x7e){3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102243503; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|81 EF 7E|"; offset:1; depth:4; content:"|81 EF 7E|"; distance:0; content:"|82 EF 7E|"; distance:0; content:"|EF 7E|"; distance:2; within:4; content:"|EF 7E|"; distance:2; within:4; content:"|EF 7E|"; distance:2; within:4; pcre:"/^(.[\x81-\x82]\xef\x7e){3}(.[\x85-\x87]\xef\x7e){3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102243504; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|82 EF 7E|"; offset:1; depth:4; content:"|81 EF 7E|"; distance:0; content:"|82 EF 7E|"; distance:0; content:"|EF 7E|"; distance:2; within:4; content:"|EF 7E|"; distance:2; within:4; content:"|EF 7E|"; distance:2; within:4; pcre:"/^(.[\x81-\x82]\xef\x7e){3}(.[\x85-\x87]\xef\x7e){3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102243505; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|81 EF 7E|"; offset:1; depth:4; content:"|82 EF 7E|"; distance:0; content:"|82 EF 7E|"; distance:0; content:"|EF 7E|"; distance:2; within:4; content:"|EF 7E|"; distance:2; within:4; content:"|EF 7E|"; distance:2; within:4; pcre:"/^(.[\x81-\x82]\xef\x7e){3}(.[\x85-\x87]\xef\x7e){3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102243506; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"|82 EF 7E|"; offset:1; depth:4; content:"|82 EF 7E|"; distance:0; content:"|82 EF 7E|"; distance:0; content:"|EF 7E|"; distance:2; within:4; content:"|EF 7E|"; distance:2; within:4; content:"|EF 7E|"; distance:2; within:4; pcre:"/^(.[\x81-\x82]\xef\x7e){3}(.[\x85-\x87]\xef\x7e){3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102243507; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^A76DB65C55EBDF8 detector_id: 22436
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"A76DB65C55EBDF8"; depth:15; pcre:"/^A76DB65C55EBDF8/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022436; rev:0;)

# Command&Control: (Backdoor) Xtrat - regex: to_server:^myversion\|\d\.\d((\x0d\x0a)|\x20) detector_id: 22437
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Xtrat"; flow:established,to_server,only_stream; content:"myversion|7C|"; depth:10; content:"."; distance:1; within:2; content:"|0D 0A|"; distance:1; within:3; pcre:"/^myversion\|\d\.\d((\x0d\x0a)|\x20)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102243700; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Xtrat"; flow:established,to_server,only_stream; content:"myversion|7C|"; depth:10; content:"."; distance:1; within:2; content:" "; distance:1; within:2; pcre:"/^myversion\|\d\.\d((\x0d\x0a)|\x20)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102243701; rev:0;)

# Command&Control: (Trojan) Farfli - regex: to_server:^(.[\x00\x01]\x00{2}){2}\S+x\x9cK.{4}\xc3\xc0{3} detector_id: 22438
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Farfli"; flow:established,to_server,only_stream; content:"|00 00 00|"; offset:1; depth:4; content:"|00 00 00|"; distance:0; content:"x|9C|K"; distance:0; content:"|C3 C0 C0 C0|"; distance:4; within:8; pcre:"/^(.[\x00\x01]\x00{2}){2}\S+x\x9cK.{4}\xc3\xc0{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102243800; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Farfli"; flow:established,to_server,only_stream; content:"|01 00 00|"; offset:1; depth:4; content:"|00 00 00|"; distance:0; content:"x|9C|K"; distance:0; content:"|C3 C0 C0 C0|"; distance:4; within:8; pcre:"/^(.[\x00\x01]\x00{2}){2}\S+x\x9cK.{4}\xc3\xc0{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102243801; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Farfli"; flow:established,to_server,only_stream; content:"|00 00 00|"; offset:1; depth:4; content:"|01 00 00|"; distance:0; content:"x|9C|K"; distance:0; content:"|C3 C0 C0 C0|"; distance:4; within:8; pcre:"/^(.[\x00\x01]\x00{2}){2}\S+x\x9cK.{4}\xc3\xc0{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102243802; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Farfli"; flow:established,to_server,only_stream; content:"|01 00 00|"; offset:1; depth:4; content:"|01 00 00|"; distance:0; content:"x|9C|K"; distance:0; content:"|C3 C0 C0 C0|"; distance:4; within:8; pcre:"/^(.[\x00\x01]\x00{2}){2}\S+x\x9cK.{4}\xc3\xc0{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102243803; rev:0;)

# Command&Control: (Dropper) Tobor - regex: to_server:^\d006806\S+$ detector_id: 22439
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"OpenBDS Command&Control: (Dropper) Tobor"; flow:established,to_server,only_stream; content:"006806"; offset:1; depth:7; pcre:"/^\d006806\S+$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022439; rev:0;)

# Command&Control: (Trojan) GenericTrojan_112 - regex: to_server:^\xd2\x02\x96\x49\x00{4}.[\x00-\x04]\x00{6} detector_id: 22440
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_112"; flow:established,to_server,only_stream; content:"|D2 02 96|I|00 00 00 00|"; depth:8; content:"|00 00 00 00 00 00|"; distance:2; within:8; pcre:"/^\xd2\x02\x96\x49\x00{4}.[\x00-\x04]\x00{6}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022440; rev:0;)

# Command&Control: (Trojan) Crime - regex: to_server:^Stealer by W33DY detector_id: 22442
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Crime"; flow:established,to_server,only_stream; content:"Stealer by W33DY"; depth:16; pcre:"/^Stealer by W33DY/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022442; rev:0;)

# Command&Control: (Trojan) GenericTrojan_113 - regex: to_server:^A\x00{3}\x03.{65}\x00{3}\x05 detector_id: 22443
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_113"; flow:established,to_server,only_stream; content:"A|00 00 00 03|"; depth:5; content:"|00 00 00 05|"; distance:65; within:69; pcre:"/^A\x00{3}\x03.{65}\x00{3}\x05/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022443; rev:0;)

# Command&Control: (Backdoor) Tenpeq - regex: to_server:^\x11\x02\x00{2}\d+\.\d+\.\d+\.\d+\x00{4}[\x00\x01]\x00{3}Version \d+\.\d+ detector_id: 22444
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Tenpeq"; flow:established,to_server,only_stream; content:"|11 02 00 00|"; depth:4; content:"."; distance:0; content:"."; distance:0; content:"."; distance:0; content:"|00 00 00 00 00 00 00 00|Version "; distance:0; content:"."; distance:0; pcre:"/^\x11\x02\x00{2}\d+\.\d+\.\d+\.\d+\x00{4}[\x00\x01]\x00{3}Version \d+\.\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102244400; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Tenpeq"; flow:established,to_server,only_stream; content:"|11 02 00 00|"; depth:4; content:"."; distance:0; content:"."; distance:0; content:"."; distance:0; content:"|00 00 00 00 01 00 00 00|Version "; distance:0; content:"."; distance:0; pcre:"/^\x11\x02\x00{2}\d+\.\d+\.\d+\.\d+\x00{4}[\x00\x01]\x00{3}Version \d+\.\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102244401; rev:0;)

# Command&Control: (Backdoor) Tenpeq - regex: to_server:^\x11\x02\x00{2}\d+\.\d+\.\d+\.\d+\x00{4}[\x00\x01]\x00{3}RUser \d+\.\d+ detector_id: 22445
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Tenpeq"; flow:established,to_server,only_stream; content:"|11 02 00 00|"; depth:4; content:"."; distance:0; content:"."; distance:0; content:"."; distance:0; content:"|00 00 00 00 00 00 00 00|RUser "; distance:0; content:"."; distance:0; pcre:"/^\x11\x02\x00{2}\d+\.\d+\.\d+\.\d+\x00{4}[\x00\x01]\x00{3}RUser \d+\.\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102244500; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Tenpeq"; flow:established,to_server,only_stream; content:"|11 02 00 00|"; depth:4; content:"."; distance:0; content:"."; distance:0; content:"."; distance:0; content:"|00 00 00 00 01 00 00 00|RUser "; distance:0; content:"."; distance:0; pcre:"/^\x11\x02\x00{2}\d+\.\d+\.\d+\.\d+\x00{4}[\x00\x01]\x00{3}RUser \d+\.\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102244501; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x41\x4e\x18.{20}\x19\x7d\x2a\x50\x15\xea\x9b\x0f\x3b\xcb\x46\x47\xdf\x11\xf6\x8e detector_id: 22446
alert tcp $HOME_NET any -> $EXTERNAL_NET 11550 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"AN|18|"; offset:1; depth:4; content:"|19 7D 2A|P|15 EA 9B 0F 3B CB|FG|DF 11 F6 8E|"; distance:20; within:36; pcre:"/^.\x41\x4e\x18.{20}\x19\x7d\x2a\x50\x15\xea\x9b\x0f\x3b\xcb\x46\x47\xdf\x11\xf6\x8e/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022446; rev:0;)

# Command&Control: (Keylogger) GenericKeylogger_2 - regex: to_server:^AuthAdministrator *@ *PC\\#/Win detector_id: 22447
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Keylogger) GenericKeylogger_2"; flow:established,to_server,only_stream; content:"AuthAdministrator"; depth:17; content:"|40|"; distance:0; content:"PC|5C 23|/Win"; distance:0; pcre:"/^AuthAdministrator *@ *PC\\#\/Win/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022447; rev:0;)

# Command&Control: (Dropper) GenericDropper_101 - regex: to_server:^LoginMaster=\S+=\d+=\d+\.\d+\.\d+\.\d+=mem\d+=End detector_id: 22448
alert tcp $HOME_NET any -> $EXTERNAL_NET 9099 (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_101"; flow:established,to_server,only_stream; content:"LoginMaster="; depth:12; content:"="; distance:0; content:"="; distance:0; content:"."; distance:0; content:"."; distance:0; content:"."; distance:0; content:"=mem"; distance:0; content:"=End"; distance:0; pcre:"/^LoginMaster=\S+=\d+=\d+\.\d+\.\d+\.\d+=mem\d+=End/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022448; rev:0;)

# Command&Control: (Trojan) GenericTrojan_114 - regex: to_server:^HTTP1\.8 GET(0|\x00{3}) detector_id: 22449
alert tcp $HOME_NET any -> $EXTERNAL_NET 8080 (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_114"; flow:established,to_server,only_stream; content:"HTTP1.8 GET0"; depth:12; pcre:"/^HTTP1\.8 GET(0|\x00{3})/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102244900; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 8080 (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_114"; flow:established,to_server,only_stream; content:"HTTP1.8 GET|00 00 00|"; depth:14; pcre:"/^HTTP1\.8 GET(0|\x00{3})/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102244901; rev:0;)

# FakeAV: GenericFakeCryptoTool_1 - regex: to_server:^\x03\x01\xb1\x1c\x6c\xb1\xf4\x10\x22\x11.{9}\x00{2}\xa8\x04 detector_id: 22450
alert tcp $HOME_NET any -> $EXTERNAL_NET 777 (msg:"OpenBDS FakeAV: GenericFakeCryptoTool_1"; flow:established,to_server,only_stream; content:"|03 01 B1 1C|l|B1 F4 10 22 11|"; depth:10; content:"|00 00 A8 04|"; distance:9; within:13; pcre:"/^\x03\x01\xb1\x1c\x6c\xb1\xf4\x10\x22\x11.{9}\x00{2}\xa8\x04/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022450; rev:0;)

# Command&Control: (Trojan) GenericTrojan_115 - regex: to_server:^STARTOK\|\d+\.\d+\.\d+\.\d+\|\d+\|.*(connect|s0cks) detector_id: 22452
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_115"; flow:established,to_server,only_stream; content:"STARTOK|7C|"; depth:8; content:"."; distance:0; content:"."; distance:0; content:"."; distance:0; content:"|7C|"; distance:0; content:"|7C|"; distance:0; content:"connect"; distance:0; pcre:"/^STARTOK\|\d+\.\d+\.\d+\.\d+\|\d+\|.*(connect|s0cks)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102245200; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_115"; flow:established,to_server,only_stream; content:"STARTOK|7C|"; depth:8; content:"."; distance:0; content:"."; distance:0; content:"."; distance:0; content:"|7C|"; distance:0; content:"|7C|"; distance:0; content:"s0cks"; distance:0; pcre:"/^STARTOK\|\d+\.\d+\.\d+\.\d+\|\d+\|.*(connect|s0cks)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102245201; rev:0;)

# Command&Control: (Trojan) GenericTrojan_116 - regex: to_server:^5\x15.\x00Windows XP\x00{22}\d+ MHz detector_id: 22453
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_116"; flow:established,to_server,only_stream; content:"5|15|"; depth:2; content:"|00|Windows XP|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:1; within:34; content:" MHz"; distance:0; pcre:"/^5\x15.\x00Windows XP\x00{22}\d+ MHz/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022453; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x2d\x50\xd6.{20}\xa7\x78\xe9\x2c\x1b\x0b\xb1\x57\x1a\x98\x60\x08\x94\xa0\x43\xf7 detector_id: 22454
alert tcp $HOME_NET any -> $EXTERNAL_NET 29365 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"-P|D6|"; offset:1; depth:4; content:"|A7|x|E9 2C 1B 0B B1|W|1A 98 60 08 94 A0|C|F7|"; distance:20; within:36; pcre:"/^.\x2d\x50\xd6.{20}\xa7\x78\xe9\x2c\x1b\x0b\xb1\x57\x1a\x98\x60\x08\x94\xa0\x43\xf7/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022454; rev:0;)

# Command&Control: (Trojan) Zegost - regex: to_server:^\x16\x00{3}[A-Z]{5}.{2}\x00{2}x\x9cK detector_id: 22458
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"|16 00 00 00|"; depth:4; content:"|00 00|x|9C|K"; distance:7; within:12; pcre:"/^\x16\x00{3}[A-Z]{5}.{2}\x00{2}x\x9cK/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022458; rev:0;)

# Command&Control: (Trojan) GenericTrojan_117 - regex: to_server:^..\x09\x00Win.*\x00{10} detector_id: 22460
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_117"; flow:established,to_server,only_stream; content:"|09 00|Win"; offset:2; depth:7; content:"|00 00 00 00 00 00 00 00 00 00|"; distance:0; pcre:"/^..\x09\x00Win.*\x00{10}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022460; rev:0;)

# Command&Control: (Trojan) Levitiang - regex: to_server:^inicio#&.*#User_ detector_id: 22461
alert tcp $HOME_NET any -> $EXTERNAL_NET 83 (msg:"OpenBDS Command&Control: (Trojan) Levitiang"; flow:established,to_server,only_stream; content:"inicio|23|&"; depth:8; content:"|23|User_"; distance:0; pcre:"/^inicio#&.*#User_/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022461; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x4f\x74\x4a.{20}\xa5\x08\x94\xfb\x8e\x3e\x58\x46\x2a\x81\x27\xf6\x69\x58\xc8\x9e detector_id: 22462
alert tcp $HOME_NET any -> $EXTERNAL_NET 19455 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"OtJ"; offset:1; depth:4; content:"|A5 08 94 FB 8E|>XF|2A 81 27 F6|iX|C8 9E|"; distance:20; within:36; pcre:"/^.\x4f\x74\x4a.{20}\xa5\x08\x94\xfb\x8e\x3e\x58\x46\x2a\x81\x27\xf6\x69\x58\xc8\x9e/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022462; rev:0;)

# Command&Control: (Trojan) IRC Bot - regex: to_server:^USER.*\x0aNICK \[WinXP\|x86\|\d+\]\x0aPONG :[A-F0-9]{8} detector_id: 22463
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) IRC Bot"; flow:established,to_server,only_stream; content:"USER"; depth:4; content:"|0A|NICK |5B|WinXP|7C|x86|7C|"; distance:0; content:"|5D 0A|PONG |3A|"; distance:0; pcre:"/^USER.*\x0aNICK \[WinXP\|x86\|\d+\]\x0aPONG :[A-F0-9]{8}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022463; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}\xba\x81.{20}\x67\x35\x8f\x4b\x97\xdf\x73\x9a\xdc\x79\xe7\xbf\x07\x41\xe3\x0e detector_id: 22464
alert tcp $HOME_NET any -> $EXTERNAL_NET 19644 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|BA 81|"; offset:2; depth:4; content:"g5|8F|K|97 DF|s|9A DC|y|E7 BF 07|A|E3 0E|"; distance:20; within:36; pcre:"/^.{2}\xba\x81.{20}\x67\x35\x8f\x4b\x97\xdf\x73\x9a\xdc\x79\xe7\xbf\x07\x41\xe3\x0e/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022464; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}R(\x84|\x86).{20}\x55\xcf\x1a\x57\x19\x42\xb8\x08\x50\x02\x49\x8a\x33\xa7\x1b\xd2 detector_id: 22465
alert tcp $HOME_NET any -> $EXTERNAL_NET 20641 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"R|84|"; offset:2; depth:4; content:"U|CF 1A|W|19|B|B8 08|P|02|I|8A|3|A7 1B D2|"; distance:20; within:36; pcre:"/^.{2}R(\x84|\x86).{20}\x55\xcf\x1a\x57\x19\x42\xb8\x08\x50\x02\x49\x8a\x33\xa7\x1b\xd2/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102246500; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 20641 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"R|86|"; offset:2; depth:4; content:"U|CF 1A|W|19|B|B8 08|P|02|I|8A|3|A7 1B D2|"; distance:20; within:36; pcre:"/^.{2}R(\x84|\x86).{20}\x55\xcf\x1a\x57\x19\x42\xb8\x08\x50\x02\x49\x8a\x33\xa7\x1b\xd2/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102246501; rev:0;)

# Command&Control: (Dropper) Dinwod - regex: to_server:^USER 1234\x0d\x0aPASS 1234\x0d\x0aPORT \d+,\d+,\d+,\d+,\d+,\d+\x0d\x0aRETR \d.exe detector_id: 22466
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 (msg:"OpenBDS Command&Control: (Dropper) Dinwod"; flow:established,to_server,only_stream; content:"USER 1234|0D 0A|PASS 1234|0D 0A|PORT "; depth:27; content:"|2C|"; distance:0; content:"|2C|"; distance:0; content:"|2C|"; distance:0; content:"|2C|"; distance:0; content:"|2C|"; distance:0; content:"|0D 0A|RETR "; distance:0; content:"exe"; distance:2; within:5; pcre:"/^USER 1234\x0d\x0aPASS 1234\x0d\x0aPORT \d+,\d+,\d+,\d+,\d+,\d+\x0d\x0aRETR \d.exe/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022466; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}\x50\xd6.{20}\xa2\x9f\xcd\x78\xa2\xba\xfb\xbf\x18\xb0\x56\x68\x86\x8d\xd1\xea detector_id: 22468
alert tcp $HOME_NET any -> $EXTERNAL_NET 29365 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"P|D6|"; offset:2; depth:4; content:"|A2 9F CD|x|A2 BA FB BF 18 B0|Vh|86 8D D1 EA|"; distance:20; within:36; pcre:"/^.{2}\x50\xd6.{20}\xa2\x9f\xcd\x78\xa2\xba\xfb\xbf\x18\xb0\x56\x68\x86\x8d\xd1\xea/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022468; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^21BFA07A83121B949443A333 detector_id: 22469
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"21BFA07A83121B949443A333"; depth:24; pcre:"/^21BFA07A83121B949443A333/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022469; rev:0;)

# Command&Control: (Trojan) Locotout - regex: to_server:^\x06\x00crap64 detector_id: 22470
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Locotout"; flow:established,to_server,only_stream; content:"|06 00|crap64"; depth:8; pcre:"/^\x06\x00crap64/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022470; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^322FAFE0461C08049BD9663D detector_id: 22471
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"322FAFE0461C08049BD9663D"; depth:24; pcre:"/^322FAFE0461C08049BD9663D/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022471; rev:0;)

# Command&Control: (Trojan) Lethic - regex: to_server:^\x00{4}\x06.{3}\x00\x21\x01.{3}\x00\x03\x2b\x00 detector_id: 22472
alert tcp $HOME_NET any -> $EXTERNAL_NET 8800 (msg:"OpenBDS Command&Control: (Trojan) Lethic"; flow:established,to_server,only_stream; content:"|00 00 00 00 06|"; depth:5; content:"|00 21 01|"; distance:3; within:6; content:"|00 03 2B 00|"; distance:3; within:7; pcre:"/^\x00{4}\x06.{3}\x00\x21\x01.{3}\x00\x03\x2b\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022472; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}\xba\x81.{40}\x34\x0d\xed\xb4$ detector_id: 22473
alert tcp $HOME_NET any -> $EXTERNAL_NET 19644 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|BA 81|"; offset:2; depth:4; content:"4|0D ED B4|"; distance:40; within:44; pcre:"/^.{2}\xba\x81.{40}\x34\x0d\xed\xb4$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022473; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}\x8c\x83.{40}\x00\x16\xf2\xd6$ detector_id: 22474
alert tcp $HOME_NET any -> $EXTERNAL_NET 16629 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|8C 83|"; offset:2; depth:4; content:"|00 16 F2 D6|"; distance:40; within:44; pcre:"/^.{2}\x8c\x83.{40}\x00\x16\xf2\xd6$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022474; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}\x18(\x09|\x0b).{40}\x89\xe4\x6e\x84$ detector_id: 22475
alert tcp $HOME_NET any -> $EXTERNAL_NET 13109 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|18 09|"; offset:2; depth:4; content:"|89 E4|n|84|"; distance:40; within:44; pcre:"/^.{2}\x18(\x09|\x0b).{40}\x89\xe4\x6e\x84$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102247500; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 13109 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|18 0B|"; offset:2; depth:4; content:"|89 E4|n|84|"; distance:40; within:44; pcre:"/^.{2}\x18(\x09|\x0b).{40}\x89\xe4\x6e\x84$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102247501; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x9a\xaa\x86.{40}\xdc\xdf\x76\x43\xbe\xe7 detector_id: 22476
alert tcp $HOME_NET any -> $EXTERNAL_NET 20215 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|9A AA 86|"; offset:1; depth:4; content:"|DC DF|vC|BE E7|"; distance:40; within:46; pcre:"/^.\x9a\xaa\x86.{40}\xdc\xdf\x76\x43\xbe\xe7/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022476; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x2a\xc6\x69.{40}\xa5\xf4\x0c\xd4\x95\xab detector_id: 22477
alert tcp $HOME_NET any -> $EXTERNAL_NET 20525 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|2A C6|i"; offset:1; depth:4; content:"|A5 F4 0C D4 95 AB|"; distance:40; within:46; pcre:"/^.\x2a\xc6\x69.{40}\xa5\xf4\x0c\xd4\x95\xab/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022477; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x17\xbb\xb8.{40}\x8a\x9b\x9f\x0e\x0c\x1e detector_id: 22478
alert tcp $HOME_NET any -> $EXTERNAL_NET 28347 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|17 BB B8|"; offset:1; depth:4; content:"|8A 9B 9F 0E 0C 1E|"; distance:40; within:46; pcre:"/^.\x17\xbb\xb8.{40}\x8a\x9b\x9f\x0e\x0c\x1e/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022478; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}R(\x84|\x86).{40}\x41\xa2\xe7\x12$ detector_id: 22479
alert tcp $HOME_NET any -> $EXTERNAL_NET 20641 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"R|84|"; offset:2; depth:4; content:"A|A2 E7 12|"; distance:40; within:44; pcre:"/^.{2}R(\x84|\x86).{40}\x41\xa2\xe7\x12$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102247900; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 20641 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"R|86|"; offset:2; depth:4; content:"A|A2 E7 12|"; distance:40; within:44; pcre:"/^.{2}R(\x84|\x86).{40}\x41\xa2\xe7\x12$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102247901; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}\xeb\xef.{40}\x7c\x14\x9c\x4f$ detector_id: 22480
alert tcp $HOME_NET any -> $EXTERNAL_NET 28383 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|EB EF|"; offset:2; depth:4; content:"|7C 14 9C|O"; distance:40; within:44; pcre:"/^.{2}\xeb\xef.{40}\x7c\x14\x9c\x4f$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022480; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xde\x0c\x71.{40}\x46\xac\xdb\x2d\xe0\x28 detector_id: 22481
alert tcp $HOME_NET any -> $EXTERNAL_NET 28270 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|DE 0C|q"; offset:1; depth:4; content:"F|AC DB|-|E0 28|"; distance:40; within:46; pcre:"/^.\xde\x0c\x71.{40}\x46\xac\xdb\x2d\xe0\x28/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022481; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xe0\xd3\x35.{40}\x64\xed\x5c\x6f\xef\x19 detector_id: 22482
alert tcp $HOME_NET any -> $EXTERNAL_NET 11334 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|E0 D3|5"; offset:1; depth:4; content:"d|ED 5C|o|EF 19|"; distance:40; within:46; pcre:"/^.\xe0\xd3\x35.{40}\x64\xed\x5c\x6f\xef\x19/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022482; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xb5\xcf\x9c.{40}\x26\x50\xb5\xb3\xf0\x6e detector_id: 22483
alert tcp $HOME_NET any -> $EXTERNAL_NET 16535 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|B5 CF 9C|"; offset:1; depth:4; content:"&P|B5 B3 F0|n"; distance:40; within:46; pcre:"/^.\xb5\xcf\x9c.{40}\x26\x50\xb5\xb3\xf0\x6e/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022483; rev:0;)

# Command&Control: (Trojan) Hioles - regex: to_server:^\x85\xb2\x04\x77\xce\x38\xe0\x33\x02\x01\x4e\x00{3}.{4}\x32\xbb\xef\x7c detector_id: 22484
alert tcp $HOME_NET any -> $EXTERNAL_NET 1001 (msg:"OpenBDS Command&Control: (Trojan) Hioles"; flow:established,to_server,only_stream; content:"|85 B2 04|w|CE|8|E0|3|02 01|N|00 00 00|"; depth:14; content:"2|BB EF 7C|"; distance:4; within:8; pcre:"/^\x85\xb2\x04\x77\xce\x38\xe0\x33\x02\x01\x4e\x00{3}.{4}\x32\xbb\xef\x7c/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022484; rev:0;)

# Command&Control: (Backdoor) Xtrat - regex: to_server:^OK\x0d\x0a\xd2\x02\x96\x49\x00{4}.{2}\x00{6} detector_id: 22487
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Xtrat"; flow:established,to_server,only_stream; content:"OK|0D 0A D2 02 96|I|00 00 00 00|"; depth:12; content:"|00 00 00 00 00 00|"; distance:2; within:8; pcre:"/^OK\x0d\x0a\xd2\x02\x96\x49\x00{4}.{2}\x00{6}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022487; rev:0;)

# Command&Control: (Dropper) GenericDropper_102 - regex: to_server:^USER \S+\x0d\x0aPASS \S+\x0d\x0aPWD\x0d\x0aCWD win.*SIZE dead0\d\x0d\x0aRETR dead0\d detector_id: 22493
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_102"; flow:established,to_server,only_stream; content:"USER "; depth:5; content:"|0D 0A|PASS "; distance:0; content:"|0D 0A|PWD|0D 0A|CWD win"; distance:0; content:"SIZE dead0"; distance:0; content:"|0D 0A|RETR dead0"; distance:1; within:13; pcre:"/^USER \S+\x0d\x0aPASS \S+\x0d\x0aPWD\x0d\x0aCWD win.*SIZE dead0\d\x0d\x0aRETR dead0\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022493; rev:0;)

# Command&Control: (Trojan) Rebhip - regex: to_server:^\d+\|\x0a\x0eKK\xc6\x1e\x83\x87\xf88ne detector_id: 22494
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Rebhip"; flow:established,to_server,only_stream; content:"|7C 0A 0E|KK|C6 1E 83 87 F8|8ne"; pcre:"/^\d+\|\x0a\x0eKK\xc6\x1e\x83\x87\xf88ne/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022494; rev:0;)

# Command&Control: (Trojan) Usteal - regex: to_server:^UFR!.\x00{3}.{4}\x00{0,4}\x2c\x00{3} detector_id: 22495
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Usteal"; flow:established,to_server,only_stream; content:"UFR|21|"; depth:4; content:"|00 00 00|"; distance:1; within:4; content:"|2C 00 00 00|"; distance:0; pcre:"/^UFR!.\x00{3}.{4}\x00{0,4}\x2c\x00{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022495; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xb7\xe2\xd3.{40}\xeb\xa0\x7d\x6b\x56\x22 detector_id: 22496
alert tcp $HOME_NET any -> $EXTERNAL_NET 22277 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|B7 E2 D3|"; offset:1; depth:4; content:"|EB A0 7D|kV|22|"; distance:40; within:46; pcre:"/^.\xb7\xe2\xd3.{40}\xeb\xa0\x7d\x6b\x56\x22/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022496; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x61\x8a\xcf.{40}\x55\x1f\xb6\xa4\x05\x8c detector_id: 22497
alert tcp $HOME_NET any -> $EXTERNAL_NET 12279 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"a|8A CF|"; offset:1; depth:4; content:"U|1F B6 A4 05 8C|"; distance:40; within:46; pcre:"/^.\x61\x8a\xcf.{40}\x55\x1f\xb6\xa4\x05\x8c/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022497; rev:0;)

# Command&Control: (Worm) Mimail - regex: to_server:^\x00.zi\x01\x00{2}\x01\x00{6}.*\x00{2}\x0f\x00\x01$ detector_id: 22498
alert tcp $HOME_NET any -> $EXTERNAL_NET 53 (msg:"OpenBDS Command&Control: (Worm) Mimail"; flow:established,to_server,only_stream; content:"|00|"; depth:1; content:"zi|01 00 00 01 00 00 00 00 00 00|"; distance:1; within:13; content:"|00 00 0F 00 01|"; distance:0; pcre:"/^\x00.zi\x01\x00{2}\x01\x00{6}.*\x00{2}\x0f\x00\x01$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022498; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^DDCE9A73CC25E7E5AE4AEC0 detector_id: 22499
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"DDCE9A73CC25E7E5AE4AEC0"; depth:23; pcre:"/^DDCE9A73CC25E7E5AE4AEC0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022499; rev:0;)

# Command&Control: (Trojan) Turkojan - regex: to_server:^trn[CDG].*\x0d0C{8,}$ detector_id: 22500
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Turkojan"; flow:established,to_server,only_stream; content:"trn"; depth:3; content:"|0D|0CCCCCCCC"; distance:0; pcre:"/^trn[CDG].*\x0d0C{8,}$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022500; rev:0;)

# Command&Control: (Trojan) Parite - regex: to_server:^\xb0\x0b\x00{3}\xc0\xa8\x00\x02\xc0\xa8\x00\x02\x10\x27\x60\xea detector_id: 22508
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Parite"; flow:established,to_server,only_stream; content:"|B0 0B 00 00 00 C0 A8 00 02 C0 A8 00 02 10 27 60 EA|"; depth:17; pcre:"/^\xb0\x0b\x00{3}\xc0\xa8\x00\x02\xc0\xa8\x00\x02\x10\x27\x60\xea/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022508; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^BABB26310C03B1BE detector_id: 22509
alert tcp $HOME_NET any -> $EXTERNAL_NET 1604 (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"BABB26310C03B1BE"; depth:16; pcre:"/^BABB26310C03B1BE/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022509; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}\x63\x36.{40}\xf6\x96\xbd\xc6$ detector_id: 22510
alert tcp $HOME_NET any -> $EXTERNAL_NET 10928 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"c6"; offset:2; depth:4; content:"|F6 96 BD C6|"; distance:40; within:44; pcre:"/^.{2}\x63\x36.{40}\xf6\x96\xbd\xc6$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022510; rev:0;)

# Command&Control: (Backdoor) Darkshell - regex: to_server:^\x00{3}\x10.{3}(.)\1{60}.{5}\1{27} detector_id: 22511
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Darkshell"; flow:established,to_server,only_stream; content:"|00 00 00 10|"; depth:4; pcre:"/^\x00{3}\x10.{3}(.)\1{60}.{5}\1{27}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022511; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x83\x68\x95.{40}\x91\xce\xf6\x5d\xaa\x72 detector_id: 22512
alert tcp $HOME_NET any -> $EXTERNAL_NET 16391 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|83|h|95|"; offset:1; depth:4; content:"|91 CE F6 5D AA|r"; distance:40; within:46; pcre:"/^.\x83\x68\x95.{40}\x91\xce\xf6\x5d\xaa\x72/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022512; rev:0;)

# Command&Control: (Trojan) GenericTrojan_118 - regex: to_server:^>S\x00{3}E\x00{3}Vw.*Win detector_id: 22513
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_118"; flow:established,to_server,only_stream; content:">S|00 00 00|E|00 00 00|Vw"; depth:11; content:"Win"; distance:0; pcre:"/^>S\x00{3}E\x00{3}Vw.*Win/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022513; rev:0;)

# Command&Control: (Trojan) Ramnit - regex: to_server:^\x00\xff\x4d\x00{3}$ detector_id: 22522
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ramnit"; flow:established,to_server,only_stream; content:"|00 FF|M|00 00 00|"; depth:6; pcre:"/^\x00\xff\x4d\x00{3}$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022522; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}\xb0\x1b.{40}\xd2\x75\x44\x34$ detector_id: 22523
alert tcp $HOME_NET any -> $EXTERNAL_NET 18404 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|B0 1B|"; offset:2; depth:4; content:"|D2|uD4"; distance:40; within:44; pcre:"/^.{2}\xb0\x1b.{40}\xd2\x75\x44\x34$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022523; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x41\x4e\x18.{40}\x60\xbc\xf9\x75\xe5\x0b detector_id: 22524
alert tcp $HOME_NET any -> $EXTERNAL_NET 11550 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"AN|18|"; offset:1; depth:4; content:"|60 BC F9|u|E5 0B|"; distance:40; within:46; pcre:"/^.\x41\x4e\x18.{40}\x60\xbc\xf9\x75\xe5\x0b/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022524; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xff\x9c\xf2.{40}\x2b\xb7\xf1\xf2\x17\xe0 detector_id: 22525
alert tcp $HOME_NET any -> $EXTERNAL_NET 23482 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|FF 9C F2|"; offset:1; depth:4; content:"|2B B7 F1 F2 17 E0|"; distance:40; within:46; pcre:"/^.\xff\x9c\xf2.{40}\x2b\xb7\xf1\xf2\x17\xe0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022525; rev:0;)

# Command&Control: (Trojan) GenericTrojan_119 - regex: to_server:^l{0,1}v0njxq80(Driver|w0rm|hiigs) detector_id: 22526
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_119"; flow:established,to_server,only_stream; content:"v0njxq80Driver"; pcre:"/^l{0,1}v0njxq80(Driver|w0rm|hiigs)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102252600; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_119"; flow:established,to_server,only_stream; content:"v0njxq80w0rm"; pcre:"/^l{0,1}v0njxq80(Driver|w0rm|hiigs)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102252601; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_119"; flow:established,to_server,only_stream; content:"v0njxq80hiigs"; pcre:"/^l{0,1}v0njxq80(Driver|w0rm|hiigs)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102252602; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}\xb1[\x11\x13].{40}\xb3\x12\xe0\x7c$ detector_id: 22533
alert tcp $HOME_NET any -> $EXTERNAL_NET 22393 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|B1 11|"; offset:2; depth:4; content:"|B3 12 E0 7C|"; distance:40; within:44; pcre:"/^.{2}\xb1[\x11\x13].{40}\xb3\x12\xe0\x7c$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102253300; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 22393 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|B1 13|"; offset:2; depth:4; content:"|B3 12 E0 7C|"; distance:40; within:44; pcre:"/^.{2}\xb1[\x11\x13].{40}\xb3\x12\xe0\x7c$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102253301; rev:0;)

# Command&Control: (Backdoor) GenericBackdoor_8 - regex: to_server:^\x00{3}\x11\x60\x00{3}.{3}(.)\1{28}.{6}\1{6} detector_id: 22557
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) GenericBackdoor_8"; flow:established,to_server,only_stream; content:"|00 00 00 11 60 00 00 00|"; depth:8; pcre:"/^\x00{3}\x11\x60\x00{3}.{3}(.)\1{28}.{6}\1{6}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022557; rev:0;)

# Command&Control: (Backdoor) Tenpeq - regex: to_server:^\xa1\x01\x00{2}[\d\.]{7,15}\x00{10,}\S+.*WinXP.*\d+MHz.*\d+MB detector_id: 22564
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Tenpeq"; flow:established,to_server,only_stream; content:"|A1 01 00 00|"; depth:4; content:"|00 00 00 00 00 00 00 00 00 00|"; distance:0; content:"WinXP"; distance:0; content:"MHz"; distance:0; content:"MB"; distance:0; pcre:"/^\xa1\x01\x00{2}[\d\.]{7,15}\x00{10,}\S+.*WinXP.*\d+MHz.*\d+MB/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022564; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}\x90(\x5d|\x5f).{40}\xbe\x03\x89\x0a$ detector_id: 22568
alert tcp $HOME_NET any -> $EXTERNAL_NET 25417 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|90 5D|"; offset:2; depth:4; content:"|BE 03 89 0A|"; distance:40; within:44; pcre:"/^.{2}\x90(\x5d|\x5f).{40}\xbe\x03\x89\x0a$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102256800; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 25417 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|90|_"; offset:2; depth:4; content:"|BE 03 89 0A|"; distance:40; within:44; pcre:"/^.{2}\x90(\x5d|\x5f).{40}\xbe\x03\x89\x0a$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102256801; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}\x56(\xf0|\xf2).{20}\x49\xa9\x1d\xe1\x55\x99\x95\xe9\x9c\x23\xa6\xce\xbb\xcf\xb3\xfd\x13\xae\x4b\xe1 detector_id: 22569
alert tcp $HOME_NET any -> $EXTERNAL_NET 15916 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"V|F0|"; offset:2; depth:4; content:"I|A9 1D E1|U|99 95 E9 9C 23 A6 CE BB CF B3 FD 13 AE|K|E1|"; distance:20; within:40; pcre:"/^.{2}\x56(\xf0|\xf2).{20}\x49\xa9\x1d\xe1\x55\x99\x95\xe9\x9c\x23\xa6\xce\xbb\xcf\xb3\xfd\x13\xae\x4b\xe1/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102256900; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 15916 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"V|F2|"; offset:2; depth:4; content:"I|A9 1D E1|U|99 95 E9 9C 23 A6 CE BB CF B3 FD 13 AE|K|E1|"; distance:20; within:40; pcre:"/^.{2}\x56(\xf0|\xf2).{20}\x49\xa9\x1d\xe1\x55\x99\x95\xe9\x9c\x23\xa6\xce\xbb\xcf\xb3\xfd\x13\xae\x4b\xe1/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102256901; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}\x56(\xf0|\xf2).{20}\x5a\x94\x42\x01\x90\xd2\x7a\xfc\x1c\x8c\x9a\xdf\x4b\x2c\x22\x75\xc3\x31\x83\xda detector_id: 22570
alert tcp $HOME_NET any -> $EXTERNAL_NET 15916 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"V|F0|"; offset:2; depth:4; content:"Z|94|B|01 90 D2|z|FC 1C 8C 9A DF|K|2C 22|u|C3|1|83 DA|"; distance:20; within:40; pcre:"/^.{2}\x56(\xf0|\xf2).{20}\x5a\x94\x42\x01\x90\xd2\x7a\xfc\x1c\x8c\x9a\xdf\x4b\x2c\x22\x75\xc3\x31\x83\xda/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102257000; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 15916 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"V|F2|"; offset:2; depth:4; content:"Z|94|B|01 90 D2|z|FC 1C 8C 9A DF|K|2C 22|u|C3|1|83 DA|"; distance:20; within:40; pcre:"/^.{2}\x56(\xf0|\xf2).{20}\x5a\x94\x42\x01\x90\xd2\x7a\xfc\x1c\x8c\x9a\xdf\x4b\x2c\x22\x75\xc3\x31\x83\xda/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102257001; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}\x56(\xf0|\xf2).{20}\xd0\x8a\x96\xa6\x0f\xcf\xa9\x93\x92\x72\x7c\x1a\x85\x4c\x69\x91\x6b\xb3\x3b\xdd detector_id: 22571
alert tcp $HOME_NET any -> $EXTERNAL_NET 15916 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"V|F0|"; offset:2; depth:4; content:"|D0 8A 96 A6 0F CF A9 93 92|r|7C 1A 85|Li|91|k|B3 3B DD|"; distance:20; within:40; pcre:"/^.{2}\x56(\xf0|\xf2).{20}\xd0\x8a\x96\xa6\x0f\xcf\xa9\x93\x92\x72\x7c\x1a\x85\x4c\x69\x91\x6b\xb3\x3b\xdd/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102257100; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 15916 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"V|F2|"; offset:2; depth:4; content:"|D0 8A 96 A6 0F CF A9 93 92|r|7C 1A 85|Li|91|k|B3 3B DD|"; distance:20; within:40; pcre:"/^.{2}\x56(\xf0|\xf2).{20}\xd0\x8a\x96\xa6\x0f\xcf\xa9\x93\x92\x72\x7c\x1a\x85\x4c\x69\x91\x6b\xb3\x3b\xdd/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102257101; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}\x56(\xf0|\xf2).{20}\xfa\x19\x54\x7d\x8d\x19\xc7\x86\x0a\x4b\xd9\xe7\xa2\xf7\xc8\x16\xeb\xbb\x76\x7e detector_id: 22572
alert tcp $HOME_NET any -> $EXTERNAL_NET 15916 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"V|F0|"; offset:2; depth:4; content:"|FA 19|T|7D 8D 19 C7 86 0A|K|D9 E7 A2 F7 C8 16 EB BB|v|7E|"; distance:20; within:40; pcre:"/^.{2}\x56(\xf0|\xf2).{20}\xfa\x19\x54\x7d\x8d\x19\xc7\x86\x0a\x4b\xd9\xe7\xa2\xf7\xc8\x16\xeb\xbb\x76\x7e/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102257200; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 15916 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"V|F2|"; offset:2; depth:4; content:"|FA 19|T|7D 8D 19 C7 86 0A|K|D9 E7 A2 F7 C8 16 EB BB|v|7E|"; distance:20; within:40; pcre:"/^.{2}\x56(\xf0|\xf2).{20}\xfa\x19\x54\x7d\x8d\x19\xc7\x86\x0a\x4b\xd9\xe7\xa2\xf7\xc8\x16\xeb\xbb\x76\x7e/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102257201; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}\x18(\x0b|\xaf|x09).{20}\x3c\x4a\xfb\x61\xc3\x1a\x9a\x20\xc5\xea\x55\xd5\x0a\xaf\x84\xe2\xd2\xa0\xd4\x60 detector_id: 22574
alert tcp $HOME_NET any -> $EXTERNAL_NET 13109 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|18 0B|"; offset:2; depth:4; content:"<J|FB|a|C3 1A 9A| |C5 EA|U|D5 0A AF 84 E2 D2 A0 D4 60|"; distance:20; within:40; pcre:"/^.{2}\x18(\x0b|\xaf|x09).{20}\x3c\x4a\xfb\x61\xc3\x1a\x9a\x20\xc5\xea\x55\xd5\x0a\xaf\x84\xe2\xd2\xa0\xd4\x60/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102257400; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 13109 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|18 AF|"; offset:2; depth:4; content:"<J|FB|a|C3 1A 9A| |C5 EA|U|D5 0A AF 84 E2 D2 A0 D4 60|"; distance:20; within:40; pcre:"/^.{2}\x18(\x0b|\xaf|x09).{20}\x3c\x4a\xfb\x61\xc3\x1a\x9a\x20\xc5\xea\x55\xd5\x0a\xaf\x84\xe2\xd2\xa0\xd4\x60/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102257401; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 13109 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|18|x09"; offset:2; depth:6; content:"<J|FB|a|C3 1A 9A| |C5 EA|U|D5 0A AF 84 E2 D2 A0 D4 60|"; distance:20; within:40; pcre:"/^.{2}\x18(\x0b|\xaf|x09).{20}\x3c\x4a\xfb\x61\xc3\x1a\x9a\x20\xc5\xea\x55\xd5\x0a\xaf\x84\xe2\xd2\xa0\xd4\x60/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102257402; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}\x56(\xf0|\xf2).{20}\xd5\x6d\xb2\xf2\xb6\x7e\xe3\x7b\x90\x5a\x4a\x7a\x97\x61\xfb\x8c\xf2\x7c\x13\x1c detector_id: 22575
alert tcp $HOME_NET any -> $EXTERNAL_NET 15916 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"V|F0|"; offset:2; depth:4; content:"|D5|m|B2 F2 B6 7E E3 7B 90|ZJz|97|a|FB 8C F2 7C 13 1C|"; distance:20; within:40; pcre:"/^.{2}\x56(\xf0|\xf2).{20}\xd5\x6d\xb2\xf2\xb6\x7e\xe3\x7b\x90\x5a\x4a\x7a\x97\x61\xfb\x8c\xf2\x7c\x13\x1c/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102257500; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 15916 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"V|F2|"; offset:2; depth:4; content:"|D5|m|B2 F2 B6 7E E3 7B 90|ZJz|97|a|FB 8C F2 7C 13 1C|"; distance:20; within:40; pcre:"/^.{2}\x56(\xf0|\xf2).{20}\xd5\x6d\xb2\xf2\xb6\x7e\xe3\x7b\x90\x5a\x4a\x7a\x97\x61\xfb\x8c\xf2\x7c\x13\x1c/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102257501; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}\x56(\xf0|\xf2).{20}\x7d\x97\x15\x8c\x9d\x48\x2a\x55\x46\x7a\xed\xe4\x47\xbb\x87\x67\x8b\x34\xf0\xa0 detector_id: 22577
alert tcp $HOME_NET any -> $EXTERNAL_NET 15916 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"V|F0|"; offset:2; depth:4; content:"|7D 97 15 8C 9D|H|2A|UFz|ED E4|G|BB 87|g|8B|4|F0 A0|"; distance:20; within:40; pcre:"/^.{2}\x56(\xf0|\xf2).{20}\x7d\x97\x15\x8c\x9d\x48\x2a\x55\x46\x7a\xed\xe4\x47\xbb\x87\x67\x8b\x34\xf0\xa0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102257700; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 15916 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"V|F2|"; offset:2; depth:4; content:"|7D 97 15 8C 9D|H|2A|UFz|ED E4|G|BB 87|g|8B|4|F0 A0|"; distance:20; within:40; pcre:"/^.{2}\x56(\xf0|\xf2).{20}\x7d\x97\x15\x8c\x9d\x48\x2a\x55\x46\x7a\xed\xe4\x47\xbb\x87\x67\x8b\x34\xf0\xa0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102257701; rev:0;)

# Command&Control: (Trojan) ZBot  - regex: to_server:^.{2}\x56(\xf0|\xf2).{20}\xed\x80\xa8\xbe\x29\x47\x3e\xcb\xf6\x17\x75\x6d\xae\x9f\x58\xd3\xe6\x68\x2f\xfd detector_id: 22578
alert tcp $HOME_NET any -> $EXTERNAL_NET 15916 (msg:"OpenBDS Command&Control: (Trojan) ZBot "; flow:established,to_server,only_stream; content:"V|F0|"; offset:2; depth:4; content:"|ED 80 A8 BE 29|G>|CB F6 17|um|AE 9F|X|D3 E6|h/|FD|"; distance:20; within:40; pcre:"/^.{2}\x56(\xf0|\xf2).{20}\xed\x80\xa8\xbe\x29\x47\x3e\xcb\xf6\x17\x75\x6d\xae\x9f\x58\xd3\xe6\x68\x2f\xfd/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102257800; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 15916 (msg:"OpenBDS Command&Control: (Trojan) ZBot "; flow:established,to_server,only_stream; content:"V|F2|"; offset:2; depth:4; content:"|ED 80 A8 BE 29|G>|CB F6 17|um|AE 9F|X|D3 E6|h/|FD|"; distance:20; within:40; pcre:"/^.{2}\x56(\xf0|\xf2).{20}\xed\x80\xa8\xbe\x29\x47\x3e\xcb\xf6\x17\x75\x6d\xae\x9f\x58\xd3\xe6\x68\x2f\xfd/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102257801; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}\x56\xf0.{20}\x4b\x41\xae\xbe\xc2\xb1\x05\x52\x35\x37\xb4\xe7\x24\x1d\xd3\x3e\x8a\x53\xb3\x34 detector_id: 22579
alert tcp $HOME_NET any -> $EXTERNAL_NET 15916 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"V|F0|"; offset:2; depth:4; content:"KA|AE BE C2 B1 05|R57|B4 E7 24 1D D3|>|8A|S|B3|4"; distance:20; within:40; pcre:"/^.{2}\x56\xf0.{20}\x4b\x41\xae\xbe\xc2\xb1\x05\x52\x35\x37\xb4\xe7\x24\x1d\xd3\x3e\x8a\x53\xb3\x34/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022579; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x2d\xa1\x1c.{20}\x31\xc1\x30\xbf\x83\x9b\xc7\x38\xb7\xe7\xff\x16\x26\x69\x8b\x97 detector_id: 22580
alert tcp $HOME_NET any -> $EXTERNAL_NET 22868 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"-|A1 1C|"; offset:1; depth:4; content:"1|C1|0|BF 83 9B C7|8|B7 E7 FF 16|&i|8B 97|"; distance:20; within:36; pcre:"/^.\x2d\xa1\x1c.{20}\x31\xc1\x30\xbf\x83\x9b\xc7\x38\xb7\xe7\xff\x16\x26\x69\x8b\x97/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022580; rev:0;)

# Command&Control: (Trojan) Luder - regex: to_server:^[\x22-\x25]\x00{2}\x01.*\x00{2}Q\x00{4}(\x03\x00{2})+$ detector_id: 22588
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Luder"; flow:established,to_server,only_stream; content:"|00 00 01|"; offset:1; depth:4; content:"|00 00|Q|00 00 00 00 03 00 00|"; distance:0; pcre:"/^[\x22-\x25]\x00{2}\x01.*\x00{2}Q\x00{4}(\x03\x00{2})+$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022588; rev:0;)

# Command&Control: (Trojan) Dibik - regex: to_server:^\x00{4}.\x00{3}x\x9c\x0b\xcf\xcc\x8b\x08\xa8\x31\x34\x32\xaf\x89 detector_id: 22589
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Dibik"; flow:established,to_server,only_stream; content:"|00 00 00 00|"; depth:4; content:"|00 00 00|x|9C 0B CF CC 8B 08 A8|142|AF 89|"; distance:1; within:17; pcre:"/^\x00{4}.\x00{3}x\x9c\x0b\xcf\xcc\x8b\x08\xa8\x31\x34\x32\xaf\x89/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022589; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x58\xe1\x81.{20}\x21\xa5\x9f\x82\x9c\x66\x78\x7b\xb2\x96\x6b\xcd\xd2\xbf\xb9\xec detector_id: 22590
alert tcp $HOME_NET any -> $EXTERNAL_NET 18368 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"X|E1 81|"; offset:1; depth:4; content:"|21 A5 9F 82 9C|fx|7B B2 96|k|CD D2 BF B9 EC|"; distance:20; within:36; pcre:"/^.\x58\xe1\x81.{20}\x21\xa5\x9f\x82\x9c\x66\x78\x7b\xb2\x96\x6b\xcd\xd2\xbf\xb9\xec/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022590; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x2d\xa1\x1c.{20}\x91\x4c\x26\xc3\x9e\x50\x7a\x42\xa1\x20\xbc\x2e\xcf\xb2\x61\xf4 detector_id: 22591
alert tcp $HOME_NET any -> $EXTERNAL_NET 22868 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"-|A1 1C|"; offset:1; depth:4; content:"|91|L&|C3 9E|PzB|A1| |BC|.|CF B2|a|F4|"; distance:20; within:36; pcre:"/^.\x2d\xa1\x1c.{20}\x91\x4c\x26\xc3\x9e\x50\x7a\x42\xa1\x20\xbc\x2e\xcf\xb2\x61\xf4/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022591; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}\x56(\xf0|\xf2).{20}\xcd\x13\x43\xf8\x9c\xb9\x19\x97\x6b\x66\x95\x87\x32\xf2\x3b\xfd detector_id: 22592
alert tcp $HOME_NET any -> $EXTERNAL_NET 15916 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"V|F0|"; offset:2; depth:4; content:"|CD 13|C|F8 9C B9 19 97|kf|95 87|2|F2 3B FD|"; distance:20; within:36; pcre:"/^.{2}\x56(\xf0|\xf2).{20}\xcd\x13\x43\xf8\x9c\xb9\x19\x97\x6b\x66\x95\x87\x32\xf2\x3b\xfd/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102259200; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 15916 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"V|F2|"; offset:2; depth:4; content:"|CD 13|C|F8 9C B9 19 97|kf|95 87|2|F2 3B FD|"; distance:20; within:36; pcre:"/^.{2}\x56(\xf0|\xf2).{20}\xcd\x13\x43\xf8\x9c\xb9\x19\x97\x6b\x66\x95\x87\x32\xf2\x3b\xfd/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102259201; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.{2}\x56(\xf0|\xf2).{20}\x4f\x4f\x55\x2a\xef\xcf\xd3\x3e\x12\xc4\x28\x39\x14\xf1\x1f\xa8 detector_id: 22593
alert tcp $HOME_NET any -> $EXTERNAL_NET 15916 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"V|F0|"; offset:2; depth:4; content:"OOU|2A EF CF D3|>|12 C4 28|9|14 F1 1F A8|"; distance:20; within:36; pcre:"/^.{2}\x56(\xf0|\xf2).{20}\x4f\x4f\x55\x2a\xef\xcf\xd3\x3e\x12\xc4\x28\x39\x14\xf1\x1f\xa8/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102259300; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 15916 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"V|F2|"; offset:2; depth:4; content:"OOU|2A EF CF D3|>|12 C4 28|9|14 F1 1F A8|"; distance:20; within:36; pcre:"/^.{2}\x56(\xf0|\xf2).{20}\x4f\x4f\x55\x2a\xef\xcf\xd3\x3e\x12\xc4\x28\x39\x14\xf1\x1f\xa8/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102259301; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x58\xe1\x81.{20}\x39\xdb\x6e\x88\xb6\xa1\x82\x97\x49\xaa\xb4\x30\x77\x2c\x79\x9d detector_id: 22594
alert tcp $HOME_NET any -> $EXTERNAL_NET 18368 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"X|E1 81|"; offset:1; depth:4; content:"9|DB|n|88 B6 A1 82 97|I|AA B4|0w|2C|y|9D|"; distance:20; within:36; pcre:"/^.\x58\xe1\x81.{20}\x39\xdb\x6e\x88\xb6\xa1\x82\x97\x49\xaa\xb4\x30\x77\x2c\x79\x9d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022594; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xbc\x5f\xd2.{20}\x56\xba\xc1\x87\x2b\xe0\xd4\x87\x11\xc7\xad\x97\xc8\xc1\x3c\xf7 detector_id: 22595
alert tcp $HOME_NET any -> $EXTERNAL_NET 14425 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|BC|_|D2|"; offset:1; depth:4; content:"V|BA C1 87 2B E0 D4 87 11 C7 AD 97 C8 C1|<|F7|"; distance:20; within:36; pcre:"/^.\xbc\x5f\xd2.{20}\x56\xba\xc1\x87\x2b\xe0\xd4\x87\x11\xc7\xad\x97\xc8\xc1\x3c\xf7/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022595; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xfd\xbc\xa3.{20}\x91\x8e\x16\x96\xc2\xb5\x53\xcd\x46\x2b\xb4\x34\x31\x71\x48\xd8 detector_id: 22596
alert tcp $HOME_NET any -> $EXTERNAL_NET 19887 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|FD BC A3|"; offset:1; depth:4; content:"|91 8E 16 96 C2 B5|S|CD|F|2B B4|41qH|D8|"; distance:20; within:36; pcre:"/^.\xfd\xbc\xa3.{20}\x91\x8e\x16\x96\xc2\xb5\x53\xcd\x46\x2b\xb4\x34\x31\x71\x48\xd8/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022596; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x20\x7c\x1f.{20}\xfa\x25\xb1\x13\xd6\x98\xcc\xb4\xf9\xcd\x56\x55\x47\x1d\xf3\x63 detector_id: 22597
alert tcp $HOME_NET any -> $EXTERNAL_NET 18189 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:" |7C 1F|"; offset:1; depth:4; content:"|FA 25 B1 13 D6 98 CC B4 F9 CD|VUG|1D F3|c"; distance:20; within:36; pcre:"/^.\x20\x7c\x1f.{20}\xfa\x25\xb1\x13\xd6\x98\xcc\xb4\xf9\xcd\x56\x55\x47\x1d\xf3\x63/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022597; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xcf\x10\x71.{20}\xb4\x38\x0e\xc8\xef\x90\xa3\xf1\x9d\x9e\x5a\x76\x9f\x89\x6a\x03 detector_id: 22851
alert tcp $HOME_NET any -> $EXTERNAL_NET 16209 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|CF 10|q"; offset:1; depth:4; content:"|B4|8|0E C8 EF 90 A3 F1 9D 9E|Zv|9F 89|j|03|"; distance:20; within:36; pcre:"/^.\xcf\x10\x71.{20}\xb4\x38\x0e\xc8\xef\x90\xa3\xf1\x9d\x9e\x5a\x76\x9f\x89\x6a\x03/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022851; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xf4\x0a\xcf.{20}\x74\xd4\xa5\x44\x46\x97\xcc\x15\xc9\x3f\x2e\x80\xe8\x1f\x01\x0f detector_id: 22852
alert tcp $HOME_NET any -> $EXTERNAL_NET 22947 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|F4 0A CF|"; offset:1; depth:4; content:"t|D4 A5|DF|97 CC 15 C9|?.|80 E8 1F 01 0F|"; distance:20; within:36; pcre:"/^.\xf4\x0a\xcf.{20}\x74\xd4\xa5\x44\x46\x97\xcc\x15\xc9\x3f\x2e\x80\xe8\x1f\x01\x0f/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022852; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xf4\x0a\xcf.{20}\xd6\x1b\x58\xd0\x80\x1f\x21\xe0\x2d\xec\x73\xd4\x52\x71\x46\x74 detector_id: 22853
alert tcp $HOME_NET any -> $EXTERNAL_NET 22947 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|F4 0A CF|"; offset:1; depth:4; content:"|D6 1B|X|D0 80 1F 21 E0|-|EC|s|D4|RqFt"; distance:20; within:36; pcre:"/^.\xf4\x0a\xcf.{20}\xd6\x1b\x58\xd0\x80\x1f\x21\xe0\x2d\xec\x73\xd4\x52\x71\x46\x74/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022853; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xee\x43\xb8.{20}\xfd\x7b\x84\x85\x7b\xbb\x2e\x58\x53\xdf\x59\x96\x64\xd4\x9d\xd7 detector_id: 22879
alert tcp $HOME_NET any -> $EXTERNAL_NET 11177 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|EE|C|B8|"; offset:1; depth:4; content:"|FD 7B 84 85 7B BB|.XS|DF|Y|96|d|D4 9D D7|"; distance:20; within:36; pcre:"/^.\xee\x43\xb8.{20}\xfd\x7b\x84\x85\x7b\xbb\x2e\x58\x53\xdf\x59\x96\x64\xd4\x9d\xd7/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022879; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xee\x43\xb8.{20}\xff\x93\x37\xda\xec\x93\xbe\xe3\xfa\xcb\x4b\xbf\xfb\x06\xfd\x14 detector_id: 22880
alert tcp $HOME_NET any -> $EXTERNAL_NET 11177 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|EE|C|B8|"; offset:1; depth:4; content:"|FF 93|7|DA EC 93 BE E3 FA CB|K|BF FB 06 FD 14|"; distance:20; within:36; pcre:"/^.\xee\x43\xb8.{20}\xff\x93\x37\xda\xec\x93\xbe\xe3\xfa\xcb\x4b\xbf\xfb\x06\xfd\x14/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022880; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xd1\x8b\x2c.{20}\x20\x40\xc2\x62\xe7\xf8\xf0\x22\xf4\x6c\x16\x2e\xd1\x5f\x68\x4f detector_id: 22881
alert tcp $HOME_NET any -> $EXTERNAL_NET 28681 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|D1 8B 2C|"; offset:1; depth:4; content:" |40 C2|b|E7 F8 F0 22 F4|l|16|.|D1|_hO"; distance:20; within:36; pcre:"/^.\xd1\x8b\x2c.{20}\x20\x40\xc2\x62\xe7\xf8\xf0\x22\xf4\x6c\x16\x2e\xd1\x5f\x68\x4f/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022881; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xd1\x8b\x2c.{20}\x43\x65\xc8\x31\x41\x63\xc8\x4a\x76\x97\x2e\x71\x18\x9d\x5e\xbb detector_id: 22882
alert tcp $HOME_NET any -> $EXTERNAL_NET 28681 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|D1 8B 2C|"; offset:1; depth:4; content:"Ce|C8|1Ac|C8|Jv|97|.q|18 9D 5E BB|"; distance:20; within:36; pcre:"/^.\xd1\x8b\x2c.{20}\x43\x65\xc8\x31\x41\x63\xc8\x4a\x76\x97\x2e\x71\x18\x9d\x5e\xbb/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1022882; rev:0;)

# Command&Control: (Backdoor) Cerberus - regex: to_server:^Ypmw1Syv023QZD detector_id: 23118
alert tcp $HOME_NET any -> $EXTERNAL_NET 5150 (msg:"OpenBDS Command&Control: (Backdoor) Cerberus"; flow:established,to_server,only_stream; content:"Ypmw1Syv023QZD"; depth:14; pcre:"/^Ypmw1Syv023QZD/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023118; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xcc.\x23.{20}\x12\x47\x99\x46\x02\xfe\xcb\xed\x91\x46\x89\xbf\x01\x65\x43\x8f\x49\x43\x6a\x87 detector_id: 23119
alert tcp $HOME_NET any -> $EXTERNAL_NET 5892 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|CC|"; offset:1; depth:2; content:"|23|"; distance:1; within:2; content:"|12|G|99|F|02 FE CB ED 91|F|89 BF 01|eC|8F|ICj|87|"; distance:20; within:40; pcre:"/^.\xcc.\x23.{20}\x12\x47\x99\x46\x02\xfe\xcb\xed\x91\x46\x89\xbf\x01\x65\x43\x8f\x49\x43\x6a\x87/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023119; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x27.\x31.{20}\x77\xfb\x79\xb9\xff\x42\xab\xb1\x8a\x37\x94\x49\xfb\xa9\xfe\xab\x53\xab\xfe\x08 detector_id: 23120
alert tcp $HOME_NET any -> $EXTERNAL_NET 8711 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|27|"; offset:1; depth:2; content:"1"; distance:1; within:2; content:"w|FB|y|B9 FF|B|AB B1 8A|7|94|I|FB A9 FE AB|S|AB FE 08|"; distance:20; within:40; pcre:"/^.\x27.\x31.{20}\x77\xfb\x79\xb9\xff\x42\xab\xb1\x8a\x37\x94\x49\xfb\xa9\xfe\xab\x53\xab\xfe\x08/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023120; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x91.\x4c.{20}\xbe\x27\x9b\x98\x76\x25\x95\xbe\x53\x8e\xe0\x68\xb2\x6d\xc2\x7e\xca\x04\x42\x2f detector_id: 23121
alert tcp $HOME_NET any -> $EXTERNAL_NET 5402 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|91|"; offset:1; depth:2; content:"L"; distance:1; within:2; content:"|BE 27 9B 98|v|25 95 BE|S|8E E0|h|B2|m|C2 7E CA 04|B/"; distance:20; within:40; pcre:"/^.\x91.\x4c.{20}\xbe\x27\x9b\x98\x76\x25\x95\xbe\x53\x8e\xe0\x68\xb2\x6d\xc2\x7e\xca\x04\x42\x2f/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023121; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x91.\x4c.{20}\x9e\xb4\x70\xde\xc3\xdb\xb2\xe2\xce\xff\x00\x82\x2e\x00\xa1\x50\x24\x5d\x6f\xaf detector_id: 23122
alert tcp $HOME_NET any -> $EXTERNAL_NET 5402 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|91|"; offset:1; depth:2; content:"L"; distance:1; within:2; content:"|9E B4|p|DE C3 DB B2 E2 CE FF 00 82|.|00 A1|P|24 5D|o|AF|"; distance:20; within:40; pcre:"/^.\x91.\x4c.{20}\x9e\xb4\x70\xde\xc3\xdb\xb2\xe2\xce\xff\x00\x82\x2e\x00\xa1\x50\x24\x5d\x6f\xaf/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023122; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xee.\xb8.{20}\xee\x46\xdb\x65\xbe\xf0\xc1\x4d\xd3\x70\x65\x87\x94\x37\x0c\x5f detector_id: 23123
alert tcp $HOME_NET any -> $EXTERNAL_NET 9407 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|EE|"; offset:1; depth:2; content:"|B8|"; distance:1; within:2; content:"|EE|F|DB|e|BE F0 C1|M|D3|pe|87 94|7|0C|_"; distance:20; within:36; pcre:"/^.\xee.\xb8.{20}\xee\x46\xdb\x65\xbe\xf0\xc1\x4d\xd3\x70\x65\x87\x94\x37\x0c\x5f/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023123; rev:0;)

# Command&Control: (Trojan) Hupigon_2 - regex: to_server:^O.\x01\x00\x00.\x01\x00\x00 detector_id: 23582
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Hupigon_2"; flow:established,to_server,only_stream; content:"O"; depth:1; content:"|01 00 00|"; distance:1; within:4; content:"|01 00 00|"; distance:1; within:4; pcre:"/^O.\x01\x00\x00.\x01\x00\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023582; rev:0;)

# Command&Control: (Trojan) ZeroAccess - regex: to_server:^\x32\x00\x00.....\x00.\x01\x00$ detector_id: 23583
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZeroAccess"; flow:established,to_server,only_stream; content:"2|00 00|"; depth:3; content:"|00|"; distance:5; within:6; content:"|01 00|"; distance:1; within:3; pcre:"/^\x32\x00\x00.....\x00.\x01\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023583; rev:0;)

# Command&Control: (Backdoor) Khelios - regex: to_server:^....\x6c\x55\x55\x45\x03\x10\x48\x40.{16}\x30\x46\x02\x41 detector_id: 23584
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Khelios"; flow:established,to_server,only_stream; content:"lUUE|03 10|H|40|"; offset:4; depth:12; content:"0F|02|A"; distance:16; within:20; pcre:"/^....\x6c\x55\x55\x45\x03\x10\x48\x40.{16}\x30\x46\x02\x41/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023584; rev:0;)

# Command&Control: (Trojan) ZeroAccess - regex: to_server:^\x00\x00\x00\x80\x44\x02\xbe\x3d\x00\x2e\x00\x00$ detector_id: 23585
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZeroAccess"; flow:established,to_server,only_stream; content:"|00 00 00 80|D|02 BE|=|00|.|00 00|"; depth:12; pcre:"/^\x00\x00\x00\x80\x44\x02\xbe\x3d\x00\x2e\x00\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023585; rev:0;)

# Command&Control: (Trojan) ZeroAccess - regex: to_server:^\xcb\x00[\x00\x80].....[\x60\x00].\x00\x00$ detector_id: 23586
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZeroAccess"; flow:established,to_server,only_stream; content:"|CB 00 00|"; depth:3; content:"|60|"; distance:5; within:6; content:"|00 00|"; distance:1; within:3; pcre:"/^\xcb\x00[\x00\x80].....[\x60\x00].\x00\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102358600; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZeroAccess"; flow:established,to_server,only_stream; content:"|CB 00 80|"; depth:3; content:"|60|"; distance:5; within:6; content:"|00 00|"; distance:1; within:3; pcre:"/^\xcb\x00[\x00\x80].....[\x60\x00].\x00\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102358601; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZeroAccess"; flow:established,to_server,only_stream; content:"|CB 00 00|"; depth:3; content:"|00|"; distance:5; within:6; content:"|00 00|"; distance:1; within:3; pcre:"/^\xcb\x00[\x00\x80].....[\x60\x00].\x00\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102358602; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZeroAccess"; flow:established,to_server,only_stream; content:"|CB 00 80|"; depth:3; content:"|00|"; distance:5; within:6; content:"|00 00|"; distance:1; within:3; pcre:"/^\xcb\x00[\x00\x80].....[\x60\x00].\x00\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:102358603; rev:0;)

# Command&Control: (Trojan) ZeroAccess - regex: to_server:^\x04\x00\x00\x00\x13\x9e\x10\x3d\x00\x08\x00\x00$ detector_id: 23587
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZeroAccess"; flow:established,to_server,only_stream; content:"|04 00 00 00 13 9E 10|=|00 08 00 00|"; depth:12; pcre:"/^\x04\x00\x00\x00\x13\x9e\x10\x3d\x00\x08\x00\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023587; rev:0;)

# Command&Control: (Trojan) ZeroAccess - regex: to_server:^\x08\x00\x00\x00\x79\xc7\xa7\x3e\x00\x04\x00\x00$ detector_id: 23588
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZeroAccess"; flow:established,to_server,only_stream; content:"|08 00 00 00|y|C7 A7|>|00 04 00 00|"; depth:12; pcre:"/^\x08\x00\x00\x00\x79\xc7\xa7\x3e\x00\x04\x00\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023588; rev:0;)

# Command&Control: (Backdoor) Nitol - regex: to_server:^\xc0\x00\x00\x00\x24\x02\x00\x00a{5}x detector_id: 23599
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Nitol"; flow:established,to_server,only_stream; content:"|C0 00 00 00 24 02 00 00|aaaaax"; depth:14; pcre:"/^\xc0\x00\x00\x00\x24\x02\x00\x00a{5}x/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023599; rev:0;)

# Command&Control: (Backdoor) Nitol - regex: to_server:^HDS.\x00\x00\x00. detector_id: 23600
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Nitol"; flow:established,to_server,only_stream; content:"HDS"; depth:3; content:"|00 00 00|"; distance:1; within:4; pcre:"/^HDS.\x00\x00\x00./s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023600; rev:0;)

# Command&Control: (Trojan) Zegost - regex: to_server:^.{7}\x00Gh0st detector_id: 23830
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"|00|Gh0st"; offset:7; depth:13; pcre:"/^.{7}\x00Gh0st/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023830; rev:0;)

# Command&Control: (Trojan) Hupigon - regex: to_server:^\x1a\x00{7}.*\xa5\x07\x52 detector_id: 23837
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Hupigon"; flow:established,to_server,only_stream; content:"|1A 00 00 00 00 00 00 00|"; depth:8; content:"|A5 07|R"; distance:0; pcre:"/^\x1a\x00{7}.*\xa5\x07\x52/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023837; rev:0;)

# Command&Control: (Trojan) ZeroAccess - regex: to_server:^\x01\x00\x00\x00\x3b\xcd\x03\x3f\x90\x03\x00\x00$ detector_id: 23838
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZeroAccess"; flow:established,to_server,only_stream; content:"|01 00 00 00 3B CD 03|?|90 03 00 00|"; depth:12; pcre:"/^\x01\x00\x00\x00\x3b\xcd\x03\x3f\x90\x03\x00\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023838; rev:0;)

# Command&Control: (Trojan) ZeroAccess - regex: to_server:^\x00\x00\x00\x80....\x00.\x00\x00$ detector_id: 23840
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZeroAccess"; flow:established,to_server,only_stream; content:"|00 00 00 80|"; depth:4; content:"|00|"; distance:4; within:5; content:"|00 00|"; distance:1; within:3; pcre:"/^\x00\x00\x00\x80....\x00.\x00\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023840; rev:0;)

# Command&Control: (Trojan) Parite - regex: to_server:^\xb0\x0b.*Windows.*\x00{16} detector_id: 23879
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Parite"; flow:established,to_server,only_stream; content:"|B0 0B|"; depth:2; content:"Windows"; distance:0; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; pcre:"/^\xb0\x0b.*Windows.*\x00{16}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023879; rev:0;)

# Command&Control: (Backdoor) Nitol - regex: to_server:\x18\x17\x4f\x80\x00{8}XSN\x80\xcc\xe9\x58\x80....\x50 detector_id: 23990
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Nitol"; flow:established,to_server,only_stream; content:"|18 17|O|80 00 00 00 00 00 00 00 00|XSN|80 CC E9|X|80|"; content:"P"; distance:4; within:5; pcre:"/\x18\x17\x4f\x80\x00{8}XSN\x80\xcc\xe9\x58\x80....\x50/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1023990; rev:0;)

# Command&Control: (Trojan) Zegost - regex: to_server:^SONGY\x7b.[A-Za-z]{1} detector_id: 30875
alert tcp $HOME_NET any -> $EXTERNAL_NET 8000 (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"SONGY|7B|"; depth:6; pcre:"/^SONGY\x7b.[A-Za-z]{1}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1030875; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.(\xfb|\xfd).(\x1a|\xbc).{20}\xe3\x95\x33\xa8\x33\x6e\xb0\x3d\x19\xee\xb4\x2b\x45\xdd\x32\xa7 detector_id: 30876
alert tcp $HOME_NET any -> $EXTERNAL_NET 5371 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|FB|"; offset:1; depth:2; content:"|1A|"; distance:1; within:2; content:"|E3 95|3|A8|3n|B0|=|19 EE B4 2B|E|DD|2|A7|"; distance:20; within:36; pcre:"/^.(\xfb|\xfd).(\x1a|\xbc).{20}\xe3\x95\x33\xa8\x33\x6e\xb0\x3d\x19\xee\xb4\x2b\x45\xdd\x32\xa7/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103087600; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5371 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|FD|"; offset:1; depth:2; content:"|1A|"; distance:1; within:2; content:"|E3 95|3|A8|3n|B0|=|19 EE B4 2B|E|DD|2|A7|"; distance:20; within:36; pcre:"/^.(\xfb|\xfd).(\x1a|\xbc).{20}\xe3\x95\x33\xa8\x33\x6e\xb0\x3d\x19\xee\xb4\x2b\x45\xdd\x32\xa7/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103087601; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5371 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|FB|"; offset:1; depth:2; content:"|BC|"; distance:1; within:2; content:"|E3 95|3|A8|3n|B0|=|19 EE B4 2B|E|DD|2|A7|"; distance:20; within:36; pcre:"/^.(\xfb|\xfd).(\x1a|\xbc).{20}\xe3\x95\x33\xa8\x33\x6e\xb0\x3d\x19\xee\xb4\x2b\x45\xdd\x32\xa7/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103087602; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5371 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|FD|"; offset:1; depth:2; content:"|BC|"; distance:1; within:2; content:"|E3 95|3|A8|3n|B0|=|19 EE B4 2B|E|DD|2|A7|"; distance:20; within:36; pcre:"/^.(\xfb|\xfd).(\x1a|\xbc).{20}\xe3\x95\x33\xa8\x33\x6e\xb0\x3d\x19\xee\xb4\x2b\x45\xdd\x32\xa7/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103087603; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.(\xb7|\xb2).(\x77|\xd3).{20}\x12\x78\xaa\x72\xc0\x61\x1c\x32\xb5\x01\x18\x24\xa9\xbb\x19\xda detector_id: 30877
alert tcp $HOME_NET any -> $EXTERNAL_NET 5237 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|B7|"; offset:1; depth:2; content:"w"; distance:1; within:2; content:"|12|x|AA|r|C0|a|1C|2|B5 01 18 24 A9 BB 19 DA|"; distance:20; within:36; pcre:"/^.(\xb7|\xb2).(\x77|\xd3).{20}\x12\x78\xaa\x72\xc0\x61\x1c\x32\xb5\x01\x18\x24\xa9\xbb\x19\xda/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103087700; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5237 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|B2|"; offset:1; depth:2; content:"w"; distance:1; within:2; content:"|12|x|AA|r|C0|a|1C|2|B5 01 18 24 A9 BB 19 DA|"; distance:20; within:36; pcre:"/^.(\xb7|\xb2).(\x77|\xd3).{20}\x12\x78\xaa\x72\xc0\x61\x1c\x32\xb5\x01\x18\x24\xa9\xbb\x19\xda/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103087701; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5237 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|B7|"; offset:1; depth:2; content:"|D3|"; distance:1; within:2; content:"|12|x|AA|r|C0|a|1C|2|B5 01 18 24 A9 BB 19 DA|"; distance:20; within:36; pcre:"/^.(\xb7|\xb2).(\x77|\xd3).{20}\x12\x78\xaa\x72\xc0\x61\x1c\x32\xb5\x01\x18\x24\xa9\xbb\x19\xda/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103087702; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5237 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|B2|"; offset:1; depth:2; content:"|D3|"; distance:1; within:2; content:"|12|x|AA|r|C0|a|1C|2|B5 01 18 24 A9 BB 19 DA|"; distance:20; within:36; pcre:"/^.(\xb7|\xb2).(\x77|\xd3).{20}\x12\x78\xaa\x72\xc0\x61\x1c\x32\xb5\x01\x18\x24\xa9\xbb\x19\xda/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103087703; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.(\x10|\x15).(\x08|\xac).{20}\xba\x12\xc4\x58\xb1\x40\xf4\x5d\x0a\x98\xb3\x3b\x8e\x43\xbc\xe0 detector_id: 30878
alert tcp $HOME_NET any -> $EXTERNAL_NET 6672 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|10|"; offset:1; depth:2; content:"|08|"; distance:1; within:2; content:"|BA 12 C4|X|B1 40 F4 5D 0A 98 B3 3B 8E|C|BC E0|"; distance:20; within:36; pcre:"/^.(\x10|\x15).(\x08|\xac).{20}\xba\x12\xc4\x58\xb1\x40\xf4\x5d\x0a\x98\xb3\x3b\x8e\x43\xbc\xe0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103087800; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 6672 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|15|"; offset:1; depth:2; content:"|08|"; distance:1; within:2; content:"|BA 12 C4|X|B1 40 F4 5D 0A 98 B3 3B 8E|C|BC E0|"; distance:20; within:36; pcre:"/^.(\x10|\x15).(\x08|\xac).{20}\xba\x12\xc4\x58\xb1\x40\xf4\x5d\x0a\x98\xb3\x3b\x8e\x43\xbc\xe0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103087801; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 6672 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|10|"; offset:1; depth:2; content:"|AC|"; distance:1; within:2; content:"|BA 12 C4|X|B1 40 F4 5D 0A 98 B3 3B 8E|C|BC E0|"; distance:20; within:36; pcre:"/^.(\x10|\x15).(\x08|\xac).{20}\xba\x12\xc4\x58\xb1\x40\xf4\x5d\x0a\x98\xb3\x3b\x8e\x43\xbc\xe0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103087802; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 6672 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|15|"; offset:1; depth:2; content:"|AC|"; distance:1; within:2; content:"|BA 12 C4|X|B1 40 F4 5D 0A 98 B3 3B 8E|C|BC E0|"; distance:20; within:36; pcre:"/^.(\x10|\x15).(\x08|\xac).{20}\xba\x12\xc4\x58\xb1\x40\xf4\x5d\x0a\x98\xb3\x3b\x8e\x43\xbc\xe0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103087803; rev:0;)

# Command&Control: (Trojan) Zegost - regex: to_server:^(.\x01\x00\x00\xb4\x02\x00\x00)?FWKJGH\x00\x00 detector_id: 35025
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"FWKJGH|00 00|"; pcre:"/^(.\x01\x00\x00\xb4\x02\x00\x00)?FWKJGH\x00\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1035025; rev:0;)

# Command&Control: (Trojan) ZeroAccess - regex: to_server:^\x01\x00\x00\x00\xb6\x5e\xfd\x3e\x90\x03\x00\x00$ detector_id: 35050
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZeroAccess"; flow:established,to_server,only_stream; content:"|01 00 00 00 B6 5E FD|>|90 03 00 00|"; depth:12; pcre:"/^\x01\x00\x00\x00\xb6\x5e\xfd\x3e\x90\x03\x00\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1035050; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.(\xed|\xee).(\xf2|\xf0).{20}\x4f\x4f\x55\x2a\xef\xcf\xd3\x3e\x12\xc4\x28\x39\x14\xf1\x1f\xa8 detector_id: 39523
alert tcp $HOME_NET any -> $EXTERNAL_NET 3285 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|ED|"; offset:1; depth:2; content:"|F2|"; distance:1; within:2; content:"OOU|2A EF CF D3|>|12 C4 28|9|14 F1 1F A8|"; distance:20; within:36; pcre:"/^.(\xed|\xee).(\xf2|\xf0).{20}\x4f\x4f\x55\x2a\xef\xcf\xd3\x3e\x12\xc4\x28\x39\x14\xf1\x1f\xa8/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103952300; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3285 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|EE|"; offset:1; depth:2; content:"|F2|"; distance:1; within:2; content:"OOU|2A EF CF D3|>|12 C4 28|9|14 F1 1F A8|"; distance:20; within:36; pcre:"/^.(\xed|\xee).(\xf2|\xf0).{20}\x4f\x4f\x55\x2a\xef\xcf\xd3\x3e\x12\xc4\x28\x39\x14\xf1\x1f\xa8/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103952301; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3285 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|ED|"; offset:1; depth:2; content:"|F0|"; distance:1; within:2; content:"OOU|2A EF CF D3|>|12 C4 28|9|14 F1 1F A8|"; distance:20; within:36; pcre:"/^.(\xed|\xee).(\xf2|\xf0).{20}\x4f\x4f\x55\x2a\xef\xcf\xd3\x3e\x12\xc4\x28\x39\x14\xf1\x1f\xa8/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103952302; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3285 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|EE|"; offset:1; depth:2; content:"|F0|"; distance:1; within:2; content:"OOU|2A EF CF D3|>|12 C4 28|9|14 F1 1F A8|"; distance:20; within:36; pcre:"/^.(\xed|\xee).(\xf2|\xf0).{20}\x4f\x4f\x55\x2a\xef\xcf\xd3\x3e\x12\xc4\x28\x39\x14\xf1\x1f\xa8/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103952303; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.(\xda|\xdf).(\x27|\x83).{20}\xff\x41\xcc\xa6\xad\x99\x5f\x43\x52\xe0\x24\x8d\xb8\x90\x53\x51 detector_id: 39524
alert tcp $HOME_NET any -> $EXTERNAL_NET 5977 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|DA|"; offset:1; depth:2; content:"|27|"; distance:1; within:2; content:"|FF|A|CC A6 AD 99|_CR|E0 24 8D B8 90|SQ"; distance:20; within:36; pcre:"/^.(\xda|\xdf).(\x27|\x83).{20}\xff\x41\xcc\xa6\xad\x99\x5f\x43\x52\xe0\x24\x8d\xb8\x90\x53\x51/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103952400; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5977 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|DF|"; offset:1; depth:2; content:"|27|"; distance:1; within:2; content:"|FF|A|CC A6 AD 99|_CR|E0 24 8D B8 90|SQ"; distance:20; within:36; pcre:"/^.(\xda|\xdf).(\x27|\x83).{20}\xff\x41\xcc\xa6\xad\x99\x5f\x43\x52\xe0\x24\x8d\xb8\x90\x53\x51/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103952401; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5977 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|DA|"; offset:1; depth:2; content:"|83|"; distance:1; within:2; content:"|FF|A|CC A6 AD 99|_CR|E0 24 8D B8 90|SQ"; distance:20; within:36; pcre:"/^.(\xda|\xdf).(\x27|\x83).{20}\xff\x41\xcc\xa6\xad\x99\x5f\x43\x52\xe0\x24\x8d\xb8\x90\x53\x51/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103952402; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5977 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|DF|"; offset:1; depth:2; content:"|83|"; distance:1; within:2; content:"|FF|A|CC A6 AD 99|_CR|E0 24 8D B8 90|SQ"; distance:20; within:36; pcre:"/^.(\xda|\xdf).(\x27|\x83).{20}\xff\x41\xcc\xa6\xad\x99\x5f\x43\x52\xe0\x24\x8d\xb8\x90\x53\x51/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103952403; rev:0;)

# Command&Control: (Trojan) Farfli - regex: to_server:^........SENbex\x9c[\x4b\x95] detector_id: 39525
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Farfli"; flow:established,to_server,only_stream; content:"SENbex|9C|K"; offset:8; depth:16; pcre:"/^........SENbex\x9c[\x4b\x95]/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103952500; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Farfli"; flow:established,to_server,only_stream; content:"SENbex|9C 95|"; offset:8; depth:16; pcre:"/^........SENbex\x9c[\x4b\x95]/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103952501; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.(\xb7|\xb2|\xb1).(\xd3|\x77|\x75).{20}\xb2\xf5\xbc\x0e\xdd\xaa\xa1\x48\xa3\xc6\x5b\x1c\x40\x60\xf3\xb9 detector_id: 39526
alert tcp $HOME_NET any -> $EXTERNAL_NET 5237 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|B2 F5 BC 0E DD AA A1|H|A3 C6 5B 1C 40 60 F3 B9|"; offset:24; depth:40; pcre:"/^.(\xb7|\xb2|\xb1).(\xd3|\x77|\x75).{20}\xb2\xf5\xbc\x0e\xdd\xaa\xa1\x48\xa3\xc6\x5b\x1c\x40\x60\xf3\xb9/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1039526; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xfd.\xa3.{20}\xb1\x1d\xfd\xd0\x77\x4b\x74\x91\xdb\x5a\x54\xde\xad\x1c\x2b\xf6 detector_id: 39527
alert tcp $HOME_NET any -> $EXTERNAL_NET 8430 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|FD|"; offset:1; depth:2; content:"|A3|"; distance:1; within:2; content:"|B1 1D FD D0|wKt|91 DB|ZT|DE AD 1C 2B F6|"; distance:20; within:36; pcre:"/^.\xfd.\xa3.{20}\xb1\x1d\xfd\xd0\x77\x4b\x74\x91\xdb\x5a\x54\xde\xad\x1c\x2b\xf6/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1039527; rev:0;)

# Command&Control: (Dropper) GenericDropper_108 - regex: to_server:^\x02\x75\xd4..\x00\x01\x00{15} detector_id: 39528
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) GenericDropper_108"; flow:established,to_server,only_stream; content:"|02|u|D4|"; depth:3; content:"|00 01 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:2; within:19; pcre:"/^\x02\x75\xd4..\x00\x01\x00{15}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1039528; rev:0;)

# Command&Control: (Trojan) Hupigon - regex: to_server:^JKEBHZBO\x0a$ detector_id: 39529
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Hupigon"; flow:established,to_server,only_stream; content:"JKEBHZBO|0A|"; depth:9; pcre:"/^JKEBHZBO\x0a$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1039529; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^51B1B7699601A1640577E4 detector_id: 39637
alert tcp $HOME_NET any -> $EXTERNAL_NET 1604 (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"51B1B7699601A1640577E4"; depth:22; pcre:"/^51B1B7699601A1640577E4/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1039637; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^8432474F3D64CD83EDF71E detector_id: 39638
alert tcp $HOME_NET any -> $EXTERNAL_NET 1604 (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"8432474F3D64CD83EDF71E"; depth:22; pcre:"/^8432474F3D64CD83EDF71E/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1039638; rev:0;)

# Command&Control: (Worm) Moldyow - regex: to_server:^Rmj[\x00-\x7f]{8}\x35\x3e\x34\x3f\x56\x03\x75\x77\x73\x20\x0a\x7c\x01\x52\x50\x25 detector_id: 39639
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Worm) Moldyow"; flow:established,to_server,only_stream; content:"Rmj"; depth:3; content:"5>4?V|03|uws |0A 7C 01|RP|25|"; distance:8; within:24; pcre:"/^Rmj[\x00-\x7f]{8}\x35\x3e\x34\x3f\x56\x03\x75\x77\x73\x20\x0a\x7c\x01\x52\x50\x25/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1039639; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.(\xee|\xed).(\xf0|\xf2).{20}\xd0\x8a\x96\xa6\x0f\xcf\xa9\x93\x92\x72\x7c\x1a\x85\x4c\x69\x91 detector_id: 39640
alert tcp $HOME_NET any -> $EXTERNAL_NET 3285 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|EE|"; offset:1; depth:2; content:"|F0|"; distance:1; within:2; content:"|D0 8A 96 A6 0F CF A9 93 92|r|7C 1A 85|Li|91|"; distance:20; within:36; pcre:"/^.(\xee|\xed).(\xf0|\xf2).{20}\xd0\x8a\x96\xa6\x0f\xcf\xa9\x93\x92\x72\x7c\x1a\x85\x4c\x69\x91/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103964000; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3285 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|ED|"; offset:1; depth:2; content:"|F0|"; distance:1; within:2; content:"|D0 8A 96 A6 0F CF A9 93 92|r|7C 1A 85|Li|91|"; distance:20; within:36; pcre:"/^.(\xee|\xed).(\xf0|\xf2).{20}\xd0\x8a\x96\xa6\x0f\xcf\xa9\x93\x92\x72\x7c\x1a\x85\x4c\x69\x91/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103964001; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3285 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|EE|"; offset:1; depth:2; content:"|F2|"; distance:1; within:2; content:"|D0 8A 96 A6 0F CF A9 93 92|r|7C 1A 85|Li|91|"; distance:20; within:36; pcre:"/^.(\xee|\xed).(\xf0|\xf2).{20}\xd0\x8a\x96\xa6\x0f\xcf\xa9\x93\x92\x72\x7c\x1a\x85\x4c\x69\x91/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103964002; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3285 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|ED|"; offset:1; depth:2; content:"|F2|"; distance:1; within:2; content:"|D0 8A 96 A6 0F CF A9 93 92|r|7C 1A 85|Li|91|"; distance:20; within:36; pcre:"/^.(\xee|\xed).(\xf0|\xf2).{20}\xd0\x8a\x96\xa6\x0f\xcf\xa9\x93\x92\x72\x7c\x1a\x85\x4c\x69\x91/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103964003; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xb2.\x77.{20}\xa7\x2e\xab\x25\xa2\xb7\x08\x8a\xad\x8e\xe9\xfa\x1f\xbd\xce\x64 detector_id: 39641
alert tcp $HOME_NET any -> $EXTERNAL_NET 5237 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|B2|"; offset:1; depth:2; content:"w"; distance:1; within:2; content:"|A7|.|AB 25 A2 B7 08 8A AD 8E E9 FA 1F BD CE|d"; distance:20; within:36; pcre:"/^.\xb2.\x77.{20}\xa7\x2e\xab\x25\xa2\xb7\x08\x8a\xad\x8e\xe9\xfa\x1f\xbd\xce\x64/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1039641; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xb2.\x77.{20}\xa1\xc8\xe3\xee\x18\xe1\x4e\x5d\x23\x69\x67\x0d\xb0\x83\x62\x31 detector_id: 39642
alert tcp $HOME_NET any -> $EXTERNAL_NET 5237 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|B2|"; offset:1; depth:2; content:"w"; distance:1; within:2; content:"|A1 C8 E3 EE 18 E1|N|5D 23|ig|0D B0 83|b1"; distance:20; within:36; pcre:"/^.\xb2.\x77.{20}\xa1\xc8\xe3\xee\x18\xe1\x4e\x5d\x23\x69\x67\x0d\xb0\x83\x62\x31/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1039642; rev:0;)

# Command&Control: (Worm) Autorun - regex: to_server:^.{10}P2PCMD\..{3,6}! detector_id: 39643
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Autorun"; flow:established,to_server,only_stream; content:"P2PCMD."; offset:10; depth:17; content:"|21|"; distance:0; pcre:"/^.{10}P2PCMD\..{3,6}!/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1039643; rev:0;)

# Command&Control: (Trojan) Zegost - regex: to_server:^AngeL.{2}\x00{2}.{2}\x00{2}[a-zA-Z] detector_id: 39644
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"AngeL"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^AngeL.{2}\x00{2}.{2}\x00{2}[a-zA-Z]/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1039644; rev:0;)

# command&control: Bandook - regex: to_server:^\xcf\x8f.*\x20\x26\x26\x26 detector_id: 39645
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: Bandook"; flow:established,to_server,only_stream; content:"|CF 8F|"; depth:2; content:" &&&"; distance:0; pcre:"/^\xcf\x8f.*\x20\x26\x26\x26/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1039645; rev:0;)

# Command&Control: (Trojan) Bandook - regex: to_server:^\xcf\x8f\x80\x9b\x9a\x9d\xcf detector_id: 39646
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bandook"; flow:established,to_server,only_stream; content:"|CF 8F 80 9B 9A 9D CF|"; depth:7; pcre:"/^\xcf\x8f\x80\x9b\x9a\x9d\xcf/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1039646; rev:0;)

# Command&Control: (Trojan) SpamThru - regex: to_server:^\x01hs5p\x00. detector_id: 39647
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) SpamThru"; flow:established,to_server,only_stream; content:"|01|hs5p|00|"; depth:6; pcre:"/^\x01hs5p\x00./s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1039647; rev:0;)

# Command&Control: (Backdoor) Neglemir - regex: to_server:^#1105/nowVer: V\d{1,3}! detector_id: 39688
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Neglemir"; flow:established,to_server,only_stream; content:"|23|1105/nowVer|3A| V"; depth:15; content:"|21|"; distance:0; pcre:"/^#1105\/nowVer: V\d{1,3}!/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1039688; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.(\xcc|\xc9).(\x23|\x87).{20}\x16\x49\x62\xd2\x2f\x80\x1d\x81\xb6\xb5\x15\x61\x31\x89\x8f\x19 detector_id: 39689
alert tcp $HOME_NET any -> $EXTERNAL_NET 5226 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|CC|"; offset:1; depth:2; content:"|23|"; distance:1; within:2; content:"|16|Ib|D2|/|80 1D 81 B6 B5 15|a1|89 8F 19|"; distance:20; within:36; pcre:"/^.(\xcc|\xc9).(\x23|\x87).{20}\x16\x49\x62\xd2\x2f\x80\x1d\x81\xb6\xb5\x15\x61\x31\x89\x8f\x19/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103968900; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5226 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|C9|"; offset:1; depth:2; content:"|23|"; distance:1; within:2; content:"|16|Ib|D2|/|80 1D 81 B6 B5 15|a1|89 8F 19|"; distance:20; within:36; pcre:"/^.(\xcc|\xc9).(\x23|\x87).{20}\x16\x49\x62\xd2\x2f\x80\x1d\x81\xb6\xb5\x15\x61\x31\x89\x8f\x19/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103968901; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5226 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|CC|"; offset:1; depth:2; content:"|87|"; distance:1; within:2; content:"|16|Ib|D2|/|80 1D 81 B6 B5 15|a1|89 8F 19|"; distance:20; within:36; pcre:"/^.(\xcc|\xc9).(\x23|\x87).{20}\x16\x49\x62\xd2\x2f\x80\x1d\x81\xb6\xb5\x15\x61\x31\x89\x8f\x19/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103968902; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5226 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|C9|"; offset:1; depth:2; content:"|87|"; distance:1; within:2; content:"|16|Ib|D2|/|80 1D 81 B6 B5 15|a1|89 8F 19|"; distance:20; within:36; pcre:"/^.(\xcc|\xc9).(\x23|\x87).{20}\x16\x49\x62\xd2\x2f\x80\x1d\x81\xb6\xb5\x15\x61\x31\x89\x8f\x19/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:103968903; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x70.\xb7.{20}\x86\xab\x99\x1b\x86\xfc\x63\xe7\x68\xb0\x77\x94\xb2\xc8\xd0\xa0 detector_id: 39690
alert tcp $HOME_NET any -> $EXTERNAL_NET 2222 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"p"; offset:1; depth:2; content:"|B7|"; distance:1; within:2; content:"|86 AB 99 1B 86 FC|c|E7|h|B0|w|94 B2 C8 D0 A0|"; distance:20; within:36; pcre:"/^.\x70.\xb7.{20}\x86\xab\x99\x1b\x86\xfc\x63\xe7\x68\xb0\x77\x94\xb2\xc8\xd0\xa0/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1039690; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x7b.\x90.{20}\xc9\x09\x4e\x60\x0d\x71\x33\xf5\xa9\x8e\x56\x78\x97\x41\xe7\xb8 detector_id: 39691
alert tcp $HOME_NET any -> $EXTERNAL_NET 5261 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|7B|"; offset:1; depth:2; content:"|90|"; distance:1; within:2; content:"|C9 09|N|60 0D|q3|F5 A9 8E|Vx|97|A|E7 B8|"; distance:20; within:36; pcre:"/^.\x7b.\x90.{20}\xc9\x09\x4e\x60\x0d\x71\x33\xf5\xa9\x8e\x56\x78\x97\x41\xe7\xb8/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1039691; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xee.\xb8.{20}\x64\x58\x0f\xc2\x21\xed\x12\x22\x5d\x8e\x83\x42\x5a\x57\x47\xbb detector_id: 39692
alert tcp $HOME_NET any -> $EXTERNAL_NET 9407 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|EE|"; offset:1; depth:2; content:"|B8|"; distance:1; within:2; content:"dX|0F C2 21 ED 12 22 5D 8E 83|BZWG|BB|"; distance:20; within:36; pcre:"/^.\xee.\xb8.{20}\x64\x58\x0f\xc2\x21\xed\x12\x22\x5d\x8e\x83\x42\x5a\x57\x47\xbb/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1039692; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x26.\xfb.{20}\x0c\xd2\xe4\xae\x23\xd9\x2b\x66\x66\x7e\xed\xb3\xf8\xb0\x2f\x83 detector_id: 39721
alert tcp $HOME_NET any -> $EXTERNAL_NET 2904 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"&"; offset:1; depth:2; content:"|FB|"; distance:1; within:2; content:"|0C D2 E4 AE 23 D9 2B|ff|7E ED B3 F8 B0|/|83|"; distance:20; within:36; pcre:"/^.\x26.\xfb.{20}\x0c\xd2\xe4\xae\x23\xd9\x2b\x66\x66\x7e\xed\xb3\xf8\xb0\x2f\x83/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1039721; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x9b.\xb3.{20}\x77\xa2\x23\x21\x2c\xbe\x43\x92\x16\xb0\xcf\xe7\x0f\xd0\x7e\x7a detector_id: 39722
alert tcp $HOME_NET any -> $EXTERNAL_NET 6276 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|9B|"; offset:1; depth:2; content:"|B3|"; distance:1; within:2; content:"w|A2 23 21 2C BE|C|92 16 B0 CF E7 0F D0 7E|z"; distance:20; within:36; pcre:"/^.\x9b.\xb3.{20}\x77\xa2\x23\x21\x2c\xbe\x43\x92\x16\xb0\xcf\xe7\x0f\xd0\x7e\x7a/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1039722; rev:0;)

# Command&Control: (Trojan) Jukbot - regex: to_server:^MYZD[A-Z0-9]{2}:Shock Vip \d\.[0-9A-Z]{1,2}\| detector_id: 40128
alert tcp $HOME_NET any -> $EXTERNAL_NET 2009 (msg:"OpenBDS Command&Control: (Trojan) Jukbot"; flow:established,to_server,only_stream; content:"MYZD"; depth:4; content:"|3A|Shock Vip "; distance:2; within:13; content:"."; distance:1; within:2; content:"|7C|"; distance:0; pcre:"/^MYZD[A-Z0-9]{2}:Shock Vip \d\.[0-9A-Z]{1,2}\|/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040128; rev:0;)

# Command&Control: (Trojan) Bladabindi - regex: to_server:^AW\|BawaneH\| detector_id: 40182
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bladabindi"; flow:established,to_server,only_stream; content:"AW|7C|BawaneH|7C|"; depth:11; pcre:"/^AW\|BawaneH\|/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040182; rev:0;)

# Command&Control: (Trojan) Hupigon - regex: to_server:^\x00\x00\x00\x06\x7f\x09\x00\x00 detector_id: 40184
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Hupigon"; flow:established,to_server,only_stream; content:"|00 00 00 06 7F 09 00 00|"; depth:8; pcre:"/^\x00\x00\x00\x06\x7f\x09\x00\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040184; rev:0;)

# Command&Control: (Trojan) Hupigon - regex: to_server:^\x02\x01\x01\x03\x00{3}\x01\x01\x00{6} detector_id: 40185
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Hupigon"; flow:established,to_server,only_stream; content:"|02 01 01 03 00 00 00 01 01 00 00 00 00 00 00|"; depth:15; pcre:"/^\x02\x01\x01\x03\x00{3}\x01\x01\x00{6}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040185; rev:0;)

# command&control: Hupigon - regex: to_server:^\x7a\x0c\x00\x00\x01\x00{3}.{24}\x00{32} detector_id: 40186
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: Hupigon"; flow:established,to_server,only_stream; content:"z|0C 00 00 01 00 00 00|"; depth:8; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:24; within:56; pcre:"/^\x7a\x0c\x00\x00\x01\x00{3}.{24}\x00{32}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040186; rev:0;)

# command&control: Fynloski - regex: to_server:^B0C531045D9DCA15372482 detector_id: 40187
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: Fynloski"; flow:established,to_server,only_stream; content:"B0C531045D9DCA15372482"; depth:22; pcre:"/^B0C531045D9DCA15372482/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040187; rev:0;)

# Command&Control: (Trojan) Farfli - regex: to_server:^.\x00{3}l\x01\x00{2}x.Kg.X3 detector_id: 40188
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Farfli"; flow:established,to_server,only_stream; content:"|00 00 00|l|01 00 00|x"; offset:1; depth:9; content:"Kg"; distance:1; within:3; content:"X3"; distance:1; within:3; pcre:"/^.\x00{3}l\x01\x00{2}x.Kg.X3/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040188; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xb6.\x9a.{20}\x89\xbb\x1b\x4b\x81\x59\xcf\xde\xfa\x8e\x7d\x8d\xeb\x96\x1f\x7e detector_id: 40209
alert tcp $HOME_NET any -> $EXTERNAL_NET 5086 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|B6|"; offset:1; depth:2; content:"|9A|"; distance:1; within:2; content:"|89 BB 1B|K|81|Y|CF DE FA 8E 7D 8D EB 96 1F 7E|"; distance:20; within:36; pcre:"/^.\xb6.\x9a.{20}\x89\xbb\x1b\x4b\x81\x59\xcf\xde\xfa\x8e\x7d\x8d\xeb\x96\x1f\x7e/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040209; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x20.\x5d.{20}\x65\xe2\xa4\x2f\x97\x6e\x68\x81\xec\x31\xf4\x3a\xa2\x07\x5e\x8a detector_id: 40210
alert tcp $HOME_NET any -> $EXTERNAL_NET 5787 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:" "; offset:1; depth:2; content:"|5D|"; distance:1; within:2; content:"e|E2 A4|/|97|nh|81 EC|1|F4 3A A2 07 5E 8A|"; distance:20; within:36; pcre:"/^.\x20.\x5d.{20}\x65\xe2\xa4\x2f\x97\x6e\x68\x81\xec\x31\xf4\x3a\xa2\x07\x5e\x8a/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040210; rev:0;)

# command&control: GenericTrojan_127 - regex: to_server:\x00{4,8}[^\x00]\x00{3}[^\x00]{2}\x00{3}.*\[\S+\].*-bit.*[0-9]+MB detector_id: 40287
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: GenericTrojan_127"; flow:established,to_server,only_stream; content:"|00 00 00 00|"; content:"|00 00 00|"; distance:1; within:4; content:"|00 00 00|"; distance:2; within:5; content:"|5B|"; distance:0; content:"|5D|"; distance:0; content:"-bit"; distance:0; content:"MB"; distance:0; pcre:"/\x00{4,8}[^\x00]\x00{3}[^\x00]{2}\x00{3}.*\[\S+\].*-bit.*[0-9]+MB/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040287; rev:0;)

# Command&Control: (Trojan) Egapel - regex: to_server:^http://.*\x00{128}.*A1\x01\x00 detector_id: 40288
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Egapel"; flow:established,to_server,only_stream; content:"http|3A|//"; depth:7; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; content:"A1|01 00|"; distance:0; pcre:"/^http:\/\/.*\x00{128}.*A1\x01\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040288; rev:0;)

# command&control: DelfInject - regex: to_server:^!Ms6\?6>6Mp5>:\?:D detector_id: 40289
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: DelfInject"; flow:established,to_server,only_stream; content:"|21|Ms6?6>6Mp5>|3A|?|3A|D"; depth:16; pcre:"/^!Ms6\?6>6Mp5>:\?:D/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040289; rev:0;)

# command&control: Farfli - regex: to_server:^\xdb\x00{3}.[\x00\x01]\x00\x00 detector_id: 40290
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: Farfli"; flow:established,to_server,only_stream; content:"|DB 00 00 00|"; depth:4; content:"|00 00 00|"; distance:0; pcre:"/^\xdb\x00{3}.[\x00\x01]\x00\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104029000; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: Farfli"; flow:established,to_server,only_stream; content:"|DB 00 00 00|"; depth:4; content:"|01 00 00|"; distance:0; pcre:"/^\xdb\x00{3}.[\x00\x01]\x00\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104029001; rev:0;)

# command&control: DarkKomet - regex: to_server:^A8B0549B0189F366ABF9B4 detector_id: 40291
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: DarkKomet"; flow:established,to_server,only_stream; content:"A8B0549B0189F366ABF9B4"; depth:22; pcre:"/^A8B0549B0189F366ABF9B4/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040291; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.(\x11|\x14|\x17).(\x87|\x23|\x21).{20}\xe8\xf4\x61\xbd\x2c\xd4\xc7\x79\x4c\x02\x2f\x9e\x29\x4e\x5e\x16 detector_id: 40319
alert tcp $HOME_NET any -> $EXTERNAL_NET 9508 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|E8 F4|a|BD 2C D4 C7|yL|02|/|9E 29|N|5E 16|"; offset:24; depth:40; pcre:"/^.(\x11|\x14|\x17).(\x87|\x23|\x21).{20}\xe8\xf4\x61\xbd\x2c\xd4\xc7\x79\x4c\x02\x2f\x9e\x29\x4e\x5e\x16/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040319; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.(\xa1|\xa4).(\x6b|\xcf).{20}\x6b\xfe\x73\x01\xe6\x9c\xef\xa9\x55\x81\xd5\x68\xca\x0b\xe8\xfa detector_id: 40320
alert tcp $HOME_NET any -> $EXTERNAL_NET 3163 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|A1|"; offset:1; depth:2; content:"k"; distance:1; within:2; content:"k|FE|s|01 E6 9C EF A9|U|81 D5|h|CA 0B E8 FA|"; distance:20; within:36; pcre:"/^.(\xa1|\xa4).(\x6b|\xcf).{20}\x6b\xfe\x73\x01\xe6\x9c\xef\xa9\x55\x81\xd5\x68\xca\x0b\xe8\xfa/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104032000; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3163 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|A4|"; offset:1; depth:2; content:"k"; distance:1; within:2; content:"k|FE|s|01 E6 9C EF A9|U|81 D5|h|CA 0B E8 FA|"; distance:20; within:36; pcre:"/^.(\xa1|\xa4).(\x6b|\xcf).{20}\x6b\xfe\x73\x01\xe6\x9c\xef\xa9\x55\x81\xd5\x68\xca\x0b\xe8\xfa/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104032001; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3163 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|A1|"; offset:1; depth:2; content:"|CF|"; distance:1; within:2; content:"k|FE|s|01 E6 9C EF A9|U|81 D5|h|CA 0B E8 FA|"; distance:20; within:36; pcre:"/^.(\xa1|\xa4).(\x6b|\xcf).{20}\x6b\xfe\x73\x01\xe6\x9c\xef\xa9\x55\x81\xd5\x68\xca\x0b\xe8\xfa/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104032002; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3163 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|A4|"; offset:1; depth:2; content:"|CF|"; distance:1; within:2; content:"k|FE|s|01 E6 9C EF A9|U|81 D5|h|CA 0B E8 FA|"; distance:20; within:36; pcre:"/^.(\xa1|\xa4).(\x6b|\xcf).{20}\x6b\xfe\x73\x01\xe6\x9c\xef\xa9\x55\x81\xd5\x68\xca\x0b\xe8\xfa/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104032003; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x34.\xb6.{20}\xee\x1a\x09\x1a\xa1\x9d\xf6\x22\x22\xee\xa4\xcb\x6a\x83\x2a\x2b detector_id: 40321
alert tcp $HOME_NET any -> $EXTERNAL_NET 8787 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"4"; offset:1; depth:2; content:"|B6|"; distance:1; within:2; content:"|EE 1A 09 1A A1 9D F6 22 22 EE A4 CB|j|83 2A 2B|"; distance:20; within:36; pcre:"/^.\x34.\xb6.{20}\xee\x1a\x09\x1a\xa1\x9d\xf6\x22\x22\xee\xa4\xcb\x6a\x83\x2a\x2b/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040321; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^894D16C17DE922C086FFFC detector_id: 40322
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"894D16C17DE922C086FFFC"; depth:22; pcre:"/^894D16C17DE922C086FFFC/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040322; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^7B3F84112BE59C42B6EAF4 detector_id: 40323
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"7B3F84112BE59C42B6EAF4"; depth:22; pcre:"/^7B3F84112BE59C42B6EAF4/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040323; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^94050BB9A9910C282FEA83 detector_id: 40325
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"94050BB9A9910C282FEA83"; depth:22; pcre:"/^94050BB9A9910C282FEA83/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040325; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xc5.\xcc.{20}\xcc\xea\x34\x6a\xc4\xfc\xba\x02\xaa\xf3\xa8\xf7\x55\x68\xf2\xc6 detector_id: 40337
alert tcp $HOME_NET any -> $EXTERNAL_NET 4425 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|C5|"; offset:1; depth:2; content:"|CC|"; distance:1; within:2; content:"|CC EA|4j|C4 FC BA 02 AA F3 A8 F7|Uh|F2 C6|"; distance:20; within:36; pcre:"/^.\xc5.\xcc.{20}\xcc\xea\x34\x6a\xc4\xfc\xba\x02\xaa\xf3\xa8\xf7\x55\x68\xf2\xc6/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040337; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^E9B01BE62F46CFFB06D63E detector_id: 40347
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"E9B01BE62F46CFFB06D63E"; depth:22; pcre:"/^E9B01BE62F46CFFB06D63E/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040347; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^B17DAB3F319EC7E6608604 detector_id: 40348
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"B17DAB3F319EC7E6608604"; depth:22; pcre:"/^B17DAB3F319EC7E6608604/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040348; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^D603495D00F3F747744061 detector_id: 40451
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"D603495D00F3F747744061"; depth:22; pcre:"/^D603495D00F3F747744061/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040451; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^E853436B9F05C2308A5435 detector_id: 40452
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"E853436B9F05C2308A5435"; depth:22; pcre:"/^E853436B9F05C2308A5435/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040452; rev:0;)

# Command&Control: (Backdoor) Xyat - regex: to_server:^XyatRAT, Version=\d\.\d\.\d\.\d detector_id: 40494
alert tcp $HOME_NET any -> $EXTERNAL_NET 1028 (msg:"OpenBDS Command&Control: (Backdoor) Xyat"; flow:established,to_server,only_stream; content:"XyatRAT|2C| Version="; depth:17; content:"."; distance:1; within:2; content:"."; distance:1; within:2; content:"."; distance:1; within:2; pcre:"/^XyatRAT, Version=\d\.\d\.\d\.\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040494; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^1204E782516BE700790F6F detector_id: 40496
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"1204E782516BE700790F6F"; depth:22; pcre:"/^1204E782516BE700790F6F/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040496; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^A270AA525C8FB detector_id: 40504
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"A270AA525C8FB"; depth:13; pcre:"/^A270AA525C8FB/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040504; rev:0;)

# Command&Control: (Trojan) GenericTrojan_105 - regex: to_server:^4t0hD/CyWqG\x0a detector_id: 40505
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_105"; flow:established,to_server,only_stream; content:"4t0hD/CyWqG|0A|"; depth:12; pcre:"/^4t0hD\/CyWqG\x0a/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040505; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^76A372080B570E705EBFD4 detector_id: 40514
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"76A372080B570E705EBFD4"; depth:22; pcre:"/^76A372080B570E705EBFD4/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040514; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^E3A261735194F2441467EC detector_id: 40515
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"E3A261735194F2441467EC"; depth:22; pcre:"/^E3A261735194F2441467EC/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040515; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^8CA27E24D1A1D37D6B696B detector_id: 40516
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"8CA27E24D1A1D37D6B696B"; depth:22; pcre:"/^8CA27E24D1A1D37D6B696B/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040516; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^E492E939A49150BC88B004 detector_id: 40564
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"E492E939A49150BC88B004"; depth:22; pcre:"/^E492E939A49150BC88B004/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040564; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^CE8D0B6C1617517A043A8B detector_id: 40565
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"CE8D0B6C1617517A043A8B"; depth:22; pcre:"/^CE8D0B6C1617517A043A8B/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040565; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^FC05767685CADBEDD1424C detector_id: 40566
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"FC05767685CADBEDD1424C"; depth:22; pcre:"/^FC05767685CADBEDD1424C/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040566; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x82.\x87.{20}\xea\x32\x88\xd6\xa5\xec\xef\x60\x38\x41\x70\xf6\x6b\x62\x08\x7c detector_id: 40647
alert tcp $HOME_NET any -> $EXTERNAL_NET 4903 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|82|"; offset:1; depth:2; content:"|87|"; distance:1; within:2; content:"|EA|2|88 D6 A5 EC EF 60|8Ap|F6|kb|08 7C|"; distance:20; within:36; pcre:"/^.\x82.\x87.{20}\xea\x32\x88\xd6\xa5\xec\xef\x60\x38\x41\x70\xf6\x6b\x62\x08\x7c/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040647; rev:0;)

# Command&Control: (Backdoor) Xtrat - regex: to_server:^\$version\$\d{4} detector_id: 40680
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Xtrat"; flow:established,to_server,only_stream; content:"|24|version|24|"; depth:9; pcre:"/^\$version\$\d{4}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040680; rev:0;)

# Command&Control: (C&C Tool) Dirt Jumper - regex: to_server:^ET /botnet/\?u=[a-z0-9]{32} detector_id: 40681
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (C&C Tool) Dirt Jumper"; flow:established,to_server,only_stream; content:"ET /botnet/?u="; depth:14; pcre:"/^ET \/botnet\/\?u=[a-z0-9]{32}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040681; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^E6CD202EEEF1608A4881BA detector_id: 40708
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"E6CD202EEEF1608A4881BA"; depth:22; pcre:"/^E6CD202EEEF1608A4881BA/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040708; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^7B701DD808A6F369F42938 detector_id: 40709
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"7B701DD808A6F369F42938"; depth:22; pcre:"/^7B701DD808A6F369F42938/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040709; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^7D83811CA8C6AEFBE08F7E detector_id: 40710
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"7D83811CA8C6AEFBE08F7E"; depth:22; pcre:"/^7D83811CA8C6AEFBE08F7E/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040710; rev:0;)

# Command&Control: (Backdoor) Redgirl - regex: to_server:^d0K\..{6}0K\..{13}\x00{6} detector_id: 40900
alert tcp $HOME_NET any -> $EXTERNAL_NET 8000 (msg:"OpenBDS Command&Control: (Backdoor) Redgirl"; flow:established,to_server,only_stream; content:"d0K."; depth:4; content:"0K."; distance:6; within:9; content:"|00 00 00 00 00 00|"; distance:13; within:19; pcre:"/^d0K\..{6}0K\..{13}\x00{6}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040900; rev:0;)

# Command&Control: (Trojan) GenericTrojan_136  - regex: to_server:Status\*\(Idle\.\.\.\)\*Version\*\(\d detector_id: 40939
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_136 "; flow:established,to_server,only_stream; content:"Status|2A 28|Idle...|29 2A|Version|2A 28|"; pcre:"/Status\*\(Idle\.\.\.\)\*Version\*\(\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1040939; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.(\xed|\xee).(\xf2|\xf0).{20}\xfa\x19\x54\x7d\x8d\x19\xc7\x86\x0a\x4b\xd9\xe7\xa2\xf7\xc8\x16 detector_id: 41062
alert tcp $HOME_NET any -> $EXTERNAL_NET 3285 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|ED|"; offset:1; depth:2; content:"|F2|"; distance:1; within:2; content:"|FA 19|T|7D 8D 19 C7 86 0A|K|D9 E7 A2 F7 C8 16|"; distance:20; within:36; pcre:"/^.(\xed|\xee).(\xf2|\xf0).{20}\xfa\x19\x54\x7d\x8d\x19\xc7\x86\x0a\x4b\xd9\xe7\xa2\xf7\xc8\x16/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104106200; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3285 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|EE|"; offset:1; depth:2; content:"|F2|"; distance:1; within:2; content:"|FA 19|T|7D 8D 19 C7 86 0A|K|D9 E7 A2 F7 C8 16|"; distance:20; within:36; pcre:"/^.(\xed|\xee).(\xf2|\xf0).{20}\xfa\x19\x54\x7d\x8d\x19\xc7\x86\x0a\x4b\xd9\xe7\xa2\xf7\xc8\x16/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104106201; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3285 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|ED|"; offset:1; depth:2; content:"|F0|"; distance:1; within:2; content:"|FA 19|T|7D 8D 19 C7 86 0A|K|D9 E7 A2 F7 C8 16|"; distance:20; within:36; pcre:"/^.(\xed|\xee).(\xf2|\xf0).{20}\xfa\x19\x54\x7d\x8d\x19\xc7\x86\x0a\x4b\xd9\xe7\xa2\xf7\xc8\x16/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104106202; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3285 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|EE|"; offset:1; depth:2; content:"|F0|"; distance:1; within:2; content:"|FA 19|T|7D 8D 19 C7 86 0A|K|D9 E7 A2 F7 C8 16|"; distance:20; within:36; pcre:"/^.(\xed|\xee).(\xf2|\xf0).{20}\xfa\x19\x54\x7d\x8d\x19\xc7\x86\x0a\x4b\xd9\xe7\xa2\xf7\xc8\x16/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104106203; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.(\x43|\x46).(\x63|\xc7).{20}\x65\x7c\x89\xa9\x0d\x99\x71\x1b\x8d\xbd\x50\xc6\x08\x1b\x11\x3f detector_id: 41091
alert tcp $HOME_NET any -> $EXTERNAL_NET 6468 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"C"; offset:1; depth:2; content:"c"; distance:1; within:2; content:"e|7C 89 A9 0D 99|q|1B 8D BD|P|C6 08 1B 11|?"; distance:20; within:36; pcre:"/^.(\x43|\x46).(\x63|\xc7).{20}\x65\x7c\x89\xa9\x0d\x99\x71\x1b\x8d\xbd\x50\xc6\x08\x1b\x11\x3f/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104109100; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 6468 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"F"; offset:1; depth:2; content:"c"; distance:1; within:2; content:"e|7C 89 A9 0D 99|q|1B 8D BD|P|C6 08 1B 11|?"; distance:20; within:36; pcre:"/^.(\x43|\x46).(\x63|\xc7).{20}\x65\x7c\x89\xa9\x0d\x99\x71\x1b\x8d\xbd\x50\xc6\x08\x1b\x11\x3f/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104109101; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 6468 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"C"; offset:1; depth:2; content:"|C7|"; distance:1; within:2; content:"e|7C 89 A9 0D 99|q|1B 8D BD|P|C6 08 1B 11|?"; distance:20; within:36; pcre:"/^.(\x43|\x46).(\x63|\xc7).{20}\x65\x7c\x89\xa9\x0d\x99\x71\x1b\x8d\xbd\x50\xc6\x08\x1b\x11\x3f/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104109102; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 6468 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"F"; offset:1; depth:2; content:"|C7|"; distance:1; within:2; content:"e|7C 89 A9 0D 99|q|1B 8D BD|P|C6 08 1B 11|?"; distance:20; within:36; pcre:"/^.(\x43|\x46).(\x63|\xc7).{20}\x65\x7c\x89\xa9\x0d\x99\x71\x1b\x8d\xbd\x50\xc6\x08\x1b\x11\x3f/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104109103; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.(\xee|\xeb|\xed).(\xf0|\xf2|\x54).{20}\xed\x80\xa8\xbe\x29\x47\x3e\xcb\xf6\x17\x75\x6d\xae\x9f\x58\xd3 detector_id: 41212
alert tcp $HOME_NET any -> $EXTERNAL_NET 3285 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|ED 80 A8 BE 29|G>|CB F6 17|um|AE 9F|X|D3|"; offset:24; depth:40; pcre:"/^.(\xee|\xeb|\xed).(\xf0|\xf2|\x54).{20}\xed\x80\xa8\xbe\x29\x47\x3e\xcb\xf6\x17\x75\x6d\xae\x9f\x58\xd3/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041212; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.(\xee|\xeb|\xed).(\xf0|\xf2|\x54).{20}\xcd\x13\x43\xf8\x9c\xb9\x19\x97\x6b\x66\x95\x87\x32\xf2\x3b\xfd detector_id: 41213
alert tcp $HOME_NET any -> $EXTERNAL_NET 3285 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|CD 13|C|F8 9C B9 19 97|kf|95 87|2|F2 3B FD|"; offset:24; depth:40; pcre:"/^.(\xee|\xeb|\xed).(\xf0|\xf2|\x54).{20}\xcd\x13\x43\xf8\x9c\xb9\x19\x97\x6b\x66\x95\x87\x32\xf2\x3b\xfd/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041213; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.(\xee|\xed).(\xf0|\xf2).{20}\x7d\x97\x15\x8c\x9d\x48\x2a\x55\x46\x7a\xed\xe4\x47\xbb\x87\x67 detector_id: 41214
alert tcp $HOME_NET any -> $EXTERNAL_NET 3285 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|EE|"; offset:1; depth:2; content:"|F0|"; distance:1; within:2; content:"|7D 97 15 8C 9D|H|2A|UFz|ED E4|G|BB 87|g"; distance:20; within:36; pcre:"/^.(\xee|\xed).(\xf0|\xf2).{20}\x7d\x97\x15\x8c\x9d\x48\x2a\x55\x46\x7a\xed\xe4\x47\xbb\x87\x67/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104121400; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3285 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|ED|"; offset:1; depth:2; content:"|F0|"; distance:1; within:2; content:"|7D 97 15 8C 9D|H|2A|UFz|ED E4|G|BB 87|g"; distance:20; within:36; pcre:"/^.(\xee|\xed).(\xf0|\xf2).{20}\x7d\x97\x15\x8c\x9d\x48\x2a\x55\x46\x7a\xed\xe4\x47\xbb\x87\x67/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104121401; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3285 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|EE|"; offset:1; depth:2; content:"|F2|"; distance:1; within:2; content:"|7D 97 15 8C 9D|H|2A|UFz|ED E4|G|BB 87|g"; distance:20; within:36; pcre:"/^.(\xee|\xed).(\xf0|\xf2).{20}\x7d\x97\x15\x8c\x9d\x48\x2a\x55\x46\x7a\xed\xe4\x47\xbb\x87\x67/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104121402; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3285 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|ED|"; offset:1; depth:2; content:"|F2|"; distance:1; within:2; content:"|7D 97 15 8C 9D|H|2A|UFz|ED E4|G|BB 87|g"; distance:20; within:36; pcre:"/^.(\xee|\xed).(\xf0|\xf2).{20}\x7d\x97\x15\x8c\x9d\x48\x2a\x55\x46\x7a\xed\xe4\x47\xbb\x87\x67/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104121403; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xc8.\x65.{20}\x60\xa2\x8f\x19\x16\x41\x05\x8a\x43\x44\x8b\xb0\x65\xc1\xd7\x2b detector_id: 41215
alert tcp $HOME_NET any -> $EXTERNAL_NET 3226 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|C8|"; offset:1; depth:2; content:"e"; distance:1; within:2; content:"|60 A2 8F 19 16|A|05 8A|CD|8B B0|e|C1 D7 2B|"; distance:20; within:36; pcre:"/^.\xc8.\x65.{20}\x60\xa2\x8f\x19\x16\x41\x05\x8a\x43\x44\x8b\xb0\x65\xc1\xd7\x2b/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041215; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x36.\x78.{20}\x80\x7d\xb9\x39\x70\xa3\x45\xc9\x45\x30\x1a\xf5\x6c\xe8\x0c\x27 detector_id: 41216
alert tcp $HOME_NET any -> $EXTERNAL_NET 4869 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"6"; offset:1; depth:2; content:"x"; distance:1; within:2; content:"|80 7D B9|9p|A3|E|C9|E0|1A F5|l|E8 0C 27|"; distance:20; within:36; pcre:"/^.\x36.\x78.{20}\x80\x7d\xb9\x39\x70\xa3\x45\xc9\x45\x30\x1a\xf5\x6c\xe8\x0c\x27/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041216; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x36.\x78.{20}\xa0\xee\x52\x7f\xc5\x5d\x62\x95\xd8\x41\xfa\x1f\xf0\x85\x6f\x09 detector_id: 41243
alert tcp $HOME_NET any -> $EXTERNAL_NET 4869 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"6"; offset:1; depth:2; content:"x"; distance:1; within:2; content:"|A0 EE|R|7F C5 5D|b|95 D8|A|FA 1F F0 85|o|09|"; distance:20; within:36; pcre:"/^.\x36.\x78.{20}\xa0\xee\x52\x7f\xc5\x5d\x62\x95\xd8\x41\xfa\x1f\xf0\x85\x6f\x09/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041243; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x72.\xa9.{20}\x38\x01\xb0\xa8\x45\xf7\x07\x62\xf3\x9b\x91\xfc\x0f\x9c\x86\xce detector_id: 41244
alert tcp $HOME_NET any -> $EXTERNAL_NET 3466 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"r"; offset:1; depth:2; content:"|A9|"; distance:1; within:2; content:"8|01 B0 A8|E|F7 07|b|F3 9B 91 FC 0F 9C 86 CE|"; distance:20; within:36; pcre:"/^.\x72.\xa9.{20}\x38\x01\xb0\xa8\x45\xf7\x07\x62\xf3\x9b\x91\xfc\x0f\x9c\x86\xce/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041244; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.(\xe8|\xee).(\x37|\x91).{20}\x42\x14\x88\x16\xc8\xec\x6b\x31\xfc\xbd\x4d\x75\xb2\xc3\xc3\xe7 detector_id: 41245
alert tcp $HOME_NET any -> $EXTERNAL_NET 5037 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|E8|"; offset:1; depth:2; content:"7"; distance:1; within:2; content:"B|14 88 16 C8 EC|k1|FC BD|Mu|B2 C3 C3 E7|"; distance:20; within:36; pcre:"/^.(\xe8|\xee).(\x37|\x91).{20}\x42\x14\x88\x16\xc8\xec\x6b\x31\xfc\xbd\x4d\x75\xb2\xc3\xc3\xe7/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104124500; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5037 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|EE|"; offset:1; depth:2; content:"7"; distance:1; within:2; content:"B|14 88 16 C8 EC|k1|FC BD|Mu|B2 C3 C3 E7|"; distance:20; within:36; pcre:"/^.(\xe8|\xee).(\x37|\x91).{20}\x42\x14\x88\x16\xc8\xec\x6b\x31\xfc\xbd\x4d\x75\xb2\xc3\xc3\xe7/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104124501; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5037 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|E8|"; offset:1; depth:2; content:"|91|"; distance:1; within:2; content:"B|14 88 16 C8 EC|k1|FC BD|Mu|B2 C3 C3 E7|"; distance:20; within:36; pcre:"/^.(\xe8|\xee).(\x37|\x91).{20}\x42\x14\x88\x16\xc8\xec\x6b\x31\xfc\xbd\x4d\x75\xb2\xc3\xc3\xe7/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104124502; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5037 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|EE|"; offset:1; depth:2; content:"|91|"; distance:1; within:2; content:"B|14 88 16 C8 EC|k1|FC BD|Mu|B2 C3 C3 E7|"; distance:20; within:36; pcre:"/^.(\xe8|\xee).(\x37|\x91).{20}\x42\x14\x88\x16\xc8\xec\x6b\x31\xfc\xbd\x4d\x75\xb2\xc3\xc3\xe7/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104124503; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xd8.\x6d.{20}\x82\x48\x67\xc0\x6c\x46\x7b\x06\xf4\x8d\x0d\xea\x3e\x98\x8d\x62 detector_id: 41246
alert tcp $HOME_NET any -> $EXTERNAL_NET 9035 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|D8|"; offset:1; depth:2; content:"m"; distance:1; within:2; content:"|82|Hg|C0|lF|7B 06 F4 8D 0D EA|>|98 8D|b"; distance:20; within:36; pcre:"/^.\xd8.\x6d.{20}\x82\x48\x67\xc0\x6c\x46\x7b\x06\xf4\x8d\x0d\xea\x3e\x98\x8d\x62/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041246; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x63.\x34.{20}\xa8\x6f\xff\x26\xc5\x10\x1e\x32\x35\xc8\x9d\x58\x55\x2e\xdd\xfd detector_id: 41302
alert tcp $HOME_NET any -> $EXTERNAL_NET 3888 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"c"; offset:1; depth:2; content:"4"; distance:1; within:2; content:"|A8|o|FF|&|C5 10 1E|25|C8 9D|XU.|DD FD|"; distance:20; within:36; pcre:"/^.\x63.\x34.{20}\xa8\x6f\xff\x26\xc5\x10\x1e\x32\x35\xc8\x9d\x58\x55\x2e\xdd\xfd/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041302; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x71.\xa5.{20}\x7b\xa7\x8f\x7d\xfa\x54\x3f\x7a\x93\x43\x1a\x8f\x23\x0f\xfa\xc8 detector_id: 41303
alert tcp $HOME_NET any -> $EXTERNAL_NET 6582 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"q"; offset:1; depth:2; content:"|A5|"; distance:1; within:2; content:"|7B A7 8F 7D FA|T?z|93|C|1A 8F 23 0F FA C8|"; distance:20; within:36; pcre:"/^.\x71.\xa5.{20}\x7b\xa7\x8f\x7d\xfa\x54\x3f\x7a\x93\x43\x1a\x8f\x23\x0f\xfa\xc8/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041303; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xa6.\x97.{20}\x2b\xbd\x46\x8e\xe6\xd8\xc8\x1a\x67\xdd\xf0\xd4\xc7\x90\x63\xd1 detector_id: 41465
alert tcp $HOME_NET any -> $EXTERNAL_NET 3194 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|A6|"; offset:1; depth:2; content:"|97|"; distance:1; within:2; content:"|2B BD|F|8E E6 D8 C8 1A|g|DD F0 D4 C7 90|c|D1|"; distance:20; within:36; pcre:"/^.\xa6.\x97.{20}\x2b\xbd\x46\x8e\xe6\xd8\xc8\x1a\x67\xdd\xf0\xd4\xc7\x90\x63\xd1/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041465; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xa6.\x97.{20}\xb0\x76\x7e\x96\x2b\xa6\x64\xdb\xc0\x98\x38\x29\x66\xc1\xd9\x7e detector_id: 41466
alert tcp $HOME_NET any -> $EXTERNAL_NET 3194 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|A6|"; offset:1; depth:2; content:"|97|"; distance:1; within:2; content:"|B0|v|7E 96 2B A6|d|DB C0 98|8|29|f|C1 D9 7E|"; distance:20; within:36; pcre:"/^.\xa6.\x97.{20}\xb0\x76\x7e\x96\x2b\xa6\x64\xdb\xc0\x98\x38\x29\x66\xc1\xd9\x7e/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041466; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.(\xa5|\xa6).(\x95|\x97).{20}\x3a\x68\xaa\x31\xb4\xbb\xb7\xb4\x4e\x66\xde\xec\xa8\xa1\x92\x9a detector_id: 41467
alert tcp $HOME_NET any -> $EXTERNAL_NET 3194 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|A5|"; offset:1; depth:2; content:"|95|"; distance:1; within:2; content:"|3A|h|AA|1|B4 BB B7 B4|Nf|DE EC A8 A1 92 9A|"; distance:20; within:36; pcre:"/^.(\xa5|\xa6).(\x95|\x97).{20}\x3a\x68\xaa\x31\xb4\xbb\xb7\xb4\x4e\x66\xde\xec\xa8\xa1\x92\x9a/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104146700; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3194 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|A6|"; offset:1; depth:2; content:"|95|"; distance:1; within:2; content:"|3A|h|AA|1|B4 BB B7 B4|Nf|DE EC A8 A1 92 9A|"; distance:20; within:36; pcre:"/^.(\xa5|\xa6).(\x95|\x97).{20}\x3a\x68\xaa\x31\xb4\xbb\xb7\xb4\x4e\x66\xde\xec\xa8\xa1\x92\x9a/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104146701; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3194 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|A5|"; offset:1; depth:2; content:"|97|"; distance:1; within:2; content:"|3A|h|AA|1|B4 BB B7 B4|Nf|DE EC A8 A1 92 9A|"; distance:20; within:36; pcre:"/^.(\xa5|\xa6).(\x95|\x97).{20}\x3a\x68\xaa\x31\xb4\xbb\xb7\xb4\x4e\x66\xde\xec\xa8\xa1\x92\x9a/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104146702; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3194 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|A6|"; offset:1; depth:2; content:"|97|"; distance:1; within:2; content:"|3A|h|AA|1|B4 BB B7 B4|Nf|DE EC A8 A1 92 9A|"; distance:20; within:36; pcre:"/^.(\xa5|\xa6).(\x95|\x97).{20}\x3a\x68\xaa\x31\xb4\xbb\xb7\xb4\x4e\x66\xde\xec\xa8\xa1\x92\x9a/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104146703; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.(\x64|\x67).(\x66|\x64).{20}\x94\xf4\x23\x98\xd4\x40\xea\x59\x6e\xe9\xf6\x19\x30\x9c\x49\xa3 detector_id: 41468
alert tcp $HOME_NET any -> $EXTERNAL_NET 1106 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"d"; offset:1; depth:2; content:"f"; distance:1; within:2; content:"|94 F4 23 98 D4 40 EA|Yn|E9 F6 19|0|9C|I|A3|"; distance:20; within:36; pcre:"/^.(\x64|\x67).(\x66|\x64).{20}\x94\xf4\x23\x98\xd4\x40\xea\x59\x6e\xe9\xf6\x19\x30\x9c\x49\xa3/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104146800; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 1106 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"g"; offset:1; depth:2; content:"f"; distance:1; within:2; content:"|94 F4 23 98 D4 40 EA|Yn|E9 F6 19|0|9C|I|A3|"; distance:20; within:36; pcre:"/^.(\x64|\x67).(\x66|\x64).{20}\x94\xf4\x23\x98\xd4\x40\xea\x59\x6e\xe9\xf6\x19\x30\x9c\x49\xa3/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104146801; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 1106 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"d"; offset:1; depth:2; content:"d"; distance:1; within:2; content:"|94 F4 23 98 D4 40 EA|Yn|E9 F6 19|0|9C|I|A3|"; distance:20; within:36; pcre:"/^.(\x64|\x67).(\x66|\x64).{20}\x94\xf4\x23\x98\xd4\x40\xea\x59\x6e\xe9\xf6\x19\x30\x9c\x49\xa3/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104146802; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 1106 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"g"; offset:1; depth:2; content:"d"; distance:1; within:2; content:"|94 F4 23 98 D4 40 EA|Yn|E9 F6 19|0|9C|I|A3|"; distance:20; within:36; pcre:"/^.(\x64|\x67).(\x66|\x64).{20}\x94\xf4\x23\x98\xd4\x40\xea\x59\x6e\xe9\xf6\x19\x30\x9c\x49\xa3/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104146803; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xa6.\x97.{20}\xad\xef\xab\xc8\xb8\xd0\xd4\xdf\x39\x8c\xd1\xb4\xd1\x7f\x8b\x12 detector_id: 41487
alert tcp $HOME_NET any -> $EXTERNAL_NET 3194 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|A6|"; offset:1; depth:2; content:"|97|"; distance:1; within:2; content:"|AD EF AB C8 B8 D0 D4 DF|9|8C D1 B4 D1 7F 8B 12|"; distance:20; within:36; pcre:"/^.\xa6.\x97.{20}\xad\xef\xab\xc8\xb8\xd0\xd4\xdf\x39\x8c\xd1\xb4\xd1\x7f\x8b\x12/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041487; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x85.\x1d.{20}\xa7\x0d\xa4\x49\xa5\x75\xed\x9d\x78\xe0\xc2\xf3\x33\x13\x23\x15 detector_id: 41488
alert tcp $HOME_NET any -> $EXTERNAL_NET 3610 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|85|"; offset:1; depth:2; content:"|1D|"; distance:1; within:2; content:"|A7 0D A4|I|A5|u|ED 9D|x|E0 C2 F3|3|13 23 15|"; distance:20; within:36; pcre:"/^.\x85.\x1d.{20}\xa7\x0d\xa4\x49\xa5\x75\xed\x9d\x78\xe0\xc2\xf3\x33\x13\x23\x15/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041488; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.(\xee|\x88).(\x37|\x91).{20}\xe2\x99\x9e\x6a\xd5\x27\xd6\x4b\xea\x7a\x0e\x4d\x5b\x18\x29\x84 detector_id: 41498
alert tcp $HOME_NET any -> $EXTERNAL_NET 5037 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|EE|"; offset:1; depth:2; content:"7"; distance:1; within:2; content:"|E2 99 9E|j|D5 27 D6|K|EA|z|0E|M|5B 18 29 84|"; distance:20; within:36; pcre:"/^.(\xee|\x88).(\x37|\x91).{20}\xe2\x99\x9e\x6a\xd5\x27\xd6\x4b\xea\x7a\x0e\x4d\x5b\x18\x29\x84/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104149800; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5037 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|88|"; offset:1; depth:2; content:"7"; distance:1; within:2; content:"|E2 99 9E|j|D5 27 D6|K|EA|z|0E|M|5B 18 29 84|"; distance:20; within:36; pcre:"/^.(\xee|\x88).(\x37|\x91).{20}\xe2\x99\x9e\x6a\xd5\x27\xd6\x4b\xea\x7a\x0e\x4d\x5b\x18\x29\x84/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104149801; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5037 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|EE|"; offset:1; depth:2; content:"|91|"; distance:1; within:2; content:"|E2 99 9E|j|D5 27 D6|K|EA|z|0E|M|5B 18 29 84|"; distance:20; within:36; pcre:"/^.(\xee|\x88).(\x37|\x91).{20}\xe2\x99\x9e\x6a\xd5\x27\xd6\x4b\xea\x7a\x0e\x4d\x5b\x18\x29\x84/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104149802; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 5037 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|88|"; offset:1; depth:2; content:"|91|"; distance:1; within:2; content:"|E2 99 9E|j|D5 27 D6|K|EA|z|0E|M|5B 18 29 84|"; distance:20; within:36; pcre:"/^.(\xee|\x88).(\x37|\x91).{20}\xe2\x99\x9e\x6a\xd5\x27\xd6\x4b\xea\x7a\x0e\x4d\x5b\x18\x29\x84/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104149803; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x05.\xb9.{20}\x24\x4d\x30\xa0\x3d\xb4\x98\xb9\x07\x2e\x2f\xb4\xcc\x76\x62\xe8 detector_id: 41499
alert tcp $HOME_NET any -> $EXTERNAL_NET 2382 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|05|"; offset:1; depth:2; content:"|B9|"; distance:1; within:2; content:"|24|M0|A0|=|B4 98 B9 07|./|B4 CC|vb|E8|"; distance:20; within:36; pcre:"/^.\x05.\xb9.{20}\x24\x4d\x30\xa0\x3d\xb4\x98\xb9\x07\x2e\x2f\xb4\xcc\x76\x62\xe8/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041499; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\x85.\x1d.{20}\x07\x80\xb2\x35\xb8\xbe\x50\xe7\x6e\x27\x81\xcb\xda\xc8\xc9\x76 detector_id: 41513
alert tcp $HOME_NET any -> $EXTERNAL_NET 3610 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|85|"; offset:1; depth:2; content:"|1D|"; distance:1; within:2; content:"|07 80 B2|5|B8 BE|P|E7|n|27 81 CB DA C8 C9|v"; distance:20; within:36; pcre:"/^.\x85.\x1d.{20}\x07\x80\xb2\x35\xb8\xbe\x50\xe7\x6e\x27\x81\xcb\xda\xc8\xc9\x76/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041513; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xe0.\x37.{20}\x8d\x72\x59\xee\x52\xd2\x7f\x2b\x32\x38\xbe\x33\xf7\x5a\xbb\xd5 detector_id: 41514
alert tcp $HOME_NET any -> $EXTERNAL_NET 8691 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|E0|"; offset:1; depth:2; content:"7"; distance:1; within:2; content:"|8D|rY|EE|R|D2 7F 2B|28|BE|3|F7|Z|BB D5|"; distance:20; within:36; pcre:"/^.\xe0.\x37.{20}\x8d\x72\x59\xee\x52\xd2\x7f\x2b\x32\x38\xbe\x33\xf7\x5a\xbb\xd5/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041514; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.(\x24|\x27).(\x01|\x03).{20}\xde\xcd\x06\x26\x94\xf0\xe6\x58\x86\x38\x83\x08\x91\x8e\xc3\x66 detector_id: 41515
alert tcp $HOME_NET any -> $EXTERNAL_NET 4361 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|24|"; offset:1; depth:2; content:"|01|"; distance:1; within:2; content:"|DE CD 06|&|94 F0 E6|X|86|8|83 08 91 8E C3|f"; distance:20; within:36; pcre:"/^.(\x24|\x27).(\x01|\x03).{20}\xde\xcd\x06\x26\x94\xf0\xe6\x58\x86\x38\x83\x08\x91\x8e\xc3\x66/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104151500; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 4361 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|27|"; offset:1; depth:2; content:"|01|"; distance:1; within:2; content:"|DE CD 06|&|94 F0 E6|X|86|8|83 08 91 8E C3|f"; distance:20; within:36; pcre:"/^.(\x24|\x27).(\x01|\x03).{20}\xde\xcd\x06\x26\x94\xf0\xe6\x58\x86\x38\x83\x08\x91\x8e\xc3\x66/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104151501; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 4361 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|24|"; offset:1; depth:2; content:"|03|"; distance:1; within:2; content:"|DE CD 06|&|94 F0 E6|X|86|8|83 08 91 8E C3|f"; distance:20; within:36; pcre:"/^.(\x24|\x27).(\x01|\x03).{20}\xde\xcd\x06\x26\x94\xf0\xe6\x58\x86\x38\x83\x08\x91\x8e\xc3\x66/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104151502; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 4361 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|27|"; offset:1; depth:2; content:"|03|"; distance:1; within:2; content:"|DE CD 06|&|94 F0 E6|X|86|8|83 08 91 8E C3|f"; distance:20; within:36; pcre:"/^.(\x24|\x27).(\x01|\x03).{20}\xde\xcd\x06\x26\x94\xf0\xe6\x58\x86\x38\x83\x08\x91\x8e\xc3\x66/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104151503; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.(\xee|\xeb).(\xf0|\x54).{20}\x49\xa9\x1d\xe1\x55\x99\x95\xe9\x9c\x23\xa6\xce\xbb\xcf\xb3\xfd detector_id: 41729
alert tcp $HOME_NET any -> $EXTERNAL_NET 3285 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|EE|"; offset:1; depth:2; content:"|F0|"; distance:1; within:2; content:"I|A9 1D E1|U|99 95 E9 9C 23 A6 CE BB CF B3 FD|"; distance:20; within:36; pcre:"/^.(\xee|\xeb).(\xf0|\x54).{20}\x49\xa9\x1d\xe1\x55\x99\x95\xe9\x9c\x23\xa6\xce\xbb\xcf\xb3\xfd/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104172900; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3285 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|EB|"; offset:1; depth:2; content:"|F0|"; distance:1; within:2; content:"I|A9 1D E1|U|99 95 E9 9C 23 A6 CE BB CF B3 FD|"; distance:20; within:36; pcre:"/^.(\xee|\xeb).(\xf0|\x54).{20}\x49\xa9\x1d\xe1\x55\x99\x95\xe9\x9c\x23\xa6\xce\xbb\xcf\xb3\xfd/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104172901; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3285 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|EE|"; offset:1; depth:2; content:"T"; distance:1; within:2; content:"I|A9 1D E1|U|99 95 E9 9C 23 A6 CE BB CF B3 FD|"; distance:20; within:36; pcre:"/^.(\xee|\xeb).(\xf0|\x54).{20}\x49\xa9\x1d\xe1\x55\x99\x95\xe9\x9c\x23\xa6\xce\xbb\xcf\xb3\xfd/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104172902; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 3285 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|EB|"; offset:1; depth:2; content:"T"; distance:1; within:2; content:"I|A9 1D E1|U|99 95 E9 9C 23 A6 CE BB CF B3 FD|"; distance:20; within:36; pcre:"/^.(\xee|\xeb).(\xf0|\x54).{20}\x49\xa9\x1d\xe1\x55\x99\x95\xe9\x9c\x23\xa6\xce\xbb\xcf\xb3\xfd/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104172903; rev:0;)

# Command&Control: (Trojan) ZBot - regex: to_server:^.\xa9.\x72.{20}\x35\x2e\x3f\x57\x18\xf5\x9f\x4d\x75\xe3\xae\x39\x55\x7e\xe4\xc9 detector_id: 41730
alert tcp $HOME_NET any -> $EXTERNAL_NET 3945 (msg:"OpenBDS Command&Control: (Trojan) ZBot"; flow:established,to_server,only_stream; content:"|A9|"; offset:1; depth:2; content:"r"; distance:1; within:2; content:"5.?W|18 F5 9F|Mu|E3 AE|9U|7E E4 C9|"; distance:20; within:36; pcre:"/^.\xa9.\x72.{20}\x35\x2e\x3f\x57\x18\xf5\x9f\x4d\x75\xe3\xae\x39\x55\x7e\xe4\xc9/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041730; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^A4BE9E6406ECD9E5B12384 detector_id: 41751
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"A4BE9E6406ECD9E5B12384"; depth:22; pcre:"/^A4BE9E6406ECD9E5B12384/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1041751; rev:0;)

# command&control: 9002 RAT - regex: to_server:^9002\x0c\x00\x00\x00\x08\x00\x00\x00\x19 detector_id: 42552
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: 9002 RAT"; flow:established,to_server,only_stream; content:"9002|0C 00 00 00 08 00 00 00 19|"; depth:13; pcre:"/^9002\x0c\x00\x00\x00\x08\x00\x00\x00\x19/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042552; rev:0;)

# Command&Control: (Trojan) Kegotip - regex: to_server:^QXNkaog[A-Za-z0-9/+]+={0,2}$ detector_id: 42638
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Kegotip"; flow:established,to_server,only_stream; content:"QXNkaog"; depth:7; pcre:"/^QXNkaog[A-Za-z0-9\/+]+={0,2}$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042638; rev:0;)

# Command&Control: (Trojan) Ramnit - regex: to_server:^\x00\xff\x4c\x00{3}\xe2\x00\x21\x00{3} detector_id: 42639
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ramnit"; flow:established,to_server,only_stream; content:"|00 FF|L|00 00 00 E2 00 21 00 00 00|"; depth:12; pcre:"/^\x00\xff\x4c\x00{3}\xe2\x00\x21\x00{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042639; rev:0;)

# Command&Control: (Trojan) Zegost - regex: to_server:^.{10}glip\x9aCehf detector_id: 42641
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"glip|9A|Cehf"; offset:10; depth:19; pcre:"/^.{10}glip\x9aCehf/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042641; rev:0;)

# Command&Control: (Backdoor) GenericBackdoor_12 - regex: to_server:^\x00{3}\x20[a-f0-9]{32}$ detector_id: 42642
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) GenericBackdoor_12"; flow:established,to_server,only_stream; content:"|00 00 00| "; depth:4; pcre:"/^\x00{3}\x20[a-f0-9]{32}$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042642; rev:0;)

# Command&Control: (Trojan) Zegost - regex: to_server:^\w{5}.[\x00-\x02]\x00{2}.[\x00-\x02]\x00{2}.{39}[A-Z]022 detector_id: 42643
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"|00 00|"; offset:7; depth:9; content:"|00 00|"; distance:2; within:4; content:"022"; distance:40; within:43; pcre:"/^\w{5}.[\x00-\x02]\x00{2}.[\x00-\x02]\x00{2}.{39}[A-Z]022/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042643; rev:0;)

# Command&Control: (Ransomware) Reveton - regex: to_server:^\x2c\x01\x00{2}[\x00-\x0f]\d{10}.{10}\x00{3}.\x00{3} detector_id: 42644
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Ransomware) Reveton"; flow:established,to_server,only_stream; content:"|2C 01 00 00|"; depth:4; content:"|00 00 00|"; distance:21; within:24; content:"|00 00 00|"; distance:1; within:4; pcre:"/^\x2c\x01\x00{2}[\x00-\x0f]\d{10}.{10}\x00{3}.\x00{3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042644; rev:0;)

# Command&Control: (Trojan) Alureon - regex: to_server:^hello/[\d\.]+/\d+/[a-f0-9]{8}(-[a-f0-9]{4}){3}-[a-f0-9]{12}/[\d\._]+/\d+/\d+ detector_id: 42645
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Alureon"; flow:established,to_server,only_stream; content:"hello/"; depth:6; content:"/"; distance:0; content:"/"; distance:0; content:"-"; distance:8; within:9; content:"-"; distance:4; within:5; content:"-"; distance:4; within:5; content:"-"; distance:4; within:5; content:"/"; distance:12; within:13; content:"/"; distance:0; content:"/"; distance:0; pcre:"/^hello\/[\d\.]+\/\d+\/[a-f0-9]{8}(-[a-f0-9]{4}){3}-[a-f0-9]{12}\/[\d\._]+\/\d+\/\d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1042645; rev:0;)

# Command&Control: (Trojan) Daws - regex: to_server:^>>\d\x00<<[\w\-]+<<[\w\-\.]+<<\d+<<\x0d\x0a#{10} detector_id: 43393
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Daws"; flow:established,to_server,only_stream; content:">>"; depth:2; content:"|00|<<"; distance:1; within:4; content:"<<"; distance:0; content:"<<"; distance:0; content:"<<|0D 0A 23 23 23 23 23 23 23 23 23 23|"; distance:0; pcre:"/^>>\d\x00<<[\w\-]+<<[\w\-\.]+<<\d+<<\x0d\x0a#{10}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043393; rev:0;)

# Command&Control: (Backdoor) Nitol - regex: to_server:^.\x00{3}.\x00{3}\x09\x04\x00{2}Win[\w\s]+\x00+\d+ MB\x00+\d\*\d+MHz\x00+\d+ Mbps detector_id: 43394
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Nitol"; flow:established,to_server,only_stream; content:"|00 00 00|"; offset:1; depth:4; content:"|00 00 00 09 04 00 00|Win"; distance:1; within:11; content:"|00|"; distance:0; content:" MB|00|"; distance:0; content:"|2A|"; distance:1; within:2; content:"MHz|00|"; distance:0; content:" Mbps"; distance:0; pcre:"/^.\x00{3}.\x00{3}\x09\x04\x00{2}Win[\w\s]+\x00+\d+ MB\x00+\d\*\d+MHz\x00+\d+ Mbps/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043394; rev:0;)

# Command&Control: (Trojan) ZeroAccess - regex: to_server:^\x01\x00\x00\x00.{3}\x3f\x90\x03\x00\x00$ detector_id: 43395
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZeroAccess"; flow:established,to_server,only_stream; content:"|01 00 00 00|"; depth:4; content:"?|90 03 00 00|"; distance:3; within:8; pcre:"/^\x01\x00\x00\x00.{3}\x3f\x90\x03\x00\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043395; rev:0;)

# Command&Control: (Trojan) ZeroAccess  - regex: to_server:^[\x01-\x02]\x00\x00.{4}\x3f\xc0\x02\x00\x00$ detector_id: 43396
alert tcp $HOME_NET any -> $EXTERNAL_NET 16464 (msg:"OpenBDS Command&Control: (Trojan) ZeroAccess "; flow:established,to_server,only_stream; content:"|01 00 00|"; depth:3; content:"?|C0 02 00 00|"; distance:4; within:9; pcre:"/^[\x01-\x02]\x00\x00.{4}\x3f\xc0\x02\x00\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104339600; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 16464 (msg:"OpenBDS Command&Control: (Trojan) ZeroAccess "; flow:established,to_server,only_stream; content:"|02 00 00|"; depth:3; content:"?|C0 02 00 00|"; distance:4; within:9; pcre:"/^[\x01-\x02]\x00\x00.{4}\x3f\xc0\x02\x00\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104339601; rev:0;)

# Command&Control: (Trojan) ServStart - regex: to_server:^.\x00{3}\x09\x04\x00{2}\w+.*\|Windows[\w\s]+\x00\| detector_id: 43435
alert tcp $HOME_NET any -> $EXTERNAL_NET 1123 (msg:"OpenBDS Command&Control: (Trojan) ServStart"; flow:established,to_server,only_stream; content:"|00 00 00 09 04 00 00|"; offset:1; depth:8; content:"|7C|Windows"; distance:0; content:"|00 7C|"; distance:0; pcre:"/^.\x00{3}\x09\x04\x00{2}\w+.*\|Windows[\w\s]+\x00\|/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043435; rev:0;)

# Command&Control: (Backdoor) Bezigate - regex: to_server:^.\x00{4}(\w\x00)+\|\x00(\w\x00)+\|\x00(\w\x00)+\|\x00D\x00E\x00A detector_id: 43436
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Bezigate"; flow:established,to_server,only_stream; content:"|00 00 00 00|"; offset:1; depth:5; content:"|00|"; distance:1; within:2; content:"|7C 00|"; distance:0; content:"|00|"; distance:1; within:2; content:"|7C 00|"; distance:0; content:"|00|"; distance:1; within:2; content:"|7C 00|D|00|E|00|A"; distance:0; pcre:"/^.\x00{4}(\w\x00)+\|\x00(\w\x00)+\|\x00(\w\x00)+\|\x00D\x00E\x00A/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043436; rev:0;)

# Command&Control: (Trojan) Rimecud - regex: to_server:^\x0d\xc9\x08\x00..\x00\x00..\x00\x00\x78\xda.. detector_id: 43566
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Rimecud"; flow:established,to_server,only_stream; content:"|0D C9 08 00|"; depth:4; content:"|00 00|"; distance:2; within:4; content:"|00 00|x|DA|"; distance:2; within:6; pcre:"/^\x0d\xc9\x08\x00..\x00\x00..\x00\x00\x78\xda../s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043566; rev:0;)

# Command&Control: (Backdoor) Nitol - regex: to_server:^\xe1\x00\x00\x00.{69}MHz\x00.{14}\xfc detector_id: 43567
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Nitol"; flow:established,to_server,only_stream; content:"|E1 00 00 00|"; depth:4; content:"MHz|00|"; distance:69; within:73; content:"|FC|"; distance:14; within:15; pcre:"/^\xe1\x00\x00\x00.{69}MHz\x00.{14}\xfc/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043567; rev:0;)

# Command&Control: (Trojan) Rimecud - regex: to_server:^C\)o\xfc\xe0\x51\x1a\xd6.{128} detector_id: 43634
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Rimecud"; flow:established,to_server,only_stream; content:"C|29|o|FC E0|Q|1A D6|"; depth:8; pcre:"/^C\)o\xfc\xe0\x51\x1a\xd6.{128}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043634; rev:0;)

# Command&Control: (Trojan) Sality - regex: to_server:^.{2}\x55\x00\x5e\x71.{83}$ detector_id: 43662
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Trojan) Sality"; flow:established,to_server,only_stream; content:"U|00 5E|q"; offset:2; depth:6; pcre:"/^.{2}\x55\x00\x5e\x71.{83}$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043662; rev:0;)

# Command&Control: (Trojan) Rimecud - regex: to_server:^S\)o\xfc\x30\xaa\x17\xf3.{128} detector_id: 43663
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Rimecud"; flow:established,to_server,only_stream; content:"S|29|o|FC|0|AA 17 F3|"; depth:8; pcre:"/^S\)o\xfc\x30\xaa\x17\xf3.{128}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043663; rev:0;)

# Command&Control: (Trojan) Sality - regex: to_server:^.{2}\x0c\x00\x6e\xe6.{10}$ detector_id: 43725
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Trojan) Sality"; flow:established,to_server,only_stream; content:"|0C 00|n|E6|"; offset:2; depth:6; pcre:"/^.{2}\x0c\x00\x6e\xe6.{10}$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1043725; rev:0;)

# Bitcoin Mining: BitCoinMiner - regex: to_server:^..\x00{2}\x05\x00{3}.[a-zA-Z0-9].*Proto[mM]iner detector_id: 43797
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Bitcoin Mining: BitCoinMiner"; flow:established,to_server,only_stream; content:"|00 00 05 00 00 00|"; offset:2; depth:8; content:"Protominer"; distance:0; pcre:"/^..\x00{2}\x05\x00{3}.[a-zA-Z0-9].*Proto[mM]iner/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104379700; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Bitcoin Mining: BitCoinMiner"; flow:established,to_server,only_stream; content:"|00 00 05 00 00 00|"; offset:2; depth:8; content:"ProtoMiner"; distance:0; pcre:"/^..\x00{2}\x05\x00{3}.[a-zA-Z0-9].*Proto[mM]iner/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104379701; rev:0;)

# command&control: Zegost - regex: to_server:^Spidern.*\x00{32}.*[Mm]\x00[Hh]\x00[Zz]\x00 detector_id: 43798
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: Zegost"; flow:established,to_server,only_stream; content:"Spidern"; depth:7; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; content:"M|00|H|00|Z|00|"; distance:0; pcre:"/^Spidern.*\x00{32}.*[Mm]\x00[Hh]\x00[Zz]\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104379800; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: Zegost"; flow:established,to_server,only_stream; content:"Spidern"; depth:7; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; content:"m|00|H|00|Z|00|"; distance:0; pcre:"/^Spidern.*\x00{32}.*[Mm]\x00[Hh]\x00[Zz]\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104379801; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: Zegost"; flow:established,to_server,only_stream; content:"Spidern"; depth:7; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; content:"M|00|h|00|Z|00|"; distance:0; pcre:"/^Spidern.*\x00{32}.*[Mm]\x00[Hh]\x00[Zz]\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104379802; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: Zegost"; flow:established,to_server,only_stream; content:"Spidern"; depth:7; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; content:"m|00|h|00|Z|00|"; distance:0; pcre:"/^Spidern.*\x00{32}.*[Mm]\x00[Hh]\x00[Zz]\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104379803; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: Zegost"; flow:established,to_server,only_stream; content:"Spidern"; depth:7; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; content:"M|00|H|00|z|00|"; distance:0; pcre:"/^Spidern.*\x00{32}.*[Mm]\x00[Hh]\x00[Zz]\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104379804; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: Zegost"; flow:established,to_server,only_stream; content:"Spidern"; depth:7; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; content:"m|00|H|00|z|00|"; distance:0; pcre:"/^Spidern.*\x00{32}.*[Mm]\x00[Hh]\x00[Zz]\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104379805; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: Zegost"; flow:established,to_server,only_stream; content:"Spidern"; depth:7; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; content:"M|00|h|00|z|00|"; distance:0; pcre:"/^Spidern.*\x00{32}.*[Mm]\x00[Hh]\x00[Zz]\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104379806; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS command&control: Zegost"; flow:established,to_server,only_stream; content:"Spidern"; depth:7; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; content:"m|00|h|00|z|00|"; distance:0; pcre:"/^Spidern.*\x00{32}.*[Mm]\x00[Hh]\x00[Zz]\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104379807; rev:0;)

# Command&Control: (Trojan) Bladabindi - regex: to_server:\d{3}\x00ll\|'\|'\|[\da-zA-Z]+={0,2}\|'\|'\|(\S+\|'\|'\|){2}\d\d-\d\d-\d\d\|'\|'\| detector_id: 44353
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bladabindi"; flow:established,to_server,only_stream; content:"|00|ll|7C 27 7C 27 7C|"; content:"|7C 27 7C 27 7C|"; distance:0; content:"|7C 27 7C 27 7C|"; distance:0; content:"|7C 27 7C 27 7C|"; distance:0; content:"-"; distance:2; within:3; content:"-"; distance:2; within:3; content:"|7C 27 7C 27 7C|"; distance:2; within:7; pcre:"/\d{3}\x00ll\|'\|'\|[\da-zA-Z]+={0,2}\|'\|'\|(\S+\|'\|'\|){2}\d\d-\d\d-\d\d\|'\|'\|/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044353; rev:0;)

# Command&Control: (Trojan) ZeroAccess - regex: to_server:^.\x00\x00[\x00\x80].\x3b\xd3\x3f\x00\x03\x00\x00$ detector_id: 44465
alert tcp $HOME_NET any -> $EXTERNAL_NET 16471 (msg:"OpenBDS Command&Control: (Trojan) ZeroAccess"; flow:established,to_server,only_stream; content:"|00 00 00|"; offset:1; depth:4; content:"|3B D3|?|00 03 00 00|"; distance:1; within:8; pcre:"/^.\x00\x00[\x00\x80].\x3b\xd3\x3f\x00\x03\x00\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104446500; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 16471 (msg:"OpenBDS Command&Control: (Trojan) ZeroAccess"; flow:established,to_server,only_stream; content:"|00 00 80|"; offset:1; depth:4; content:"|3B D3|?|00 03 00 00|"; distance:1; within:8; pcre:"/^.\x00\x00[\x00\x80].\x3b\xd3\x3f\x00\x03\x00\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:104446501; rev:0;)

# Command&Control: (Backdoor) Nitol - regex: to_server:^\x01\x00{3}\x09\x04\x00{6}x\x01(\d)\x00{5}.\x3a\1 detector_id: 44466
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Nitol"; flow:established,to_server,only_stream; content:"|01 00 00 00 09 04 00 00 00 00 00 00|x|01|"; depth:14; content:"|00 00 00 00 00|"; distance:1; within:6; content:"|3A|"; distance:1; within:2; pcre:"/^\x01\x00{3}\x09\x04\x00{6}x\x01(\d)\x00{5}.\x3a\1/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1044466; rev:0;)

# Command&Control: (Spyware) Finfisher - regex: to_server:^\x0c\x00\x00\x00\x40\x01\x73\x00 detector_id: 50578
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Spyware) Finfisher"; flow:established,to_server,only_stream; content:"|0C 00 00 00 40 01|s|00|"; depth:8; pcre:"/^\x0c\x00\x00\x00\x40\x01\x73\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050578; rev:0;)

# Command&Control: (Spyware) FinFisher - regex: to_server:^\x5c\x00\x00\x00\xa0\x02\x72\x00\x0c\x00\x00\x00\x40\x04\xfe\x00 detector_id: 50579
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Spyware) FinFisher"; flow:established,to_server,only_stream; content:"|5C 00 00 00 A0 02|r|00 0C 00 00 00 40 04 FE 00|"; depth:16; pcre:"/^\x5c\x00\x00\x00\xa0\x02\x72\x00\x0c\x00\x00\x00\x40\x04\xfe\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050579; rev:0;)

# Command&Control: (Trojan) Zegost - regex: to_server:^[A-Za-z0-9]{8}.{2}\x00{2}.{2}\x00{2}x\x9c detector_id: 50671
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"|00 00|"; offset:10; depth:12; content:"|00 00|x|9C|"; distance:2; within:6; pcre:"/^[A-Za-z0-9]{8}.{2}\x00{2}.{2}\x00{2}x\x9c/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050671; rev:0;)

# Command&Control: (Trojan) Zegost - regex: to_server:^.{2}\x00{2}.{2}\x00{2}[A-Za-z0-9]{5}x\x9c detector_id: 50708
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"|00 00|"; offset:2; depth:4; content:"|00 00|"; distance:2; within:4; content:"x|9C|"; distance:5; within:7; pcre:"/^.{2}\x00{2}.{2}\x00{2}[A-Za-z0-9]{5}x\x9c/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1050708; rev:0;)

# Command&Control: (Trojan) Ramnit - regex: to_server:\x00\xFF\x4C\x00\x00\x00\xE2\x00\x21\x00\x00\x00\xBD\x81\x40\x14\x11\xC7\xCA\xC8\x8E\xDB\xB8\x2E\xC6\xF2\x98\x69\xD3\xE2\x0D\x1C\x54\xE8\xF4\x12\xF5\x42\x8E\xBF\xA0\x8A\x1F\x57\x93\x00\x20\x00\x00\x00\xB9\xF6\x38\x60\x1F\xC2\x99\xEC\xA9\x8F\xE5\x09\x94\xA6\x99\x19\x82\xE7\x56\x3B\x5B\xEC\xF2\x6B\xF6\x40\x80\x9C\xA1\xDE\x11\x26 detector_id: 51665
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Ramnit"; flow:established,to_server,only_stream; content:"|00 FF|L|00 00 00 E2 00 21 00 00 00 BD 81 40 14 11 C7 CA C8 8E DB B8|.|C6 F2 98|i|D3 E2 0D 1C|T|E8 F4 12 F5|B|8E BF A0 8A 1F|W|93 00| |00 00 00 B9 F6|8|60 1F C2 99 EC A9 8F E5 09 94 A6 99 19 82 E7|V|3B 5B EC F2|k|F6 40 80 9C A1 DE 11|&"; pcre:"/\x00\xFF\x4C\x00\x00\x00\xE2\x00\x21\x00\x00\x00\xBD\x81\x40\x14\x11\xC7\xCA\xC8\x8E\xDB\xB8\x2E\xC6\xF2\x98\x69\xD3\xE2\x0D\x1C\x54\xE8\xF4\x12\xF5\x42\x8E\xBF\xA0\x8A\x1F\x57\x93\x00\x20\x00\x00\x00\xB9\xF6\x38\x60\x1F\xC2\x99\xEC\xA9\x8F\xE5\x09\x94\xA6\x99\x19\x82\xE7\x56\x3B\x5B\xEC\xF2\x6B\xF6\x40\x80\x9C\xA1\xDE\x11\x26/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1051665; rev:0;)

# Command&Control: (RAT) ZxShell - regex: to_server:\x86\x19\x00\x00\x04\x01\x00\x00 detector_id: 53330
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (RAT) ZxShell"; flow:established,to_server,only_stream; content:"|86 19 00 00 04 01 00 00|"; pcre:"/\x86\x19\x00\x00\x04\x01\x00\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053330; rev:0;)

# Command&Control: (Spyware) Kryptik - regex: to_server:^relayrqst$ detector_id: 53395
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Spyware) Kryptik"; flow:established,to_server,only_stream; content:"relayrqst"; depth:9; pcre:"/^relayrqst$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053395; rev:0;)

# Command&Control: (Backdoor) Generic - regex: to_server:^.\xaez\xecG\^$ detector_id: 53396
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"OpenBDS Command&Control: (Backdoor) Generic"; flow:established,to_server,only_stream; content:"|AE|z|EC|G|5E|"; offset:1; depth:6; pcre:"/^.\xaez\xecG\^$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053396; rev:0;)

# Command&Control: (Backdoor) Nitol - regex: to_server:^\d\*\d+MHz detector_id: 53416
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Nitol"; flow:established,to_server,only_stream; content:"|2A|"; offset:1; depth:2; content:"MHz"; distance:0; pcre:"/^\d\*\d+MHz/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053416; rev:0;)

# Command&Control: (Trojan) Beaugrit - regex: to_server:^AZIN [a-zA-Z]{3,} KMP [a-zA-Z]{3,} \d\.\d\,\d detector_id: 53512
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Beaugrit"; flow:established,to_server,only_stream; content:"AZIN "; depth:5; content:" KMP "; distance:0; content:" "; distance:0; content:"."; distance:1; within:2; content:"|2C|"; distance:1; within:2; pcre:"/^AZIN [a-zA-Z]{3,} KMP [a-zA-Z]{3,} \d\.\d\,\d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053512; rev:0;)

# Command&Control: (Trojan) Badur - regex: to_server:^\(\x00\x00\xff\x01\x00\x00\x00G detector_id: 53564
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Badur"; flow:established,to_server,only_stream; content:"|28 00 00 FF 01 00 00 00|G"; depth:9; pcre:"/^\(\x00\x00\xff\x01\x00\x00\x00G/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053564; rev:0;)

# Command&Control: (Trojan) Reveton - regex: to_server:^\xa7\x02\x00\x00 detector_id: 53600
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Reveton"; flow:established,to_server,only_stream; content:"|A7 02 00 00|"; depth:4; pcre:"/^\xa7\x02\x00\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053600; rev:0;)

#  - regex: to_server:^PROPFIND .*\/jvm\.dll HTTP detector_id: 53602
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS "; flow:established,to_server,only_stream; content:"PROPFIND "; depth:9; content:"/jvm.dll HTTP"; distance:0; pcre:"/^PROPFIND .*\/jvm\.dll HTTP/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053602; rev:0;)

# Command&Control: (Trojan) Zegost - regex: to_server:^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2} detector_id: 53612
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"7hero"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361200; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Adobe"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361201; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"B1X6Z"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361202; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"BEiLa"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361203; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"BeiJi"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361204; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"ByShe"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361205; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"FKJP3"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361206; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"FLYNN"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361207; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"FWAPR"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361208; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"FWKJG"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361209; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"GWRAT"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361210; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Gh0st"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361211; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"GOLDt"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361212; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"HEART"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361213; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"HTTPS"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361214; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"HXWAN"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361215; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Heart"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361216; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"IM007"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361217; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"ITore"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361218; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"KOBBX"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361219; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"KrisR"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361220; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"LUCKK"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361221; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"LURK0"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361222; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"LYRAT"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361223; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Level"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361224; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Lover"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361225; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Lyyyy"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361226; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"MYFYB"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361227; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"MoZhe"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361228; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"MyRat"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361229; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"OXXMM"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361230; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"PCRat"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361231; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"QWPOT"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361232; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Spide"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361233; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Tyjhu"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361234; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"URATU"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361235; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"W0LFK"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361236; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Wangz"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361237; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Winds"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361238; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"World"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361239; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"X6RAT"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361240; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"XDAPR"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361241; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Xjjhj"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361242; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"ag0ft"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361243; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"attac"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361244; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"cb1st"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361245; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"https"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361246; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"whmhl"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361247; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"xhjyk"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361248; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"00000"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361249; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"ABCDE"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361250; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"apach"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361251; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Assas"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361252; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Blues"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361253; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"chevr"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361254; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"CHINA"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361255; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"cyl22"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361256; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"DrAgO"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361257; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"EXXMM"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361258; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Eyes1"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361259; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Gi0st"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361260; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"GM110"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361261; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Hello"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361262; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"httpx"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361263; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"kaGni"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361264; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"light"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361265; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"LkxCq"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361266; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"lvxYT"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361267; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Naver"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361268; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"NIGHT"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361269; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"NoNul"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361270; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Origi"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361271; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Snown"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361272; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"SocKt"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361273; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Super"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361274; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Sw|40|rd"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361275; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"v2010"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361276; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"VGTLS"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361277; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"wcker"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361278; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Wh0vt"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361279; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"wings"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361280; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"X6M9K"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361281; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"xqwf7"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361282; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"YANGZ"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361283; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"A1CEA"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA).{2}\x00{2}.{2}\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105361284; rev:0;)

# Adware: (Bitcoin Login) Bitcoinminer - regex: to_server:^\{"method": "login", "params": \{"login": "[^"]+", "pass": "x", "agent": "cpuminer-multi/0\.1"} detector_id: 53692
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Bitcoin Login) Bitcoinminer"; flow:established,to_server,only_stream; content:"|7B 22|method|22 3A| |22|login|22 2C| |22|params|22 3A| |7B 22|login|22 3A| |22|"; depth:41; content:"|22 2C| |22|pass|22 3A| |22|x|22 2C| |22|agent|22 3A| |22|cpuminer-multi/0.1|22 7D|"; distance:0; pcre:"/^\{"method": "login", "params": \{"login": "[^"]+", "pass": "x", "agent": "cpuminer-multi\/0\.1"}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1053692; rev:0;)

# Command&Control: (Worm) Jenxcus - regex: to_server:^lv(0njxq80.*){6} detector_id: 54031
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Jenxcus"; flow:established,to_server,only_stream; content:"lv0njxq80"; depth:9; content:"0njxq80"; distance:0; content:"0njxq80"; distance:0; content:"0njxq80"; distance:0; content:"0njxq80"; distance:0; content:"0njxq80"; distance:0; pcre:"/^lv(0njxq80.*){6}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054031; rev:0;)

# icq login (Dedler?) - regex: to_server:^\*\x02\d.\x00I\x00\x17\x00\x04\x00\x00\x00\x00\x00\x00\x00\x01\x00\;\x00\x00\x00\x00\(\x00\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00..\x00\x00..\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\t\x00 detector_id: 54032
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS icq login (Dedler?)"; flow:established,to_server,only_stream; content:"|2A 02|"; depth:2; content:"|00|I|00 17 00 04 00 00 00 00 00 00 00 01 00 3B 00 00 00 00 28 00 03 00 00 00 00 00 00 00 00 00 00 00|"; distance:2; within:36; content:"|00 00|"; distance:2; within:4; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 09 00|"; distance:2; within:20; pcre:"/^\*\x02\d.\x00I\x00\x17\x00\x04\x00\x00\x00\x00\x00\x00\x00\x01\x00\;\x00\x00\x00\x00\(\x00\x03\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00..\x00\x00..\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\t\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054032; rev:0;)

# Command&Control: (Trojan) Symmi - regex: to_server:^\#\d{5}\!$ detector_id: 54095
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Symmi"; flow:established,to_server,only_stream; content:"|23|"; depth:1; content:"|21|"; distance:5; within:6; pcre:"/^\#\d{5}\!$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054095; rev:0;)

# Command&Control: (Backdoor) Zegost - regex: to_server:^BDFDB..\x00{2}..\x00{2}\x83\x7f detector_id: 54121
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Zegost"; flow:established,to_server,only_stream; content:"BDFDB"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00 83 7F|"; distance:2; within:6; pcre:"/^BDFDB..\x00{2}..\x00{2}\x83\x7f/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054121; rev:0;)

# Command&Control: (Trojan) Zegost - regex: to_server:^.\x00\x00\x00B\d165..\x00\x00z\x9a detector_id: 54122
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"|00 00 00|B"; offset:1; depth:5; content:"165"; distance:1; within:4; content:"|00 00|z|9A|"; distance:2; within:6; pcre:"/^.\x00\x00\x00B\d165..\x00\x00z\x9a/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054122; rev:0;)

# Command&Control: (Virus) Parite - regex: to_server:^\x00\x00\x00\x00.\x04\x00\x00[a-zA-Z0-9]+ detector_id: 54145
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Virus) Parite"; flow:established,to_server,only_stream; content:"|00 00 00 00|"; depth:4; content:"|04 00 00|"; distance:1; within:4; pcre:"/^\x00\x00\x00\x00.\x04\x00\x00[a-zA-Z0-9]+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054145; rev:0;)

# Command&Control: (Trojan) Parite - regex: to_server:^\x00\x00\x00\x00.\x04\x00\x00[a-zA-Z0-9\.]{3,}.*\x00\x02\x00\x00\x00[a-zA-Z0-9 ]{5,} detector_id: 54164
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Parite"; flow:established,to_server,only_stream; content:"|00 00 00 00|"; depth:4; content:"|04 00 00|"; distance:1; within:4; content:"|00 02 00 00 00|"; distance:0; pcre:"/^\x00\x00\x00\x00.\x04\x00\x00[a-zA-Z0-9\.]{3,}.*\x00\x02\x00\x00\x00[a-zA-Z0-9 ]{5,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054164; rev:0;)

# Command&Control: (Worm) Dedler - regex: to_server:^\*\x01\x00.\x00\x04\x00\x00\x00\x01 detector_id: 54221
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Dedler"; flow:established,to_server,only_stream; content:"|2A 01 00|"; depth:3; content:"|00 04 00 00 00 01|"; distance:1; within:7; pcre:"/^\*\x01\x00.\x00\x04\x00\x00\x00\x01/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054221; rev:0;)

# Command&Control: (Dropper) Bartallex - regex: to_server:^RkEntryPoint \: .* \:  detector_id: 54222
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Bartallex"; flow:established,to_server,only_stream; content:"RkEntryPoint |3A| "; depth:15; content:" |3A| "; distance:0; pcre:"/^RkEntryPoint \: .* \: /s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054222; rev:0;)

# Command&Control: (Trojan) SystemHijack - regex: to_server:^\x00(\x00\x10|\x01\x00)\x00Windows[\w\ \.\-]{2,20}\x00(.{17}\d+ \x2a \d+ Mhz\x00|\x00{17}[^\x00]{2}) detector_id: 54225
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) SystemHijack"; flow:established,to_server,only_stream; content:"|00 00 10 00|Windows"; depth:11; content:"|00|"; distance:0; content:" |2A| "; distance:0; content:" Mhz|00|"; distance:0; pcre:"/^\x00(\x00\x10|\x01\x00)\x00Windows[\w\ \.\-]{2,20}\x00(.{17}\d+ \x2a \d+ Mhz\x00|\x00{17}[^\x00]{2})/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105422500; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) SystemHijack"; flow:established,to_server,only_stream; content:"|00 01 00 00|Windows"; depth:11; content:"|00|"; distance:0; content:" |2A| "; distance:0; content:" Mhz|00|"; distance:0; pcre:"/^\x00(\x00\x10|\x01\x00)\x00Windows[\w\ \.\-]{2,20}\x00(.{17}\d+ \x2a \d+ Mhz\x00|\x00{17}[^\x00]{2})/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105422501; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) SystemHijack"; flow:established,to_server,only_stream; content:"|00 00 10 00|Windows"; depth:11; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; pcre:"/^\x00(\x00\x10|\x01\x00)\x00Windows[\w\ \.\-]{2,20}\x00(.{17}\d+ \x2a \d+ Mhz\x00|\x00{17}[^\x00]{2})/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105422502; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) SystemHijack"; flow:established,to_server,only_stream; content:"|00 01 00 00|Windows"; depth:11; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; pcre:"/^\x00(\x00\x10|\x01\x00)\x00Windows[\w\ \.\-]{2,20}\x00(.{17}\d+ \x2a \d+ Mhz\x00|\x00{17}[^\x00]{2})/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105422503; rev:0;)

# Command&Control: (Trojan) SystemHijack - regex: to_server:^VERS0NEX:Win[\w\ \.\-]{2,20}\x7c\d{1,3} \x2a \d{2,5}Mhz\/\d{3,5}Mb\x7c detector_id: 54226
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) SystemHijack"; flow:established,to_server,only_stream; content:"VERS0NEX|3A|Win"; depth:12; content:"|7C|"; distance:0; content:" |2A| "; distance:0; content:"Mhz/"; distance:0; content:"Mb|7C|"; distance:0; pcre:"/^VERS0NEX:Win[\w\ \.\-]{2,20}\x7c\d{1,3} \x2a \d{2,5}Mhz\/\d{3,5}Mb\x7c/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054226; rev:0;)

# Command&Control: (Downloader) Bartallex - regex: to_server:^REGMELINE .* \| .* \| .*\| \d+ detector_id: 54227
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Downloader) Bartallex"; flow:established,to_server,only_stream; content:"REGMELINE "; depth:10; content:" |7C| "; distance:0; content:" |7C| "; distance:0; content:"|7C| "; distance:0; pcre:"/^REGMELINE .* \| .* \| .*\| \d+/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054227; rev:0;)

# Command&Control: (Trojan) ServStart - regex: to_server:^VERSONEX:Win[^\|]+\|\d+\|\d+ MHz\|\d+MB\|\d+MB\| detector_id: 54228
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ServStart"; flow:established,to_server,only_stream; content:"VERSONEX|3A|Win"; depth:12; content:"|7C|"; distance:0; content:"|7C|"; distance:0; content:" MHz|7C|"; distance:0; content:"MB|7C|"; distance:0; content:"MB|7C|"; distance:0; pcre:"/^VERSONEX:Win[^\|]+\|\d+\|\d+ MHz\|\d+MB\|\d+MB\|/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054228; rev:0;)

# Command&Control: (Banker) SpyBanker - regex: to_server:^\x12\x01\x00N\x00\x00\x00\x00\x16\x03\x01\x00A\x01\x00\x00=\x03\x01T.{31}\x00\x00\x16\x00\x04\x00\x05\x00\x0a\x00\x09\x00d\x00b\x00\x03\x00\x06\x00\x13\x00\x12\x00c\x01\x00$ detector_id: 54229
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Banker) SpyBanker"; flow:established,to_server,only_stream; content:"|12 01 00|N|00 00 00 00 16 03 01 00|A|01 00 00|=|03 01|T"; depth:20; content:"|00 00 16 00 04 00 05 00 0A 00 09 00|d|00|b|00 03 00 06 00 13 00 12 00|c|01 00|"; distance:31; within:58; pcre:"/^\x12\x01\x00N\x00\x00\x00\x00\x16\x03\x01\x00A\x01\x00\x00=\x03\x01T.{31}\x00\x00\x16\x00\x04\x00\x05\x00\x0a\x00\x09\x00d\x00b\x00\x03\x00\x06\x00\x13\x00\x12\x00c\x01\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054229; rev:0;)

# Exe download - regex: to_server:^(GET|POST)\ [^\r]+\.exe detector_id: 54246
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Exe download"; flow:established,to_server,only_stream; content:"GET "; depth:4; content:".exe"; distance:0; pcre:"/^(GET|POST)\ [^\r]+\.exe/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105424600; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Exe download"; flow:established,to_server,only_stream; content:"POST "; depth:5; content:".exe"; distance:0; pcre:"/^(GET|POST)\ [^\r]+\.exe/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105424601; rev:0;)

# Command&Control: (Trojan) Zusy - regex: to_server:\x5f{37}\x0d\x0aVictim Infected, logs will be updated within detector_id: 54247
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zusy"; flow:established,to_server,only_stream; content:"_____________________________________|0D 0A|Victim Infected|2C| logs will be updated within"; pcre:"/\x5f{37}\x0d\x0aVictim Infected, logs will be updated within/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054247; rev:0;)

# Command&Control: (Trojan) Killproc - regex: to_server:^\r\nGET /.*/.*\.exe HTTP.*User-Agent: XD detector_id: 54250
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Killproc"; flow:established,to_server,only_stream; content:"|0D 0A|GET /"; depth:7; content:"/"; distance:0; content:".exe HTTP"; distance:0; content:"User-Agent|3A| XD"; distance:0; pcre:"/^\r\nGET \/.*\/.*\.exe HTTP.*User-Agent: XD/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054250; rev:0;)

# NewLine HTTP evasion - regex: to_server:^(\r\n){1,3}(GET|POST) \/[^\r]+ HTTP detector_id: 54261
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS NewLine HTTP evasion"; flow:established,to_server,only_stream; content:"|0D 0A|"; depth:2; content:"GET /"; distance:0; content:" HTTP"; distance:0; pcre:"/^(\r\n){1,3}(GET|POST) \/[^\r]+ HTTP/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105426100; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS NewLine HTTP evasion"; flow:established,to_server,only_stream; content:"|0D 0A|"; depth:2; content:"POST /"; distance:0; content:" HTTP"; distance:0; pcre:"/^(\r\n){1,3}(GET|POST) \/[^\r]+ HTTP/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105426101; rev:0;)

# Command&Control: (Backdoor) Venik - regex: to_server:^[ -~]{4}\-[ -~]{2}\x1A{5} detector_id: 54294
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Venik"; flow:established,to_server,only_stream; content:"-"; offset:4; depth:5; content:"|1A 1A 1A 1A 1A|"; distance:2; within:7; pcre:"/^[ -~]{4}\-[ -~]{2}\x1A{5}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054294; rev:0;)

# Command&Control: (Backdoor) Venik - regex: to_server:^[\x20-\x7e]{4}\-..\x1A{25}IJLF:M\\\x1A{5}gqp:bj:kjK\x1A{22} detector_id: 54317
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Venik"; flow:established,to_server,only_stream; content:"-"; offset:4; depth:5; content:"|1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A|IJLF|3A|M|5C 1A 1A 1A 1A 1A|gqp|3A|bj|3A|kjK|1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A 1A|"; distance:2; within:71; pcre:"/^[\x20-\x7e]{4}\-..\x1A{25}IJLF:M\\\x1A{5}gqp:bj:kjK\x1A{22}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054317; rev:0;)

# Command&Control: (Trojan) Virlock - regex: to_server:^\x16\x03\x03\x00S\x01\x00\x00O\x03\x03................................\x00\x00\x1c\x00k\x00g\x009\x003\x00\=\x00\<\x005\x00\/\x00\x05 detector_id: 54318
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"OpenBDS Command&Control: (Trojan) Virlock"; flow:established,to_server,only_stream; content:"|16 03 03 00|S|01 00 00|O|03 03|"; depth:11; content:"|00 00 1C 00|k|00|g|00|9|00|3|00|=|00|<|00|5|00|/|00 05|"; distance:32; within:53; pcre:"/^\x16\x03\x03\x00S\x01\x00\x00O\x03\x03................................\x00\x00\x1c\x00k\x00g\x009\x003\x00\=\x00\<\x005\x00\/\x00\x05/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054318; rev:0;)

# Command&Control: (Trojan) Bladabindi - regex: to_server:^\d+\x00.+\|\'\|\'\|.*\|\'\|\'\| detector_id: 54393
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bladabindi"; flow:established,to_server,only_stream; content:"|00|"; content:"|7C 27 7C 27 7C|"; distance:0; content:"|7C 27 7C 27 7C|"; distance:0; pcre:"/^\d+\x00.+\|\'\|\'\|.*\|\'\|\'\|/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1054393; rev:0;)

# Command&Control: (Trojan) Zegost - regex: to_server:^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2} detector_id: 54405
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"7hero"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440500; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Adobe"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440501; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"B1X6Z"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440502; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"BEiLa"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440503; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"BeiJi"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440504; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"ByShe"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440505; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"FKJP3"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440506; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"FLYNN"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440507; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"FWAPR"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440508; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"FWKJG"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440509; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"GWRAT"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440510; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Gh0st"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440511; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"GOLDt"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440512; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"HEART"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440513; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"HTTPS"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440514; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"HXWAN"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440515; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Heart"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440516; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"IM007"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440517; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"ITore"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440518; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"KOBBX"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440519; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"KrisR"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440520; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"LUCKK"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440521; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"LURK0"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440522; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"LYRAT"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440523; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Level"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440524; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Lover"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440525; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Lyyyy"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440526; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"MYFYB"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440527; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"MoZhe"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440528; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"MyRat"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440529; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"OXXMM"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440530; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"PCRat"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440531; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"QWPOT"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440532; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Spide"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440533; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Tyjhu"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440534; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"URATU"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440535; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"W0LFK"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440536; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Wangz"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440537; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Winds"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440538; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"World"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440539; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"X6RAT"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440540; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"XDAPR"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440541; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Xjjhj"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440542; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"ag0ft"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440543; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"attac"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440544; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"cb1st"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440545; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"https"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440546; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"whmhl"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440547; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"xhjyk"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440548; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"00000"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440549; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"ABCDE"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440550; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"apach"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440551; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Assas"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440552; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Blues"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440553; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"chevr"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440554; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"CHINA"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440555; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"cyl22"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440556; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"DrAgO"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440557; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"EXXMM"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440558; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Eyes1"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440559; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Gi0st"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440560; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"GM110"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440561; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Hello"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440562; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"httpx"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440563; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"kaGni"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440564; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"light"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440565; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"LkxCq"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440566; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"lvxYT"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440567; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Naver"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440568; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"NIGHT"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440569; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"NoNul"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440570; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Origi"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440571; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Snown"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440572; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"SocKt"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440573; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Super"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440574; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Sw|40|rd"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440575; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"v2010"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440576; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"VGTLS"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440577; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"wcker"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440578; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"Wh0vt"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440579; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"wings"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440580; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"X6M9K"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440581; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"xqwf7"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440582; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"YANGZ"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440583; rev:0;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"A1CEA"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^(7hero|Adobe|B1X6Z|BEiLa|BeiJi|ByShe|FKJP3|FLYNN|FWAPR|FWKJG|GWRAT|Gh0st|GOLDt|HEART|HTTPS|HXWAN|Heart|IM007|ITore|KOBBX|KrisR|LUCKK|LURK0|LYRAT|Level|Lover|Lyyyy|MYFYB|MoZhe|MyRat|OXXMM|PCRat|QWPOT|Spide|Tyjhu|URATU|W0LFK|Wangz|Winds|World|X6RAT|XDAPR|Xjjhj|ag0ft|attac|cb1st|https|whmhl|xhjyk|00000|ABCDE|apach|Assas|Blues|chevr|CHINA|cyl22|DrAgO|EXXMM|Eyes1|Gi0st|GM110|Hello|httpx|kaGni|light|LkxCq|lvxYT|Naver|NIGHT|NoNul|Origi|Snown|SocKt|Super|Sw@rd|v2010|VGTLS|wcker|Wh0vt|wings|X6M9K|xqwf7|YANGZ|A1CEA)[^\x00].\x00{2}[^\x00].\x00{2}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105440584; rev:0;)

# Command&Control: (Trojan) Lydra - regex: to_server:^Ver\ \d+\r\nSess\_ID\ \d{2}\.\d{2}\.\d{4}\ \d{2}:\d{2}:\d{2}\r\n detector_id: 55272
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Lydra"; flow:established,to_server,only_stream; content:"Ver "; depth:4; content:"|0D 0A|Sess_ID "; distance:0; content:"."; distance:2; within:3; content:"."; distance:2; within:3; content:" "; distance:4; within:5; content:"|3A|"; distance:2; within:3; content:"|3A|"; distance:2; within:3; content:"|0D 0A|"; distance:2; within:4; pcre:"/^Ver\ \d+\r\nSess\_ID\ \d{2}\.\d{2}\.\d{4}\ \d{2}:\d{2}:\d{2}\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1055272; rev:0;)

# Command&Control: (Trojan) Nitol - regex: to_server:^KuGou..\x00\x00..\x00\x00 detector_id: 55349
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Nitol"; flow:established,to_server,only_stream; content:"KuGou"; depth:5; content:"|00 00|"; distance:2; within:4; content:"|00 00|"; distance:2; within:4; pcre:"/^KuGou..\x00\x00..\x00\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1055349; rev:0;)

# PE EXE file download (tcp) - regex: to_server:^.{0,16}MZ.{70,80}This\x20program.*PE\x00\x00 detector_id: 57321
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS PE EXE file download (tcp)"; flow:established,to_client,only_stream; content:"MZ"; depth:18; content:"This program"; distance:70; within:92; content:"PE|00 00|"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105732100; rev:0;)

# PE EXE file download (smtp) - regex: to_server:Content-Transfer-Encoding: base64\r\n.*\r\n0D0A0D0ATV.*AAAAAAAAAAAAAAAA detector_id: 57323
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"OpenBDS PE EXE file download (smtp)"; flow:established,to_server; content:"Content-Transfer-Encoding|3A| base64|0D 0A|"; content:"|0D 0A|TV"; distance:0; within:200; content:"AAAAAAAAAAAAAAAA"; distance:0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105732300; rev:0;)

# PE EXE file download (smtp - this program) - regex: to_server:\x0d\x0a\x0d\x0aTV.*(RoaXMgcHJvZ3Jhb|UaGlzIHByb2dyYW|VGhpcyBwcm9ncmFt) detector_id: 57324
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"OpenBDS PE EXE file download (smtp - this program)"; flow:established,to_server,only_stream; content:"|0D 0A 0D 0A|TV"; content:"RoaXMgcHJvZ3Jhb"; distance:93; within:121; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105732400; rev:0;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"OpenBDS PE EXE file download (smtp - this program)"; flow:established,to_server,only_stream; content:"|0D 0A 0D 0A|TV"; content:"UaGlzIHByb2dyYW"; distance:93; within:122; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105732401; rev:0;)
alert tcp $EXTERNAL_NET any -> $HOME_NET 25 (msg:"OpenBDS PE EXE file download (smtp - this program)"; flow:established,to_server,only_stream; content:"|0D 0A 0D 0A|TV"; content:"VGhpcyBwcm9ncmFt"; distance:93; within:123; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105732402; rev:0;)

# Command&Control: (Dropper) Beaugrit - regex: to_server:^>>.\x00<<[A-Z0-9\-]+<<[A-Z0-9\-]+<<0<<....::.*::.* detector_id: 57399
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Beaugrit"; flow:established,to_server,only_stream; content:">>"; depth:2; content:"|00|<<"; distance:1; within:4; content:"<<"; distance:0; content:"<<0<<"; distance:0; content:"|3A 3A|"; distance:4; within:6; content:"|3A 3A|"; distance:0; pcre:"/^>>.\x00<<[A-Z0-9\-]+<<[A-Z0-9\-]+<<0<<....::.*::.*/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057399; rev:0;)

# Command&Control: (Trojan) Zegost - regex: to_server:^\&n\x9e\x93f\xda[^\x00]\x00{3}[^\x00]\x00{3}\x1A.{8}$ detector_id: 57521
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"&n|9E 93|f|DA|"; depth:6; content:"|00 00 00|"; distance:1; within:4; content:"|00 00 00 1A|"; distance:1; within:5; pcre:"/^\&n\x9e\x93f\xda[^\x00]\x00{3}[^\x00]\x00{3}\x1A.{8}$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057521; rev:0;)

# Command&Control: (Trojan) Zegost - regex: to_server:^\&n\x9e\x93f\xda[^\x00]\x00{3}[^\x00]\x00{3}\x1A.{8} detector_id: 57522
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"&n|9E 93|f|DA|"; depth:6; content:"|00 00 00|"; distance:1; within:4; content:"|00 00 00 1A|"; distance:1; within:5; pcre:"/^\&n\x9e\x93f\xda[^\x00]\x00{3}[^\x00]\x00{3}\x1A.{8}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057522; rev:0;)

# Command&Control: (Trojan) Fynloski - regex: to_server:^ENDSNAP detector_id: 57526
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski"; flow:established,to_server,only_stream; content:"ENDSNAP"; depth:7; pcre:"/^ENDSNAP/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057526; rev:0;)

# Command&Control: (Trojan) Fynloski/Darkcomet - regex: to_server:^A{103}$ detector_id: 57527
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fynloski/Darkcomet"; flow:established,to_server,only_stream; content:"AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"; depth:103; pcre:"/^A{103}$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057527; rev:0;)

# Command&Control: (IRC) IRCbot - regex: to_server:^NICK C\d_(\d_)?[A-Z\-]+\r?\n detector_id: 57528
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (IRC) IRCbot"; flow:established,to_server,only_stream; content:"NICK C"; depth:6; content:"_"; distance:1; within:2; content:"|0A|"; distance:0; pcre:"/^NICK C\d_(\d_)?[A-Z\-]+\r?\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057528; rev:0;)

# Command&Control: (Bruteforcer) Pramro - regex: to_server:^.....\x00\xe0\x72\x09\xab\xd5\x4f\x6e||to_client:^......\xe3\x78\x61\xdf detector_id: 57912
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Bruteforcer) Pramro (0) (no alert)"; flow:established,to_server,only_stream; content:"|00 E0|r|09 AB D5|On"; offset:5; depth:13; pcre:"/^.....\x00\xe0\x72\x09\xab\xd5\x4f\x6e/s"; flowbits:set,LL.57912_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105791200; rev:0;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Bruteforcer) Pramro (1)"; flowbits:isset,LL.57912_0; flow:established,to_client,only_stream; content:"|E3|xa|DF|"; offset:6; depth:10; pcre:"/^......\xe3\x78\x61\xdf/s"; flowbits:unset,LL.57912_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105791201; rev:0;)

# Command&Control: (Backdoor) PCClient - regex: to_server:^.\xe8\xf7\xf7.{8,12}\xf7\xf7\xf7\xf7 detector_id: 57954
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) PCClient"; flow:established,to_server,only_stream; content:"|E8 F7 F7|"; offset:1; depth:4; content:"|F7 F7 F7 F7|"; distance:0; pcre:"/^.\xe8\xf7\xf7.{8,12}\xf7\xf7\xf7\xf7/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057954; rev:0;)

# Command&Control: (Trojan) Zegost - regex: to_server:^DEATHQ[^\x00].\x00\x00[^\x00].\x00\x00\x1a\xbaI\xd9\.\x96\?\(\xdb detector_id: 57955
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"DEATHQ"; depth:6; content:"|00 00|"; distance:2; within:4; content:"|00 00 1A BA|I|D9|.|96|?|28 DB|"; distance:2; within:13; pcre:"/^DEATHQ[^\x00].\x00\x00[^\x00].\x00\x00\x1a\xbaI\xd9\.\x96\?\(\xdb/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1057955; rev:0;)

# Command&Control: (Backdoor) Blocrypt - regex: to_client:^.(?![ -~]{5}).{5,}(GET|POST) /[^\r\n]+ HTTP/1\.\d\r\n detector_id: 58070
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Backdoor) Blocrypt"; flow:established,to_client,only_stream; content:"GET /"; content:" HTTP/1."; distance:0; content:"|0D 0A|"; distance:1; within:3; pcre:"/^.(?![ -~]{5}).{5,}(GET|POST) \/[^\r\n]+ HTTP\/1\.\d\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105807000; rev:0;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Backdoor) Blocrypt"; flow:established,to_client,only_stream; content:"POST /"; content:" HTTP/1."; distance:0; content:"|0D 0A|"; distance:1; within:3; pcre:"/^.(?![ -~]{5}).{5,}(GET|POST) \/[^\r\n]+ HTTP\/1\.\d\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105807001; rev:0;)

# Command&Control: (Trojan) Depok - regex: to_server:^ADN0\r\nADN1\r\nADN3\r\nADN4\r\nADN2\r\n detector_id: 58258
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Depok"; flow:established,to_server,only_stream; content:"ADN0|0D 0A|ADN1|0D 0A|ADN3|0D 0A|ADN4|0D 0A|ADN2|0D 0A|"; depth:30; pcre:"/^ADN0\r\nADN1\r\nADN3\r\nADN4\r\nADN2\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058258; rev:0;)

# Command&Control: (Trojan) MSIL/Injector CnC beacons - regex: to_server:^[A-Za-z0-9+/]{22}==\x0d\x0a$||to_client:^[A-Za-z0-9+/]{22}==\x0d\x0a$ detector_id: 58259
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) MSIL/Injector CnC beacons (0) (no alert)"; flow:established,to_server,only_stream; content:"==|0D 0A|"; offset:22; depth:26; pcre:"/^[A-Za-z0-9+\/]{22}==\x0d\x0a$/s"; flowbits:set,LL.58259_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105825900; rev:0;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Trojan) MSIL/Injector CnC beacons (1)"; flowbits:isset,LL.58259_0; flow:established,to_client,only_stream; content:"==|0D 0A|"; offset:22; depth:26; pcre:"/^[A-Za-z0-9+\/]{22}==\x0d\x0a$/s"; flowbits:unset,LL.58259_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105825901; rev:0;)

# Command&Control: (Backdoor) Gbot - regex: to_server:^\x85\x13\<\x9e\xa2MZ detector_id: 58712
alert tcp $HOME_NET any -> $EXTERNAL_NET 3127 (msg:"OpenBDS Command&Control: (Backdoor) Gbot"; flow:established,to_server,only_stream; content:"|85 13|<|9E A2|MZ"; depth:7; pcre:"/^\x85\x13\<\x9e\xa2MZ/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058712; rev:1708;)

# Command&Control: (Trojan) Zegost - regex: to_server:^..\x00{2}\&n\x9e\x93f\xda[^\x00]\x00{3}[^\x00] detector_id: 58713
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zegost"; flow:established,to_server,only_stream; content:"|00 00|&n|9E 93|f|DA|"; offset:2; depth:10; content:"|00 00 00|"; distance:1; within:4; pcre:"/^..\x00{2}\&n\x9e\x93f\xda[^\x00]\x00{3}[^\x00]/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058713; rev:1711;)

# Command&Control: (Trojan) Fusing - regex: to_server:^K\x8d9\x08Q..\x9c\x7f.\#\xb6\xf9X...TZj\xf3.A\xb2\x9bln\xe8y..F\xde\xceM\>\| detector_id: 58829
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Fusing"; flow:established,to_server,only_stream; content:"K|8D|9|08|Q"; depth:5; content:"|9C 7F|"; distance:2; within:4; content:"|23 B6 F9|X"; distance:1; within:5; content:"TZj|F3|"; distance:3; within:7; content:"A|B2 9B|ln|E8|y"; distance:1; within:8; content:"F|DE CE|M>|7C|"; distance:2; within:8; pcre:"/^K\x8d9\x08Q..\x9c\x7f.\#\xb6\xf9X...TZj\xf3.A\xb2\x9bln\xe8y..F\xde\xceM\>\|/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058829; rev:1747;)

# Command&Control: (Trojan) FF-RAT - regex: to_server:\xd8\xd8\xd8\xd87\'\'&\$\'\'\'\xc7 detector_id: 58830
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) FF-RAT"; flow:established,to_server,only_stream; content:"|D8 D8 D8 D8|7|27 27|&|24 27 27 27 C7|"; pcre:"/\xd8\xd8\xd8\xd87\'\'&\$\'\'\'\xc7/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058830; rev:1747;)

# Command&Control: (Trojan) Sdbot - regex: to_server:^Windows .*\x00\x00\x00\x00\x00{47,52}.*\x00\x00\x00\x00\x00{12,28}\d+\*\d+MHz\x00{23}\d+MB\x00{16,32}.*\x00{26}\;([0-9]{1,3}\.){3}[0-9]{1,3} detector_id: 58857
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sdbot"; flow:established,to_server,only_stream; content:"Windows "; depth:8; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; content:"|2A|"; distance:0; content:"MHz|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; content:"MB|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 3B|"; distance:0; content:"."; distance:0; content:"."; distance:0; content:"."; distance:0; pcre:"/^Windows .*\x00\x00\x00\x00\x00{47,52}.*\x00\x00\x00\x00\x00{12,28}\d+\*\d+MHz\x00{23}\d+MB\x00{16,32}.*\x00{26}\;([0-9]{1,3}\.){3}[0-9]{1,3}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058857; rev:1753;)

# Command&Control: (Trojan) Wonton - regex: to_server:^(.\x32\x01\x00)||to_client:^(.\x32\x01\x00)\x13\x01 detector_id: 58910
alert tcp $HOME_NET any -> $EXTERNAL_NET 7700 (msg:"OpenBDS Command&Control: (Trojan) Wonton (0) (no alert)"; flow:established,to_server,only_stream; content:"2|01 00|"; offset:1; depth:4; pcre:"/^(.\x32\x01\x00)/s"; flowbits:set,LL.58910_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105891000; rev:1768;)
alert tcp $EXTERNAL_NET 7700 -> $HOME_NET any (msg:"OpenBDS Command&Control: (Trojan) Wonton (1)"; flowbits:isset,LL.58910_0; flow:established,to_client,only_stream; content:"2|01 00 13 01|"; offset:1; depth:6; pcre:"/^(.\x32\x01\x00)\x13\x01/s"; flowbits:unset,LL.58910_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105891001; rev:1768;)

# Command&Control: (Trojan) Asterope - regex: to_server:^(hi|yo|knock)(\|\|\d+|\|\d+\|[\d\.]+\|\d+\|[\d\.]+\|\d+\|\d+\|\d+) detector_id: 58911
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Asterope"; flow:established,to_server,only_stream; content:"hi|7C 7C|"; depth:4; pcre:"/^(hi|yo|knock)(\|\|\d+|\|\d+\|[\d\.]+\|\d+\|[\d\.]+\|\d+\|\d+\|\d+)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105891100; rev:1768;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Asterope"; flow:established,to_server,only_stream; content:"yo|7C 7C|"; depth:4; pcre:"/^(hi|yo|knock)(\|\|\d+|\|\d+\|[\d\.]+\|\d+\|[\d\.]+\|\d+\|\d+\|\d+)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105891101; rev:1768;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Asterope"; flow:established,to_server,only_stream; content:"knock|7C 7C|"; depth:7; pcre:"/^(hi|yo|knock)(\|\|\d+|\|\d+\|[\d\.]+\|\d+\|[\d\.]+\|\d+\|\d+\|\d+)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105891102; rev:1768;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Asterope"; flow:established,to_server,only_stream; content:"hi|7C|"; depth:3; content:"|7C|"; distance:0; content:"|7C|"; distance:0; content:"|7C|"; distance:0; content:"|7C|"; distance:0; content:"|7C|"; distance:0; content:"|7C|"; distance:0; pcre:"/^(hi|yo|knock)(\|\|\d+|\|\d+\|[\d\.]+\|\d+\|[\d\.]+\|\d+\|\d+\|\d+)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105891103; rev:1768;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Asterope"; flow:established,to_server,only_stream; content:"yo|7C|"; depth:3; content:"|7C|"; distance:0; content:"|7C|"; distance:0; content:"|7C|"; distance:0; content:"|7C|"; distance:0; content:"|7C|"; distance:0; content:"|7C|"; distance:0; pcre:"/^(hi|yo|knock)(\|\|\d+|\|\d+\|[\d\.]+\|\d+\|[\d\.]+\|\d+\|\d+\|\d+)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105891104; rev:1768;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Asterope"; flow:established,to_server,only_stream; content:"knock|7C|"; depth:6; content:"|7C|"; distance:0; content:"|7C|"; distance:0; content:"|7C|"; distance:0; content:"|7C|"; distance:0; content:"|7C|"; distance:0; content:"|7C|"; distance:0; pcre:"/^(hi|yo|knock)(\|\|\d+|\|\d+\|[\d\.]+\|\d+\|[\d\.]+\|\d+\|\d+\|\d+)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105891105; rev:1768;)

# Command&Control (Dropper) Korlia - regex: to_server:^\xbc\x01\x00\x00\)\({11}\x19\(\x1a\(\x19\(\x11\({12}\((?i)B\(G\(\@\(F detector_id: 58912
alert tcp $HOME_NET any -> $EXTERNAL_NET 443 (msg:"OpenBDS Command&Control (Dropper) Korlia"; flow:established,to_server,only_stream; content:"|BC 01 00 00 29 28 28 28 28 28 28 28 28 28 28 28 19 28 1A 28 19 28 11 28 28 28 28 28 28 28 28 28 28 28 28 28|B|28|G|28 40 28|F"; nocase; depth:43; pcre:"/^\xbc\x01\x00\x00\)\({11}\x19\(\x1a\(\x19\(\x11\({12}\((?i)B\(G\(\@\(F/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058912; rev:1768;)

# Command&Control: (Trojan) Bandook - regex: to_server:^QDAwMD..(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})&&&||to_client:^QDAwM..= detector_id: 58914
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bandook (0) (no alert)"; flow:established,to_server,only_stream; content:"QDAwMD"; depth:6; content:"=="; distance:0; content:"&&&"; distance:0; pcre:"/^QDAwMD..(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{4})&&&/s"; flowbits:set,LL.58914_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105891400; rev:1771;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bandook (0) (no alert)"; flow:established,to_server,only_stream; content:"QDAwMD"; depth:6; content:"="; distance:0; content:"&&&"; distance:0; pcre:"/^QDAwMD..(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{4})&&&/s"; flowbits:set,LL.58914_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105891401; rev:1771;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bandook (0) (no alert)"; flow:established,to_server,only_stream; content:"QDAwMD"; depth:6; content:"&&&"; distance:0; pcre:"/^QDAwMD..(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{4})&&&/s"; flowbits:set,LL.58914_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105891402; rev:1771;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Trojan) Bandook (1)"; flowbits:isset,LL.58914_0; flow:established,to_client,only_stream; content:"QDAwM"; depth:5; content:"="; distance:2; within:3; pcre:"/^QDAwM..=/s"; flowbits:unset,LL.58914_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105891403; rev:1771;)

# Foobar - regex: to_server:^TestThatWillNeverMatchAnythingAtAll detector_id: 58915
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Foobar"; flow:established,to_server,only_stream; content:"TestThatWillNeverMatchAnythingAtAll"; depth:35; pcre:"/^TestThatWillNeverMatchAnythingAtAll/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1058915; rev:1921;)

# Command&Control: (Trojan) Webky Gh0st variant - regex: to_server:^HTTP\x5c1\.1\x20Sycmentec detector_id: 59031
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Webky Gh0st variant"; flow:established,to_server,only_stream; content:"HTTP|5C|1.1 Sycmentec"; depth:18; pcre:"/^HTTP\x5c1\.1\x20Sycmentec/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059031; rev:1831;)

# Command&Control: (Trojan) NetwireRAT - regex: to_server:^A\x00\x00\x00\x03||to_client:^A\x00\x00\x00\x05||to_server:^.\x00\x00\x00\x05 detector_id: 59032
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) NetwireRAT (0) (no alert)"; flow:established,to_server,only_stream; content:"A|00 00 00 03|"; depth:5; pcre:"/^A\x00\x00\x00\x03/s"; flowbits:set,LL.59032_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105903200; rev:1831;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Trojan) NetwireRAT (1) (no alert)"; flowbits:isset,LL.59032_0; flow:established,to_client,only_stream; content:"A|00 00 00 05|"; depth:5; pcre:"/^A\x00\x00\x00\x05/s"; flowbits:unset,LL.59032_0; flowbits:set,LL.59032_1; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105903201; rev:1831;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) NetwireRAT (2)"; flowbits:isset,LL.59032_1; flow:established,to_server,only_stream; content:"|00 00 00 05|"; offset:1; depth:5; pcre:"/^.\x00\x00\x00\x05/s"; flowbits:unset,LL.59032_1; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105903202; rev:1831;)

# Command&Control: (Backdoor) PcClient - regex: to_server:^\xc8\xe8\xf7\xf7\xf7\xf7\xf7\xf7\xd3\x13\xab\xf5\xf7\xf7\xf7\xf7\xf7{248} detector_id: 59064
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) PcClient"; flow:established,to_server,only_stream; content:"|C8 E8 F7 F7 F7 F7 F7 F7 D3 13 AB F5 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7|"; depth:255; content:"|F7 F7 F7 F7 F7 F7 F7 F7 F7|"; distance:0; pcre:"/^\xc8\xe8\xf7\xf7\xf7\xf7\xf7\xf7\xd3\x13\xab\xf5\xf7\xf7\xf7\xf7\xf7{248}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059064; rev:1834;)

# Command&Control: (Backdoor) PcClient - regex: to_server:^.\xe8\xf7\xf7....\xc7\xc7\xc7\xc7\xc7{4}\xf7\xf7\xf7\xf7\xf7{460}\x00\x00\x00\x00\x00{12} detector_id: 59065
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) PcClient"; flow:established,to_server,only_stream; content:"|E8 F7 F7|"; offset:1; depth:4; content:"|C7 C7 C7 C7 C7 C7 C7 C7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7|"; distance:4; within:259; content:"|F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; pcre:"/^.\xe8\xf7\xf7....\xc7\xc7\xc7\xc7\xc7{4}\xf7\xf7\xf7\xf7\xf7{460}\x00\x00\x00\x00\x00{12}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059065; rev:1834;)

# Command&Control: (Backdoor) PcClient - regex: to_server:.\xe8\xf7\xf7(\x00\x00\x00\x00|\xf7\xf7\xf7\xf7)\xf7\xf7\xf7\xf7\xf7{4}o\xff\xf7 detector_id: 59066
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) PcClient"; flow:established,to_server,only_stream; content:"|E8 F7 F7 00 00 00 00 F7 F7 F7 F7 F7 F7 F7 F7|o|FF F7|"; pcre:"/.\xe8\xf7\xf7(\x00\x00\x00\x00|\xf7\xf7\xf7\xf7)\xf7\xf7\xf7\xf7\xf7{4}o\xff\xf7/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105906600; rev:1834;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) PcClient"; flow:established,to_server,only_stream; content:"|E8 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7 F7|o|FF F7|"; pcre:"/.\xe8\xf7\xf7(\x00\x00\x00\x00|\xf7\xf7\xf7\xf7)\xf7\xf7\xf7\xf7\xf7{4}o\xff\xf7/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105906601; rev:1834;)

# Command&Control: (Trojan) Symmi - regex: to_server:^D9D17F54CFAB2502F36DBB detector_id: 59167
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Symmi"; flow:established,to_server,only_stream; content:"D9D17F54CFAB2502F36DBB"; depth:22; pcre:"/^D9D17F54CFAB2502F36DBB/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059167; rev:1855;)

# Command&Control: (Dropper) Malushka - regex: to_server:^\d{5}\:\-?\d\|\d{3,5}\|[A-Za-z0-9_\ \-\.]+,\d\x00 detector_id: 59198
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Malushka"; flow:established,to_server,only_stream; content:"|3A|"; offset:5; depth:6; content:"|7C|"; distance:0; content:"|7C|"; distance:0; content:"|2C|"; distance:0; content:"|00|"; distance:1; within:2; pcre:"/^\d{5}\:\-?\d\|\d{3,5}\|[A-Za-z0-9_\ \-\.]+,\d\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059198; rev:1870;)

# Command&Control: (Trojan) GenericTrojan_158 - regex: to_server:^POST .*User-Agent: [^\n]+Safari/[a-zA-Z0-9]{6}\r\n.*Expect: 100-continue||to_server:^[a-zA-Z0-9]{18}$ detector_id: 59199
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Trojan) GenericTrojan_158"; flow:established,to_server,only_stream; content:"POST "; depth:5; content:"User-Agent|3A| "; distance:0; content:"Safari/"; distance:0; content:"|0D 0A|"; distance:6; within:8; content:"Expect|3A| 100-continue"; distance:0; pcre:"/^POST .*User-Agent: [^\n]+Safari\/[a-zA-Z0-9]{6}\r\n.*Expect: 100-continue/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059199; rev:1873;)

# Command&Control: (Trojan) RealtimeSpy - regex: to_server:^GET\ \/locrts\d\.php\r\n||to_client:^\-?\d{,2}\.\d{4},\-?\d{,3}\.\d{4} detector_id: 59200
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) RealtimeSpy (0) (no alert)"; flow:established,to_server,only_stream; content:"GET /locrts"; depth:11; content:".php|0D 0A|"; distance:1; within:7; pcre:"/^GET\ \/locrts\d\.php\r\n/s"; flowbits:set,LL.59200_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105920000; rev:1873;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Trojan) RealtimeSpy (1)"; flowbits:isset,LL.59200_0; flow:established,to_client,only_stream; content:"."; content:"|2C|"; distance:4; within:5; content:"."; distance:0; pcre:"/^\-?\d{,2}\.\d{4},\-?\d{,3}\.\d{4}/s"; flowbits:unset,LL.59200_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105920001; rev:1873;)

# Command&Control: (Trojan) IRCbot - regex: to_server:^NICK (...\|\d{5})\r\nUSER [a-z]{5,7} \d \d :\1 detector_id: 59228
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) IRCbot"; flow:established,to_server,only_stream; content:"NICK "; depth:5; content:"|7C|"; distance:3; within:4; content:"|0D 0A|USER "; distance:5; within:12; content:" "; distance:0; content:" "; distance:1; within:2; content:" |3A|"; distance:1; within:3; pcre:"/^NICK (...\|\d{5})\r\nUSER [a-z]{5,7} \d \d :\1/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059228; rev:1876;)

# Command&Control: (Trojan) Dorkbot - regex: to_server:^PASS .*\r\nNICK .?\{.{2,3}\|.+\}([a-z]+)\r\nUSER \1 \d \d :\1 detector_id: 59229
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Dorkbot"; flow:established,to_server,only_stream; content:"PASS "; depth:5; content:"|0D 0A|NICK "; distance:0; content:"|7B|"; distance:0; content:"|7C|"; distance:0; content:"|7D|"; distance:0; content:"|0D 0A|USER "; distance:0; content:" "; distance:0; content:" "; distance:1; within:2; content:" |3A|"; distance:1; within:3; pcre:"/^PASS .*\r\nNICK .?\{.{2,3}\|.+\}([a-z]+)\r\nUSER \1 \d \d :\1/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059229; rev:1876;)

# Command&Control: (Backdoor) SOGU - regex: to_client:^.{,16}g\x00o\x00g\x00o\x00g\x00o\x00d detector_id: 59332
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"OpenBDS Command&Control: (Backdoor) SOGU"; flow:established,to_client,only_stream; content:"g|00|o|00|g|00|o|00|g|00|o|00|d"; pcre:"/^.{,16}g\x00o\x00g\x00o\x00g\x00o\x00d/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1059332; rev:1912;)

# tcp test multi bis - regex: to_server:^EHLO\ JohnsonANDJohnson||to_client:FUFUFUFUFFA detector_id: 59370
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS tcp test multi bis (0) (no alert)"; flow:established,to_server,only_stream; content:"EHLO JohnsonANDJohnson"; depth:22; pcre:"/^EHLO\ JohnsonANDJohnson/s"; flowbits:set,LL.59370_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105937000; rev:1921;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS tcp test multi bis (1)"; flowbits:isset,LL.59370_0; flow:established,to_client,only_stream; content:"FUFUFUFUFFA"; pcre:"/FUFUFUFUFFA/s"; flowbits:unset,LL.59370_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105937001; rev:1921;)

# Command&Control: (Trojan) Dynamer - regex: to_client:[0-9]{6}\|0\r\n||to_server:[0-9]{6}\|1\|[A-Za-z0-9-]+\|[^|]+\|\|\d+\|\d+\|\|[[A-Za-z0-9 .-]+\r\n detector_id: 59516
alert tcp $EXTERNAL_NET 82 -> $HOME_NET any (msg:"OpenBDS Command&Control: (Trojan) Dynamer (0) (no alert)"; flow:established,to_client,only_stream; content:"|7C|0|0D 0A|"; pcre:"/[0-9]{6}\|0\r\n/s"; flowbits:set,LL.59516_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105951600; rev:1956;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 82 (msg:"OpenBDS Command&Control: (Trojan) Dynamer (1)"; flowbits:isset,LL.59516_0; flow:established,to_server,only_stream; content:"|7C|1|7C|"; content:"|7C|"; distance:0; content:"|7C 7C|"; distance:0; content:"|7C|"; distance:0; content:"|7C 7C|"; distance:0; content:"|0D 0A|"; distance:0; pcre:"/[0-9]{6}\|1\|[A-Za-z0-9-]+\|[^|]+\|\|\d+\|\d+\|\|[[A-Za-z0-9 .-]+\r\n/s"; flowbits:unset,LL.59516_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105951601; rev:1956;)

# Command&Control: (Trojan) Poison Ivy - regex: to_server:PASS (?i)virus\r\nNICK (?i)VirUs-[a-z]{6,8}\r\nUSER (?i)(VirUs|[a-z]{6}) "" "[^"]+" : detector_id: 59633
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Poison Ivy"; flow:established,to_server,only_stream; content:"PASS virus|0D 0A|NICK VirUs-"; nocase; content:"|0D 0A|USER VirUs"; nocase; distance:0; content:" |22 22| |22|"; nocase; distance:0; content:"|22| |3A|"; nocase; distance:0; pcre:"/PASS (?i)virus\r\nNICK (?i)VirUs-[a-z]{6,8}\r\nUSER (?i)(VirUs|[a-z]{6}) "" "[^"]+" :/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105963300; rev:2019;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Poison Ivy"; flow:established,to_server,only_stream; content:"PASS virus|0D 0A|NICK VirUs-"; nocase; content:"|0D 0A|USER "; nocase; distance:0; content:" |22 22| |22|"; nocase; distance:0; content:"|22| |3A|"; nocase; distance:0; pcre:"/PASS (?i)virus\r\nNICK (?i)VirUs-[a-z]{6,8}\r\nUSER (?i)(VirUs|[a-z]{6}) "" "[^"]+" :/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105963301; rev:2019;)

# Command&Control: (Banker) Bancos - regex: to_server:^\x01\x01\x00.\x00\x00\x01\x00.{22}S\x00E\x00L\x00E\x00C\x00T\x00 \x00i\x00m\x00g\x00\x20\x00||to_client:^\x04\x00[\x18-\xff].\x00.\x01\x00\x81.*i\x00m\x00g\x00.*This program cannot be run  detector_id: 59635
alert tcp $HOME_NET any -> $EXTERNAL_NET 1433 (msg:"OpenBDS Command&Control: (Banker) Bancos (0) (no alert)"; flow:established,to_server,only_stream; content:"|01 01 00|"; depth:3; content:"|00 00 01 00|"; distance:1; within:5; content:"S|00|E|00|L|00|E|00|C|00|T|00| |00|i|00|m|00|g|00| |00|"; distance:22; within:44; pcre:"/^\x01\x01\x00.\x00\x00\x01\x00.{22}S\x00E\x00L\x00E\x00C\x00T\x00 \x00i\x00m\x00g\x00\x20\x00/s"; flowbits:set,LL.59635_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105963500; rev:2019;)
alert tcp $EXTERNAL_NET 1433 -> $HOME_NET any (msg:"OpenBDS Command&Control: (Banker) Bancos (1)"; flowbits:isset,LL.59635_0; flow:established,to_client,only_stream; content:"|04 00|"; depth:2; content:"|00|"; distance:2; within:3; content:"|01 00 81|"; distance:1; within:4; content:"i|00|m|00|g|00|"; distance:0; content:"This program cannot be run "; distance:0; pcre:"/^\x04\x00[\x18-\xff].\x00.\x01\x00\x81.*i\x00m\x00g\x00.*This program cannot be run /s"; flowbits:unset,LL.59635_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105963501; rev:2019;)

# Command&Control: (Trojan) Poison Ivy - regex: to_server:PASS (?i)Virus\r\nNICK VirUs-[a-z]{6,8}\r\nUSER (VirUs|[a-z]{6}) "" "[^"]+" : detector_id: 59720
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Poison Ivy"; flow:established,to_server,only_stream; content:"PASS Virus|0D 0A|NICK VirUs-"; nocase; content:"|0D 0A|USER VirUs"; nocase; distance:0; content:" |22 22| |22|"; nocase; distance:0; content:"|22| |3A|"; nocase; distance:0; pcre:"/PASS (?i)Virus\r\nNICK VirUs-[a-z]{6,8}\r\nUSER (VirUs|[a-z]{6}) "" "[^"]+" :/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105972000; rev:2043;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Poison Ivy"; flow:established,to_server,only_stream; content:"PASS Virus|0D 0A|NICK VirUs-"; nocase; content:"|0D 0A|USER "; nocase; distance:0; content:" |22 22| |22|"; nocase; distance:0; content:"|22| |3A|"; nocase; distance:0; pcre:"/PASS (?i)Virus\r\nNICK VirUs-[a-z]{6,8}\r\nUSER (VirUs|[a-z]{6}) "" "[^"]+" :/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:105972001; rev:2043;)

# Command&Control: (Trojan) Omaneat - regex: to_server:[A-Za-z0-9+/]{104}(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{4})\r\n||to_client:7f8cqGAJEj1YRkuvn+/4fA== detector_id: 60158
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Omaneat (0) (no alert)"; flow:established,to_server,only_stream; content:"=="; content:"|0D 0A|"; distance:0; pcre:"/[A-Za-z0-9+\/]{104}(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{4})\r\n/s"; flowbits:set,LL.60158_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106015800; rev:2159;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Omaneat (0) (no alert)"; flow:established,to_server,only_stream; content:"="; content:"|0D 0A|"; distance:0; pcre:"/[A-Za-z0-9+\/]{104}(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=|[A-Za-z0-9+\/]{4})\r\n/s"; flowbits:set,LL.60158_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106015801; rev:2159;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Trojan) Omaneat (1)"; flowbits:isset,LL.60158_0; flow:established,to_client,only_stream; content:"7f8cqGAJEj1YRkuvn/4fA=="; pcre:"/7f8cqGAJEj1YRkuvn+\/4fA==/s"; flowbits:unset,LL.60158_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106015802; rev:2159;)

# Command&Control: (Trojan) Carbanak - regex: to_server:\x00\x00OS: [ -~]+, Domain: [ -~]+, User: [ -~]+, Ver:  detector_id: 60163
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Carbanak"; flow:established,to_server,only_stream; content:"|00 00|OS|3A| "; content:"|2C| Domain|3A| "; distance:0; content:"|2C| User|3A| "; distance:0; content:"|2C| Ver|3A| "; distance:0; pcre:"/\x00\x00OS: [ -~]+, Domain: [ -~]+, User: [ -~]+, Ver: /s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060163; rev:2162;)

# Command&Control: (Trojan) Carbanak - regex: to_server:\x09\x01\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00[^\x00]{3}\x00 detector_id: 60164
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Carbanak"; flow:established,to_server,only_stream; content:"|09 01 00 00 00 00 00 00 00 00 02 00 00 00 00 00 00 00 00 00|"; content:"|00|"; distance:3; within:4; pcre:"/\x09\x01\x00\x00\x00\x00\x00\x00\x00\x00\x02\x00\x00\x00\x00\x00\x00\x00\x00\x00[^\x00]{3}\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060164; rev:2162;)

# Command&Control: (Trojan) Zbot - regex: to_server:^\x00\x01\x01\x00\x00\x01\x00\x00\x00\x00\x00\x00.{4}\x05\x00.{21}\x00{5}$ detector_id: 60183
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Zbot"; flow:established,to_server,only_stream; content:"|00 01 01 00 00 01 00 00 00 00 00 00|"; depth:12; content:"|05 00|"; distance:4; within:6; content:"|00 00 00 00 00|"; distance:21; within:26; pcre:"/^\x00\x01\x01\x00\x00\x01\x00\x00\x00\x00\x00\x00.{4}\x05\x00.{21}\x00{5}$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060183; rev:2177;)

# Command&Control: (Trojan) Kryptik - regex: to_server:^....\x6c\x55\x55\x45\x03\x10\x48\x40.{152}$ detector_id: 60184
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Trojan) Kryptik"; flow:established,to_server,only_stream; content:"lUUE|03 10|H|40|"; offset:4; depth:12; pcre:"/^....\x6c\x55\x55\x45\x03\x10\x48\x40.{152}$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060184; rev:2177;)

# Command&Control: (Trojan) ZeroAccess - regex: to_server:^\xc8\xf3T\x85....\x8b\xe1\x8aQ\xbd\}\xf1\x19 detector_id: 60185
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) ZeroAccess"; flow:established,to_server,only_stream; content:"|C8 F3|T|85|"; depth:4; content:"|8B E1 8A|Q|BD 7D F1 19|"; distance:4; within:12; pcre:"/^\xc8\xf3T\x85....\x8b\xe1\x8aQ\xbd\}\xf1\x19/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060185; rev:2177;)

# Command&Control: (Banker) Bancos - regex: to_server:I\x00N\x00S\x00E\x00R\x00T\x00 \x00I\x00N\x00T\x00O\x00 \x00d\x00b\x00o\x00.\x00i\x00n\x00f\x00e\x00c\x00t\x00 \x00 detector_id: 60206
alert tcp $HOME_NET any -> $EXTERNAL_NET 1433 (msg:"OpenBDS Command&Control: (Banker) Bancos"; flow:established,to_server,only_stream; content:"I|00|N|00|S|00|E|00|R|00|T|00| |00|I|00|N|00|T|00|O|00| |00|d|00|b|00|o|00|"; content:"|00|i|00|n|00|f|00|e|00|c|00|t|00| |00|"; distance:1; within:16; pcre:"/I\x00N\x00S\x00E\x00R\x00T\x00 \x00I\x00N\x00T\x00O\x00 \x00d\x00b\x00o\x00.\x00i\x00n\x00f\x00e\x00c\x00t\x00 \x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060206; rev:2207;)

# Command&Control: (Worm) Houdini - regex: to_server:(?:NEW_HOUDINI<\|>)?\d+<\|>[a-zA-Z0-9-]+<\|>[^\/\\\[\]:;\|=,+\*\?<>]+<\|>.+<\|> detector_id: 60292
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Worm) Houdini"; flow:established,to_server,only_stream; content:"<|7C|>"; content:"<|7C|>"; distance:0; content:"<|7C|>"; distance:0; content:"<|7C|>"; distance:0; pcre:"/(?:NEW_HOUDINI<\|>)?\d+<\|>[a-zA-Z0-9-]+<\|>[^\/\\\[\]:\;\|=,+\*\?<>]+<\|>.+<\|>/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060292; rev:2291;)

# Command&Control: (Trojan) - regex: to_server:^,\x01\x00\x00$ detector_id: 60410
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan)"; flow:established,to_server,only_stream; content:"|2C 01 00 00|"; depth:4; pcre:"/^,\x01\x00\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060410; rev:2374;)

# Command&Control: (Trojan) Krap - regex: to_server:^\xDD\xAA\x99f.\x00\x00\x00.\x00\x00\x00\x00\x00\x00\x00\x00.\x00\x00\x10.\x95\x06\x07\xDE.?\x9F.{1,10}\xDE\xD6\xE0||to_client:^\xDD\xAA\x99f detector_id: 60411
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Krap (0) (no alert)"; flow:established,to_server,only_stream; content:"|DD AA 99|f"; depth:4; content:"|00 00 00|"; distance:1; within:4; content:"|00 00 00 00 00 00 00 00|"; distance:1; within:9; content:"|00 00 10|"; distance:1; within:4; content:"|95 06 07 DE|"; distance:1; within:5; content:"|9F|"; distance:0; content:"|DE D6 E0|"; distance:0; pcre:"/^\xDD\xAA\x99f.\x00\x00\x00.\x00\x00\x00\x00\x00\x00\x00\x00.\x00\x00\x10.\x95\x06\x07\xDE.?\x9F.{1,10}\xDE\xD6\xE0/s"; flowbits:set,LL.60411_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106041100; rev:2374;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Trojan) Krap (1)"; flowbits:isset,LL.60411_0; flow:established,to_client,only_stream; content:"|DD AA 99|f"; depth:4; pcre:"/^\xDD\xAA\x99f/s"; flowbits:unset,LL.60411_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106041101; rev:2374;)

# Command&Control: (Backdoor) Venik - regex: to_server:^.{4}\xA8.{7}\xA8.{3}\xA8.{7}\xA8.\xAE.{3}\xC8{34}\xB9\xB8\xBA\xB4\xA8\x8D\x8A\xC8{25} detector_id: 60413
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Venik"; flow:established,to_server,only_stream; content:"|A8|"; offset:4; depth:5; content:"|A8|"; distance:7; within:8; content:"|A8|"; distance:3; within:4; content:"|A8|"; distance:7; within:8; content:"|AE|"; distance:1; within:2; content:"|C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 B9 B8 BA B4 A8 8D 8A C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8 C8|"; distance:3; within:69; pcre:"/^.{4}\xA8.{7}\xA8.{3}\xA8.{7}\xA8.\xAE.{3}\xC8{34}\xB9\xB8\xBA\xB4\xA8\x8D\x8A\xC8{25}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060413; rev:2374;)

# Command&Control: (Backdoor) Nitol - regex: to_server:.*\x00{5}Win(\x20|dows)[\w\s]*\x00{5,}[\d.]+\x20(MB|GB)\x00{5,} detector_id: 60450
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Nitol"; flow:established,to_server,only_stream; content:"|00 00 00 00 00|Win "; content:"|00 00 00 00 00|"; distance:0; content:" MB|00 00 00 00 00|"; distance:0; pcre:"/.*\x00{5}Win(\x20|dows)[\w\s]*\x00{5,}[\d.]+\x20(MB|GB)\x00{5,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106045000; rev:2423;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Nitol"; flow:established,to_server,only_stream; content:"|00 00 00 00 00|Windows"; content:"|00 00 00 00 00|"; distance:0; content:" MB|00 00 00 00 00|"; distance:0; pcre:"/.*\x00{5}Win(\x20|dows)[\w\s]*\x00{5,}[\d.]+\x20(MB|GB)\x00{5,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106045001; rev:2423;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Nitol"; flow:established,to_server,only_stream; content:"|00 00 00 00 00|Win "; content:"|00 00 00 00 00|"; distance:0; content:" GB|00 00 00 00 00|"; distance:0; pcre:"/.*\x00{5}Win(\x20|dows)[\w\s]*\x00{5,}[\d.]+\x20(MB|GB)\x00{5,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106045002; rev:2423;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Nitol"; flow:established,to_server,only_stream; content:"|00 00 00 00 00|Windows"; content:"|00 00 00 00 00|"; distance:0; content:" GB|00 00 00 00 00|"; distance:0; pcre:"/.*\x00{5}Win(\x20|dows)[\w\s]*\x00{5,}[\d.]+\x20(MB|GB)\x00{5,}/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106045003; rev:2423;)

# Command&Control: (Trojan) Virut - regex: to_server:^\x01[0-9A-Z\-]{4,20}\x00\x00\x00\x00{11,27}||to_client:^\x02||to_server:^\x02\x02\x02 detector_id: 60465
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Virut (0) (no alert)"; flow:established,to_server,only_stream; content:"|01|"; depth:1; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; distance:0; pcre:"/^\x01[0-9A-Z\-]{4,20}\x00\x00\x00\x00{11,27}/s"; flowbits:set,LL.60465_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106046500; rev:2431;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Trojan) Virut (1) (no alert)"; flowbits:isset,LL.60465_0; flow:established,to_client,only_stream; content:"|02|"; depth:1; pcre:"/^\x02/s"; flowbits:unset,LL.60465_0; flowbits:set,LL.60465_1; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106046501; rev:2431;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Virut (2)"; flowbits:isset,LL.60465_1; flow:established,to_server,only_stream; content:"|02 02 02|"; depth:3; pcre:"/^\x02\x02\x02/s"; flowbits:unset,LL.60465_1; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106046502; rev:2431;)

# Adware: (Riskware) Chinbo - regex: to_server:^\d{14}\,0\,0||to_client:^1 detector_id: 60493
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: (Riskware) Chinbo (0) (no alert)"; flow:established,to_server,only_stream; content:"|2C|0|2C|0"; offset:14; depth:18; pcre:"/^\d{14}\,0\,0/s"; flowbits:set,LL.60493_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106049300; rev:2515;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Adware: (Riskware) Chinbo (1)"; flowbits:isset,LL.60493_0; flow:established,to_client,only_stream; content:"1"; depth:1; pcre:"/^1/s"; flowbits:unset,LL.60493_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106049301; rev:2515;)

# Adware: test proposal - regex: to_server:test signature proposal detector_id: 60598
alert tcp $HOME_NET any -> $EXTERNAL_NET 31 (msg:"OpenBDS Adware: test proposal"; flow:established,to_server,only_stream; content:"test signature proposal"; pcre:"/test signature proposal/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060598; rev:2647;)

# Adware: 4share test - regex: to_server:now again another one! detector_id: 60599
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Adware: 4share test"; flow:established,to_server,only_stream; content:"now again another one|21|"; pcre:"/now again another one!/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060599; rev:2647;)

# Composite tcp signature test 2 - regex: to_server:^\x16\x03\x01\x01\x06\x10\x00\x01\x02\x01\x00||to_client:^\x14\x03\x01\x00\x01\x01\x16\x03\x01\x00\( detector_id: 60611
alert tcp $HOME_NET any -> $EXTERNAL_NET 1234 (msg:"OpenBDS Composite tcp signature test 2 (0) (no alert)"; flow:established,to_server,only_stream; content:"|16 03 01 01 06 10 00 01 02 01 00|"; depth:11; pcre:"/^\x16\x03\x01\x01\x06\x10\x00\x01\x02\x01\x00/s"; flowbits:set,LL.60611_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106061100; rev:2652;)
alert tcp $EXTERNAL_NET 1234 -> $HOME_NET any (msg:"OpenBDS Composite tcp signature test 2 (1)"; flowbits:isset,LL.60611_0; flow:established,to_client,only_stream; content:"|14 03 01 00 01 01 16 03 01 00 28|"; depth:11; pcre:"/^\x14\x03\x01\x00\x01\x01\x16\x03\x01\x00\(/s"; flowbits:unset,LL.60611_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106061101; rev:2652;)

# Command&Control: (Trojan) NanoCore - regex: to_client:^\x20\x00\x00\x00[^\x00\x01](?!\x00{3}).{3}.{28}$||to_server:^\x08\x00\x00\x00(?!\x00{4}).{4}.{4}$ detector_id: 60658
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Trojan) NanoCore (0) (no alert)"; flow:established,to_client,only_stream; content:" |00 00 00|"; depth:4; pcre:"/^\x20\x00\x00\x00[^\x00\x01](?!\x00{3}).{3}.{28}$/s"; flowbits:set,LL.60658_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106065800; rev:2659;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) NanoCore (1)"; flowbits:isset,LL.60658_0; flow:established,to_server,only_stream; content:"|08 00 00 00|"; depth:4; pcre:"/^\x08\x00\x00\x00(?!\x00{4}).{4}.{4}$/s"; flowbits:unset,LL.60658_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106065801; rev:2659;)

# Command&Control: (Trojan) Sality - regex: to_server:^.[\x00-\x03]\x00\x00..(?:\x12|\x11)\x00$||to_client:^\x11q\x00\x00\x9F\?\x9C\xFD\xB2\xE0 detector_id: 60659
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sality (0) (no alert)"; flow:established,to_server,only_stream; content:"|00 00|"; offset:2; depth:4; content:"|12 00|"; distance:0; pcre:"/^.[\x00-\x03]\x00\x00..(?:\x12|\x11)\x00$/s"; flowbits:set,LL.60659_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106065900; rev:2659;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Sality (0) (no alert)"; flow:established,to_server,only_stream; content:"|00 00|"; offset:2; depth:4; content:"|11 00|"; distance:0; pcre:"/^.[\x00-\x03]\x00\x00..(?:\x12|\x11)\x00$/s"; flowbits:set,LL.60659_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106065901; rev:2659;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Trojan) Sality (1)"; flowbits:isset,LL.60659_0; flow:established,to_client,only_stream; content:"|11|q|00 00 9F|?|9C FD B2 E0|"; depth:10; pcre:"/^\x11q\x00\x00\x9F\?\x9C\xFD\xB2\xE0/s"; flowbits:unset,LL.60659_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106065902; rev:2659;)

# Command&Control: (Dropper) Tiny - regex: to_server:^.{8}\x0C\x00\x00.$||to_client:.{150,}(?:.{5,40}\xE8.\x00\x00\x00(CreateToolhelp32Snapshot|GetLastError|Process32First|GetModuleHandle|GetVersionEx|lstrcat|lstrlen|CreateProcess|SetFilePointer|RegQueryValueEx|RegCloseKey|GetFolderPath))+ detector_id: 60660
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Dropper) Tiny (0) (no alert)"; flow:established,to_server,only_stream; content:"|0C 00 00|"; offset:8; depth:11; pcre:"/^.{8}\x0C\x00\x00.$/s"; flowbits:set,LL.60660_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106066000; rev:2659;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Dropper) Tiny (1)"; flowbits:isset,LL.60660_0; flow:established,to_client,only_stream; content:"|E8|"; content:"|00 00 00|CreateToolhelp32Snapshot"; distance:1; within:28; pcre:"/.{150,}(?:.{5,40}\xE8.\x00\x00\x00(CreateToolhelp32Snapshot|GetLastError|Process32First|GetModuleHandle|GetVersionEx|lstrcat|lstrlen|CreateProcess|SetFilePointer|RegQueryValueEx|RegCloseKey|GetFolderPath))+/s"; flowbits:unset,LL.60660_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106066001; rev:2659;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Dropper) Tiny (1)"; flowbits:isset,LL.60660_0; flow:established,to_client,only_stream; content:"|E8|"; content:"|00 00 00|GetLastError"; distance:1; within:16; pcre:"/.{150,}(?:.{5,40}\xE8.\x00\x00\x00(CreateToolhelp32Snapshot|GetLastError|Process32First|GetModuleHandle|GetVersionEx|lstrcat|lstrlen|CreateProcess|SetFilePointer|RegQueryValueEx|RegCloseKey|GetFolderPath))+/s"; flowbits:unset,LL.60660_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106066002; rev:2659;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Dropper) Tiny (1)"; flowbits:isset,LL.60660_0; flow:established,to_client,only_stream; content:"|E8|"; content:"|00 00 00|Process32First"; distance:1; within:18; pcre:"/.{150,}(?:.{5,40}\xE8.\x00\x00\x00(CreateToolhelp32Snapshot|GetLastError|Process32First|GetModuleHandle|GetVersionEx|lstrcat|lstrlen|CreateProcess|SetFilePointer|RegQueryValueEx|RegCloseKey|GetFolderPath))+/s"; flowbits:unset,LL.60660_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106066003; rev:2659;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Dropper) Tiny (1)"; flowbits:isset,LL.60660_0; flow:established,to_client,only_stream; content:"|E8|"; content:"|00 00 00|GetModuleHandle"; distance:1; within:19; pcre:"/.{150,}(?:.{5,40}\xE8.\x00\x00\x00(CreateToolhelp32Snapshot|GetLastError|Process32First|GetModuleHandle|GetVersionEx|lstrcat|lstrlen|CreateProcess|SetFilePointer|RegQueryValueEx|RegCloseKey|GetFolderPath))+/s"; flowbits:unset,LL.60660_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106066004; rev:2659;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Dropper) Tiny (1)"; flowbits:isset,LL.60660_0; flow:established,to_client,only_stream; content:"|E8|"; content:"|00 00 00|GetVersionEx"; distance:1; within:16; pcre:"/.{150,}(?:.{5,40}\xE8.\x00\x00\x00(CreateToolhelp32Snapshot|GetLastError|Process32First|GetModuleHandle|GetVersionEx|lstrcat|lstrlen|CreateProcess|SetFilePointer|RegQueryValueEx|RegCloseKey|GetFolderPath))+/s"; flowbits:unset,LL.60660_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106066005; rev:2659;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Dropper) Tiny (1)"; flowbits:isset,LL.60660_0; flow:established,to_client,only_stream; content:"|E8|"; content:"|00 00 00|lstrcat"; distance:1; within:11; pcre:"/.{150,}(?:.{5,40}\xE8.\x00\x00\x00(CreateToolhelp32Snapshot|GetLastError|Process32First|GetModuleHandle|GetVersionEx|lstrcat|lstrlen|CreateProcess|SetFilePointer|RegQueryValueEx|RegCloseKey|GetFolderPath))+/s"; flowbits:unset,LL.60660_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106066006; rev:2659;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Dropper) Tiny (1)"; flowbits:isset,LL.60660_0; flow:established,to_client,only_stream; content:"|E8|"; content:"|00 00 00|lstrlen"; distance:1; within:11; pcre:"/.{150,}(?:.{5,40}\xE8.\x00\x00\x00(CreateToolhelp32Snapshot|GetLastError|Process32First|GetModuleHandle|GetVersionEx|lstrcat|lstrlen|CreateProcess|SetFilePointer|RegQueryValueEx|RegCloseKey|GetFolderPath))+/s"; flowbits:unset,LL.60660_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106066007; rev:2659;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Dropper) Tiny (1)"; flowbits:isset,LL.60660_0; flow:established,to_client,only_stream; content:"|E8|"; content:"|00 00 00|CreateProcess"; distance:1; within:17; pcre:"/.{150,}(?:.{5,40}\xE8.\x00\x00\x00(CreateToolhelp32Snapshot|GetLastError|Process32First|GetModuleHandle|GetVersionEx|lstrcat|lstrlen|CreateProcess|SetFilePointer|RegQueryValueEx|RegCloseKey|GetFolderPath))+/s"; flowbits:unset,LL.60660_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106066008; rev:2659;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Dropper) Tiny (1)"; flowbits:isset,LL.60660_0; flow:established,to_client,only_stream; content:"|E8|"; content:"|00 00 00|SetFilePointer"; distance:1; within:18; pcre:"/.{150,}(?:.{5,40}\xE8.\x00\x00\x00(CreateToolhelp32Snapshot|GetLastError|Process32First|GetModuleHandle|GetVersionEx|lstrcat|lstrlen|CreateProcess|SetFilePointer|RegQueryValueEx|RegCloseKey|GetFolderPath))+/s"; flowbits:unset,LL.60660_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106066009; rev:2659;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Dropper) Tiny (1)"; flowbits:isset,LL.60660_0; flow:established,to_client,only_stream; content:"|E8|"; content:"|00 00 00|RegQueryValueEx"; distance:1; within:19; pcre:"/.{150,}(?:.{5,40}\xE8.\x00\x00\x00(CreateToolhelp32Snapshot|GetLastError|Process32First|GetModuleHandle|GetVersionEx|lstrcat|lstrlen|CreateProcess|SetFilePointer|RegQueryValueEx|RegCloseKey|GetFolderPath))+/s"; flowbits:unset,LL.60660_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106066010; rev:2659;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Dropper) Tiny (1)"; flowbits:isset,LL.60660_0; flow:established,to_client,only_stream; content:"|E8|"; content:"|00 00 00|RegCloseKey"; distance:1; within:15; pcre:"/.{150,}(?:.{5,40}\xE8.\x00\x00\x00(CreateToolhelp32Snapshot|GetLastError|Process32First|GetModuleHandle|GetVersionEx|lstrcat|lstrlen|CreateProcess|SetFilePointer|RegQueryValueEx|RegCloseKey|GetFolderPath))+/s"; flowbits:unset,LL.60660_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106066011; rev:2659;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Dropper) Tiny (1)"; flowbits:isset,LL.60660_0; flow:established,to_client,only_stream; content:"|E8|"; content:"|00 00 00|GetFolderPath"; distance:1; within:17; pcre:"/.{150,}(?:.{5,40}\xE8.\x00\x00\x00(CreateToolhelp32Snapshot|GetLastError|Process32First|GetModuleHandle|GetVersionEx|lstrcat|lstrlen|CreateProcess|SetFilePointer|RegQueryValueEx|RegCloseKey|GetFolderPath))+/s"; flowbits:unset,LL.60660_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106066012; rev:2659;)

# Malware distribution: (Possible Worm) RPC DCOM exploit - regex: to_server:^\x05\x00\x0b\x03\x10\x00\x00\x00..\x00\x00.\x00\x00\x00.{5}\x00.\x00.\x00.\x00.\x00.\x00.{40}$||to_server:^\x05\x00\x00\x03.{98}\x00\x00MARB\x01\x00\x00\x00.{22}\x00\x00MEOW\x04\x00\x00\x00 detector_id: 60661
alert tcp $HOME_NET any -> $EXTERNAL_NET 135 (msg:"OpenBDS Malware distribution: (Possible Worm) RPC DCOM exploit (0) (no alert)"; flow:established,to_server,only_stream; content:"|05 00 0B 03 10 00 00 00|"; depth:8; content:"|00 00|"; distance:2; within:4; content:"|00 00 00|"; distance:1; within:4; content:"|00|"; distance:5; within:6; content:"|00|"; distance:1; within:2; content:"|00|"; distance:1; within:2; content:"|00|"; distance:1; within:2; content:"|00|"; distance:1; within:2; content:"|00|"; distance:1; within:2; pcre:"/^\x05\x00\x0b\x03\x10\x00\x00\x00..\x00\x00.\x00\x00\x00.{5}\x00.\x00.\x00.\x00.\x00.\x00.{40}$/s"; flowbits:set,LL.60661_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106066100; rev:2662;)
alert tcp $HOME_NET any -> $EXTERNAL_NET 135 (msg:"OpenBDS Malware distribution: (Possible Worm) RPC DCOM exploit (1)"; flowbits:isset,LL.60661_0; flow:established,to_server,only_stream; content:"|05 00 00 03|"; depth:4; content:"|00 00|MARB|01 00 00 00|"; distance:98; within:108; content:"|00 00|MEOW|04 00 00 00|"; distance:22; within:32; pcre:"/^\x05\x00\x00\x03.{98}\x00\x00MARB\x01\x00\x00\x00.{22}\x00\x00MEOW\x04\x00\x00\x00/s"; flowbits:unset,LL.60661_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106066101; rev:2662;)

# Command&Control: (Trojan) Dorkbot/NgrBot - regex: to_server:PASS [^\r\n]+\r\nKCIK [a-zA-Z0-9]*([^a-zA-Z0-9][a-zA-Z0-9]+){3}\r\n detector_id: 60695
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Dorkbot/NgrBot"; flow:established,to_server,only_stream; content:"PASS "; content:"|0D 0A|KCIK "; distance:0; content:"|0D 0A|"; distance:0; pcre:"/PASS [^\r\n]+\r\nKCIK [a-zA-Z0-9]*([^a-zA-Z0-9][a-zA-Z0-9]+){3}\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060695; rev:2708;)

# Command&Control: (Backdoor) GenericBackdoor_14 - regex: to_server:^01\|[^\n]+\n02\|[a-zA-Z0-9\_]+\@[^\|]+\|[^\|]+\|ENU\n detector_id: 60696
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) GenericBackdoor_14"; flow:established,to_server,only_stream; content:"01|7C|"; depth:3; content:"|0A|02|7C|"; distance:0; content:"|40|"; distance:0; content:"|7C|"; distance:0; content:"|7C|ENU|0A|"; distance:0; pcre:"/^01\|[^\n]+\n02\|[a-zA-Z0-9\_]+\@[^\|]+\|[^\|]+\|ENU\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060696; rev:2708;)

# Command&Control: (VirTool) Ceeinject - regex: to_server:^\<id\>srv\_[a-f0-9]{32}\<\/id\>||to_client:^OK\d+\.\d+\.\d+\.\d+\x00 detector_id: 60720
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (VirTool) Ceeinject (0) (no alert)"; flow:established,to_server,only_stream; content:"<id>srv_"; depth:8; content:"</id>"; distance:32; within:37; pcre:"/^\<id\>srv\_[a-f0-9]{32}\<\/id\>/s"; flowbits:set,LL.60720_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106072000; rev:2742;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (VirTool) Ceeinject (1)"; flowbits:isset,LL.60720_0; flow:established,to_client,only_stream; content:"OK"; depth:2; content:"."; distance:0; content:"."; distance:0; content:"."; distance:0; content:"|00|"; distance:0; pcre:"/^OK\d+\.\d+\.\d+\.\d+\x00/s"; flowbits:unset,LL.60720_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106072001; rev:2742;)

# Command&Control: (IRC Botnet) Scar - regex: to_server:NICK \[[A-Z]{2}\|x(32|64)\|[a-zA-Z0-9]+\|\d+\]\r\n detector_id: 60724
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (IRC Botnet) Scar"; flow:established,to_server,only_stream; content:"NICK |5B|"; content:"|7C|x32|7C|"; distance:2; within:7; content:"|7C|"; distance:0; content:"|5D 0D 0A|"; distance:0; pcre:"/NICK \[[A-Z]{2}\|x(32|64)\|[a-zA-Z0-9]+\|\d+\]\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106072400; rev:2742;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (IRC Botnet) Scar"; flow:established,to_server,only_stream; content:"NICK |5B|"; content:"|7C|x64|7C|"; distance:2; within:7; content:"|7C|"; distance:0; content:"|5D 0D 0A|"; distance:0; pcre:"/NICK \[[A-Z]{2}\|x(32|64)\|[a-zA-Z0-9]+\|\d+\]\r\n/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106072401; rev:2742;)

# Command&Control: (Trojan) Vbna - regex: to_server:^\[[a-zA-Z\_]+\]\|1234567890\$\$\%\%\&\&FIN\$\$\%\%\&\& detector_id: 60725
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Vbna"; flow:established,to_server,only_stream; content:"|5B|"; depth:1; content:"|5D 7C|1234567890|24 24 25 25|&&FIN|24 24 25 25|&&"; distance:0; pcre:"/^\[[a-zA-Z\_]+\]\|1234567890\$\$\%\%\&\&FIN\$\$\%\%\&\&/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060725; rev:2742;)

# Command&Control: (Trojan) Staser - regex: to_client:^\x09\x00\x00\x00..\x00\x00.*\x20{100,}\x00$ detector_id: 60726
alert tcp $EXTERNAL_NET [952,953] -> $HOME_NET any (msg:"OpenBDS Command&Control: (Trojan) Staser"; flow:established,to_client,only_stream; content:"|09 00 00 00|"; depth:4; content:"|00 00|"; distance:2; within:4; content:"                                                                                                    |00|"; distance:0; pcre:"/^\x09\x00\x00\x00..\x00\x00.*\x20{100,}\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060726; rev:2742;)

# Command&Control: (Trojan) Bookworm - regex: to_server:POST / HTTP/\d\.\d\r\nContent-Length: \d+\r\nConnection: Keep-Alive\r\n\r\n\x00\x08.+ZZ detector_id: 60728
alert tcp $HOME_NET any -> $EXTERNAL_NET 80 (msg:"OpenBDS Command&Control: (Trojan) Bookworm"; flow:established,to_server,only_stream; content:"POST / HTTP/"; content:"."; distance:1; within:2; content:"|0D 0A|Content-Length|3A| "; distance:1; within:19; content:"|0D 0A|Connection|3A| Keep-Alive|0D 0A 0D 0A 00 08|"; distance:0; content:"ZZ"; distance:0; pcre:"/POST \/ HTTP\/\d\.\d\r\nContent-Length: \d+\r\nConnection: Keep-Alive\r\n\r\n\x00\x08.+ZZ/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060728; rev:2742;)

# Command&Control: (Backdoor) Nitol - regex: to_server:^\x64\x01\x00\x00\x77[\x00-\xff]+Win[^\x00]+\x00+[0-9]{1,5} (GB|MB|Mbps)\x00+[0-9]{3,4} MHz\x00+[\x00-\xff]+\x00$ detector_id: 60735
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Nitol"; flow:established,to_server,only_stream; content:"d|01 00 00|w"; depth:5; content:"Win"; distance:0; content:"|00|"; distance:0; content:" GB|00|"; distance:0; content:" MHz|00|"; distance:0; content:"|00|"; distance:0; pcre:"/^\x64\x01\x00\x00\x77[\x00-\xff]+Win[^\x00]+\x00+[0-9]{1,5} (GB|MB|Mbps)\x00+[0-9]{3,4} MHz\x00+[\x00-\xff]+\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106073500; rev:2754;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Nitol"; flow:established,to_server,only_stream; content:"d|01 00 00|w"; depth:5; content:"Win"; distance:0; content:"|00|"; distance:0; content:" MB|00|"; distance:0; content:" MHz|00|"; distance:0; content:"|00|"; distance:0; pcre:"/^\x64\x01\x00\x00\x77[\x00-\xff]+Win[^\x00]+\x00+[0-9]{1,5} (GB|MB|Mbps)\x00+[0-9]{3,4} MHz\x00+[\x00-\xff]+\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106073501; rev:2754;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Nitol"; flow:established,to_server,only_stream; content:"d|01 00 00|w"; depth:5; content:"Win"; distance:0; content:"|00|"; distance:0; content:" Mbps|00|"; distance:0; content:" MHz|00|"; distance:0; content:"|00|"; distance:0; pcre:"/^\x64\x01\x00\x00\x77[\x00-\xff]+Win[^\x00]+\x00+[0-9]{1,5} (GB|MB|Mbps)\x00+[0-9]{3,4} MHz\x00+[\x00-\xff]+\x00$/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106073502; rev:2754;)

# Command&Control: (Trojan) Blocrypt - regex: to_server:.{11}\x00\x00\x00Execution\x20\d+\x20\(\w*\) detector_id: 60736
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Blocrypt"; flow:established,to_server,only_stream; content:"|00 00 00|Execution "; content:" |28|"; distance:0; content:"|29|"; distance:0; pcre:"/.{11}\x00\x00\x00Execution\x20\d+\x20\(\w*\)/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060736; rev:2754;)

# Command&Control: (Trojan) Blocrypt - regex: to_server:^.{10,}\x92w\xB4\x5c&\x00\x00\x00 detector_id: 60737
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Blocrypt"; flow:established,to_server,only_stream; content:"|92|w|B4 5C|&|00 00 00|"; pcre:"/^.{10,}\x92w\xB4\x5c&\x00\x00\x00/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060737; rev:2754;)

# Adware: (PUA) VisualProtect - regex: to_server:^\xFF\x00\x00\x00\x00\x00\x00\x00\x01\x7F detector_id: 60738
alert tcp $HOME_NET any -> $EXTERNAL_NET 6666 (msg:"OpenBDS Adware: (PUA) VisualProtect"; flow:established,to_server,only_stream; content:"|FF 00 00 00 00 00 00 00 01 7F|"; depth:10; pcre:"/^\xFF\x00\x00\x00\x00\x00\x00\x00\x01\x7F/s"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060738; rev:2754;)

# Command&Control: (Trojan) Bladabindi - regex: to_server:^\d{2,3}\x00[ -~]{20,}||to_client:^0\x00$ detector_id: 60831
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Bladabindi (0) (no alert)"; flow:established,to_server,only_stream; content:"|00|"; pcre:"/^\d{2,3}\x00[ -~]{20,}/s"; flowbits:set,LL.60831_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106083100; rev:2898;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Trojan) Bladabindi (1)"; flowbits:isset,LL.60831_0; flow:established,to_client,only_stream; content:"0|00|"; depth:2; pcre:"/^0\x00$/s"; flowbits:unset,LL.60831_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106083101; rev:2898;)

# Command&Control: (Trojan) Omaneat - regex: to_server:^1\*2U[A-Za-z0-9+\/]+={0,3}\r\n||to_client:^[A-Za-z0-9+\/]+={0,3}\r\n detector_id: 60832
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Omaneat (0) (no alert)"; flow:established,to_server,only_stream; content:"1|2A|2U"; depth:4; content:"|0D 0A|"; distance:0; pcre:"/^1\*2U[A-Za-z0-9+\/]+={0,3}\r\n/s"; flowbits:set,LL.60832_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106083200; rev:2898;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Trojan) Omaneat (1)"; flowbits:isset,LL.60832_0; flow:established,to_client,only_stream; content:"|0D 0A|"; pcre:"/^[A-Za-z0-9+\/]+={0,3}\r\n/s"; flowbits:unset,LL.60832_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106083201; rev:2898;)

# Exploit Toolkit: (EK) UnnamedChineseEK - regex: to_server; http_method="GET"; http_uri="/jquery.min.js";||to_client; http_server_body="<html>"; http_server_body="file_exists"; http_server_body="\360Base.dll"; detector_id: 60758
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Exploit Toolkit: (EK) UnnamedChineseEK (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"/jquery.min.js"; http_uri; flowbits:set,LL.60758_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106075800; rev:2778;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Exploit Toolkit: (EK) UnnamedChineseEK (1)"; flowbits:isset,LL.60758_0; flow:established,to_client; content:"<html>"; http_server_body; content:"file_exists"; http_server_body; content:"|5C|360Base.dll"; http_server_body; flowbits:unset,LL.60758_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106075801; rev:2778;)

# Exploit Toolkit: (EK) UnnamedChineseEK - regex: to_server; http_method="GET"; http_uri="/jquery.min.js";||to_client; http_server_body="<html>"; http_server_body="file_exists"; http_server_body="\360Base.dll"; detector_id: 60757
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Exploit Toolkit: (EK) UnnamedChineseEK (0) (no alert)"; flow:established,to_server; content:"GET"; nocase; http_method; content:"/jquery.min.js"; http_uri; flowbits:set,LL.60757_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106075700; rev:2778;)
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Exploit Toolkit: (EK) UnnamedChineseEK (1)"; flowbits:isset,LL.60757_0; flow:established,to_client; content:"<html>"; http_server_body; content:"file_exists"; http_server_body; content:"|5C|360Base.dll"; http_server_body; flowbits:unset,LL.60757_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106075701; rev:2778;)

# Command&Control: (PasswordStealer) Pony/Fareit - regex: to_server; content="POST /"; content="news.php"; content="HTTP/"; content="Host:"; content="Accept: */*"; content="Connection: close"; content="Content-Encoding: binary"; !content="Referer:"; pcre_http_client_body="\xFF"; detector_id: 60759
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (PasswordStealer) Pony/Fareit"; flow:established,to_server; content:"POST /"; content:"news.php"; content:"HTTP/"; content:"Host|3A|"; content:"Accept|3A| |2A|/|2A|"; content:"Connection|3A| close"; content:"Content-Encoding|3A| binary"; content:!"Referer|3A|"; pcre:"/\xFF/P"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060759; rev:2778;)

# Command&Control: (Trojan) KazyBot - regex: to_server; http_method="POST"; content=".php"; content="Content-Type: application/x-www-form-urlencoded"; http_header="Host"; http_header="Content-Length"; content="Expect: 100-continue"; content="Connection: Close"; !http_header="Referer"; !http_header="User-Agent"; http_client_body="ID="; http_client_body="VERSION="; detector_id: 60805
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) KazyBot"; flow:established,to_server; content:"POST"; nocase; http_method; content:".php"; content:"Content-Type|3A| application/x-www-form-urlencoded"; content:"Host"; http_header; content:"Content-Length"; http_header; content:"Expect|3A| 100-continue"; content:"Connection|3A| Close"; content:!"Referer"; http_header; content:!"User-Agent"; http_header; content:"ID="; http_client_body; content:"VERSION="; http_client_body; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060805; rev:2832;)

# Command&Control: (Trojan) KazyBot - regex: to_server; http_method="POST"; content=".php"; content="Content-Type: application/x-www-form-urlencoded"; http_header="Host"; http_header="Content-Length"; content="Expect: 100-continue"; content="Connection: Close"; !http_header="Referer"; !http_header="User-Agent";||to_server; http_client_body="ID="; http_client_body="VERSION="; detector_id: 60806
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) KazyBot (0) (no alert)"; flow:established,to_server; content:"POST"; nocase; http_method; content:".php"; content:"Content-Type|3A| application/x-www-form-urlencoded"; content:"Host"; http_header; content:"Content-Length"; http_header; content:"Expect|3A| 100-continue"; content:"Connection|3A| Close"; content:!"Referer"; http_header; content:!"User-Agent"; http_header; flowbits:set,LL.60806_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106080600; rev:2832;)
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) KazyBot (1)"; flowbits:isset,LL.60806_0; flow:established,to_server; content:"ID="; http_client_body; content:"VERSION="; http_client_body; flowbits:unset,LL.60806_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106080601; rev:2832;)

# Command&Control: (Trojan) Neshta - regex: to_server; http_method="POST"; pcre="/analysis.+\.php"; content="Connection: keep-alive"; pcre="Content-Type: multipart/form-data; boundary=[^\r\n]+"; http_header="Content-Length"; http_header="Host"; http_header="Accept"; http_header="User-Agent"; !http_header="Referer"; pcre_http_client_body="[\d-]+\r\nContent-Disposition: form-data; name=\x22UID=\x22\r\n\r\nTest\r\n[\d-]+"; detector_id: 60829
alert http $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Trojan) Neshta"; flow:established,to_server; content:"POST"; nocase; http_method; pcre:"/\/analysis.+\.php/"; content:"Connection|3A| keep-alive"; pcre:"/Content-Type: multipart\/form-data\; boundary=[^\r\n]+/"; content:"Content-Length"; http_header; content:"Host"; http_header; content:"Accept"; http_header; content:"User-Agent"; http_header; content:!"Referer"; http_header; pcre:"/[\d-]+\r\nContent-Disposition: form-data\; name=\x22UID=\x22\r\n\r\nTest\r\n[\d-]+/P"; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:1060829; rev:2898;)

# Command&Control: (Backdoor) Blocrypt - regex: to_client; dsize=5; pcre="^\x00\x00\x00\x00\x06";||to_server; dsize=5; pcre="^\x00\x00\x00\x00\x06"; detector_id: 60838
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS Command&Control: (Backdoor) Blocrypt (0) (no alert)"; flow:established,to_client; dsize:5; content:"|00 00 00 00 06|"; pcre:"/^\x00\x00\x00\x00\x06/"; flowbits:set,LL.60838_0; flowbits:noalert; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106083800; rev:2902;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any (msg:"OpenBDS Command&Control: (Backdoor) Blocrypt (1)"; flowbits:isset,LL.60838_0; flow:established,to_server; dsize:5; content:"|00 00 00 00 06|"; pcre:"/^\x00\x00\x00\x00\x06/"; flowbits:unset,LL.60838_0; threshold: type limit, track by_src, seconds 180, count 1; reference:url,www.openbds.org; classtype:trojan-activity; sid:106083801; rev:2902;)

# manual signature - detector_id: 46091
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"BROWSER-IE Internet Explorer Use-After-Free detected"; flow:to_client,established; file_data; content:"|7b| Behavior|3a| url|28 23|default|23|VML|29 20 7d|"; nocase; content:"CollectGarbage()"; nocase; content:".offsetParent"; nocase; content:".onpropertychange ="; nocase; distance:0; within:24; content:".firstChild.nextSibling"; nocase; fast_pattern:only; content:".disabled"; nocase; metadata:impact_flag red, service http, service pop3, service imap; reference:cve,2014-1776; classtype:attempted-user; sid:1046091; rev:0;)

# manual signature - detector_id: 46097
alert http $EXTERNAL_NET any -> $HOME_NET any (msg:"OpenBDS CURRENT_EVENTS Common Group Indicators Used in Various Targeted 0-day Attacks"; flow:from_server,established; file_data; content:"dword2data"; fast_pattern; pcre:"/^\s*?\(/Rs"; pcre:"/function\s*?fun\s*?\(/s"; content:"CollectGarbage"; reference:cve,2014-0322; reference:cve,2014-1776; classtype:trojan-activity; sid:1046097; rev:0;)

# manual signature - detector_id: 51267
alert tcp $EXTERNAL_NET 443 -> $HOME_NET any (msg:"OpenBDS Command&Control: (Trojan) Upatre suspicious certificate"; flow:established,from_server; content:"|2a 86 48 86 f7 0d 01 09 01|"; pcre:"/^.{2}(?P<fake_email>([asdfgh]+|[qwerty]+|[zxcvbn]+)\@([asdfgh]+|[qwerty]+|[zxcvbn]+)\.)/Rs"; content:"|06 03 55 04 07|"; pcre:"/^.{2}(?P<fake_loc>([asdfgh]+|[qwerty]+|[zxcvbn]+|[23werf]+)[01])/Rs"; classtype:trojan-activity; sid:1051267; rev:0; threshold: type limit, track by_src, seconds 300, count 500;)

# manual signature - detector_id: 1627
alert tcp $HOME_NET any -> $EXTERNAL_NET 25 (msg:"OpenBDS Phishing: (APT Phishing) Nitro X-Mailer "; content:"x-mailer:"; nocase; content:"10.40.1836"; within:30; classtype:trojan-activity; sid:1001627; rev:0;)

# manual signature - detector_id: 46092
alert tcp $EXTERNAL_NET any -> $HOME_NET any (msg:"FILE-IMAGE known-bad struct marker found in GIF"; flow:to_client,established; file_data; content:"GIF"; distance:0; content:"|60 75 84 13 B8 0A 8E 5D 27 05 0C 8F|"; fast_pattern:only; metadata:impact_flag red, service http, service pop3, service imap; reference:cve,2014-1776; classtype:successful-admin; sid:1046092; rev:0;)

